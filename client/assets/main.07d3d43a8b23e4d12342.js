(window.webpackJsonp=window.webpackJsonp||[]).push([[1],{0:function(t,e,s){t.exports=s("zUnb")},JY8D:function(t){t.exports=JSON.parse('{"a":{"direction":0,"camera":{"x":0,"y":0,"z":10},"canvases":[{"scale":"h","geometries":[{"id":"vertical","width":90,"height":130,"dx":0,"dy":0},{"id":"sitting","width":90,"height":130,"dx":0,"dy":0},{"id":"horizontal","width":128,"height":80,"dx":30,"dy":0},{"id":"swhorizontal","width":192,"height":120,"dx":0,"dy":-40}]},{"scale":"sh","geometries":[{"id":"vertical","width":45,"height":72,"dx":0,"dy":0},{"id":"sitting","width":45,"height":72,"dx":0,"dy":0},{"id":"horizontal","width":64,"height":50,"dx":15,"dy":-10},{"id":"swhorizontal","width":96,"height":70,"dx":0,"dy":-20},{"id":"swim","width":64,"height":70,"dx":25,"dy":10}]}],"avatarSets":[{"id":"full","avatarSets":[{"id":"body","main":true,"bodyParts":[{"id":"top"},{"id":"bottom"},{"id":"behind"},{"id":"torso"},{"id":"leftitem"},{"id":"rightitem"},{"id":"leftarm"},{"id":"rightarm"}]},{"id":"head","bodyParts":[{"id":"head"}]}]}],"types":[{"id":"vertical","bodyParts":[{"id":"top","x":0,"y":0,"z":0,"radius":2},{"id":"bottom","x":0,"y":0,"z":0,"radius":0.001},{"id":"behind","x":0,"y":0,"z":0.2,"radius":0.3},{"id":"torso","x":0,"y":0,"z":0,"radius":0.4,"items":[{"id":"bd","x":0,"y":0,"z":0,"radius":0.01,"nx":0,"ny":0,"nz":-1,"double":true},{"id":"bds","x":0,"y":0,"z":0,"radius":0.01,"nx":0,"ny":0,"nz":-1,"double":true},{"id":"ch","x":0,"y":0,"z":0,"radius":0.04,"nx":0,"ny":0,"nz":-1,"double":false},{"id":"sh","x":0,"y":0,"z":0,"radius":0.02,"nx":0,"ny":0,"nz":-1,"double":false},{"id":"lg","x":0,"y":0,"z":0,"radius":0.03,"nx":0,"ny":0,"nz":-1,"double":false},{"id":"ss","x":0,"y":0,"z":0,"radius":0.04,"nx":0,"ny":0,"nz":-1,"double":false},{"id":"cp","x":0,"y":0,"z":0,"radius":0.045,"nx":0,"ny":0,"nz":-1,"double":false},{"id":"wa","x":0,"y":0,"z":0,"radius":0.05,"nx":0,"ny":0,"nz":-1,"double":false},{"id":"cc","x":0,"y":0,"z":0,"radius":0.06,"nx":0,"ny":0,"nz":-1,"double":false},{"id":"ca","x":0,"y":0,"z":0,"radius":0.07,"nx":0,"ny":0,"nz":-1,"double":false}]},{"id":"leftitem","x":0,"y":0,"z":-0.29,"radius":0.3,"items":[{"id":"li","x":0,"y":0,"z":0,"radius":0.01,"nx":0,"ny":0,"nz":-1,"double":false}]},{"id":"rightitem","x":0,"y":0,"z":-0.29,"radius":0.3,"items":[{"id":"ri","x":0,"y":0,"z":0,"radius":0.01,"nx":0,"ny":0,"nz":-1,"double":false}]},{"id":"leftarm","x":-1,"y":0,"z":-0.51,"radius":0.5,"items":[{"id":"lh","x":0,"y":0,"z":0,"radius":0.01,"nx":0,"ny":0,"nz":-1,"double":false},{"id":"lhs","x":0,"y":0,"z":0,"radius":0.01,"nx":0,"ny":0,"nz":-1,"double":false},{"id":"ls","x":0,"y":0,"z":0,"radius":0.02,"nx":0,"ny":0,"nz":-1,"double":false},{"id":"lc","x":0,"y":0,"z":0,"radius":0.025,"nx":0,"ny":0,"nz":-1,"double":false}]},{"id":"rightarm","x":1,"y":0,"z":-0.51,"radius":0.5,"items":[{"id":"rh","x":0,"y":0,"z":0,"radius":0.01,"nx":0,"ny":0,"nz":-1,"double":false},{"id":"rhs","x":0,"y":0,"z":0,"radius":0.01,"nx":0,"ny":0,"nz":-1,"double":false},{"id":"rs","x":0,"y":0,"z":0,"radius":0.02,"nx":0,"ny":0,"nz":-1,"double":false},{"id":"rc","x":0,"y":0,"z":0,"radius":0.025,"nx":0,"ny":0,"nz":-1,"double":false}]},{"id":"head","x":0,"y":0,"z":0,"radius":0.5,"items":[{"id":"hd","x":0,"y":0,"z":0,"radius":0.01,"nx":0,"ny":0,"nz":-1,"double":true},{"id":"fc","x":0,"y":0,"z":0,"radius":0.02,"nx":0,"ny":0,"nz":-1,"double":false},{"id":"ey","x":0,"y":0,"z":0,"radius":0.03,"nx":0,"ny":0,"nz":-1,"double":false},{"id":"hr","x":0,"y":0,"z":0,"radius":0.04,"nx":0,"ny":0,"nz":-1,"double":true},{"id":"hrb","x":0,"y":0,"z":0,"radius":0.05,"nx":0,"ny":0,"nz":-1,"double":true},{"id":"fa","x":0,"y":0,"z":0,"radius":0.06,"nx":0,"ny":0,"nz":-1,"double":false},{"id":"ea","x":0,"y":0,"z":0,"radius":0.07,"nx":0,"ny":0,"nz":-1,"double":false},{"id":"ha","x":0,"y":0,"z":0,"radius":0.08,"nx":0,"ny":0,"nz":-1,"double":false},{"id":"he","x":0,"y":0,"z":0,"radius":0.09,"nx":0,"ny":0,"nz":-1,"double":false}]}]},{"id":"sitting","bodyParts":[{"id":"top","x":0,"y":0,"z":0,"radius":2},{"id":"bottom","x":0,"y":0,"z":0,"radius":0.001},{"id":"behind","x":0,"y":0,"z":0.2,"radius":0.3},{"id":"torso","x":0,"y":0,"z":0,"radius":0.4,"items":[{"id":"bd","x":0,"y":0,"z":0,"radius":0.01,"nx":0,"ny":0,"nz":-1,"double":true},{"id":"bds","x":0,"y":0,"z":0,"radius":0.01,"nx":0,"ny":0,"nz":-1,"double":true},{"id":"ch","x":0,"y":0,"z":0,"radius":0.03,"nx":0,"ny":0,"nz":-1,"double":false},{"id":"sh","x":0,"y":0,"z":0,"radius":0.04,"nx":0,"ny":0,"nz":-1,"double":false},{"id":"lg","x":0,"y":0,"z":0,"radius":0.02,"nx":0,"ny":0,"nz":-1,"double":false},{"id":"ss","x":0,"y":0,"z":0,"radius":0.04,"nx":0,"ny":0,"nz":-1,"double":false},{"id":"cp","x":0,"y":0,"z":0,"radius":0.045,"nx":0,"ny":0,"nz":-1,"double":false},{"id":"wa","x":0,"y":0,"z":0,"radius":0.05,"nx":0,"ny":0,"nz":-1,"double":false},{"id":"cc","x":0,"y":0,"z":0,"radius":0.06,"nx":0,"ny":0,"nz":-1,"double":false},{"id":"ca","x":0,"y":0,"z":0,"radius":0.07,"nx":0,"ny":0,"nz":-1,"double":false}]},{"id":"leftitem","x":0,"y":0,"z":-0.29,"radius":0.3,"items":[{"id":"li","x":0,"y":0,"z":0,"radius":0.01,"nx":0,"ny":0,"nz":-1,"double":false}]},{"id":"rightitem","x":0,"y":0,"z":-0.29,"radius":0.3,"items":[{"id":"ri","x":0,"y":0,"z":0,"radius":0.01,"nx":0,"ny":0,"nz":-1,"double":false}]},{"id":"leftarm","x":-1,"y":0,"z":-0.51,"radius":0.5,"items":[{"id":"lh","x":0,"y":0,"z":0,"radius":0.01,"nx":0,"ny":0,"nz":-1,"double":false},{"id":"lhs","x":0,"y":0,"z":0,"radius":0.01,"nx":0,"ny":0,"nz":-1,"double":false},{"id":"ls","x":0,"y":0,"z":0,"radius":0.02,"nx":0,"ny":0,"nz":-1,"double":false},{"id":"lc","x":0,"y":0,"z":0,"radius":0.025,"nx":0,"ny":0,"nz":-1,"double":false}]},{"id":"rightarm","x":1,"y":0,"z":-0.51,"radius":0.5,"items":[{"id":"rh","x":0,"y":0,"z":0,"radius":0.01,"nx":0,"ny":0,"nz":-1,"double":false},{"id":"rhs","x":0,"y":0,"z":0,"radius":0.01,"nx":0,"ny":0,"nz":-1,"double":false},{"id":"rs","x":0,"y":0,"z":0,"radius":0.02,"nx":0,"ny":0,"nz":-1,"double":false},{"id":"rc","x":0,"y":0,"z":0,"radius":0.025,"nx":0,"ny":0,"nz":-1,"double":false}]},{"id":"head","x":0,"y":0,"z":0,"radius":0.5,"items":[{"id":"hd","x":0,"y":0,"z":0,"radius":0.01,"nx":0,"ny":0,"nz":-1,"double":true},{"id":"fc","x":0,"y":0,"z":0,"radius":0.02,"nx":0,"ny":0,"nz":-1,"double":false},{"id":"ey","x":0,"y":0,"z":0,"radius":0.03,"nx":0,"ny":0,"nz":-1,"double":false},{"id":"hr","x":0,"y":0,"z":0,"radius":0.04,"nx":0,"ny":0,"nz":-1,"double":true},{"id":"hrb","x":0,"y":0,"z":0,"radius":0.05,"nx":0,"ny":0,"nz":-1,"double":true},{"id":"fa","x":0,"y":0,"z":0,"radius":0.06,"nx":0,"ny":0,"nz":-1,"double":false},{"id":"ea","x":0,"y":0,"z":0,"radius":0.07,"nx":0,"ny":0,"nz":-1,"double":false},{"id":"ha","x":0,"y":0,"z":0,"radius":0.08,"nx":0,"ny":0,"nz":-1,"double":false},{"id":"he","x":0,"y":0,"z":0,"radius":0.09,"nx":0,"ny":0,"nz":-1,"double":false}]}]},{"id":"horizontal","bodyParts":[{"id":"torso","x":0,"y":0,"z":0,"radius":0.4,"items":[{"id":"bd","x":0,"y":0,"z":0,"radius":0.01,"nx":0,"ny":0,"nz":-1,"double":true},{"id":"bds","x":0,"y":0,"z":0,"radius":0.01,"nx":0,"ny":0,"nz":-1,"double":true},{"id":"ch","x":0,"y":0,"z":0,"radius":0.02,"nx":0,"ny":0,"nz":-1,"double":false},{"id":"cp","x":0,"y":0,"z":0,"radius":0.025,"nx":0,"ny":0,"nz":-1,"double":false},{"id":"sh","x":0,"y":0,"z":0,"radius":0.04,"nx":0,"ny":0,"nz":-1,"double":false},{"id":"lg","x":0,"y":0,"z":0,"radius":0.03,"nx":0,"ny":0,"nz":-1,"double":false},{"id":"ss","x":0,"y":0,"z":0,"radius":0.03,"nx":0,"ny":0,"nz":-1,"double":false},{"id":"wa","x":0,"y":0,"z":0,"radius":0.05,"nx":0,"ny":0,"nz":-1,"double":false},{"id":"cc","x":0,"y":0,"z":0,"radius":0.06,"nx":0,"ny":0,"nz":-1,"double":false},{"id":"ca","x":0,"y":0,"z":0,"radius":0.07,"nx":0,"ny":0,"nz":-1,"double":false}]},{"id":"leftitem","x":0,"y":0,"z":-0.29,"radius":0.3,"items":[{"id":"li","x":0,"y":0,"z":0,"radius":0.01,"nx":0,"ny":0,"nz":-1,"double":false}]},{"id":"rightitem","x":0,"y":0,"z":-0.29,"radius":0.3,"items":[{"id":"ri","x":0,"y":0,"z":0,"radius":0.01,"nx":0,"ny":0,"nz":-1,"double":false}]},{"id":"leftarm","x":-1,"y":0,"z":-0.51,"radius":0.6,"items":[{"id":"lh","x":0,"y":0,"z":0,"radius":0.01,"nx":0,"ny":0,"nz":-1,"double":false},{"id":"lhs","x":0,"y":0,"z":0,"radius":0.01,"nx":0,"ny":0,"nz":-1,"double":false},{"id":"ls","x":0,"y":0,"z":0,"radius":0.02,"nx":0,"ny":0,"nz":-1,"double":false},{"id":"lc","x":0,"y":0,"z":0,"radius":0.025,"nx":0,"ny":0,"nz":-1,"double":false}]},{"id":"rightarm","x":1,"y":0,"z":-0.51,"radius":0.6,"items":[{"id":"rh","x":0,"y":0,"z":0,"radius":0.01,"nx":0,"ny":0,"nz":-1,"double":false},{"id":"rhs","x":0,"y":0,"z":0,"radius":0.01,"nx":0,"ny":0,"nz":-1,"double":false},{"id":"rs","x":0,"y":0,"z":0,"radius":0.02,"nx":0,"ny":0,"nz":-1,"double":false},{"id":"rc","x":0,"y":0,"z":0,"radius":0.025,"nx":0,"ny":0,"nz":-1,"double":false}]},{"id":"head","x":0,"y":0,"z":0,"radius":0.5,"items":[{"id":"hd","x":0,"y":0,"z":0,"radius":0.01,"nx":0,"ny":0,"nz":-1,"double":true},{"id":"fc","x":0,"y":0,"z":0,"radius":0.02,"nx":0,"ny":0,"nz":-1,"double":false},{"id":"ey","x":0,"y":0,"z":0,"radius":0.03,"nx":0,"ny":0,"nz":-1,"double":false},{"id":"hr","x":0,"y":0,"z":0,"radius":0.04,"nx":0,"ny":0,"nz":-1,"double":true},{"id":"hrb","x":0,"y":0,"z":0,"radius":0.05,"nx":0,"ny":0,"nz":-1,"double":true},{"id":"fa","x":0,"y":0,"z":0,"radius":0.06,"nx":0,"ny":0,"nz":-1,"double":false},{"id":"ea","x":0,"y":0,"z":0,"radius":0.07,"nx":0,"ny":0,"nz":-1,"double":false},{"id":"ha","x":0,"y":0,"z":0,"radius":0.08,"nx":0,"ny":0,"nz":-1,"double":false},{"id":"he","x":0,"y":0,"z":0,"radius":0.09,"nx":0,"ny":0,"nz":-1,"double":false}]}]},{"id":"swhorizontal","bodyParts":[{"id":"torso","x":0,"y":0,"z":0,"radius":0.4,"items":[{"id":"bd","x":0,"y":0,"z":0,"radius":0.01,"nx":0,"ny":0,"nz":-1,"double":true},{"id":"bds","x":0,"y":0,"z":0,"radius":0.01,"nx":0,"ny":0,"nz":-1,"double":true},{"id":"ch","x":0,"y":0,"z":0,"radius":0.02,"nx":0,"ny":0,"nz":-1,"double":false},{"id":"cp","x":0,"y":0,"z":0,"radius":0.025,"nx":0,"ny":0,"nz":-1,"double":false},{"id":"sh","x":0,"y":0,"z":0,"radius":0.04,"nx":0,"ny":0,"nz":-1,"double":false},{"id":"lg","x":0,"y":0,"z":0,"radius":0.03,"nx":0,"ny":0,"nz":-1,"double":false},{"id":"ss","x":0,"y":0,"z":0,"radius":0.03,"nx":0,"ny":0,"nz":-1,"double":false},{"id":"wa","x":0,"y":0,"z":0,"radius":0.05,"nx":0,"ny":0,"nz":-1,"double":false},{"id":"cc","x":0,"y":0,"z":0,"radius":0.06,"nx":0,"ny":0,"nz":-1,"double":false},{"id":"ca","x":0,"y":0,"z":0,"radius":0.07,"nx":0,"ny":0,"nz":-1,"double":false}]},{"id":"leftitem","x":0,"y":0,"z":-0.29,"radius":0.3,"items":[{"id":"li","x":0,"y":0,"z":0,"radius":0.01,"nx":0,"ny":0,"nz":-1,"double":false}]},{"id":"rightitem","x":0,"y":0,"z":-0.29,"radius":0.3,"items":[{"id":"ri","x":0,"y":0,"z":0,"radius":0.01,"nx":0,"ny":0,"nz":-1,"double":false}]},{"id":"leftarm","x":-1,"y":0,"z":-0.51,"radius":0.6,"items":[{"id":"lh","x":0,"y":0,"z":0,"radius":0.01,"nx":0,"ny":0,"nz":-1,"double":false},{"id":"lhs","x":0,"y":0,"z":0,"radius":0.01,"nx":0,"ny":0,"nz":-1,"double":false},{"id":"ls","x":0,"y":0,"z":0,"radius":0.02,"nx":0,"ny":0,"nz":-1,"double":false},{"id":"lc","x":0,"y":0,"z":0,"radius":0.025,"nx":0,"ny":0,"nz":-1,"double":false}]},{"id":"rightarm","x":1,"y":0,"z":-0.51,"radius":0.6,"items":[{"id":"rh","x":0,"y":0,"z":0,"radius":0.01,"nx":0,"ny":0,"nz":-1,"double":false},{"id":"rhs","x":0,"y":0,"z":0,"radius":0.01,"nx":0,"ny":0,"nz":-1,"double":false},{"id":"rs","x":0,"y":0,"z":0,"radius":0.02,"nx":0,"ny":0,"nz":-1,"double":false},{"id":"rc","x":0,"y":0,"z":0,"radius":0.025,"nx":0,"ny":0,"nz":-1,"double":false}]},{"id":"head","x":0,"y":0,"z":0,"radius":0.5,"items":[{"id":"hd","x":0,"y":0,"z":0,"radius":0.01,"nx":0,"ny":0,"nz":-1,"double":true},{"id":"fc","x":0,"y":0,"z":0,"radius":0.02,"nx":0,"ny":0,"nz":-1,"double":false},{"id":"ey","x":0,"y":0,"z":0,"radius":0.03,"nx":0,"ny":0,"nz":-1,"double":false},{"id":"hr","x":0,"y":0,"z":0,"radius":0.04,"nx":0,"ny":0,"nz":-1,"double":true},{"id":"hrb","x":0,"y":0,"z":0,"radius":0.05,"nx":0,"ny":0,"nz":-1,"double":true},{"id":"fa","x":0,"y":0,"z":0,"radius":0.06,"nx":0,"ny":0,"nz":-1,"double":false},{"id":"ea","x":0,"y":0,"z":0,"radius":0.07,"nx":0,"ny":0,"nz":-1,"double":false},{"id":"ha","x":0,"y":0,"z":0,"radius":0.08,"nx":0,"ny":0,"nz":-1,"double":false},{"id":"he","x":0,"y":0,"z":0,"radius":0.09,"nx":0,"ny":0,"nz":-1,"double":false}]}]},{"id":"swim","bodyParts":[{"id":"torso","x":0,"y":0,"z":0,"radius":0.4,"items":[{"id":"bds","x":0,"y":0,"z":0,"radius":0.01,"nx":0,"ny":0,"nz":-1,"double":true},{"id":"ss","x":0,"y":0,"z":0,"radius":0.03,"nx":0,"ny":0,"nz":-1,"double":false}]},{"id":"head","x":0,"y":0,"z":0,"radius":0.5,"items":[{"id":"hd","x":0,"y":0,"z":0,"radius":0.01,"nx":0,"ny":0,"nz":-1,"double":true},{"id":"fc","x":0,"y":0,"z":0,"radius":0.02,"nx":0,"ny":0,"nz":-1,"double":false},{"id":"ey","x":0,"y":0,"z":0,"radius":0.03,"nx":0,"ny":0,"nz":-1,"double":false},{"id":"hr","x":0,"y":0,"z":0,"radius":0.04,"nx":0,"ny":0,"nz":-1,"double":true},{"id":"hrb","x":0,"y":0,"z":0,"radius":0.05,"nx":0,"ny":0,"nz":-1,"double":true},{"id":"fa","x":0,"y":0,"z":0,"radius":0.06,"nx":0,"ny":0,"nz":-1,"double":false},{"id":"ea","x":0,"y":0,"z":0,"radius":0.07,"nx":0,"ny":0,"nz":-1,"double":false},{"id":"ha","x":0,"y":0,"z":0,"radius":0.08,"nx":0,"ny":0,"nz":-1,"double":false},{"id":"he","x":0,"y":0,"z":0,"radius":0.09,"nx":0,"ny":0,"nz":-1,"double":false}]}]}]}}')},LPTP:function(t){t.exports=JSON.parse('{"a":{"partSet":[{"setType":"ri","flippedSetType":"ri"},{"setType":"ri","flippedSetType":"ri"},{"setType":"rh","flippedSetType":"lh"},{"setType":"rhs","flippedSetType":"lhs"},{"setType":"rs","swim":"0","flippedSetType":"ls"},{"setType":"rc","flippedSetType":"lc"},{"setType":"bd"},{"setType":"bds"},{"setType":"ss"},{"setType":"sh"},{"setType":"lg"},{"setType":"ch"},{"setType":"cp"},{"setType":"cc"},{"setType":"hd"},{"setType":"fc"},{"setType":"ey"},{"setType":"hr"},{"setType":"hrb","removeSetType":"hr"},{"setType":"li","flippedSetType":"li"},{"setType":"lh","flippedSetType":"rh"},{"setType":"lhs","flippedSetType":"rhs"},{"setType":"ls","flippedSetType":"rs"},{"setType":"lc","flippedSetType":"rc"},{"setType":"wa"},{"setType":"ea"},{"setType":"ca"},{"setType":"fa"},{"setType":"ha"},{"setType":"he"}],"activePartSets":[{"id":"figure","activeParts":[{"setType":"rh"},{"setType":"rh"},{"setType":"rhs"},{"setType":"rs"},{"setType":"rc"},{"setType":"bd"},{"setType":"bds"},{"setType":"ss"},{"setType":"sh"},{"setType":"lg"},{"setType":"ch"},{"setType":"cp"},{"setType":"cc"},{"setType":"wa"},{"setType":"hd"},{"setType":"fc"},{"setType":"ey"},{"setType":"hr"},{"setType":"hrb"},{"setType":"lh"},{"setType":"lhs"},{"setType":"ls"},{"setType":"lc"},{"setType":"ea"},{"setType":"ca"},{"setType":"fa"},{"setType":"ha"},{"setType":"he"}]},{"id":"head","activeParts":[{"setType":"hd"},{"setType":"fc"},{"setType":"ey"},{"setType":"hr"},{"setType":"hrb"},{"setType":"ea"},{"setType":"fa"},{"setType":"ha"},{"setType":"he"}]},{"id":"speak","activeParts":[{"setType":"hd"},{"setType":"hr"},{"setType":"hrb"},{"setType":"fc"},{"setType":"fa"},{"setType":"ha"}]},{"id":"gesture","activeParts":[{"setType":"ey"},{"setType":"fc"}]},{"id":"eye","activeParts":[{"setType":"ey"}]},{"id":"handRight","activeParts":[{"setType":"rh"},{"setType":"rhs"},{"setType":"rs"},{"setType":"rc"},{"setType":"ri"}]},{"id":"handRightAndHead","activeParts":[{"setType":"rh"},{"setType":"rhs"},{"setType":"rs"},{"setType":"rc"},{"setType":"ri"},{"setType":"ey"},{"setType":"fc"},{"setType":"hd"}]},{"id":"handLeft","activeParts":[{"setType":"lh"},{"setType":"lhs"},{"setType":"ls"},{"setType":"lc"},{"setType":"li"}]},{"id":"walk","activeParts":[{"setType":"bd"},{"setType":"bds"},{"setType":"ss"},{"setType":"lg"},{"setType":"lh"},{"setType":"lhs"},{"setType":"rh"},{"setType":"rhs"},{"setType":"ls"},{"setType":"lc"},{"setType":"rs"},{"setType":"rc"},{"setType":"sh"}]},{"id":"sit","activeParts":[{"setType":"bd"},{"setType":"bds"},{"setType":"ss"},{"setType":"lg"},{"setType":"sh"},{"setType":"cc"}]},{"id":"itemRight","activeParts":[{"setType":"ri"}]}]}}')},yp5t:function(t){t.exports=JSON.parse('{"a":[{"id":"Move","parts":[{"setType":"bd","frames":[{"number":0,"assetPartDefinition":"wlk"},{"number":1,"assetPartDefinition":"wlk"},{"number":2,"assetPartDefinition":"wlk"},{"number":3,"assetPartDefinition":"wlk"}]},{"setType":"bds","frames":[{"number":0,"assetPartDefinition":"wlk"},{"number":1,"assetPartDefinition":"wlk"},{"number":2,"assetPartDefinition":"wlk"},{"number":3,"assetPartDefinition":"wlk"}]},{"setType":"ss","frames":[{"number":0,"assetPartDefinition":"wlk"},{"number":1,"assetPartDefinition":"wlk"},{"number":2,"assetPartDefinition":"wlk"},{"number":3,"assetPartDefinition":"wlk"}]},{"setType":"lg","frames":[{"number":0,"assetPartDefinition":"wlk"},{"number":1,"assetPartDefinition":"wlk"},{"number":2,"assetPartDefinition":"wlk"},{"number":3,"assetPartDefinition":"wlk"}]},{"setType":"sh","frames":[{"number":0,"assetPartDefinition":"wlk"},{"number":1,"assetPartDefinition":"wlk"},{"number":2,"assetPartDefinition":"wlk"},{"number":3,"assetPartDefinition":"wlk"}]},{"setType":"lh","frames":[{"number":0,"assetPartDefinition":"wlk"},{"number":1,"assetPartDefinition":"wlk"},{"number":2,"assetPartDefinition":"wlk"},{"number":3,"assetPartDefinition":"wlk"}]},{"setType":"lhs","frames":[{"number":0,"assetPartDefinition":"wlk"},{"number":1,"assetPartDefinition":"wlk"},{"number":2,"assetPartDefinition":"wlk"},{"number":3,"assetPartDefinition":"wlk"}]},{"setType":"ls","frames":[{"number":0,"assetPartDefinition":"wlk"},{"number":1,"assetPartDefinition":"wlk"},{"number":2,"assetPartDefinition":"wlk"},{"number":3,"assetPartDefinition":"wlk"}]},{"setType":"lc","frames":[{"number":0,"assetPartDefinition":"wlk"},{"number":1,"assetPartDefinition":"wlk"},{"number":2,"assetPartDefinition":"wlk"},{"number":3,"assetPartDefinition":"wlk"}]},{"setType":"rh","frames":[{"number":0,"assetPartDefinition":"wlk"},{"number":1,"assetPartDefinition":"wlk"},{"number":2,"assetPartDefinition":"wlk"},{"number":3,"assetPartDefinition":"wlk"}]},{"setType":"rhs","frames":[{"number":0,"assetPartDefinition":"wlk"},{"number":1,"assetPartDefinition":"wlk"},{"number":2,"assetPartDefinition":"wlk"},{"number":3,"assetPartDefinition":"wlk"}]},{"setType":"rs","frames":[{"number":0,"assetPartDefinition":"wlk"},{"number":1,"assetPartDefinition":"wlk"},{"number":2,"assetPartDefinition":"wlk"},{"number":3,"assetPartDefinition":"wlk"}]},{"setType":"rc","frames":[{"number":0,"assetPartDefinition":"wlk"},{"number":1,"assetPartDefinition":"wlk"},{"number":2,"assetPartDefinition":"wlk"},{"number":3,"assetPartDefinition":"wlk"}]},{"setType":"ch","frames":[{"number":0,"assetPartDefinition":"wlk"},{"number":1,"assetPartDefinition":"wlk"},{"number":2,"assetPartDefinition":"wlk"},{"number":3,"assetPartDefinition":"wlk"}]}]},{"id":"Wave","parts":[{"setType":"lh","frames":[{"number":0,"assetPartDefinition":"wav"},{"number":1,"assetPartDefinition":"wav"}]},{"setType":"lhs","frames":[{"number":0,"assetPartDefinition":"wav"},{"number":1,"assetPartDefinition":"wav"}]},{"setType":"ls","frames":[{"number":0,"assetPartDefinition":"wav"},{"number":1,"assetPartDefinition":"wav"}]},{"setType":"lc","frames":[{"number":0,"assetPartDefinition":"wav"},{"number":1,"assetPartDefinition":"wav"}]},{"setType":"ch","frames":[{"number":0,"assetPartDefinition":"wav"},{"number":1,"assetPartDefinition":"wav"},{"number":2,"assetPartDefinition":"wav"},{"number":3,"assetPartDefinition":"wav"}]}]},{"id":"Talk","parts":[{"setType":"hd","frames":[{"number":0,"assetPartDefinition":"spk"},{"number":1,"assetPartDefinition":"spk"}]},{"setType":"fc","frames":[{"number":0,"assetPartDefinition":"spk"},{"number":1,"assetPartDefinition":"spk"}]},{"setType":"fa","frames":[{"number":0,"assetPartDefinition":"spk"},{"number":1,"assetPartDefinition":"spk"}]}]},{"id":"Sign","parts":[{"setType":"lh","frames":[{"number":0,"assetPartDefinition":"sig"}]},{"setType":"li","frames":[{"number":0,"assetPartDefinition":"sig"}]},{"setType":"ls","frames":[{"number":0,"assetPartDefinition":"wav"}]},{"setType":"lc","frames":[{"number":0,"assetPartDefinition":"wav"}]}]},{"id":"Respect","parts":[{"setType":"lh","frames":[{"number":0,"assetPartDefinition":"respect","repeats":15},{"number":1,"assetPartDefinition":"respect","repeats":15}]},{"setType":"ls","frames":[{"number":0,"assetPartDefinition":"wav","repeats":15},{"number":1,"assetPartDefinition":"wav","repeats":15}]},{"setType":"lc","frames":[{"number":0,"assetPartDefinition":"wav","repeats":15},{"number":1,"assetPartDefinition":"wav","repeats":15}]}]},{"id":"Blow","parts":[{"setType":"rh","frames":[{"number":0,"assetPartDefinition":"blw","repeats":10},{"number":1,"assetPartDefinition":"blw","repeats":10}]},{"setType":"rs","frames":[{"number":0,"assetPartDefinition":"drk"}]},{"setType":"rc","frames":[{"number":0,"assetPartDefinition":"drk"}]},{"setType":"ri","frames":[{"number":0,"assetPartDefinition":""}]},{"setType":"ey","frames":[{"number":0,"assetPartDefinition":"std","repeats":10},{"number":0,"assetPartDefinition":"eyb","repeats":10}]},{"setType":"fc","frames":[{"number":0,"assetPartDefinition":"std","repeats":10},{"number":0,"assetPartDefinition":"blw","repeats":10}]}]},{"id":"Laugh","parts":[{"setType":"rh","frames":[{"number":0,"assetPartDefinition":"blw"}]},{"setType":"rs","frames":[{"number":0,"assetPartDefinition":"drk"}]},{"setType":"rc","frames":[{"number":0,"assetPartDefinition":"drk"}]},{"setType":"ri","frames":[{"number":0,"assetPartDefinition":""}]},{"setType":"ey","frames":[{"number":0,"assetPartDefinition":"std","repeats":2}]},{"setType":"fc","frames":[{"number":0,"assetPartDefinition":"sml"}]}],"offsets":{"frames":[{"id":0,"directions":[{"id":0,"bodyParts":[{"id":"head","dx":0,"dy":1}]},{"id":1,"bodyParts":[{"id":"head","dx":0,"dy":1}]},{"id":2,"bodyParts":[{"id":"head","dx":0,"dy":1}]},{"id":3,"bodyParts":[{"id":"head","dx":0,"dy":1}]},{"id":4,"bodyParts":[{"id":"head","dx":0,"dy":1}]},{"id":5,"bodyParts":[{"id":"head","dx":0,"dy":1}]},{"id":6,"bodyParts":[{"id":"head","dx":0,"dy":1}]},{"id":7,"bodyParts":[{"id":"head","dx":0,"dy":1}]}]},{"id":1,"directions":[{"id":0,"bodyParts":[{"id":"head","dx":0,"dy":0}]},{"id":1,"bodyParts":[{"id":"head","dx":0,"dy":0}]},{"id":2,"bodyParts":[{"id":"head","dx":0,"dy":0}]},{"id":3,"bodyParts":[{"id":"head","dx":0,"dy":0}]},{"id":4,"bodyParts":[{"id":"head","dx":0,"dy":0}]},{"id":5,"bodyParts":[{"id":"head","dx":0,"dy":0}]},{"id":6,"bodyParts":[{"id":"head","dx":0,"dy":0}]},{"id":7,"bodyParts":[{"id":"head","dx":0,"dy":0}]}]}]}}]}')},zUnb:function(t,e,s){"use strict";s.r(e);var i=s("fXoL"),r=s("jhN1"),n=s("R1ws"),a=s("mgaL"),o=s("ofXK"),c=s("3Pt+"),_=s("1kSV"),h=s("dbUT"),l=s("oOf3"),u=s("Kdsb"),d=s("5eHb");let g=(()=>{class t{constructor(){this._messengerSound=null,this._messengerSound=new Audio("assets/sounds/new_message.mp3")}playMessengerSound(){const t=this._messengerSound;t&&t.play()}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275prov=i.Qb({token:t,factory:t.\u0275fac}),t})();const m={suppressScrollX:!0};let p=(()=>{class t{}return t.\u0275mod=i.Sb({type:t}),t.\u0275inj=i.Rb({factory:function(e){return new(e||t)},providers:[{provide:u.a,useValue:m},g],imports:[[r.a,n.a,o.b,c.f,c.p,d.a.forRoot(),_.e,_.j,_.h,l.a,a.a,u.c,h.b.forRoot()],o.b,c.f,c.p,d.a,_.e,_.j,_.h,l.a,a.a,u.c,h.b]}),t})();class E{constructor(t,e){this._callBack=t,this._parserClass=e,this._parser=null,this._connection=null}dispose(){this._callBack=null,this._parserClass=null,this._parser=null,this._connection=null}get callBack(){return this._callBack}get parserClass(){return this._parserClass}get parser(){return this._parser}set parser(t){this._parser=t}get connection(){return this._connection}set connection(t){this._connection=t}}let f=(()=>{class t{constructor(t){if(this._unseen=0,!t)throw new Error("invalid_parser");this._achievementId=t.readInt(),this._level=t.readInt(),this._badgeId=t.readString(),this._Str_6791=t.readInt(),this._Str_18274=Math.max(1,t.readInt()),this._Str_10280=t.readInt(),this._Str_12282=t.readInt(),this._Str_19007=t.readInt(),this._Str_16081=t.readBoolean(),this._category=t.readString(),this._Str_21707=t.readString(),this._Str_20339=t.readInt(),this._Str_19099=t.readInt()}get achievementId(){return this._achievementId}get badgeId(){return this._badgeId}get level(){return this._level}get _Str_25209(){return this._Str_6791}get _Str_24142(){return this._Str_18274-this._Str_6791}get rewardAmount(){return this._Str_10280}get rewardType(){return this._Str_12282}get _Str_22939(){return this._Str_19007-this._Str_6791}get _Str_7518(){return this._Str_16081}get category(){return this._category}get _Str_25896(){return this._Str_21707}get totalLevels(){return this._Str_20339}get _Str_10438(){return this._level>1||this._Str_16081}_Str_24410(){this._Str_19007=this._Str_18274}get _Str_24874(){return this._Str_19099}get progress(){return this._Str_19007}get toNextProgress(){return this._Str_18274}set unseen(t){this._unseen=t}get unseen(){return this._unseen}reset(t){this._achievementId=t._achievementId,this._level=t._level,this._badgeId=t._badgeId,this._Str_6791=t._Str_6791,this._Str_18274=t._Str_18274,this._Str_10280=t._Str_10280,this._Str_12282=t._Str_12282,this._Str_19007=t._Str_19007,this._Str_16081=t._Str_16081,this._category=t.category,this._Str_21707=t._Str_21707,this._Str_20339=t._Str_20339,this._Str_19099=t._Str_19099}}return t._Str_21736=-1,t._Str_21318=0,t._Str_15908=1,t._Str_20384=2,t})();class S{flush(){return this._achievement=null,!0}parse(t){return!!t&&(this._achievement=new f(t),!0)}get achievement(){return this._achievement}}class b extends E{constructor(t){super(t,S)}getParser(){return this.parser}}class R{flush(){return this._achievements=[],this._Str_19269=null,!0}parse(t){if(!t)return!1;this._achievements=[];let e=t.readInt();for(;e>0;)this._achievements.push(new f(t)),e--;return this._Str_19269=t.readString(),!0}get achievements(){return this._achievements}get _Str_16300(){return this._Str_19269}}class I extends E{constructor(t){super(t,R)}getParser(){return this.parser}}class v{flush(){return this._score=0,!0}parse(t){return!!t&&(this._score=t.readInt(),!0)}get score(){return this._score}}class T extends E{constructor(t){super(t,v)}getParser(){return this.parser}}class O{constructor(){this._data=[]}getMessageArray(){return this._data}dispose(){}}var A=s("IqKQ");let y=(()=>{class t extends Event{}return t.COMPLETE="NITRO_COMPLETE",t})(),C=(()=>{class t extends y{constructor(t){super(t)}}return t.LOADED="NCE_LOADED",t.FAILED="NCE_FAILED",t})();class M{constructor(){this._isDisposed=!1,this._isDisposing=!1}dispose(){this._isDisposed||this._isDisposing||(this._isDisposing=!0,this.onDispose(),this._isDisposed=!0,this._isDisposing=!1)}onDispose(){}get disposed(){return this._isDisposed}get isDisposing(){return this._isDisposing}}let D=(()=>{class t{constructor(t,e=null){this._name=t,this._description=e,this._print=!0}log(t){this.printMessage(t)}error(t,e){this.printMessage(e||t)}warn(t){this.printMessage(t)}printMessage(e){this._print&&t.log(e,this._name)}static log(t,e="Nitro"){console.log(`[Nitro] ${(new Date).toDateString()} [${e}] ${t} ${this.getTimestamp()}`)}static getTimestamp(){const e=Date.now(),s=` +${e-t.LAST_TIMESTAMP||0}ms`;return this.LAST_TIMESTAMP=e,s}get description(){return this._description}set description(t){this._description=t}get print(){return this._print}set print(t){this._print=t}}return t.LAST_TIMESTAMP=Date.now(),t})();class N extends M{constructor(){super(),this._logger=new D(this.constructor.name),this._listeners=new Map}onDispose(){this.removeAllListeners(),super.onDispose()}addEventListener(t,e){if(!t||!e)return;const s=this._listeners.get(t);s?s.push(e):this._listeners.set(t,[e])}removeEventListener(t,e){if(!t||!e)return;const s=this._listeners.get(t);if(s&&s.length)for(const[i,r]of s.entries())if(r&&r===e)return s.splice(i,1),void(s.length||this._listeners.delete(t))}dispatchEvent(t){return!!t&&(um.instance.getConfiguration("system.dispatcher.log")&&this._logger.log("DISPATCHED: "+t.type),this.processEvent(t),!0)}processEvent(t){const e=this._listeners.get(t.type);if(!e||!e.length)return;const s=[];for(const r of e)r&&s.push(r);for(;s.length;){const e=s.shift();try{e(t)}catch(i){return void this._logger.error(i)}}}removeAllListeners(){this._listeners.clear()}}let w=(()=>{class t{static createAsset(e,s,i,r,n,a=!1,o=!1,c=!1){const _=t.GRAPHIC_POOL.length?t.GRAPHIC_POOL.pop():new t;return _._name=e,_._source=s||null,i?(_._texture=i,_._initialized=!1):(_._texture=null,_._initialized=!0),_._usesPalette=c,_._x=r,_._y=n,_._flipH=a,_._flipV=o,_._rectangle=null,_}recycle(){this._texture=null,t.GRAPHIC_POOL.push(this)}initialize(){!this._initialized&&this._texture&&(this._width=this._texture.width,this._height=this._texture.height,this._initialized=!0)}get name(){return this._name}get source(){return this._source}get texture(){return this._texture}get usesPalette(){return this._usesPalette}get x(){return this._x}get y(){return this._y}get width(){return this.initialize(),this._width}get height(){return this.initialize(),this._height}get offsetX(){return this._flipH?-this._x:this._x}get offsetY(){return this._flipV?-this._y:this._y}get flipH(){return this._flipH}get flipV(){return this._flipV}get rectangle(){return this._rectangle||(this._rectangle=new A.k(0,0,this.width,this.height)),this._rectangle}}return t.GRAPHIC_POOL=[],t})();class U{constructor(t,e,s){for(this._palette=t;this._palette.length<256;)this._palette.push([0,0,0]);this._primaryColor=e,this._secondaryColor=s}dispose(){}applyPalette(t){const e=A.n.from(t),s=um.instance.renderer.extract.canvas(e),i=s.getContext("2d"),r=i.getImageData(0,0,s.width,s.height),n=r.data;for(let a=0;a<n.length;a+=4){let t=this._palette[n[a+1]];void 0===t&&(t=[0,0,0]),n[a]=t[0],n[a+1]=t[1],n[a+2]=t[2]}return i.putImageData(r,0,0),A.p.from(s)}get primaryColor(){return this._primaryColor}get secondaryColor(){return this._secondaryColor}}let L=(()=>{class t{constructor(t,e){if(!t)throw new Error("invalid_collection");this._name=t.name,this._data=t,this._textures=new Map,this._assets=new Map,this._palettes=new Map,this._paletteAssetNames=[],e&&this.addLibraryAsset(e.textures),this.define(t)}dispose(){if(this._palettes){for(const t of this._palettes.values())t.dispose();this._palettes.clear()}if(this._paletteAssetNames&&(this.disposePaletteAssets(),this._paletteAssetNames=null),this._assets){for(const t of this._assets.values())t.recycle();this._assets.clear()}}addReference(){this._referenceCount++,this._referenceTimestamp=um.instance.time}removeReference(){this._referenceCount--,this._referenceCount<=0&&(this._referenceCount=0,this._referenceTimestamp=um.instance.time,this.disposePaletteAssets(!1))}define(t){const e=t.assets,s=t.palettes;e&&this.defineAssets(e),s&&this.definePalettes(s)}defineAssets(t){if(t)for(const e in t){const s=t[e];if(!s)continue;const i=-s.x||0,r=-s.y||0;let n=!1;const a=!1,o=s.usesPalette||!1;let c=s.source||"";s.flipH&&c.length&&(n=!0),c.length||(c=e);const _=this.getLibraryAsset(c);if(!_)continue;let h=this.createAsset(e,c,_,n,a,i,r,o);if(!h){const t=this.getAsset(e);t&&t.name!==t.source&&(h=this.replaceAsset(e,c,_,n,a,i,r,o))}}}definePalettes(t){if(t)for(const e in t){const s=t[e];if(!s)continue;const i=s.id.toString();if(this._palettes.get(i))continue;let r=16777215,n=16777215,a=s.color1;a&&a.length>0&&(r=parseInt(a,16)),a=s.color2,a&&a.length>0&&(n=parseInt(a,16)),this._palettes.set(i,new U(s.rgb,r,n))}}createAsset(t,e,s,i,r,n,a,o){if(this._assets.get(t))return!1;const c=w.createAsset(t,e,s,n,a,i,r,o);return this._assets.set(t,c),!0}replaceAsset(t,e,s,i,r,n,a,o){const c=this._assets.get(t);return c&&(this._assets.delete(t),c.recycle()),this.createAsset(t,e,s,i,r,n,a,o)}getAsset(t){return t&&this._assets.get(t)||null}getAssetWithPalette(t,e){const s=t+"@"+e;let i=this.getAsset(s);if(!i){if(i=this.getAsset(t),!i||!i.usesPalette)return i;const r=this.getPalette(e);if(r){const t=r.applyPalette(i.texture);t&&(this._paletteAssetNames.push(s),this.createAsset(s,i.source+"@"+e,t,i.flipH,i.flipV,i.x,i.y,!1),i=this.getAsset(s))}}return i}getPaletteNames(){return Array.from(this._palettes.keys())}getPaletteColors(t){const e=this.getPalette(t);return e?[e.primaryColor,e.secondaryColor]:null}getPalette(t){return t&&this._palettes.get(t)||null}addAsset(t,e,s,i=0,r=0,n=!1,a=!1){if(!t||!e)return!1;const o=this.getLibraryAsset(t);return o?!!s&&(o.baseTexture=e.baseTexture,o.frame=e.frame,o.trim=e.trim,o.updateUvs(),!0):(this._textures.set(t,e),this.createAsset(t,t,e,n,a,i,r,!1))}disposeAsset(t){const e=this._assets.get(t);if(!e)return;this._assets.delete(t);const s=this.getLibraryAsset(e.source);s&&(this._textures.delete(e.source),s.destroy(!0)),e.recycle()}getLibraryAsset(t){return t&&this._textures.get(t=this._name+"_"+t)||null}addLibraryAsset(t){if(t)for(const e in t){const s=t[e];s&&this._textures.set(P.removeFileExtension(e),s)}}disposePaletteAssets(e=!0){if(this._paletteAssetNames&&(e||this._paletteAssetNames.length>t.PALETTE_ASSET_DISPOSE_THRESHOLD)){for(const t of this._paletteAssetNames)this.disposeAsset(t);this._paletteAssetNames=[]}}get referenceCount(){return this._referenceCount}get referenceTimestamp(){return this._referenceTimestamp}get name(){return this._name}get data(){return this._data}get textures(){return this._textures}get assets(){return this._assets}}return t.PALETTE_ASSET_DISPOSE_THRESHOLD=10,t})();class P extends M{constructor(){super(),this._logger=new D(this.constructor.name),this._textures=new Map,this._collections=new Map,this._pendingUrls=new Map}static removeFileExtension(t){return t.substring(0,t.lastIndexOf("."))||t}getTexture(t){return t&&this._textures.get(t)||null}setTexture(t,e){t&&e&&this._textures.set(t,e)}getAsset(t){if(!t)return null;for(const e of this._collections.values()){if(!e)continue;const s=e.getAsset(t);if(s)return s}return null}getCollection(t){return t&&this._collections.get(t)||null}createCollection(t,e){if(!t)return null;const s=new L(t,e);if(s){for(const[t,e]of s.textures.entries())this.setTexture(t,e);this._collections.set(s.name,s)}}downloadAsset(t,e){return this.downloadAssets([t],e)}downloadAssets(t,e){if(!t||!t.length)return e(!0),!0;const s=t.length;let i=0;const r=(t,r,n)=>{t&&t.destroy(),n?(i++,i===s&&e(!0)):this._logger.error("Failed to download asset: "+r.url)};for(const n of t){if(!n)continue;const t=new A.g,e={crossOrigin:!1};t.use((e,s)=>this.assetLoader(t,e,s,r)).add(n,e).load()}return!0}assetLoader(t,e,s,i){if(!e||e.error)return e&&e.texture&&e.texture.destroy(!0),void i(t,e,!1);if(e.type===A.h.TYPE.JSON){const s=e.data;if(!s.type)return;if(s.spritesheet&&Object.keys(s.spritesheet).length){const r=s.spritesheet.meta&&s.spritesheet.meta.image;if(!r||!r.length)return void i(t,e,!1);const n=e.url.substring(0,e.url.lastIndexOf("/")+1)+r,a=A.c.from(n);if(a.valid){const r=new A.o(a,s.spritesheet);r.parse(n=>{this.createCollection(s,r),i(t,e,!0)})}else a.once("loaded",()=>{a.removeAllListeners();const r=new A.o(a,s.spritesheet);r.parse(n=>{this.createCollection(s,r),i(t,e,!0)})}),a.once("error",()=>{a.removeAllListeners(),i(t,e,!1)});return}return this.createCollection(s,null),void i(t,e,!0)}e.type!==A.h.TYPE.IMAGE||(e.texture.valid?(this.setTexture(e.name,e.texture),i(t,e,!0)):i(t,e,!1))}get collections(){return this._collections}}class x{constructor(t){this._position=0,this._dataView=new DataView(t)}readByte(){const t=this._dataView.getInt8(this._position);return this._position++,t}readBytes(t){const e=new x(this._dataView.buffer.slice(this._position,this._position+t));return this._position+=t,e}readShort(){const t=this._dataView.getInt16(this._position);return this._position+=2,t}readInt(){const t=this._dataView.getInt32(this._position);return this._position+=4,t}remaining(){return this._dataView.byteLength-this._position}toString(t){return(new TextDecoder).decode(this._dataView.buffer)}}class F{constructor(){this._buffer=new Uint8Array}writeByte(t){const e=new Uint8Array(1);return e[0]=t,this.appendArray(e),this}writeBytes(t){const e=new Uint8Array(t);return this.appendArray(e),this}writeShort(t){const e=new Uint8Array(2);return e[0]=t>>8,e[1]=255&t,this.appendArray(e),this}writeInt(t){const e=new Uint8Array(4);return e[0]=t>>24,e[1]=t>>16,e[2]=t>>8,e[3]=255&t,this.appendArray(e),this}writeString(t,e=!0){const s=(new TextEncoder).encode(t);return e?(this.writeShort(s.length),this.appendArray(s)):this.appendArray(s),this}appendArray(t){if(!t)return;const e=new Uint8Array(this._buffer.length+t.length);e.set(this._buffer),e.set(t,this._buffer.length),this._buffer=e}getBuffer(){return this._buffer.buffer}toString(t){return new TextDecoder(t).decode(this._buffer)}}class G{constructor(t){this._value=t}get value(){return this._value}}class V{constructor(t){this._value=t}get value(){return this._value}}class Y{constructor(t,e){this._header=t,this._buffer=e}readByte(){return this._buffer?this._buffer.readByte():-1}readBytes(t){return this._buffer?this._buffer.readBytes(t):null}readBoolean(){return 1===this.readByte()}readShort(){return this._buffer?this._buffer.readShort():-1}readInt(){return this._buffer?this._buffer.readInt():-1}readString(){const t=this.readShort();return this._buffer.readBytes(t).toString("utf8")}get header(){return this._header}get bytesAvailable(){return this._buffer&&this._buffer.remaining()>0}}class k{encode(t,e){const s=new F;s.writeShort(t);for(const r of e){let t=typeof r;switch("object"===t&&(null===r?t="null":r instanceof G?t="byte":r instanceof V&&(t="short")),t){case"null":s.writeShort(0);break;case"byte":s.writeByte(r.value);break;case"short":s.writeShort(r.value);break;case"number":s.writeInt(r);break;case"boolean":s.writeByte(r?1:0);break;case"string":r?s.writeString(r,!0):s.writeShort(0)}}const i=s.getBuffer();return i?(new F).writeInt(i.byteLength).writeBytes(i):null}decode(t){if(!t||!t.dataBuffer||!t.dataBuffer.byteLength)return null;const e=[];for(;t.dataBuffer.byteLength&&!(t.dataBuffer.byteLength<4);){const s=new x(t.dataBuffer),i=s.readInt();if(i>t.dataBuffer.byteLength-4)break;const r=s.readBytes(i);e.push(new Y(r.readShort(),r)),t.dataBuffer=t.dataBuffer.slice(i+4)}return e}}let j=(()=>{class t extends y{constructor(t,e,s){super(t),this._connection=e,this._originalEvent=event}get connection(){return this._connection}get originalEvent(){return this._originalEvent}}return t.CONNECTION_OPENED="SCE_OPEN",t.CONNECTION_CLOSED="SCE_CLOSED",t.CONNECTION_ERROR="SCE_ERROR",t.CONNECTION_MESSAGE="SCE_MESSAGE",t})();class B{constructor(){this._messageIdByEvent=new Map,this._messageIdByComposer=new Map,this._messageInstancesById=new Map}dispose(){this._messageIdByEvent.clear(),this._messageIdByComposer.clear(),this._messageInstancesById.clear()}registerMessages(t){for(const[e,s]of t.events)this.registerMessageEventClass(e,s);for(const[e,s]of t.composers)this.registerMessageComposerClass(e,s)}registerMessageEventClass(t,e){t&&e&&(this._messageIdByEvent.get(e)||this._messageIdByEvent.set(e,t))}registerMessageComposerClass(t,e){t&&e&&(this._messageIdByComposer.get(e)||this._messageIdByComposer.set(e,t))}registerMessageEvent(t){if(!t)return;const e=this.getEventId(t);if(!e)return;let s=this._messageInstancesById.get(e);s&&s.length?t.parser=s[0].parser:(s=[],this._messageInstancesById.set(e,s),t.parser=new t.parserClass),s.push(t)}removeMessageEvent(t){if(!t)return;const e=this.getEventId(t);if(!e)return;const s=this._messageInstancesById.get(e);if(s)for(const[i,r]of s.entries())if(r&&r===t)return s.splice(i,1),0===s.length&&this._messageInstancesById.delete(e),void r.dispose()}getEvents(t){if(t)return this._messageInstancesById.get(t)||void 0}getEventId(t){return t&&this._messageIdByEvent.get(t instanceof E?t.constructor:t)||-1}getComposerId(t){return t&&this._messageIdByComposer.get(t.constructor)||-1}}let H=(()=>{class t{}return t.CONNECTION_OPENED="open",t.CONNECTION_CLOSED="close",t.CONNECTION_ERROR="error",t.CONNECTION_MESSAGE="message",t})();class W extends N{constructor(t,e){super(),this._communicationManager=t,this._stateListener=e,this._socket=null,this._messages=new B,this._codec=new k,this._dataBuffer=null,this._isReady=!1,this._pendingClientMessages=[],this._pendingServerMessages=[],this._isAuthenticated=!1,this.onOpen=this.onOpen.bind(this),this.onClose=this.onClose.bind(this),this.onError=this.onError.bind(this),this.onMessage=this.onMessage.bind(this)}init(t){this._stateListener&&this._stateListener.connectionInit(t),this.createSocket(t)}onDispose(){super.onDispose(),this.destroySocket(),this._communicationManager=null,this._stateListener=null,this._messages=null,this._codec=null,this._dataBuffer=null}onReady(){this._isReady||(this._isReady=!0,this._pendingServerMessages&&this._pendingServerMessages.length&&this.processWrappers(...this._pendingServerMessages),this._pendingClientMessages&&this._pendingClientMessages.length&&this.send(...this._pendingClientMessages),this._pendingServerMessages=[],this._pendingClientMessages=[])}createSocket(t){t&&(this.destroySocket(),this._dataBuffer=new ArrayBuffer(0),this._socket=new WebSocket(t),this._socket.addEventListener(H.CONNECTION_OPENED,this.onOpen),this._socket.addEventListener(H.CONNECTION_CLOSED,this.onClose),this._socket.addEventListener(H.CONNECTION_ERROR,this.onError),this._socket.addEventListener(H.CONNECTION_MESSAGE,this.onMessage))}destroySocket(){this._socket&&(this._socket.removeEventListener(H.CONNECTION_OPENED,this.onOpen),this._socket.removeEventListener(H.CONNECTION_CLOSED,this.onClose),this._socket.removeEventListener(H.CONNECTION_ERROR,this.onError),this._socket.removeEventListener(H.CONNECTION_MESSAGE,this.onMessage),this._socket.readyState===WebSocket.OPEN&&this._socket.close(),this._socket=null)}onOpen(t){this.dispatchConnectionEvent(j.CONNECTION_OPENED,t)}onClose(t){this.dispatchConnectionEvent(j.CONNECTION_CLOSED,t)}onError(t){this.dispatchConnectionEvent(j.CONNECTION_ERROR,t)}onMessage(t){if(!t)return;this.dispatchConnectionEvent(j.CONNECTION_MESSAGE,t);const e=new FileReader;e.readAsArrayBuffer(t.data),e.onloadend=()=>{this._dataBuffer=this.concatArrayBuffers(this._dataBuffer,e.result),this.processReceivedData()}}dispatchConnectionEvent(t,e){this.dispatchEvent(new j(t,this,e))}authenticated(){this._isAuthenticated=!0}send(...t){if(this.disposed||!t)return!1;if(t=[...t],this._isAuthenticated&&!this._isReady)return this._pendingClientMessages||(this._pendingClientMessages=[]),this._pendingClientMessages.push(...t),!1;for(const e of t){if(!e)continue;const t=this._messages.getComposerId(e);if(-1===t){D.log("Unknown Composer: "+e.constructor.name);continue}const s=this._codec.encode(t,e.getMessageArray());s?(um.instance.getConfiguration("communication.packet.log")&&D.log("OutgoingComposer: "+e.constructor.name),this.write(s.getBuffer())):um.instance.getConfiguration("communication.packet.log")&&D.log("Encoding Failed: "+e.constructor.name)}return!0}write(t){this._socket.readyState===WebSocket.OPEN&&this._socket.send(t)}processReceivedData(){try{this.processData()}catch(t){D.log(t)}}processData(){const t=this.splitReceivedMessages();if(t&&t.length)return this._isAuthenticated&&!this._isReady?(this._pendingServerMessages||(this._pendingServerMessages=[]),void this._pendingServerMessages.push(...t)):void this.processWrappers(...t)}processWrappers(...t){if(t&&t.length)for(const e of t){if(!e)continue;const t=this.getMessagesForWrapper(e);t&&t.length&&(um.instance.getConfiguration("communication.packet.log")&&D.log(`IncomingMessage: ${t[0].constructor.name} [${e.header}]`),this.handleMessages(...t))}}splitReceivedMessages(){return this._dataBuffer&&this._dataBuffer.byteLength?this._codec.decode(this):null}concatArrayBuffers(t,e){const s=new Uint8Array(t.byteLength+e.byteLength);return s.set(new Uint8Array(t),0),s.set(new Uint8Array(e),t.byteLength),s.buffer}getMessagesForWrapper(t){if(!t)return null;const e=this._messages.getEvents(t.header);if(!e||!e.length)return null;try{const s=e[0].parser;if(!s||!s.flush()||!s.parse(t))return null}catch(s){return D.log("Error parsing message: "+s,e[0].constructor.name),null}return e}handleMessages(...t){t=[...t];for(const e of t)e&&(e.connection=this,e.callBack&&e.callBack(e))}registerMessages(t){t&&this._messages.registerMessages(t)}addMessageEvent(t){t&&this._messages&&this._messages.registerMessageEvent(t)}removeMessageEvent(t){t&&this._messages&&this._messages.removeMessageEvent(t)}get isAuthenticated(){return this._isAuthenticated}get dataBuffer(){return this._dataBuffer}set dataBuffer(t){this._dataBuffer=t}}class Z extends M{constructor(){super(),this._connections=[]}onDispose(){if(this._connections&&this._connections.length)for(const t of this._connections.values())t&&t.dispose()}createConnection(t=null){const e=new W(this,t);if(e)return this._connections.push(e),e}update(t){let e=0;for(;e<this._connections.length;){const t=this._connections[e];if(t.processReceivedData(),this.disposed)return;t.disposed?this._connections.splice(e,1):e++}}}class z extends M{constructor(t=null){super(),this._logger=t instanceof D?t:new D(this.constructor.name),this._events=new N,this._isLoaded=!1,this._isLoading=!1}init(){this._isLoaded||this._isLoading||this.isDisposing||(this._isLoading=!0,this.onInit(),this._isLoaded=!0,this._isLoading=!1)}onInit(){}onDispose(){this._events&&this._events.dispose(),super.onDispose()}reload(){this.dispose(),this.init()}get logger(){return this._logger}get events(){return this._events}get isLoaded(){return this._isLoaded}get isLoading(){return this._isLoading}}class X{constructor(){this._length=0,this._dictionary=new Map,this._array=[],this._keys=[]}get length(){return this._length}get disposed(){return!this._dictionary}dispose(){if(!this._dictionary){for(const t of this._dictionary.keys())this._dictionary.delete(t);this._dictionary=null}this._length=0,this._array=null,this._keys=null}reset(){for(const t of this._dictionary.keys())this._dictionary.delete(t);this._length=0,this._array=[],this._keys=[]}unshift(t,e){return null===this._dictionary.get(t)&&(this._dictionary.set(t,e),this._array.unshift(e),this._keys.unshift(t),this._length++,!0)}add(t,e){return void 0===this._dictionary.get(t)&&(this._dictionary.set(t,e),this._array[this._length]=e,this._keys[this._length]=t,this._length++,!0)}remove(t){const e=this._dictionary.get(t);if(!e)return null;const s=this._array.indexOf(e);return s>=0&&(this._array.splice(s,1),this._keys.splice(s,1),this._length--),this._dictionary.delete(t),e}getWithIndex(t){return t<0||t>=this._length?null:this._array[t]}getKey(t){return t<0||t>=this._length?null:this._keys[t]}getKeys(){return this._keys.slice()}hasKey(t){return this._keys.indexOf(t)>-1}getValue(t){return this._dictionary.get(t)}getValues(){return this._array.slice()}hasValue(t){return this._array.indexOf(t)>-1}indexOf(t){return this._array.indexOf(t)}concatenate(t){for(const e of t._keys)this.add(e,t.getValue(e))}clone(){const t=new X;return t.concatenate(this),t}}class K extends z{constructor(){super(),this._definitions=new X,this.onConfigurationLoaded=this.onConfigurationLoaded.bind(this)}onInit(){this.loadConfigurationFromUrl(NitroConfig.configurationUrl)}loadConfigurationFromUrl(t){if(!t||""===t)return void this.dispatchConfigurationEvent(C.FAILED);const e=new XMLHttpRequest;try{e.open("GET",t),e.onloadend=this.onConfigurationLoaded,e.onerror=this.onConfigurationFailed,e.send()}catch(s){this.logger.error(s)}}onConfigurationLoaded(t){t&&(this.parseConfiguration(t.target.response)?this.dispatchConfigurationEvent(C.LOADED):this.dispatchConfigurationEvent(C.FAILED))}onConfigurationFailed(t){this.dispatchConfigurationEvent(C.FAILED)}dispatchConfigurationEvent(t){this.events&&this.events.dispatchEvent(new C(t))}parseConfiguration(t){if(!t||""===t)return!1;try{const e=JSON.parse(t),s=new RegExp(/%(.*?)%/g);for(const t in e){let i=e[t];"string"==typeof i&&(i=this.interpolate(i,s)),this._definitions.add(t,i)}return!0}catch(e){return this.logger.error(e.stack),!1}}interpolate(t,e=null){e||(e=new RegExp(/%(.*?)%/g));const s=t.match(e);if(s&&s.length)for(const i of s){const e=this._definitions.getValue(this.removeInterpolateKey(i));e&&(t=t.replace(i,e))}return t}removeInterpolateKey(t){return t.replace(/%/g,"")}getValue(t,e=null){let s=this._definitions.getValue(t);return void 0===s&&(this.logger.warn("Missing configuration key: "+t),s=e),s}setValue(t,e){this._definitions.add(t,e)}}class q extends M{constructor(){super(),window.console.log.apply(console,["\n%c       _   ___ __              \n      / | / (_) /__________    \n     /  |/ / / __/ ___/ __ \\   \n    / /|  / / /_/ /  / /_/ /   \n   /_/ |_/_/\\__/_/   \\____/    \n                               \n Thanks for using Nitro        \n To report bugs or issues      \n join us on Discord            \n https://discord.gg/66UR68FPgy \n                               \n","color: #FFFFFF; background: #000000; padding:0px 0;"]),this._configuration=new K,this._communication=new Z,this._asset=new P}onDispose(){this._asset&&(this._asset.dispose(),this._asset=null),this._communication&&(this._communication.dispose(),this._communication=null)}get configuration(){return this._configuration}get communication(){return this._communication}get asset(){return this._asset}}class J{constructor(t=1){this._elapsedTime=0,this._percision=t,this._timer=null,this.start()}start(){this._elapsedTime=0,this._timer||(this._timer=setInterval(()=>this.increase(),this._percision))}stop(){this._timer&&clearTimeout(this._timer)}increase(){this._elapsedTime+=this._percision}getTimer(){return this._elapsedTime}}let Q=(()=>{class t extends y{constructor(t,e){super(t),this._contentType=e}get contentType(){return this._contentType}}return t.RCLE_SUCCESS="RCLE_SUCCESS",t.RCLE_FAILURE="RCLE_FAILURE",t.RCLE_CANCEL="RCLE_CANCEL",t})();var $=function(t){return t.FLOOR="S",t.WALL="I",t.EFFECT="E",t.BADGE="B",t.ROBOT="R",t.HABBO_CLUB="H",t.PET="P",t}({});let tt=(()=>{class t{}return t.MINIMUM=-2,t.ROOM=0,t.FLOOR=10,t.WALL=20,t.UNIT=100,t.CURSOR=200,t})(),et=(()=>{class t{static getTypeNumber(e){return t.AVATAR_TYPES[e]}static getTypeString(e){for(const s in t.AVATAR_TYPES)if(s&&t.AVATAR_TYPES[s]===e)return s;return null}static getRealType(e){switch(e){case t.BOT:case t.RENTABLE_BOT:return t.USER;default:return e}}}return t.USER="user",t.PET="pet",t.BOT="bot",t.RENTABLE_BOT="rentable_bot",t.MONSTER_PLANT="monsterplant",t.AVATAR_TYPES={user:1,pet:2,bot:3,rentable_bot:4},t})(),st=(()=>{class t{}return t.OBJECT_ROOM_ID="object_room_id",t.OBJECT_ACCURATE_Z_VALUE="object_accurate_z_value",t.TILE_CURSOR_HEIGHT="tile_cursor_height",t.FIGURE="figure",t.GENDER="gender",t.OWN_USER="own_user",t.FIGURE_CAN_STAND_UP="figure_can_stand_up",t.FIGURE_VERTICAL_OFFSET="figure_vertical_offset",t.FIGURE_TALK="figure_talk",t.FIGURE_DANCE="figure_dance",t.FIGURE_SLEEP="figure_sleep",t.FIGURE_BLINK="figure_blink",t.FIGURE_EFFECT="figure_effect",t.FIGURE_CARRY_OBJECT="figure_carry_object",t.FIGURE_USE_OBJECT="figure_use_object",t.FIGURE_GESTURE="figure_gesture",t.FIGURE_POSTURE="figure_posture",t.FIGURE_POSTURE_PARAMETER="figure_posture_parameter",t.FIGURE_HIGHLIGHT_ENABLE="figure_highlight_enable",t.FIGURE_HIGHLIGHT="figure_highlight",t.STD="std",t.FIGURE_SIGN="figure_sign",t.FIGURE_FLAT_CONTROL="figure_flat_control",t.FIGURE_IS_TYPING="figure_is_typing",t.FIGURE_IS_MUTED="figure_is_muted",t.FIGURE_GAINED_EXPERIENCE="figure_gained_experience",t.FIGURE_NUMBER_VALUE="figure_number_value",t.FIGURE_IS_PLAYING_GAME="figure_is_playing_game",t.FIGURE_GUIDE_STATUS="figure_guide_status",t.FIGURE_EXPRESSION="figure_expression",t.HEAD_DIRECTION="head_direction",t.FURNITURE_AUTOMATIC_STATE_INDEX="furniture_automatic_state_index",t.FURNITURE_ALWAYS_STACKABLE="furniture_always_stackable",t.FURNITURE_DISABLE_PICKING_ANIMATION="furniture_disable_picking_animation",t.FURNITURE_DATA_FORMAT="furniture_data_format",t.FURNITURE_UNIQUE_SERIAL_NUMBER="furniture_unique_serial_number",t.FURNITURE_UNIQUE_EDITION_SIZE="furniture_unique_edition_size",t.FURNITURE_CRACKABLE_STATE="furniture_crackable_state",t.FURNITURE_CRACKABLE_HITS="furniture_crackable_hits",t.FURNITURE_CRACKABLE_TARGET="furniture_crackable_target",t.FURNITURE_CREDIT_VALUE="furniture_credit_value",t.FURNITURE_DATA="furniture_data",t.FURNITURE_ITEMDATA="furniture_itemdata",t.FURNITURE_COLOR="furniture_color",t.FURNITURE_LIFT_AMOUNT="furniure_lift_amount",t.FURNITURE_GUILD_CUSTOMIZED_GUILD_ID="furniture_guild_customized_guild_id",t.FURNITURE_GUILD_CUSTOMIZED_BADGE="furniture_guild_customized_badge",t.FURNITURE_GUILD_CUSTOMIZED_COLOR_1="furniture_guild_customized_color_1",t.FURNITURE_GUILD_CUSTOMIZED_COLOR_2="furniture_guild_customized_color_2",t.FURNITURE_STATE_UPDATE_TIME="furniture_state_update_time",t.FURNITURE_SELECTION_DISABLED="furniture_selection_disabled",t.FURNITURE_SIZE_X="furniture_size_x",t.FURNITURE_SIZE_Y="furniture_size_y",t.FURNITURE_SIZE_Z="furniture_size_z",t.FURNITURE_CENTER_X="furniture_center_x",t.FURNITURE_CENTER_Y="furniture_center_y",t.FURNITURE_CENTER_Z="furniture_center_z",t.FURNITURE_ALLOWED_DIRECTIONS="furniture_allowed_directions",t.FURNITURE_AD_URL="furniture_ad_url",t.FURNITURE_TYPE_ID="furniture_type_id",t.FURNITURE_EXTRAS="furniture_extras",t.FURNITURE_EXPIRY_TIME="furniture_expiry_time",t.FURNITURE_EXPIRTY_TIMESTAMP="furniture_expiry_timestamp",t.FURNITURE_REAL_ROOM_OBJECT="furniture_real_room_object",t.FURNITURE_IS_STICKIE="furniture_is_stickie",t.FURNITURE_BRANDING_IMAGE_STATUS="furniture_branding_image_status",t.FURNITURE_BRANDING_IMAGE_URL="furniture_branding_image_url",t.FURNITURE_BRANDING_URL="furniture_branding_url",t.FURNITURE_BRANDING_OFFSET_X="furniture_branding_offset_x",t.FURNITURE_BRANDING_OFFSET_Y="furniture_branding_offset_y",t.FURNITURE_BRANDING_OFFSET_Z="furniture_branding_offset_z",t.FURNITURE_BADGE_IMAGE_STATUS="furniture_badge_image_status",t.FURNITURE_BADGE_ASSET_NAME="furniture_badge_asset_name",t.FURNITURE_BADGE_VISIBLE_IN_STATE="furniture_badge_visible_in_state",t.FURNITURE_ALPHA_MULTIPLIER="furniture_alpha_multiplier",t.FURNITURE_USAGE_POLICY="furniture_usage_policy",t.FURNITURE_OWNER_ID="furniture_owner_id",t.FURNITURE_OWNER_NAME="furniture_owner_name",t.FURNITURE_ROOM_BACKGROUND_COLOR_HUE="furniture_room_background_color_hue",t.FURNITURE_ROOM_BACKGROUND_COLOR_SATURATION="furniture_room_background_color_saturation",t.FURNITURE_ROOM_BACKGROUND_COLOR_LIGHTNESS="furniture_room_background_color_lightness",t.FURNITURE_USES_PLANE_MASK="furniture_uses_plane_mask",t.FURNITURE_PLANE_MASK_TYPE="furniture_plane_mask_type",t.FURNITURE_IS_VARIABLE_HEIGHT="furniture_is_variable_height",t.FURNITURE_VOTE_MAJORITY_RESULT="furniture_vote_majority_result",t.FURNITURE_VOTE_COUNTER_COUNT="furniture_vote_counter_count",t.FURNITURE_MANNEQUIN_NAME="furniture_mannequin_name",t.FURNITURE_MANNEQUIN_GENDER="furniture_mannequin_gender",t.FURNITURE_MANNEQUIN_FIGURE="furniture_mannequin_figure",t.FURNITURE_HIGHSCORE_SCORE_TYPE="furniture_highscore_score_type",t.FURNITURE_HIGHSCORE_CLEAR_TYPE="furniture_highscore_clear_type",t.FURNITURE_HIGHSCORE_DATA_ENTRY_COUNT="furniture_highscore_data_entry_count",t.FURNITURE_HIGHSCORE_DATA_ENTRY_BASE_USERS_="furniture_highscore_data_entry_base_users_",t.FURNITURE_HIGHSCORE_DATA_ENTRY_BASE_SCORE_="furniture_highscore_data_entry_base_score_",t.FURNITURE_INTERNAL_LINK="furniture_internal_link",t.PET_PALETTE_INDEX="pet_palette_index",t.PET_COLOR="pet_color",t.PET_HEAD_ONLY="pet_head_only",t.PET_CUSTOM_LAYER_IDS="pet_custom_layer_ids",t.PET_CUSTOM_PARTS_IDS="pet_custom_part_ids",t.PET_CUSTOM_PALETTE_IDS="pet_custom_palette_ids",t.PET_IS_RIDING="pet_is_riding",t.PET_TYPE="pet_type",t.PET_ALLOWED_DIRECTIONS="pet_allowed_directions",t.RACE="race",t.ROOM_MAP_DATA="room_map_data",t.ROOM_PLANE_MASK_XML="room_plane_mask_xml",t.ROOM_FLOOR_TYPE="room_floor_type",t.ROOM_WALL_TYPE="room_wall_type",t.ROOM_LANDSCAPE_TYPE="room_landscape_type",t.ROOM_WALL_THICKNESS="room_wall_thickness",t.ROOM_FLOOR_THICKNESS="room_floor_thickness",t.ROOM_FLOOR_HOLE_UPDATE_TIME="room_floor_hole_update_time",t.ROOM_FLOOR_VISIBILITY="room_floor_visibility",t.ROOM_WALL_VISIBILITY="room_wall_visibility",t.ROOM_LANDSCAPE_VISIBILITY="room_landscape_visibility",t.ROOM_DOOR_X="room_door_x",t.ROOM_DOOR_Y="room_door_y",t.ROOM_DOOR_Z="room_door_z",t.ROOM_DOOR_DIR="room_door_dir",t.ROOM_BACKGROUND_COLOR="room_background_color",t.ROOM_COLORIZE_BG_ONLY="room_colorize_bg_only",t.ROOM_RANDOM_SEED="room_random_seed",t.ROOM_WORLD_TYPE="room_world_type",t.ROOM_SELECTED_X="room_selected_x",t.ROOM_SELECTED_Y="room_selected_y",t.ROOM_SELECTED_Z="room_selected_z",t.ROOM_SELECTED_PLANE="room_selected_plane",t.IMAGE_QUERY_SCALE="image_query_scale",t})(),it=(()=>{class t{}return t.FURNITURE_STATIC="furniture_static",t.FURNITURE_ANIMATED="furniture_animated",t.FURNITURE_RESETTING_ANIMATED="furniture_resetting_animated",t.FURNITURE_POSTER="furniture_poster",t.FURNITURE_EXTERNAL_IMAGE="furniture_external_image",t.FURNITURE_HABBOWHEEL="furniture_habbowheel",t.FURNITURE_VAL_RANDOMIZER="furniture_val_randomizer",t.FURNITURE_BOTTLE="furniture_bottle",t.FURNITURE_PLANET_SYSTEM="furniture_planet_system",t.FURNITURE_QUEUE_TILE="furniture_queue_tile",t.FURNITURE_PARTY_BEAMER="furniture_party_beamer",t.FURNITURE_CUBOID="furniture_cuboid",t.FURNITURE_GIFT_WRAPPED="furniture_gift_wrapped",t.FURNITURE_GIFT_WRAPPED_FIREWORKS="furniture_gift_wrapped_fireworks",t.FURNITURE_COUNTER_CLOCK="furniture_counter_clock",t.FURNITURE_WATER_AREA="furniture_water_area",t.FURNITURE_SCORE_BOARD="furniture_score_board",t.FURNITURE_FIREWORKS="furniture_fireworks",t.FURNITURE_BB="furniture_bb",t.FURNITURE_BG="furniture_bg",t.FURNITURE_STICKIE="furniture_stickie",t.FURNITURE_MANNEQUIN="furniture_mannequin",t.FURNITURE_GUILD_CUSTOMIZED="furniture_guild_customized",t.FURNITURE_GUILD_ISOMETRIC_BADGE="furniture_guild_isometric_badge",t.FURNITURE_VOTE_COUNTER="furniture_vote_counter",t.FURNITURE_VOTE_MAJORITY="furniture_vote_majority",t.FURNITURE_SOUNDBLOCK="furniture_soundblock",t.FURNITURE_BADGE_DISPLAY="furniture_badge_display",t.FURNITURE_YOUTUBE="furniture_youtube",t.FURNITURE_BUILDER_PLACEHOLDER="furniture_builder_placeholder",t.ROOM="room",t.USER="user",t.PET_ANIMATED="pet_animated",t.BOT="bot",t.RENTABLE_BOT="rentable_bot",t.TILE_CURSOR="tile_cursor",t})(),rt=(()=>{class t{constructor(){this._logger=new D(this.constructor.name),this._stateEvents=null,this._sessionDataManager=null,this._waitingForSessionDataManager=!1,this._iconListener=null,this._collections=new Map,this._images=new Map,this._events=new Map,this._activeObjects={},this._activeObjectTypes=new Map,this._activeObjectTypeIds=new Map,this._objectTypeAdUrls=new Map,this._wallItems={},this._wallItemTypes=new Map,this._wallItemTypeIds=new Map,this._pets={},this._objectAliases=new Map,this._objectOriginalNames=new Map,this._pendingContentTypes=[]}initialize(t){this._stateEvents=t,this.setFurnitureData();for(const[e,s]of um.instance.getConfiguration("pet.types").entries())this._pets[s]=e}dispose(){}setSessionDataManager(t){this._sessionDataManager=t,this._waitingForSessionDataManager&&(this._waitingForSessionDataManager=!1,this.setFurnitureData())}loadFurnitureData(){this.setFurnitureData()}setFurnitureData(){if(!this._sessionDataManager)return void(this._waitingForSessionDataManager=!0);const t=this._sessionDataManager.getAllFurnitureData(this);t&&(this._sessionDataManager.removePendingFurniDataListener(this),this.processFurnitureData(t))}processFurnitureData(t){if(t)for(const e of t){if(!e)continue;const t=e.id;let s=e.className,i=e.className;e.colorId&&(s=s+"*"+e.colorId);const r=e.adUrl;r&&r.length>0&&this._objectTypeAdUrls.set(s,r),e.type===$.FLOOR?(this._activeObjectTypes.set(t,s),this._activeObjectTypeIds.set(s,t),this._activeObjects[i]||(this._activeObjects[i]=1)):e.type===$.WALL&&("post.it"===s&&(s="post_it",i="post_it"),"post.it.vd"===s&&(s="post_it_vd",i="post_id_vd"),this._wallItemTypes.set(t,s),this._wallItemTypeIds.set(s,t),this._wallItems[i]||(this._wallItems[i]=1))}}getFurnitureFloorNameForTypeId(t){const e=this._activeObjectTypes.get(t);return this.removeColorIndex(e)}getFurnitureWallNameForTypeId(t,e=null){let s=this._wallItemTypes.get(t);return"poster"===s&&null!==e&&(s+=e),this.removeColorIndex(s)}getFurnitureFloorColorIndex(t){const e=this._activeObjectTypes.get(t);return e?this.getColorIndexFromName(e):-1}getFurnitureWallColorIndex(t){const e=this._wallItemTypes.get(t);return e?this.getColorIndexFromName(e):-1}getColorIndexFromName(t){if(!t)return-1;const e=t.indexOf("*");return-1===e?0:parseInt(t.substr(e+1))}removeColorIndex(t){if(!t)return null;const e=t.indexOf("*");return-1===e?t:t.substr(0,e)}getCollection(t){if(!t)return null;const e=this._collections.get(t);if(!e){const e=um.instance.core.asset.getCollection(t);return e?(this._collections.set(t,e),e):null}return e}getImage(t){if(!t)return null;const e=this._images.get(t);if(!e)return null;const s=new Image;return s.src=e.src,s}addAssetToCollection(t,e,s){const i=this.getCollection(t);return!!i&&i.addAsset(e,s,!0,0,0,!1,!1)}createCollection(t,e){if(!t||!e)return null;const s=new L(t,e);this._collections.set(s.name,s)}getPlaceholderName(e){return void 0!==this._activeObjects[e]?t.PLACE_HOLDER:void 0!==this._wallItems[e]?t.PLACE_HOLDER_WALL:void 0!==this._pets[e]?t.PLACE_HOLDER_PET:t.PLACE_HOLDER_DEFAULT}getCategoryForType(t){return t?void 0!==this._activeObjects[t]?tt.FLOOR:void 0!==this._wallItems[t]?tt.WALL:void 0!==this._pets[t]?tt.UNIT:0===t.indexOf("poster")?tt.WALL:"room"===t?tt.ROOM:t===et.USER||t===et.PET||t===et.BOT||t===et.RENTABLE_BOT?tt.UNIT:"tile_cursor"===t||"selection_arrow"===t?tt.CURSOR:tt.MINIMUM:tt.MINIMUM}getPetNameForType(t){return um.instance.getConfiguration("pet.types")[t]||null}isLoaderType(t){return(t=et.getRealType(t))!==it.USER}downloadImage(t,e,s,i=null){let r=null,n=[];if(e&&e.indexOf(",")>=0&&(r=e,e=r.split(",")[0]),n=this.getAssetUrls(r||e,s,!0),n&&n.length){const i=n[0],r=new Image;return r.src=i,r.onload=()=>{r.onerror=null,this._images.set([e,s].join("_"),r),this._iconListener.onRoomContentLoaded(t,[e,s].join("_"),!0)},r.onerror=()=>{r.onload=null,this._logger.error("Failed to download asset: "+i),this._iconListener.onRoomContentLoaded(t,[e,s].join("_"),!1)},!0}return!1}downloadAsset(t,e){const s=this.getAssetUrls(t);if(!s||!s.length)return!1;if(this._pendingContentTypes.indexOf(t)>=0||this.getOrRemoveEventDispatcher(t))return!1;this._pendingContentTypes.push(t),this._events.set(t,e);const i=s.length;let r=0;const n=(s,n,a)=>{if(s&&s.destroy(),!a)return this._logger.error("Failed to download asset: "+n.url),void e.dispatchEvent(new Q(Q.RCLE_FAILURE,t));if(r++,r===i){const e=this._events.get(t);if(!e)return;e.dispatchEvent(new Q(Q.RCLE_SUCCESS,t))}};for(const a of s){if(!a)continue;const t=new A.g,e={crossOrigin:!1};t.use((e,s)=>this.assetLoader(t,e,s,n)).add(s,e).load()}return!0}assetLoader(t,e,s,i){if(!e||e.error)return e&&e.texture&&e.texture.destroy(!0),void i(t,e,!1);if(e.type===A.h.TYPE.JSON){const s=e.data;if(!s.type)return void i(t,e,!1);if(s.spritesheet&&Object.keys(s.spritesheet).length){const r=s.spritesheet.meta&&s.spritesheet.meta.image;if(!r||!r.length)return void i(t,e,!1);const n=e.url.substring(0,e.url.lastIndexOf("/")+1)+r,a=A.c.from(n);if(a.valid){const r=new A.o(a,s.spritesheet);r.parse(n=>{this.createCollection(s,r),i(t,e,!0)})}else a.once("loaded",()=>{a.removeAllListeners();const r=new A.o(a,s.spritesheet);r.parse(n=>{this.createCollection(s,r),i(t,e,!0)})}),a.once("error",()=>{a.removeAllListeners(),i(t,e,!1)});return}this.createCollection(s,null),i(t,e,!0)}else i(t,e,!1)}_Str_12966(t,e){this._objectAliases.set(t,e),this._objectOriginalNames.set(e,t)}getAssetAliasName(t){return this._objectAliases.get(t)||t}getAssetOriginalName(t){return this._objectOriginalNames.get(t)||t}getAssetUrls(e,s=null,i=!1){switch(e){case t.PLACE_HOLDER:return[this.getAssetUrlWithRoomBase("place_holder")];case t.PLACE_HOLDER_WALL:return[this.getAssetUrlWithRoomBase("place_holder_wall")];case t.PLACE_HOLDER_PET:return[this.getAssetUrlWithRoomBase("place_holder_pet")];case t.ROOM:return[this.getAssetUrlWithRoomBase("room")];case t.TILE_CURSOR:return[this.getAssetUrlWithRoomBase("tile_cursor")];case t.SELECTION_ARROW:return[this.getAssetUrlWithRoomBase("selection_arrow")];default:{const t=this.getCategoryForType(e);if(t===tt.FLOOR||t===tt.WALL){const t=this.getAssetAliasName(e);let r=i?this.getAssetUrlWithFurniIconBase(t):this.getAssetUrlWithFurniBase(e);if(i){const e=s&&""!==s&&"0"!==s&&null!==this._activeObjectTypeIds.get(t+"*"+s);r=r.replace(/%param%/gi,e?"_"+s:"")}return[r]}return t===tt.UNIT?[this.getAssetUrlWithPetBase(e)]:null}}}getAssetIconUrl(t,e){let s=null,i=[];return t&&t.indexOf(",")>=0&&(s=t,t=s.split(",")[0]),i=this.getAssetUrls(s||t,e,!0),i.length?i[0]:null}getAssetUrlWithRoomBase(t){return um.instance.getConfiguration("room.asset.url").replace(/%libname%/gi,t)}getAssetUrlWithFurniBase(t){return um.instance.getConfiguration("furni.asset.url").replace(/%libname%/gi,t)}getAssetUrlWithFurniIconBase(t){return um.instance.getConfiguration("furni.asset.icon.url").replace(/%libname%/gi,t)}getAssetUrlWithPetBase(t){return um.instance.getConfiguration("pet.asset.url").replace(/%libname%/gi,t)}setRoomObjectRoomId(t,e){const s=t&&t.model;s&&s.setValue(st.OBJECT_ROOM_ID,e)}getOrRemoveEventDispatcher(t,e=!1){const s=this._events.get(t);return e&&this._events.delete(t),s}setIconListener(t){this._iconListener=t}}return t.PLACE_HOLDER="place_holder",t.PLACE_HOLDER_WALL="place_holder_wall",t.PLACE_HOLDER_PET="place_holder_pet",t.PLACE_HOLDER_DEFAULT=t.PLACE_HOLDER,t.ROOM="room",t.TILE_CURSOR="tile_cursor",t.SELECTION_ARROW="selection_arrow",t.MANDATORY_LIBRARIES=[t.PLACE_HOLDER,t.PLACE_HOLDER_WALL,t.PLACE_HOLDER_PET,t.ROOM,t.TILE_CURSOR,t.SELECTION_ARROW],t})();class nt{constructor(){this._map=new Map,this._updateCounter=0}dispose(){this._map.clear(),this._updateCounter=0}getValue(t){return this._map.get(t)}setValue(t,e){this._map.set(t,e),this._updateCounter++}removeKey(t){t&&(this._map.delete(t),this._updateCounter++)}get updateCounter(){return this._updateCounter}}class at extends M{constructor(t,e){super(),this._id=t,this._container=e,this._renderer=null,this._managers=new Map,this._updateCategories=[],this._model=new nt}onDispose(){this.removeAllManagers(),this.destroyRenderer(),this._container=null,this._model.dispose()}setRenderer(t){if(t!==this._renderer&&(this._renderer&&this.destroyRenderer(),this._renderer=t,this._renderer&&(this._renderer.reset(),this._managers.size)))for(const e of this._managers.values()){if(!e)continue;const t=e.objects;if(t.length)for(const e of t.getValues())e&&this._renderer.addObject(e)}}destroyRenderer(){this._renderer&&(this._renderer.dispose(),this._renderer=null)}getManager(t){return this._managers.get(t)||null}getManagerOrCreate(t){let e=this.getManager(t);return e||(e=this._container.createRoomObjectManager(t),e?(this._managers.set(t,e),e):null)}getTotalObjectsForManager(t){const e=this.getManager(t);return e?e.totalObjects:0}getRoomObject(t,e){const s=this.getManager(e);return s&&s.getObject(t)||null}getRoomObjectsForCategory(t){const e=this.getManager(t);return e?e.objects.getValues():[]}getRoomObjectByIndex(t,e){const s=this.getManager(e);return s&&s.getObjectByIndex(t)||null}createRoomObject(t,e,s,i){const r=this.getManagerOrCreate(i);if(!r)return null;const n=r.createObject(t,e,s);return n?(this._renderer&&this._renderer.addObject(n),n):null}createRoomObjectAndInitalize(t,e,s){return this._container?this._container.createRoomObjectAndInitalize(this._id,t,e,s):null}removeRoomObject(t,e){const s=this.getManager(e);if(!s)return;const i=s.getObject(t);i&&(i.tearDown(),this._renderer&&this._renderer.removeObject(i),s.removeObject(t))}removeAllManagers(){for(const t of this._managers.values())if(t){if(this._renderer){const e=t.objects;if(e.length)for(const t of e.getValues())t&&this._renderer.removeObject(t)}t.dispose()}this._managers.clear()}addUpdateCategory(t){this._updateCategories.indexOf(t)>=0||this._updateCategories.push(t)}removeUpdateCategory(t){const e=this._updateCategories.indexOf(t);-1!==e&&this._updateCategories.splice(e,1)}update(t,e=!1){for(const s of this._updateCategories){const e=this.getManager(s);if(!e)continue;const i=e.objects;if(i.length)for(const s of i.getValues()){if(!s)continue;const e=s.logic;e&&e.update(t)}}this._renderer&&this._renderer.update(t,e)}hasUninitializedObjects(){for(const t of this._managers.values())if(t)for(const e of t.objects.getValues())if(e&&!e.isReady)return!0;return!1}get id(){return this._id}get container(){return this._container}get renderer(){return this._renderer}get managers(){return this._managers}get model(){return this._model}}class ot{constructor(t=0,e=0,s=0){this._x=t,this._y=e,this._z=s,this._length=NaN}static sum(t,e){return t&&e?new ot(t.x+e.x,t.y+e.y,t.z+e.z):null}static dif(t,e){return t&&e?new ot(t.x-e.x,t.y-e.y,t.z-e.z):null}static product(t,e){return t?new ot(t.x*e,t.y*e,t.z*e):null}static dotProduct(t,e){return t&&e?t.x*e.x+t.y*e.y+t.z*e.z:0}static crossProduct(t,e){return t&&e?new ot(t.y*e.z-t.z*e.y,t.z*e.x-t.x*e.z,t.x*e.y-t.y*e.x):null}static scalarProjection(t,e){if(!t||!e)return-1;const s=e.length;return s>0?(t.x*e.x+t.y*e.y+t.z*e.z)/s:-1}static cosAngle(t,e){if(!t||!e)return 0;const s=t.length*e.length;return s?ot.dotProduct(t,e)/s:0}static isEqual(t,e){return!(!t||!e)&&t.x===e.x&&t.y===e.y&&t.z===e.z}negate(){this._x=-this._x,this._y=-this._y,this._z=-this._z}add(t){t&&(this._x+=t.x,this._y+=t.y,this._z+=t.z,this._length=NaN)}subtract(t){t&&(this._x-=t.x,this._y-=t.y,this._z-=t.z,this._length=NaN)}multiply(t){this._x*=t,this._y*=t,this._z*=t,this._length=NaN}divide(t){this._x/=t,this._y/=t,this._z/=t,this._length=NaN}assign(t){t&&(this._x=t.x,this._y=t.y,this._z=t.z,this._length=NaN)}get x(){return this._x}set x(t){this._x=t,this._length=NaN}get y(){return this._y}set y(t){this._y=t,this._length=NaN}get z(){return this._z}set z(t){this._z=t,this._length=NaN}get length(){return isNaN(this._length)&&(this._length=Math.sqrt(this._x*this._x+this._y*this._y+this._z*this._z)),this._length}toString(){return`[Vector3d: ${this._x}, ${this._y}, ${this._z}]`}}let ct=(()=>{class t extends M{constructor(e,s,i){super(),this._id=e,this._instanceId=t.OBJECT_COUNTER++,this._type=i,this._model=new nt,this._location=new ot,this._direction=new ot,this._states=[],this._visualization=null,this._logic=null,this._pendingLogicMessages=[],this._updateCounter=0,this._isReady=!1;let r=s-1;for(;r>=0;)this._states[r]=0,r--}onDispose(){this._pendingLogicMessages=[],this.setVisualization(null),this.setLogic(null),this._model&&this._model.dispose(),super.onDispose()}getLocation(){return this._location}setLocation(t){t&&(t.x===this._location.x&&t.y===this._location.y&&t.z===this._location.z||(this._location.x=t.x,this._location.y=t.y,this._location.z=t.z,this._updateCounter++))}getDirection(){return this._direction}setDirection(t){t&&(t.x===this._direction.x&&t.y===this._direction.y&&t.z===this._direction.z||(this._direction.x=(t.x%360+360)%360,this._direction.y=(t.y%360+360)%360,this._direction.z=(t.z%360+360)%360,this._updateCounter++))}getState(t=0){return t>=0&&t<this._states.length?this._states[t]:-1}setState(t,e=0){return e>=0&&e<this._states.length&&(this._states[e]!==t&&(this._states[e]=t,this._updateCounter++),!0)}setVisualization(t){this._visualization!==t&&(this._visualization&&this._visualization.dispose(),this._visualization=t,this._visualization&&(this._visualization.object=this))}setLogic(t){if(this._logic===t)return;const e=this._logic;if(e&&(this._logic=null,e.setObject(null)),this._logic=t,this._logic)for(this._logic.setObject(this);this._pendingLogicMessages.length;){const t=this._pendingLogicMessages.shift();this._logic.processUpdateMessage(t)}}processUpdateMessage(t){if(this._logic)return this._logic.processUpdateMessage(t);this._pendingLogicMessages.push(t)}tearDown(){this._logic&&this._logic.tearDown()}get id(){return this._id}get instanceId(){return this._instanceId}get type(){return this._type}get model(){return this._model}get visualization(){return this._visualization}get mouseHandler(){return this._logic}get logic(){return this._logic}get location(){return this._location}get direction(){return this._direction}get updateCounter(){return this._updateCounter}set updateCounter(t){this._updateCounter=t}get isReady(){return this._isReady}set isReady(t){this._isReady=t}}return t.OBJECT_COUNTER=0,t})();class _t{constructor(){this._objects=new X,this._objectsPerType=new X}dispose(){this.removeAllObjects()}getObject(t){return this._objects.getValue(t)||null}getObjectByIndex(t){return this._objects.getWithIndex(t)||null}createObject(t,e,s){const i=new ct(t,e,s);return this.addObject(t,s,i)}addObject(t,e,s){if(this._objects.getValue(t))return s.dispose(),null;this._objects.add(t,s);const i=this.getTypeMap(e);return i&&i.add(t,s),s}removeObject(t){const e=this._objects.remove(t);if(e){const t=this.getTypeMap(e.type);t&&t.remove(e.id),e.dispose()}}removeAllObjects(){let t=0;for(;t<this._objects.length;){const e=this._objects.getWithIndex(t);e&&e.dispose(),t++}for(this._objects.reset(),t=0;t<this._objectsPerType.length;){const e=this._objectsPerType.getWithIndex(t);e&&e.dispose(),t++}this._objectsPerType.reset()}getTypeMap(t,e=!0){let s=this._objectsPerType.getValue(t);return!s&&e&&(s=new X,this._objectsPerType.add(t,s)),s}get objects(){return this._objects}get totalObjects(){return this._objects.length}}let ht=(()=>{class t extends z{constructor(e,s,i){super(),this._state=t._Str_16443,this._rooms=new Map,this._contentLoader=null,this._updateCategories=[],this._listener=e,this._visualizationFactory=s,this._logicFactory=i,this._initialLoadList=[],this._pendingContentTypes=[],this._skipContentProcessing=!1,this._disposed=!1,this.onRoomContentLoadedEvent=this.onRoomContentLoadedEvent.bind(this),this.events.addEventListener(Q.RCLE_SUCCESS,this.onRoomContentLoadedEvent),this.events.addEventListener(Q.RCLE_FAILURE,this.onRoomContentLoadedEvent),this.events.addEventListener(Q.RCLE_CANCEL,this.onRoomContentLoadedEvent)}onInit(){if(this._state>=t._Str_13904||!this._contentLoader)return;const e=rt.MANDATORY_LIBRARIES;for(const t of e)t&&-1===this._initialLoadList.indexOf(t)&&(this._contentLoader.downloadAsset(t,this.events),this._initialLoadList.push(t));this._state=t._Str_13904}getRoomInstance(t){return this._rooms.get(t)||null}createRoomInstance(t){if(this._rooms.get(t))return null;const e=new at(t,this);if(this._rooms.set(e.id,e),this._updateCategories.length)for(const s of this._updateCategories)e.addUpdateCategory(s);return e}removeRoomInstance(t){const e=this._rooms.get(t);return!!e&&(this._rooms.delete(t),e.dispose(),!0)}createRoomObjectAndInitalize(t,e,s,i){const r=this.getRoomInstance(t);if(!r)return null;let n=s,a=s,o=s,c=null,_=!1;if(this._contentLoader.isLoaderType(s)){if(c=this._contentLoader.getCollection(s),!c&&(_=!0,this._contentLoader.downloadAsset(s,this.events),o=this._contentLoader.getPlaceholderName(s),c=this._contentLoader.getCollection(o),!c))return null;n=c.data.visualizationType,a=c.data.logicType}const h=r.createRoomObject(e,1,s,i);if(!h)return null;if(this._visualizationFactory){const t=this._visualizationFactory.getVisualization(n);if(!t)return r.removeRoomObject(e,i),null;t.asset=c;const s=this._visualizationFactory.getVisualizationData(o,n,c&&c.data||null);if(!s||!t.initialize(s))return r.removeRoomObject(e,i),null;h.setVisualization(t)}if(this._logicFactory){const t=this._logicFactory.getLogic(a);h.setLogic(t),t&&t.initialize(c&&c.data||null)}return _||(h.isReady=!0),this._contentLoader.setRoomObjectRoomId(h,t),h}reinitializeRoomObjectsByType(t){if(!(t&&this._contentLoader&&this._visualizationFactory&&this._logicFactory))return;const e=this._contentLoader.getCollection(t);if(!e)return;const s=e.data.visualizationType,i=e.data.logicType,r=this._visualizationFactory.getVisualizationData(t,s,e.data);for(const n of this._rooms.values())if(n)for(const[a,o]of n.managers.entries())if(o)for(const c of o.objects.getValues()){if(!c||c.type!==t)continue;const _=this._visualizationFactory.getVisualization(s);if(_)if(_.asset=e,r&&_.initialize(r)){c.setVisualization(_);const t=this._logicFactory.getLogic(i);c.setLogic(t),t&&t.initialize(e.data),c.isReady=!0,this._listener&&this._listener.objectInitialized(n.id,c.id,a)}else o.removeObject(c.id);else o.removeObject(c.id)}}addUpdateCategory(t){if(!(this._updateCategories.indexOf(t)>=0)&&(this._updateCategories.push(t),this._rooms.size))for(const e of this._rooms.values())e&&e.addUpdateCategory(t)}removeUpdateCategory(t){const e=this._updateCategories.indexOf(t);if(-1!==e&&(this._updateCategories.splice(e,1),this._rooms.size))for(const s of this._rooms.values())s&&s.removeUpdateCategory(t)}setContentLoader(t){this._contentLoader&&this._contentLoader.dispose(),this._contentLoader=t}processPendingContentTypes(t){if(this._skipContentProcessing)this._skipContentProcessing=!1;else for(;this._pendingContentTypes.length;){const t=this._pendingContentTypes.shift();this._contentLoader.getCollection(t)?(this.reinitializeRoomObjectsByType(t),this._listener&&this._listener.initalizeTemporaryObjectsByType(t,!0),this._initialLoadList.length>0&&this.removeFromInitialLoad(t)):(this._listener&&this._listener.initalizeTemporaryObjectsByType(t,!1),this.logger.log("Invalid Collection: "+t))}}removeFromInitialLoad(e){if(e&&this._state!==t._Str_9994)if(this._contentLoader||(this._state=t._Str_9994),this._contentLoader.getCollection(e)){const s=this._initialLoadList.indexOf(e);s>=0&&this._initialLoadList.splice(s,1),this._initialLoadList.length||(this._state=t._Str_9846,this._listener&&this._listener.onRoomEngineInitalized(!0))}else this._state=t._Str_9994,this._listener&&this._listener.onRoomEngineInitalized(!1)}onRoomContentLoadedEvent(t){if(!this._contentLoader)return;const e=t.contentType;this._pendingContentTypes.indexOf(e)>=0||this._pendingContentTypes.push(e)}update(t,e=!1){if(this.processPendingContentTypes(t),this._rooms.size)for(const s of this._rooms.values())s&&s.update(t,e)}createRoomObjectManager(t){return new _t}get rooms(){return this._rooms}get disposed(){return this._disposed}}return t._Str_9994=-1,t._Str_16337=0,t._Str_16443=1,t._Str_13904=2,t._Str_9846=3,t._Str_18280=40,t})();var lt=s("CDzl");let ut=(()=>{class t{constructor(){this._gender="M",this._avatarEffectType=-1}_Str_2153(t,e){this._data=new Map,this._colors=new Map,this._gender=e,this._Str_958(t)}dispose(){this._data=null,this._colors=null,this._isDisposed=!0}get disposed(){return this._isDisposed}_Str_958(t){if(t)for(const e of t.split(".")){const t=e.split("-");if(t.length>0){const e=t[0],s=parseInt(t[1]),i=[];let r=2;for(;r<t.length;)i.push(parseInt(t[r])),r++;i.length||i.push(0),this._Str_1876(e,s,!1),this.savePartSetColourId(e,i,!1)}}}_Str_2131(t){return!!this._data.get(t)}getPartSetId(t){return this._Str_2131(t)?this._data.get(t):-1}getColourIds(t){return this._colors.get(t)?this._colors.get(t):[]}_Str_1008(){let t="";const e=[];for(const[i,r]of this._data.entries()){let t=i+"-"+r;const s=this._colors.get(i);if(s)for(const e of s)t=t+"-"+e;e.push(t)}let s=0;for(;s<e.length;)t+=e[s],s<e.length-1&&(t+="."),s++;return t}_Str_2088(t,e,s,i=!1){this._Str_1876(t,e,i),this.savePartSetColourId(t,s,i)}_Str_1876(e,s,i=!0){switch(e){case t.HD:case t.HR:case t.HA:case t.HE:case t.EA:case t.FA:case t.CH:case t.CC:case t.CA:case t.CP:case t.LG:case t.SH:case t.WA:s>=0?this._data.set(e,s):this._data.delete(e)}}savePartSetColourId(e,s,i=!0){switch(e){case t.HD:case t.HR:case t.HA:case t.HE:case t.EA:case t.FA:case t.CH:case t.CC:case t.CA:case t.CP:case t.LG:case t.SH:case t.WA:return void this._colors.set(e,s)}}getFigureStringWithFace(e){const s=[t.HD];let i="";const r=[];for(const a of s){const s=this._colors.get(a);if(s){let i=this._data.get(a);a===t.HD&&(i=e);let n=a+"-"+i;if(i>=0){let t=0;for(;t<s.length;)n=n+"-"+s[t],t++}r.push(n)}}let n=0;for(;n<r.length;)i+=r[n],n<r.length-1&&(i+="."),n++;return i}get gender(){return this._gender}}return t.M="M",t.F="F",t.U="U",t.H="h",t.STD="std",t._Str_2028="0",t.HD="hd",t.HR="hr",t.HA="ha",t.HE="he",t.EA="ea",t.FA="fa",t.CC="cc",t.CH="ch",t.CA="ca",t.CP="cp",t.LG="lg",t.SH="sh",t.WA="wa",t._Str_1329=[28,29,30,33,34,35,36,37,38,39,40,41,42,43,68],t})();class dt{constructor(t,e){this._name=t,this._link=e.link,this._flipH=1===e.fliph,this._flipV=1===e.flipv}get name(){return this._name}get link(){return this._link}get flipH(){return this._flipH}get flipV(){return this._flipV}}class gt{constructor(t,e){this._avatarRenderManager=t,this._aliases=new Map,this._assets=e,this._missingAssetNames=[]}dispose(){this._assets=null,this._aliases=null}reset(){this.init()}init(){for(const t of this._assets.collections.values()){if(!t)continue;const e=t.data&&t.data.aliases;if(e)for(const t in e){const s=e[t];s&&this._aliases.set(t,new dt(t,s))}}}_Str_1044(t){return!!this._aliases.get(t)}_Str_2125(t){let e=t,s=5;for(;this._Str_1044(e)&&s>=0;)e=this._aliases.get(e).link,s--;return e}getAsset(t){return this._assets?(t=this._Str_2125(t),this._assets.getAsset(t)||null):null}}let mt=(()=>{class t extends y{constructor(t,e){super(t),this._library=e}get library(){return this._library}}return t.DOWNLOAD_COMPLETE="ARLE_DOWNLOAD_COMPLETE",t})(),pt=(()=>{class t extends N{constructor(e,s,i,r){super(),this._state=t.NOT_LOADED,this._libraryName=e,this._revision=s,this._downloadUrl=r,this._assets=i,this._downloadUrl=this._downloadUrl.replace(/%libname%/gi,this._libraryName),this._downloadUrl=this._downloadUrl.replace(/%revision%/gi,this._revision),this._assets.getCollection(this._libraryName)&&(this._state=t.LOADED)}downloadAsset(){if(this._assets&&this._state!==t.LOADING&&this._state!==t.LOADED)return this._assets.getCollection(this._libraryName)?(this._state=t.LOADED,void this.dispatchEvent(new mt(mt.DOWNLOAD_COMPLETE,this))):(this._state=t.LOADING,void this._assets.downloadAsset(this._downloadUrl,e=>{e&&(this._state=t.LOADED,this.dispatchEvent(new mt(mt.DOWNLOAD_COMPLETE,this)))}))}get libraryName(){return this._libraryName}get isLoaded(){return this._state===t.LOADED}}return t.DOWNLOAD_COMPLETE="AADL_DOWNLOAD_COMPLETE",t.NOT_LOADED=0,t.LOADING=1,t.LOADED=2,t})(),Et=(()=>{class t{}return t.AVATAR_RENDER_READY="AVATAR_RENDER_READY",t})(),ft=(()=>{class t extends N{constructor(t,e){super(),this._assets=t,this._structure=e,this._missingMandatoryLibs=um.instance.getConfiguration("avatar.mandatory.libraries"),this._figureMap=new Map,this._pendingContainers=[],this._figureListeners=new Map,this._incompleteFigures=new Map,this._pendingDownloadQueue=[],this._currentDownloads=[],this._libraryNames=[],this._isReady=!1,this.onLibraryLoaded=this.onLibraryLoaded.bind(this),this.onAvatarRenderReady=this.onAvatarRenderReady.bind(this),this.loadFigureMap(),this._structure.renderManager.events.addEventListener(Et.AVATAR_RENDER_READY,this.onAvatarRenderReady)}loadFigureMap(){const e=new XMLHttpRequest;try{e.open("GET",um.instance.getConfiguration("avatar.figuremap.url")),e.send(),e.onloadend=s=>{if(e.responseText){const s=JSON.parse(e.responseText);this.processFigureMap(s.libraries),this.processMissingLibraries(),this._isReady=!0,this.dispatchEvent(new y(t.DOWNLOADER_READY))}},e.onerror=t=>{throw new Error("invalid_avatar_figure_map")}}catch(s){D.log(s)}}processFigureMap(t){if(t)for(const e of t){if(!e)continue;const t=e.id,s=e.revision||"";if(this._libraryNames.indexOf(t)>=0)continue;this._libraryNames.push(t);const i=new pt(t,s,this._assets,um.instance.getConfiguration("avatar.asset.url"));i.addEventListener(mt.DOWNLOAD_COMPLETE,this.onLibraryLoaded);for(const r of e.parts){const t=r.type+":"+r.id;let e=this._figureMap.get(t);e||(e=[]),e.push(i),this._figureMap.set(t,e)}}}onAvatarRenderReady(t){if(t){for(const[t,e]of this._pendingContainers)this.downloadAvatarFigure(t,e);this._pendingContainers=[]}}onLibraryLoaded(e){if(!e||!e.library)return;const s=[];for(const[r,n]of this._incompleteFigures.entries()){let e=!0;for(const t of n)if(t&&!t.isLoaded){e=!1;break}if(e){s.push(r);const e=this._figureListeners.get(r);if(e)for(const t of e)t&&!t.disposed&&t.resetFigure(r);this._figureListeners.delete(r),this.dispatchEvent(new y(t.LIBRARY_LOADED))}}for(const t of s)t&&this._incompleteFigures.delete(t);let i=0;for(;i<this._currentDownloads.length;){const t=this._currentDownloads[i];t&&t.libraryName===e.library.libraryName&&this._currentDownloads.splice(i,1),i++}}processMissingLibraries(){const t=this._missingMandatoryLibs.slice();for(const e of t){if(!e)continue;const t=this._figureMap.get(e);if(t)for(const e of t)e&&this.downloadLibrary(e)}}isAvatarFigureContainerReady(t){return!(!this._isReady||!this._structure.renderManager.isReady||this.getAvatarFigurePendingLibraries(t).length)}getAvatarFigurePendingLibraries(t){const e=[];if(!t||!this._structure)return e;const s=this._structure.figureData;if(!s)return e;const i=t._Str_1016();for(const r of i){const i=s._Str_740(r);if(!i)continue;const n=i._Str_1020(t.getPartSetId(r));if(n)for(const t of n._Str_806){if(!t)continue;const s=this._figureMap.get(t.type+":"+t.id);if(void 0!==s)for(const t of s)t&&!t.isLoaded&&(e.indexOf(t)>=0||e.push(t))}}return e}downloadAvatarFigure(t,e){if(!this._isReady||!this._structure.renderManager.isReady)return void this._pendingContainers.push([t,e]);const s=t._Str_1008(),i=this.getAvatarFigurePendingLibraries(t);if(i&&i.length){if(e&&!e.disposed){let t=this._figureListeners.get(s);t||(t=[],this._figureListeners.set(s,t)),t.push(e)}this._incompleteFigures.set(s,i);for(const t of i)t&&this.downloadLibrary(t)}else e&&!e.disposed&&e.resetFigure(s)}downloadLibrary(t){t&&!t.isLoaded&&(this._pendingDownloadQueue.indexOf(t)>=0||this._currentDownloads.indexOf(t)>=0||(this._pendingDownloadQueue.push(t),this.processDownloadQueue()))}processDownloadQueue(){for(;this._pendingDownloadQueue.length;)this._pendingDownloadQueue[0].downloadAsset(),this._currentDownloads.push(this._pendingDownloadQueue.shift())}}return t.DOWNLOADER_READY="AADM_DOWNLOADER_READY",t.LIBRARY_LOADED="AADM_LIBRARY_LOADED",t.MAX_DOWNLOADS=2,t})();class St{constructor(t){this._parts=new Map,this.parseFigure(t)}_Str_1016(){return this.partSets().keys()}_Str_744(t){return null!==this.partSets().get(t)}getPartSetId(t){const e=this.partSets().get(t);return e?e.get("setid"):0}_Str_815(t){const e=this.partSets().get(t);return e?e.get("colorids"):null}_Str_830(t,e,s){const i=new Map;i.set("type",t),i.set("setid",e),i.set("colorids",s);const r=this.partSets();r.delete(t),r.set(t,i)}_Str_923(t){this.partSets().delete(t)}_Str_1008(){const t=[];for(const e of this.partSets().keys()){if(!e)continue;let s=[];s.push(e),s.push(this.getPartSetId(e)),s=s.concat(this._Str_815(e)),t.push(s.join("-"))}return t.join(".")}partSets(){return this._parts||(this._parts=new Map),this._parts}parseFigure(t){t||(t="");for(const e of t.split(".")){const t=e.split("-");if(t.length>=2){const e=t[0],s=parseInt(t[1]),i=[];let r=2;for(;r<t.length;)i.push(parseInt(t[r])),r++;this._Str_830(e,s,i)}}}}let bt=(()=>{class t{static generateTexture(e,s=null,i=A.m.NEAREST,r=1){return e?t.getRenderer().generateTexture(e,i,r,s):null}static generateTextureFromImage(t){return t?A.p.from(t):null}static generateImage(e){return e?t.getRenderer().extract.image(e):null}static generateImageUrl(e){return e?t.getRenderer().extract.base64(e):null}static getRenderer(){return t._renderer?t._renderer:um.instance.renderer}static setRenderer(e){t._renderer=e}}return t._renderer=null,t})();class Rt{constructor(t,e="",s=0){this._actionType=t||"",this._actionParameter=e||"",this._definition=null,this._startFrame=s||0,this._overridingAction=null}dispose(){this._actionType=null,this._actionParameter=null,this._definition=null}get id(){return this._definition?this._definition.id+"_"+this._actionParameter:""}get _Str_695(){return this._actionType}get _Str_727(){return this._actionParameter}set _Str_727(t){this._actionParameter=t}get _Str_742(){return this._definition}set _Str_742(t){this._definition=t}get _Str_664(){return this._startFrame}get _Str_707(){return this._overridingAction}set _Str_707(t){this._overridingAction=t}}class It{}let vt=(()=>{class t{constructor(t,e,s){if(this._id=t.id,this._animationFrame=parseInt(t.frame)||0,this._dx=void 0!==t.dx?parseInt(t.dx):0,this._dy=void 0!==t.dy?parseInt(t.dy):0,this._dz=void 0!==t.dz?parseInt(t.dz):0,this._directionOffset=void 0!==t.dd?parseInt(t.dd):0,this._type=e,this._base=t.base||"",this._items=new Map,t.items)for(const i of t.items)this._items.set(i.id,i.base);""!==this._base&&this._Str_2108().toString(),s&&(this._action=new Rt(s.state,this.base),this._action._Str_742=s)}get items(){return this._items}_Str_2108(){let t=0,e=0;for(;e<this._base.length;)t+=this._base.charCodeAt(e),e++;return t}get id(){return this._id}get _Str_891(){return this._animationFrame}get dx(){return this._dx}get dy(){return this._dy}get dz(){return this._dz}get dd(){return this._directionOffset}get type(){return this._type}get base(){return this._base}get action(){return this._action}}return t.BODYPART="bodypart",t.FX="fx",t})();class Tt{constructor(t,e,s){this._image=t,this._regPoint=e,this._offset=new A.j(0,0),this._regPoint=e,this._isCacheable=s,this._Str_1225()}dispose(){this._image&&this._image.destroy({children:!0}),this._image=null,this._regPoint=null,this._offset=null}_Str_1225(){}_Str_1387(t){this._regPoint=t,this._Str_1225()}get image(){return this._image}set image(t){this._image&&this._image!==t&&this._image.destroy({children:!0}),this._image=t}get _Str_1076(){const t=this._regPoint.clone();return t.x+=this._offset.x,t.y+=this._offset.y,t}set offset(t){this._offset=t,this._Str_1225()}get _Str_1807(){return this._isCacheable}}let Ot=(()=>{class t{}return t.DIRECTION_TO_ANGLE=[45,90,135,180,225,270,315,0],t.DIRECTION_IS_FLIPPED=[!1,!1,!1,!1,!0,!0,!0,!1],t.MIN_DIRECTION=0,t.MAX_DIRECTION=7,t})(),At=(()=>{class t{}return t.BODY="bd",t.SHOES="sh",t.LEGS="lg",t.CHEST="ch",t.WAIST_ACCESSORY="wa",t.CHEST_ACCESSORY="ca",t.HEAD="hd",t.HAIR="hr",t.FACE_ACCESSORY="fa",t.EYE_ACCESSORY="ea",t.HEAD_ACCESSORY="ha",t.HEAD_ACCESSORY_EXTRA="he",t.COAT_CHEST="cc",t.CHEST_PRINT="cp",t.LEFT_HAND_ITEM="li",t.LEFT_HAND="lh",t.LEFT_SLEEVE="ls",t.RIGHT_HAND="rh",t.RIGHT_SLEEVE="rs",t.FACE="fc",t.EYES="ey",t.HAIR_BIG="hrb",t.RIGHT_HAND_ITEM="ri",t.LEFT_COAT_SLEEVE="lc",t.RIGHT_COAT_SLEEVE="rc",t._Str_1286=[t.SHOES,t.LEGS,t.CHEST,t.WAIST_ACCESSORY,t.CHEST_ACCESSORY,t.HEAD,t.HAIR,t.FACE_ACCESSORY,t.EYE_ACCESSORY,t.HEAD_ACCESSORY,t.HEAD_ACCESSORY_EXTRA,t.COAT_CHEST,t.CHEST_PRINT],t})(),yt=(()=>{class t{}return t.LARGE="h",t.SMALL="sh",t})(),Ct=(()=>{class t{}return t.VERTICAL="vertical",t.SITTING="sitting",t.HORIZONTAL="horizontal",t.SWIM="swim",t.SNOWWARS_HORIZONTAL="swhorizontal",t})();class Mt{constructor(){this._Str_586=new Map}_Str_1565(t,e){this._Str_1233||(this._Str_1233=t);const s=this._Str_1961(this._Str_1233);s&&s._Str_1108(e),this._Str_1233=t}dispose(){if(!this._disposed){if(!this._Str_586)return;this._Str_2089(0,2147483647),this._Str_586.clear(),this._Str_586=null,this._disposed=!0}}_Str_2089(t,e){if(this._Str_586&&!this._disposed)for(const[s,i]of this._Str_586.entries())i&&e-i._Str_1815()>=t&&(i.dispose(),this._Str_586.delete(s))}_Str_2244(){return this._Str_1233}setDirection(t){this._Str_1188=t}getDirection(){return this._Str_1188}_Str_1961(t=null){return this._Str_1233?(t||(t=this._Str_1233),this._Str_586.get(t._Str_707?t._Str_707:t.id)):null}_Str_1765(t,e){this._Str_586.set(t._Str_707?t._Str_707:t.id,e)}_Str_587(t){}}class Dt{constructor(){this._Str_586=new Map,this._Str_1108(um.instance.time)}dispose(){if(this._Str_587("[dispose]"),this._Str_586){for(const t of this._Str_586.values())t&&t.dispose();this._Str_586.clear()}}_Str_2070(t){return this._Str_586.get(t.toString())||null}_Str_2168(t,e){this._Str_586.set(t.toString(),e)}_Str_1108(t){this._Str_1509=t}_Str_1815(){return this._Str_1509}_Str_587(t){}}class Nt{constructor(t){this._partList=t,this._images=new Map}dispose(){for(const t of this._images.values())t&&t.dispose();this._images=null}_Str_1699(){return this._partList}_Str_1629(t){return this._images.get(this._Str_2219(t))||null}_Str_1924(t,e){const s=this._Str_2219(e),i=this._images.get(s);i&&i.dispose(),this._images.set(s,t)}_Str_2219(t){let e="";for(const s of this._partList)e+=s._Str_1206(t)+"/";return e}_Str_587(t){}}class wt{constructor(t,e,s,i,r,n=null){this._texture=t,this._container=n,this._rect=e,this._regPoint=s,this._flipH=i,this._color=r,i&&(this._regPoint.x=-this._regPoint.x+e.width)}dispose(){this._texture=null,this._regPoint=null,this._color=null}get texture(){return this._texture}get container(){return this._container}get rect(){return this._rect}get _Str_1076(){return this._regPoint}get flipH(){return this._flipH}get color(){return this._color}get _Str_1567(){return new A.k(-this._regPoint.x,-this._regPoint.y,this._rect.width,this._rect.height)}}let Ut=(()=>{class t{constructor(t,e,s,i){this._structure=t,this._avatar=e,this._assets=s,this._scale=i,this._cache=new Map,this._canvas=null,this._disposed=!1,this._unionImages=[],this._matrix=new A.i,this._serverRenderData=[]}dispose(){if(!this._disposed){if(this._structure=null,this._avatar=null,this._assets=null,this._canvas=null,this._disposed=!0,this._cache){for(const t of this._cache.values())t&&t.dispose();this._cache=null}if(this._unionImages){for(const t of this._unionImages)t&&t.dispose();this._unionImages=[]}}}_Str_1086(t=6e4){const e=um.instance.time;if(this._cache)for(const s of this._cache.values())s&&s._Str_2089(t,e)}_Str_741(t){if(this._cache)for(const e of this._cache.values())e&&e._Str_1565(t,0)}setDirection(t,e){const s=this._structure._Str_1695(t);if(s)for(const i of s){const t=this._Str_1050(i);t&&t.setDirection(e)}}_Str_1565(t,e){const s=this._structure._Str_2021(t,this._avatar);for(const i of s){const s=this._Str_1050(i);s&&s._Str_1565(t,e)}}_Str_2014(t){if(this._geometryType!==t){if(this._geometryType===Ct.SITTING&&t===Ct.VERTICAL||this._geometryType===Ct.VERTICAL&&t===Ct.SITTING||this._geometryType===Ct.SNOWWARS_HORIZONTAL&&(t=Ct.SNOWWARS_HORIZONTAL))return this._geometryType=t,void(this._canvas=null);this._Str_1086(0),this._geometryType=t,this._canvas=null}}_Str_1629(t,e,s=!1){let i=this._Str_1050(t);i||(i=new Mt,this._cache.set(t,i));let r=i.getDirection(),n=i._Str_2244(),a=e;n._Str_742._Str_812&&(a-=n._Str_664);let o=n,c=[],_=new Map;const h=new A.j;if(n&&n._Str_742&&n._Str_742._Str_861){let s=r;const i=this._structure._Str_720(n._Str_742.state+"."+n._Str_727),l=e-n._Str_664;if(i){const e=i._Str_607(l,t,n._Str_707);e&&(s=r+e.dd,e.dd<0?s<0?s=8+s:s>7&&(s=8-s):s<0?s+=8:s>7&&(s-=8),this._scale===yt.LARGE?(h.x=e.dx,h.y=e.dy):(h.x=e.dx/2,h.y=e.dy/2),a=e._Str_891,e.action&&(n=e.action),e.type===vt.BODYPART?(null!=e.action&&(o=e.action),r=s):e.type===vt.FX&&(r=s),_=e.items),c=i._Str_652}}let l=i._Str_1961(o);l&&!s||(l=new Dt,i._Str_1765(o,l));let u=l._Str_2070(r);if(!u||s){const e=this._structure._Str_713(t,this._avatar.getFigure(),o,this._geometryType,r,c,this._avatar,_);u=new Nt(e),l._Str_2168(r,u)}let d=u._Str_1629(a);if(!d||s){const t=u._Str_1699();if(d=this._Str_1834(r,t,a,n,s),!d||s)return null;d._Str_1807&&u._Str_1924(d,a)}const g=this._structure._Str_1888(o,r,a,t);return h.x+=g.x,h.y+=g.y,d.offset=h,d}_Str_1009(){return this._serverRenderData=[],this._serverRenderData}_Str_1050(t){let e=this._cache.get(t);return e||(e=new Mt,this._cache.set(t,e)),e}_Str_1834(t,e,s,i,r=!1){if(!e||!e.length)return null;if(!this._canvas&&(this._canvas=this._structure._Str_1664(this._scale,this._geometryType),!this._canvas))return null;const n=Ot.DIRECTION_IS_FLIPPED[t]||!1;let a=i._Str_742._Str_778,o=!0,c=e.length-1;for(;c>=0;){const i=e[c];let _=16777215;if((7!=t||"fc"!==i._Str_1669&&"ey"!==i._Str_1669)&&("ri"!==i._Str_1669||i._Str_1502)){const e=i._Str_1502,c=i._Str_2258(s);let h=i._Str_1669,l=0;c?(l=c.number,c._Str_778&&""!==c._Str_778&&(a=c._Str_778)):l=i._Str_1674(s);let u=t,d=!1;n&&("wav"===a&&(h===At.LEFT_HAND||h===At.LEFT_SLEEVE||h===At.LEFT_COAT_SLEEVE)||"drk"===a&&(h===At.RIGHT_HAND||h===At.RIGHT_SLEEVE||h===At.RIGHT_COAT_SLEEVE)||"blw"===a&&h===At.RIGHT_HAND||"sig"===a&&h===At.LEFT_HAND||"respect"===a&&h===At.LEFT_HAND||h===At.RIGHT_HAND_ITEM||h===At.LEFT_HAND_ITEM||h===At.CHEST_PRINT?d=!0:(4===t?u=2:5===t?u=1:6===t&&(u=0),i._Str_1666!==h&&(h=i._Str_1666)));let g=this._scale+"_"+a+"_"+h+"_"+e+"_"+u+"_"+l,m=this._assets.getAsset(g);if(m||(g=this._scale+"_std_"+h+"_"+e+"_"+u+"_0",m=this._assets.getAsset(g)),m){const t=m.texture;if(t&&t.valid&&t.baseTexture){i.isColorable&&i.color&&(_=i.color._Str_915);const e=new A.j(-m.x,-m.y);if(d&&(e.x=e.x+(this._scale===yt.LARGE?65:31)),r){const s=new It;s.name=this._assets._Str_2125(g),s.x=-e.x-33,s.y=-e.y,s.z=-1e-4*this._serverRenderData.length,s.width=m.rectangle.width,s.height=m.rectangle.height,s.flipH=d,"lay"===a&&(s.x=s.x+53),n&&(s.flipH=!s.flipH,s.x=s.flipH?-s.x-t.width:s.x+65),i.isColorable&&(s.color=""+_),this._serverRenderData.push(s)}this._unionImages.push(new wt(t,m.rectangle,e,d,_))}else o=!1}}c--}if(!this._unionImages.length)return null;const _=this._Str_1236(this._unionImages,n),h=new A.j(-_._Str_1076.x,(this._scale===yt.LARGE?this._canvas.height-16:this._canvas.height-8)-_._Str_1076.y);n&&"lay"!==a&&(h.x=h.x+(this._scale===yt.LARGE?67:31));let l=this._unionImages.length-1;for(;l>=0;){const t=this._unionImages.pop();t&&t.dispose(),l--}return new Tt(_.container,h,o)}_Str_1652(t){let e=(255*t).toString(16);return e.length<2&&(e="0"+e),e}_Str_1236(t,e){const s=new A.k;for(const a of t)a&&s.enlarge(a._Str_1567);const i=new A.j(-s.x,-s.y),r=new A.d,n=new A.n(A.p.EMPTY);n.width=s.width,n.height=s.height,r.addChild(n);for(const a of t){if(!a)continue;const t=a.texture,s=a.color,n=!(e&&a.flipH)&&(e||a.flipH),o=i.clone();o.x-=a._Str_1076.x,o.y-=a._Str_1076.y,e&&(o.x=r.width-(o.x+a.rect.width)),n?(this._matrix.a=-1,this._matrix.tx=a.rect.x+a.rect.width+o.x,this._matrix.ty=o.y-a.rect.y):(this._matrix.a=1,this._matrix.tx=o.x-a.rect.x,this._matrix.ty=o.y-a.rect.y);const c=new A.n(t);c.tint=s,c.transform.setFromMatrix(this._matrix),r.addChild(c)}return new wt(null,r.getLocalBounds(),i,e,null,r)}}return t._Str_2189=6e4,t})(),Lt=(()=>{class t{static getExpressionTimeout(t){switch(t=parseInt(t)){case 1:return 5e3;case 2:return 1400;case 3:case 4:return 2e3;case 5:return 0;case 6:return 700;case 7:return 2e3;case 8:case 9:case 10:return 1500;default:return 0}}static getExpressionId(e){return t.EXPRESSION_MAP.indexOf(e)}static getExpression(e){return e>t.EXPRESSION_MAP.length?null:t.EXPRESSION_MAP[e]}static getGestureId(e){return t.GESTURE_MAP.indexOf(e)}static getGesture(e){return e>t.GESTURE_MAP.length?null:t.GESTURE_MAP[e]}static idToAvatarActionState(t){return"Lay"===t?"lay":"Float"===t?"float":"Swim"===t?"swim":"Sit"===t?"sit":"Respect"===t?"respect":"Wave"===t?"wave":"Idle"===t?"idle":"Dance"===t?"dance":"UseItem"===t?"usei":"CarryItem"===t?"cri":"Talk"===t?"talk":"Sleep"===t?"Sleep":"Move"===t?"mv":"std"}}return t.CARRY_OBJECT="cri",t.DANCE="dance",t.EFFECT="fx",t.EXPRESSION="expression",t.EXPRESSION_BLOW_A_KISS="blow",t.EXPRESSION_CRY="cry",t.EXPRESSION_IDLE="idle",t.EXPRESSION_LAUGH="laugh",t.EXPRESSION_RESPECT="respect",t.EXPRESSION_RIDE_JUMP="ridejump",t.EXPRESSION_SNOWBOARD_OLLIE="sbollie",t.EXPRESSION_SNOWBORD_360="sb360",t.EXPRESSION_WAVE="wave",t.GESTURE="gest",t.GESTURE_AGGRAVATED="agr",t.GESTURE_SAD="sad",t.GESTURE_SMILE="sml",t.GESTURE_SURPRISED="srp",t.GUIDE_STATUS="guide",t.MUTED="muted",t.PET_GESTURE_BLINK="eyb",t.PET_GESTURE_CRAZY="crz",t.PET_GESTURE_JOY="joy",t.PET_GESTURE_MISERABLE="mis",t.PET_GESTURE_PUZZLED="puz",t.PET_GESTURE_TONGUE="tng",t.PLAYING_GAME="playing_game",t.POSTURE="posture",t.POSTURE_FLOAT="float",t.POSTURE_LAY="lay",t.POSTURE_SIT="sit",t.POSTURE_STAND="std",t.POSTURE_SWIM="swim",t.POSTURE_WALK="mv",t.SIGN="sign",t.SLEEP="sleep",t.SNOWWAR_DIE_BACK="swdieback",t.SNOWWAR_DIE_FRONT="swdiefront",t.SNOWWAR_PICK="swpick",t.SNOWWAR_RUN="swrun",t.SNOWWAR_THROW="swthrow",t.TALK="talk",t.BLINK="blink",t.TYPING="typing",t.USE_OBJECT="usei",t.VOTE="vote",t.GESTURE_MAP=["",t.GESTURE_SMILE,t.GESTURE_AGGRAVATED,t.GESTURE_SURPRISED,t.GESTURE_SAD,t.PET_GESTURE_JOY,t.PET_GESTURE_CRAZY,t.PET_GESTURE_TONGUE,t.PET_GESTURE_BLINK,t.PET_GESTURE_MISERABLE,t.PET_GESTURE_PUZZLED],t.EXPRESSION_MAP=["",t.EXPRESSION_WAVE,t.EXPRESSION_BLOW_A_KISS,t.EXPRESSION_LAUGH,t.EXPRESSION_CRY,t.EXPRESSION_IDLE,t.DANCE,t.EXPRESSION_RESPECT,t.EXPRESSION_SNOWBOARD_OLLIE,t.EXPRESSION_SNOWBORD_360,t.EXPRESSION_RIDE_JUMP],t})(),Pt=(()=>{class t{}return t.FULL="full",t.HEAD="head",t.BODY="body",t})(),xt=(()=>{class t{constructor(e,s,i,r,n,a=null){this._frameCounter=0,this._directionOffset=0,this._isAnimating=!1,this._animationHasResetOnToggle=!1,this._actionsSorted=!1,this._fullImageCacheSize=5,this._isCachedImage=!1,this._useFullImageCache=!1,this._effectIdInUse=-1,this._cachedBodyPartsDirection=-1,this._cachedBodyPartsGeometryType=null,this._cachedBodyPartsAvatarSet=null,this._canvasOffsets=[],this._actions=[],this._cachedBodyParts=[],this._changes=!0,this._disposed=!1,this._effectManager=n,this._structure=e,this._assets=s,this._scale=r,this._effectListener=a,null==this._scale&&(this._scale=yt.LARGE),null==i&&(i=new St("hr-893-45.hd-180-2.ch-210-66.lg-270-82.sh-300-91.wa-2007-.ri-1-")),this._figure=i,this._cache=new Ut(this._structure,this,this._assets,this._scale),this.setDirection(t.DEFAULT_AVATAR_SET,t.DEFAULT_DIRECTION),this._actions=[],this._defaultAction=new Rt(Lt.POSTURE_STAND),this._defaultAction._Str_742=this._structure._Str_1675(t.DEFAULT_ACTION),this.resetActions(),this._fullImageCache=new X,this._animationFrameCount=0}getServerRenderData(){return this.getAvatarPartsForCamera(Pt.FULL),this._cache._Str_1009()}dispose(){if(!this._disposed){if(this._structure=null,this._assets=null,this._mainAction=null,this._figure=null,this._avatarSpriteData=null,this._actions=null,this._image&&(this._image.destroy(),this._image=null),this._cache&&(this._cache.dispose(),this._cache=null),this._fullImageCache){for(const t of this._fullImageCache.getValues())t&&t.destroy();this._fullImageCache=null}this._image=null,this._canvasOffsets=null,this._disposed=!0}}get disposed(){return this._disposed}getFigure(){return this._figure}getScale(){return this._scale}getPartColor(t){return this._structure._Str_867(this._figure,t)}setDirection(t,e){(e+=this._directionOffset)<Ot.MIN_DIRECTION&&(e=Ot.MAX_DIRECTION+(e+1)),e>Ot.MAX_DIRECTION&&(e-=Ot.MAX_DIRECTION+1),this._structure._Str_1939(t)&&(this._mainDirection=e),t!==Pt.HEAD&&t!==Pt.FULL||(t===Pt.HEAD&&this.isHeadTurnPreventedByAction()&&(e=this._mainDirection),this._headDirection=e),this._cache.setDirection(t,e),this._changes=!0}setDirectionAngle(t,e){this.setDirection(t,Math.floor(e/45))}getSprites(){return this._sprites}getCanvasOffsets(){return this._canvasOffsets}getLayerData(t){return this._structure._Str_1881(t.animation.id,this._frameCounter,t.id)}updateAnimationByFrames(t=1){this._frameCounter+=t,this._changes=!0}resetAnimationFrameCounter(){this._frameCounter=0,this._changes=!0}getFullImageCacheKey(){if(!this._useFullImageCache)return null;if(1==this._sortedActions.length&&this._mainDirection==this._headDirection)return this._mainDirection+this._currentActionsString+this._frameCounter%4;if(2==this._sortedActions.length)for(const t of this._sortedActions){if("fx"==t._Str_695&&("33"==t._Str_727||"34"==t._Str_727||"35"==t._Str_727||"36"==t._Str_727))return this._mainDirection+this._currentActionsString+0;if("fx"==t._Str_695&&("38"==t._Str_727||"39"==t._Str_727))return this._mainDirection+"_"+this._headDirection+this._currentActionsString+this._frameCounter%11;if("dance"===t._Str_695&&("1"===t._Str_727||"2"===t._Str_727||"3"===t._Str_727||"4"===t._Str_727)){let e=this._frameCounter%8;return"3"===t._Str_727&&(e=this._frameCounter%10),"4"===t._Str_727&&(e=this._frameCounter%16),this._mainDirection+t._Str_695+t._Str_727+e}}return null}getBodyParts(t,e,s){return s==this._cachedBodyPartsDirection&&e==this._cachedBodyPartsGeometryType&&t==this._cachedBodyPartsAvatarSet||(this._cachedBodyPartsDirection=s,this._cachedBodyPartsGeometryType=e,this._cachedBodyPartsAvatarSet=t,this._cachedBodyParts=this._structure._Str_755(t,e,s)),this._cachedBodyParts}getAvatarPartsForCamera(t){let e;if(null==this._mainAction)return;if(null==this._structure._Str_1664(this._scale,this._mainAction._Str_742._Str_868))return;const s=this.getBodyParts(t,this._mainAction._Str_742._Str_868,this._mainDirection);let i=s.length-1;for(;i>=0;)e=s[i],this._cache._Str_1629(e,this._frameCounter,!0),i--}getImage(t,e,s=1,i=!0){if(!this._changes)return this._image;if(!this._mainAction)return null;this._actionsSorted||this.endActionAppends();const r=this._structure._Str_1664(this._scale,this._mainAction._Str_742._Str_868);if(!r)return null;!this._image||this._image.width===r.width&&this._image.height===r.height||(this._reusableTexture&&(this._reusableTexture.destroy(!0),this._reusableTexture=null),this._image=null,this._isCachedImage=!1);const n=this.getBodyParts(t,this._mainAction._Str_742._Str_868,this._mainDirection);this._image=null;const a=new A.d;let o=!0,c=n.length-1;for(;c>=0;){const t=this._cache._Str_1629(n[c],this._frameCounter);if(t){const e=t.image;if(!e)return a.destroy({children:!0}),null;o=o&&t._Str_1807;const s=t._Str_1076.clone();if(s){s.x+=r.offset.x,s.y+=r.offset.y,s.x+=r._Str_1076.x,s.y+=r._Str_1076.y;const t=new A.d;t.addChild(e),t&&(t.position.set(s.x,s.y),a.addChild(t))}}c--}return this._avatarSpriteData&&this._avatarSpriteData._Str_832&&this.convertToGrayscale(a),i?(this._reusableTexture?um.instance.renderer.render(a,this._reusableTexture,!0):this._reusableTexture=bt.generateTexture(a,new A.k(0,0,r.width,r.height)),this._reusableTexture?(this._image=this._reusableTexture,this._changes=!1,this._image):null):bt.generateTexture(a,new A.k(0,0,r.width,r.height))}getImageAsSprite(t,e=1){if(!this._mainAction)return null;this._actionsSorted||this.endActionAppends();const s=this._structure._Str_1664(this._scale,this._mainAction._Str_742._Str_868);if(!s)return null;const i=this.getBodyParts(t,this._mainAction._Str_742._Str_868,this._mainDirection),r=new A.n,n=new A.n(A.p.EMPTY);n.width=s.width,n.height=s.height,r.addChild(n);let a=i.length-1;for(;a>=0;){const t=this._cache._Str_1629(i[a],this._frameCounter);if(t){const e=t.image;if(!e)return r.destroy({children:!0}),null;const i=t._Str_1076.clone();if(i){i.x+=s.offset.x,i.y+=s.offset.y,i.x+=s._Str_1076.x,i.y+=s._Str_1076.y;const t=new A.d;t.addChild(e),t.position.set(i.x,i.y),r.addChild(t)}}a--}return r}getCroppedImage(t,e=1){if(!this._mainAction)return null;this._actionsSorted||this.endActionAppends();const s=this._structure._Str_1664(this._scale,this._mainAction._Str_742._Str_868);if(!s)return null;const i=this.getBodyParts(t,this._mainAction._Str_742._Str_868,this._mainDirection),r=new A.d,n=new A.n(A.p.EMPTY);n.width=s.width,n.height=s.height,r.addChild(n);let a=i.length-1;for(;a>=0;){const t=this._cache._Str_1629(i[a],this._frameCounter);if(t){const e=t.image;if(!e)return r.destroy({children:!0}),null;const i=t._Str_1076.clone();if(i){i.x+=s.offset.x,i.y+=s.offset.y,i.x+=s._Str_1076.x,i.y+=s._Str_1076.y;const t=new A.d;t.addChild(e),t&&(t.position.set(i.x,i.y),r.addChild(t))}}a--}return um.instance.renderer.extract.image(r)||null}getFullImage(t){const e=this._fullImageCache.getValue(t);return e?(e.valid||(this._fullImageCache.remove(t),e.destroy(!0)),e):null}cacheFullImage(t,e){const s=this._fullImageCache.getValue(t);if(s&&(this._fullImageCache.remove(t),s.destroy(!0)),this._fullImageCache.length===this._fullImageCacheSize){const t=this._fullImageCache.getKey(0);t&&this._fullImageCache.remove(t).destroy(!0)}this._fullImageCache.add(t,e)}getAsset(t){return this._assets.getAsset(t)}getDirection(){return this._mainDirection}initActionAppends(){this._actions=[],this._actionsSorted=!1,this._currentActionsString="",this._useFullImageCache=!1}endActionAppends(){if(this.sortActions()){for(const t of this._sortedActions)t._Str_695===Lt.EFFECT&&(this._effectManager.isAvatarEffectReady(parseInt(t._Str_727))||this._effectManager.downloadAvatarEffect(parseInt(t._Str_727),this));this.resetActions(),this.setActionsToParts()}}appendAction(t,...e){let s="";switch(this._actionsSorted=!1,e&&e.length>0&&(s=e[0]),null!=s&&(s=s.toString()),t){case Lt.POSTURE:switch(s){case Lt.POSTURE_LAY:this.setDirection(Pt.FULL,0==this._mainDirection?4:2);case Lt.POSTURE_WALK:case Lt.POSTURE_STAND:this._useFullImageCache=!0,this._useFullImageCache=!0;case Lt.POSTURE_SWIM:case Lt.POSTURE_FLOAT:case Lt.POSTURE_SIT:case Lt.SNOWWAR_RUN:case Lt.SNOWWAR_DIE_FRONT:case Lt.SNOWWAR_DIE_BACK:case Lt.SNOWWAR_PICK:case Lt.SNOWWAR_THROW:this.addActionData(s)}break;case Lt.GESTURE:switch(s){case Lt.GESTURE_AGGRAVATED:case Lt.GESTURE_SAD:case Lt.GESTURE_SMILE:case Lt.GESTURE_SURPRISED:this.addActionData(s)}break;case Lt.EFFECT:"33"!==s&&"34"!==s&&"35"!==s&&"36"!==s&&"38"!==s&&"39"!==s||(this._useFullImageCache=!0);case Lt.DANCE:case Lt.TALK:case Lt.EXPRESSION_WAVE:case Lt.SLEEP:case Lt.SIGN:case Lt.EXPRESSION_RESPECT:case Lt.EXPRESSION_BLOW_A_KISS:case Lt.EXPRESSION_LAUGH:case Lt.EXPRESSION_CRY:case Lt.EXPRESSION_IDLE:case Lt.EXPRESSION_SNOWBOARD_OLLIE:case Lt.EXPRESSION_SNOWBORD_360:case Lt.EXPRESSION_RIDE_JUMP:this.addActionData(t,s);break;case Lt.CARRY_OBJECT:case Lt.USE_OBJECT:{const e=this._structure._Str_2018(t);e&&(s=e._Str_1350(s)),this.addActionData(t,s);break}}return!0}addActionData(t,e=""){let s;this._actions||(this._actions=[]);let i=0;for(;i<this._actions.length;){if(s=this._actions[i],s._Str_695==t&&s._Str_727==e)return;i++}this._actions.push(new Rt(t,e,this._frameCounter))}isAnimating(){return this._isAnimating||this._animationFrameCount>1}resetActions(){return this._animationHasResetOnToggle=!1,this._isAnimating=!1,this._sprites=[],this._avatarSpriteData=null,this._directionOffset=0,this._structure._Str_2101(this),this._mainAction=this._defaultAction,this._mainAction._Str_742=this._defaultAction._Str_742,this.resetBodyPartCache(this._defaultAction),!0}isHeadTurnPreventedByAction(){let t,e;if(null==this._sortedActions)return!1;for(const s of this._sortedActions)t=this._structure._Str_2018(s._Str_695),null!=t&&t._Str_715(s._Str_727)&&(e=!0);return e}sortActions(){let t,e,s;if(this._currentActionsString="",this._sortedActions=this._structure._Str_711(this._actions),this._animationFrameCount=this._structure._Str_1936(this._sortedActions),this._sortedActions){this._canvasOffsets=this._structure._Str_781(this._sortedActions,this._scale,this._mainDirection);for(const s of this._sortedActions)if(this._currentActionsString=this._currentActionsString+(s._Str_695+s._Str_727),s._Str_695===Lt.EFFECT){const i=parseInt(s._Str_727);this._effectIdInUse!==i&&(t=!0),this._effectIdInUse=i,e=!0}e||(this._effectIdInUse>-1&&(t=!0),this._effectIdInUse=-1),t&&this._cache._Str_1086(0),this._lastActionsString!=this._currentActionsString&&(s=!0,this._lastActionsString=this._currentActionsString)}else this._canvasOffsets=[0,0,0],""!==this._lastActionsString&&(s=!0,this._lastActionsString="");return this._actionsSorted=!0,s}setActionsToParts(){if(null==!this._sortedActions)return;const t=um.instance.time,e=[];for(const s of this._sortedActions)e.push(s._Str_695);for(const s of this._sortedActions)if(s&&s._Str_742&&s._Str_742._Str_861){const t=this._structure._Str_720(s._Str_742.state+"."+s._Str_727);if(t&&t._Str_1892()){const i=t._Str_1571();if(i)for(const r of i)e.indexOf(r)>=0&&(s._Str_707=t._Str_707(r))}t&&t.resetOnToggle&&(this._animationHasResetOnToggle=!0)}for(const s of this._sortedActions)if(s&&s._Str_742&&(s._Str_742._Str_861&&""===s._Str_727&&(s._Str_727="1"),this.setActionToParts(s,t),s._Str_742._Str_861)){this._isAnimating=s._Str_742._Str_801(s._Str_727);const t=this._structure._Str_720(s._Str_742.state+"."+s._Str_727);t&&(this._sprites=this._sprites.concat(t._Str_786),t._Str_776()&&(this._directionOffset=t._Str_1493.offset),t._Str_872()&&(this._avatarSpriteData=t._Str_1475))}}setActionToParts(t,e){null!=t&&null!=t._Str_742&&""!=t._Str_742._Str_778&&(t._Str_742._Str_779&&(this._mainAction=t,this._cache._Str_2014(t._Str_742._Str_868)),this._cache._Str_1565(t,e),this._changes=!0)}resetBodyPartCache(t){t&&""!==t._Str_742._Str_778&&(t._Str_742._Str_779&&(this._mainAction=t,this._cache._Str_2014(t._Str_742._Str_868)),this._cache._Str_741(t),this._changes=!0)}get avatarSpriteData(){return this._avatarSpriteData}convertToGrayscale(e,s="CHANNELS_EQUAL"){let i=.33,r=.33,n=.33;switch(s){case t.CHANNELS_UNIQUE:i=.3,r=.59,n=.11;break;case t.CHANNELS_RED:i=1,r=0,n=0;break;case t.CHANNELS_GREEN:i=0,r=1,n=0;break;case t.CHANNELS_BLUE:i=0,r=0,n=1;break;case t.CHANNELS_DESATURATED:i=.3086,r=.6094,n=.082}const a=new A.r.ColorMatrixFilter;return a.matrix=[i,r,n,0,0,i,r,n,0,0,i,r,n,0,0,0,0,0,1,0],e.filters=[a],e}errorThis(t){}logThis(t){}isPlaceholder(){return!1}forceActionUpdate(){this._lastActionsString=""}get animationHasResetOnToggle(){return this._animationHasResetOnToggle}get mainAction(){return this._mainAction._Str_695}resetEffect(t){t===this._effectIdInUse&&(this.resetActions(),this.setActionsToParts(),this._animationHasResetOnToggle=!0,this._changes=!0,this._effectListener&&this._effectListener.resetEffect(t))}}return t.CHANNELS_EQUAL="CHANNELS_EQUAL",t.CHANNELS_UNIQUE="CHANNELS_UNIQUE",t.CHANNELS_RED="CHANNELS_RED",t.CHANNELS_GREEN="CHANNELS_GREEN",t.CHANNELS_BLUE="CHANNELS_BLUE",t.CHANNELS_DESATURATED="CHANNELS_DESATURATED",t.DEFAULT_ACTION="Default",t.DEFAULT_DIRECTION=2,t.DEFAULT_AVATAR_SET=Pt.FULL,t})();class Ft{constructor(t){this._id=parseInt(t.id),this._value=parseInt(t.id),this._prevents=t.prevents||[],this._preventHeadTurn=t.preventHeadTurn||!1,this._isAnimated=!0,void 0!==t.animated&&!1===t.animated&&(this._isAnimated=!1)}get id(){return this._id}get value(){return this._value}get prevents(){return this._prevents}get _Str_1891(){return this._preventHeadTurn}get _Str_801(){return this._isAnimated}}class Gt{constructor(t){if(this._id=t.id,this._state=t.state,this._precedence=t.precedence,this._activePartSet=t.activePartSet,this._assetPartDefinition=t.assetPartDefinition,this._lay=t.lay,this._geometryType=t.geometryType,this._isMain=t.main||!1,this._isDefault=t.isDefault||!1,this._isAnimation=t.animation||!1,this._startFromFrameZero=t.startFromFrameZero||!1,this._prevents=t.prevents||[],this._preventHeadTurn=t.preventHeadTurn||!1,this._types=new Map,this._params=new Map,this._defaultParameterValue="",this._canvasOffsets=null,t.params&&t.params.length>0)for(const e of t.params)e&&("default"===e.id?this._defaultParameterValue=e.value:this._params.set(e.id,e.value));if(t.types&&t.types.length>0)for(const e of t.types){if(!e)continue;const t=new Ft(e);this._types.set(t.id,t)}}_Str_772(t,e,s){this._canvasOffsets||(this._canvasOffsets=new Map);let i=this._canvasOffsets.get(t);i||(i=new Map,this._canvasOffsets.set(t,i)),i.set(e,s)}_Str_805(t,e){if(!this._canvasOffsets)return null;const s=this._canvasOffsets.get(t);return s?s.get(e):null}getType(t){return t&&this._types.get(parseInt(t))||null}_Str_1350(t){return t?this._params.get(t)||this._defaultParameterValue:""}_Str_733(t){return this._prevents.concat(this._Str_1889(t))}_Str_1889(t){if(!t)return[];const e=this._types.get(parseInt(t));return e?e.prevents:[]}_Str_715(t){if(!t)return this._preventHeadTurn;const e=this.getType(t);return e?e._Str_1891:this._preventHeadTurn}_Str_801(t){if(!t)return!0;const e=this.getType(t);return!e||e._Str_801}get id(){return this._id}get state(){return this._state}get precedence(){return this._precedence}get activePartSet(){return this._activePartSet}get _Str_778(){return this._assetPartDefinition}get lay(){return this._lay}get _Str_868(){return this._geometryType}get _Str_779(){return this._isMain}get _Str_804(){return this._isDefault}get _Str_861(){return this._isAnimation}get _Str_812(){return this._startFromFrameZero}get prevents(){return this._prevents}get preventHeadTurn(){return this._preventHeadTurn}get params(){return this._params}}class Vt{constructor(t,e){this._assets=t,this._actions=new Map,this._defaultAction=null,this._Str_1620(e)}_Str_1620(t){if(t){for(const e of t.actions){if(!e||!e.state)continue;const t=new Gt(e);this._actions.set(t.state,t)}t.actionOffsets&&this._Str_1767(t.actionOffsets)}}_Str_1767(t){if(t&&t.length)for(const e of t){const t=this._actions.get(e.action);if(t)for(const s of e.offsets){const e=s.size||"",i=s.direction;""!==e&&void 0!==i&&t._Str_772(e,i,[s.x||0,s.y||0,s.z||0])}}}_Str_1675(t){if(!t)return null;for(const e of this._actions.values())if(e&&e.id===t)return e;return null}_Str_2018(t){return this._actions.get(t)||null}_Str_1027(){if(this._defaultAction)return this._defaultAction;for(const t of this._actions.values())if(t&&t._Str_804)return this._defaultAction=t,t;return null}_Str_781(t,e,s){let i=[];for(const r of t){if(!r)continue;const t=this._actions.get(r._Str_695),n=t&&t._Str_805(e,s);n&&(i=n)}return i}_Str_711(t){if(!t)return null;t=this._Str_1247(t);const e=[];for(const s of t){if(!s)continue;const t=this._actions.get(s._Str_695);t&&(s._Str_742=t,e.push(s))}return e.sort(this.sortByPrecedence),e}_Str_1247(t){let e=[];const s=[];for(const i of t){if(!i)continue;const t=this._actions.get(i._Str_695);t&&(e=e.concat(t._Str_733(i._Str_727)))}for(const i of t){if(!i)continue;let t=i._Str_695;"fx"===i._Str_695&&(t=t+"."+i._Str_727),e.indexOf(t)>=0||s.push(i)}return s}sortByPrecedence(t,e){if(!t||!e)return 0;const s=t._Str_742.precedence,i=e._Str_742.precedence;return s<i?1:s>i?-1:0}}class Yt{constructor(t){this._id=t.id||"",this._align=t.align||"",this._base=t.base||"",this._ink=t.ink||0,this._blend=0;const e=t.blend;e&&e.length>0&&(this._blend=parseInt(e),this._blend>1&&(this._blend=this._blend/100))}get id(){return this._id}get align(){return this._align}get base(){return this._base}get ink(){return this._ink}get blend(){return this._blend}get _Str_1096(){return 1!==this._blend}}class kt{constructor(t){this._ink=parseInt(t.ink);let e=t.foreground,s=t.background;e=e.replace("#",""),s=s.replace("#",""),this._foreGround=parseInt(e,16),this._backGround=parseInt(s,16),this._colorTransform=null,this._rgb=parseInt(e,16),this._r=this._rgb>>16&255,this._g=this._rgb>>8&255,this._b=this._rgb>>0&255,this._redMultiplier=this._r/255*1,this._greenMultiplier=this._g/255*1,this._blueMultiplier=this._b/255*1,this._alphaMultiplier=1,this._paletteIsGrayscale=!0,37===this._ink&&(this._alphaMultiplier=.5,this._paletteIsGrayscale=!1),this._colorMap=this._Str_1181(this._backGround,this._foreGround)}get ink(){return this._ink}get colorTransform(){return this._colorTransform}get reds(){return this._colorMap.get("reds")}get greens(){return this._colorMap.get("greens")}get blues(){return this._colorMap.get("blues")}get alphas(){return this._colorMap.get("alphas")}get _Str_832(){return this._paletteIsGrayscale}_Str_1181(t,e){const s=t>>24&255,i=t>>16&255,r=t>>8&255,n=t>>0&255,a=((e>>24&255)-s)/255,o=((e>>16&255)-i)/255,c=((e>>8&255)-r)/255,_=((e>>0&255)-n)/255,h=new Map,l=[],u=[],d=[],g=[];let m=s,p=i,E=r,f=n,S=0;for(;S<256;)p==i&&E==r&&f==n&&(m=0),m+=a,p+=o,E+=c,f+=_,g.push(m<<24),l.push(m<<24|p<<16|E<<8|f),u.push(m<<24|p<<16|E<<8|f),d.push(m<<24|p<<16|E<<8|f),S++;return h.set("alphas",l),h.set("reds",l),h.set("greens",u),h.set("blues",d),h}}class jt{constructor(t){this._offset=parseInt(t.offset)}get offset(){return this._offset}}class Bt{constructor(t,e){this._animation=t,this._id=e.id,this._ink=e.ink,this._member=e.member,this._hasStaticY=!!e.staticY,this._hasDirections=!!e.directions,this._dx=[],this._dy=[],this._dz=[];const s=e.directionList;if(s&&s.length)for(const i of s){const t=i.id;void 0!==t&&(this._dx[t]=i.dx||0,this._dy[t]=i.dy||0,this._dz[t]=i.dz||0)}}_Str_809(t){return t<this._dx.length?this._dx[t]:0}_Str_739(t){return t<this._dy.length?this._dy[t]:0}_Str_839(t){return t<this._dz.length?this._dz[t]:0}get animation(){return this._animation}get id(){return this._id}get ink(){return this._ink}get member(){return this._member}get _Str_949(){return this._hasDirections}get _Str_767(){return this._hasStaticY}}let Ht=(()=>{class t{constructor(t,e){if(this._id=e.name,this._description=this._id,this._frames=[],this._spriteData=null,this._avatarData=null,this._directionData=null,this._removeData=null,this._addData=null,this._overriddenActions=null,this._overrideFrames=null,this._resetOnToggle=e.resetOnToggle||!1,e.sprites&&e.sprites.length){this._spriteData=[];for(const t of e.sprites)this._spriteData.push(new Bt(this,t))}if(e.avatars&&e.avatars.length&&(this._avatarData=new kt(e.avatars[0])),e.directions&&e.directions.length&&(this._directionData=new jt(e.directions[0])),e.removes&&e.removes.length){this._removeData=[];for(const t of e.removes)this._removeData.push(t.id)}if(e.adds&&e.adds.length){this._addData=[];for(const t of e.adds)this._addData.push(new Yt(t))}if(e.overrides&&e.overrides.length){this._overrideFrames=new Map,this._overriddenActions=new Map;for(const s of e.overrides){const e=s.name;this._overriddenActions.set(s.override,e);const i=[];this._Str_1031(i,s.frames,t),this._overrideFrames.set(e,i)}}this._Str_1031(this._frames,e.frames,t)}_Str_1031(t,e,s){if(e&&e.length)for(const i of e){let e=1;i.repeats&&i.repeats>1&&(e=i.repeats);let r=0;for(;r<e;){const e=[];if(i.bodyparts&&i.bodyparts.length)for(const t of i.bodyparts){const i=s._Str_1675(t.action),r=new vt(t,vt.BODYPART,i);e.push(r)}if(i.fxs&&i.fxs.length)for(const t of i.fxs){const i=s._Str_1675(t.action),r=new vt(t,vt.FX,i);e.push(r)}t.push(e),r++}}}_Str_2185(t=null){if(!t)return this._frames.length;if(this._overrideFrames){const e=this._overrideFrames.get(t);if(e)return e.length}return 0}_Str_1892(){return!!this._overriddenActions&&this._overriddenActions.size>0}_Str_1571(){if(!this._overriddenActions)return null;const t=[];for(const e of this._overriddenActions.keys())t.push(e);return t}_Str_707(t){return this._overriddenActions?this._overriddenActions.get(t):null}_Str_2259(t,e=null){t<0&&(t=0);let s=[];if(e){const i=this._overrideFrames.get(e);i&&i.length>0&&(s=i[t%i.length])}else this._frames.length>0&&(s=this._frames[t%this._frames.length]);return s}_Str_1065(t,e=null){const s=[];for(const i of this._Str_2259(t,e))if(i.type===vt.BODYPART)s.push(i.id);else if(i.type===vt.FX&&this._addData&&this._addData.length)for(const t of this._addData)t.id===i.id&&s.push(t.align);return s}_Str_607(t,e,s=null){for(const i of this._Str_2259(t,s)){if(i.id===e)return i;if(i.type===vt.FX&&this._addData&&this._addData.length)for(const t of this._addData)if(t.align===e&&t.id===i.id)return i}return null}_Str_872(){return null!==this._avatarData}_Str_776(){return null!==this._directionData}_Str_706(){return null!==this._addData}_Str_1550(t){if(this._addData)for(const e of this._addData)if(e.id===t)return e;return null}get id(){return this._id}get _Str_786(){return this._spriteData||t._Str_2211}get _Str_1475(){return this._avatarData}get _Str_1493(){return this._directionData}get _Str_652(){return this._removeData||t._Str_2211}get _Str_687(){return this._addData||t._Str_2211}toString(){return this._description}get resetOnToggle(){return this._resetOnToggle}}return t._Str_2211=[],t})();class Wt{constructor(){this._animations=new Map}_Str_2061(t,e){const s=e[Object.keys(e)[0]],i=new Ht(t,s);return this._animations.set(s.name,i),!0}_Str_720(t){return this._animations.get(t)||null}_Str_607(t,e,s){const i=this._Str_720(t);return i?i._Str_607(e,s):null}get animations(){return this._animations}}class Zt{constructor(t){this._number=t.number,this._assetPartDefinition=t.assetPartDefinition||null}get number(){return this._number}get _Str_778(){return this._assetPartDefinition}}class zt{constructor(t,e,s,i,r,n,a,o,c="",_=!1,h=1){this._bodyPartId=t,this._partType=e,this._partId=s,this._color=i,this._frames=r,this._action=n,this._isColorable=a,this._paletteMapId=o,this._flippedPartType=c,this._isBlendable=_,this._blendTransform=null,"ey"===this._partType&&(this._isColorable=!1)}_Str_1674(t){if(!this._frames||!this._frames.length)return 0;const e=t%this._frames.length;return this._frames[e]instanceof Zt?this._frames[e].number:e}_Str_2258(t){const e=t%this._frames.length;return this._frames&&this._frames.length>e&&this._frames[e]instanceof Zt?this._frames[e]:null}_Str_1206(t){const e=t%this._frames.length;if(this._frames&&this._frames.length>e&&this._frames[e]instanceof Zt){const t=this._frames[e];return this._Str_1502+":"+t._Str_778+":"+t.number}return this._Str_1502+":"+e}get _Str_1360(){return this._bodyPartId}get _Str_1669(){return this._partType}get _Str_1502(){return this._partId}get color(){return this._color}get action(){return this._action}get isColorable(){return this._isColorable}set isColorable(t){this._isColorable=t}get _Str_1406(){return this._paletteMapId}get _Str_1666(){return this._flippedPartType}get _Str_1184(){return this._isBlendable}toString(){return[this._bodyPartId,this._partType,this._partId].join(":")}}class Xt{constructor(t,e){this._id=t.id,this._width=t.width,this._height=t.height,this._offset=new A.j(t.dx,t.dy),this._regPoint=new A.j(e==yt.LARGE?(this._width-64)/2:(this._width-32)/2,0)}get width(){return this._width}get height(){return this._height}get offset(){return this._offset}get id(){return this._id}get _Str_1076(){return this._regPoint}}class Kt{constructor(t){if(this._id=t.id,this._isMain=t.main||!1,this._avatarSets=new Map,this._bodyParts=[],this._allBodyParts=[],t.avatarSets&&t.avatarSets.length>0)for(const s of t.avatarSets){if(!s)continue;const t=new Kt(s);this._avatarSets.set(t.id,t)}if(t.bodyParts&&t.bodyParts.length>0)for(const s of t.bodyParts)s&&this._bodyParts.push(s.id);let e=this._bodyParts.concat();for(const s of this._avatarSets.values())s&&(e=e.concat(s._Str_755()));this._allBodyParts=e}_Str_1498(t){if(t===this._id)return this;for(const e of this._avatarSets.values())if(e&&e._Str_1498(t))return e;return null}_Str_755(){return this._allBodyParts.concat()}get id(){return this._id}get _Str_779(){if(this._isMain)return!0;for(const t of this._avatarSets.values())if(t&&t._Str_779)return!0;return!1}}class qt{constructor(t=0,e=0,s=0){this._x=t,this._y=e,this._z=s}static _Str_2224(t,e){return t.x*e.x+t.y*e.y+t.z*e.z}static _Str_1645(t,e){const s=new qt;return s.x=t.y*e.z-t.z*e.y,s.y=t.z*e.x-t.x*e.z,s.z=t.x*e.y-t.y*e.x,s}static subtract(t,e){return new qt(t.x-e.x,t.y-e.y,t.z-e.z)}_Str_2224(t){return this._x*t.x+this._y*t.y+this._z*t.z}_Str_1645(t){const e=new qt;return e.x=this._y*t.z-this._z*t.y,e.y=this._z*t.x-this._x*t.z,e.z=this._x*t.y-this._y*t.x,e}subtract(t){this._x=this._x-t.x,this._y=this._y-t.y,this._z=this._z-t.z}add(t){this._x=this._x+t.x,this._y=this._y+t.y,this._z=this._z+t.z}normalize(){const t=1/this.length();this._x=this._x*t,this._y=this._y*t,this._z=this._z*t}length(){return Math.sqrt(this._x*this._x+this._y*this._y+this._z*this._z)}toString(){return"Vector3D: ("+this._x+","+this._y+","+this._z+")"}get x(){return this._x}set x(t){this._x=t}get y(){return this._y}set y(t){this._y=t}get z(){return this._z}set z(t){this._z=t}}class Jt{constructor(t,e,s){this._location=new qt(t,e,s),this._transformedLocation=new qt,this._needsTransformation=!1,0==t&&0==e&&0==s||(this._needsTransformation=!0)}get location(){return this._location}get _Str_1604(){return this._transformedLocation}_Str_1101(t){this._needsTransformation&&(this._transformedLocation=t._Str_2186(this._location))}}class Qt extends Jt{constructor(t,e=!1){super(parseFloat(t.x),parseFloat(t.y),parseFloat(t.z)),this._id=t.id,this._radius=parseFloat(t.radius),this._normal=new qt(parseFloat(t.nx),parseFloat(t.ny),parseFloat(t.nz)),this._isDoubleSided=t.double||!1,this._isDynamic=e}_Str_1522(t){const e=Math.abs(t.z-this._Str_1604.z-this._radius),s=Math.abs(t.z-this._Str_1604.z+this._radius);return Math.min(e,s)}get id(){return this._id}get normal(){return this._normal}get _Str_2207(){return this._isDoubleSided}toString(){return this._id+": "+this.location+" - "+this._Str_1604}get _Str_1457(){return this._isDynamic}}class $t extends Jt{constructor(t){if(super(parseFloat(t.x),parseFloat(t.y),parseFloat(t.z)),this._id=t.id,this._radius=parseFloat(t.radius),this._parts=new Map,this._dynamicParts=new Map,t.items&&t.items.length>0)for(const e of t.items){if(!e)continue;const t=new Qt(e);this._parts.set(t.id,t)}}_Str_1883(t){const e=this._dynamicParts.get(t),s=[];if(e)for(const i in e){const t=e[i];t&&s.push(t)}return s}_Str_1456(t){const e=[];for(const s of this._parts.values())s&&e.push(s.id);if(t){const s=this._dynamicParts.get(t);if(s)for(const t in s){const i=s[t];i&&e.push(i.id)}}return e}_Str_2004(t){return this._dynamicParts.delete(t),!0}_Str_2020(t,e){if(this._Str_2030(t.id,e))return!1;let s=this._dynamicParts.get(e);return s||(s={},this._dynamicParts.set(e,s)),s[t.id]=new Qt(t,!0),!0}_Str_2030(t,e){let s=this._parts.get(t)||null;return s||void 0===this._dynamicParts.get(e)||(s=this._dynamicParts.get(e)[t]||null),null!==s}_Str_713(t,e,s,i){const r=[];for(const o of this._parts.values())o&&(o._Str_1101(t),r.push([o._Str_1522(e),o]));const n=this._dynamicParts.get(i);if(n)for(const o in n){const s=n[o];s&&(s._Str_1101(t),r.push([s._Str_1522(e),s]))}r.sort((t,e)=>{const s=t[0],i=e[0];return s<i?-1:s>i?1:0});const a=[];for(const o of r)o&&a.push(o[1].id);return a}_Str_1522(t){const e=Math.abs(t.z-this._Str_1604.z-this._radius),s=Math.abs(t.z-this._Str_1604.z+this._radius);return Math.min(e,s)}get id(){return this._id}get radius(){return this._radius}}let te=(()=>{class t{constructor(t=0,e=0,s=0,i=0,r=0,n=0,a=0,o=0,c=0){this._data=[t,e,s,i,r,n,a,o,c]}static _Str_1869(e){const s=e*Math.PI/180,i=Math.cos(s),r=Math.sin(s);return new t(1,0,0,0,i,-r,0,r,i)}static _Str_1560(e){const s=e*Math.PI/180,i=Math.cos(s),r=Math.sin(s);return new t(i,0,r,0,1,0,-r,0,i)}static _Str_1368(e){const s=e*Math.PI/180,i=Math.cos(s),r=Math.sin(s);return new t(i,-r,0,r,i,0,0,0,1)}identity(){return this._data=[1,0,0,0,1,0,0,0,1],this}_Str_2186(t){return new qt(t.x*this._data[0]+t.y*this._data[3]+t.z*this._data[6],t.x*this._data[1]+t.y*this._data[4]+t.z*this._data[7],t.x*this._data[2]+t.y*this._data[5]+t.z*this._data[8])}_Str_1186(e){return new t(this._data[0]*e.data[0]+this._data[1]*e.data[3]+this._data[2]*e.data[6],this._data[0]*e.data[1]+this._data[1]*e.data[4]+this._data[2]*e.data[7],this._data[0]*e.data[2]+this._data[1]*e.data[5]+this._data[2]*e.data[8],this._data[3]*e.data[0]+this._data[4]*e.data[3]+this._data[5]*e.data[6],this._data[3]*e.data[1]+this._data[4]*e.data[4]+this._data[5]*e.data[7],this._data[3]*e.data[2]+this._data[4]*e.data[5]+this._data[5]*e.data[8],this._data[6]*e.data[0]+this._data[7]*e.data[3]+this._data[8]*e.data[6],this._data[6]*e.data[1]+this._data[7]*e.data[4]+this._data[8]*e.data[7],this._data[6]*e.data[2]+this._data[7]*e.data[5]+this._data[8]*e.data[8])}_Str_1157(t){let e=0;for(;e<this._data.length;)this._data[e]=this._data[e]*t,e++}_Str_1089(e){const s=e*Math.PI/180,i=Math.cos(s),r=Math.sin(s);return new t(1,0,0,0,i,-r,0,r,i)._Str_1186(this)}_Str_2123(e){const s=e*Math.PI/180,i=Math.cos(s),r=Math.sin(s);return new t(i,0,r,0,1,0,-r,0,i)._Str_1186(this)}_Str_2232(e){const s=e*Math.PI/180,i=Math.cos(s),r=Math.sin(s);return new t(i,-r,0,r,i,0,0,0,1)._Str_1186(this)}skew(){}_Str_1779(){return new t(this._data[0],this._data[3],this._data[6],this._data[1],this._data[4],this._data[7],this._data[2],this._data[5],this._data[8])}_Str_1451(t){return!1}get data(){return this._data}}return t.IDENTITY=new t(1,0,0,0,1,0,0,0,1),t.TOLERANS=1e-18,t})();class ee{constructor(t){this._camera=new qt(0,0,10),this._avatarSet=new Kt(t.avatarSets[0]),this._geometryTypes=new Map,this._itemIdToBodyPartMap=new Map,this._transformation=new te,this._canvases=new Map;const e=t.camera;if(e&&(this._camera.x=parseFloat(e.x),this._camera.y=parseFloat(e.y),this._camera.z=parseFloat(e.z)),t.canvases&&t.canvases.length>0)for(const s of t.canvases){if(!s)continue;const t=s.scale,e=new Map;if(s.geometries&&s.geometries.length>0)for(const i of s.geometries){if(!i)continue;const s=new Xt(i,t);e.set(s.id,s)}this._canvases.set(t,e)}if(t.types&&t.types.length>0)for(const s of t.types){if(!s)continue;const t=new Map,e=new Map;if(s.bodyParts&&s.bodyParts.length>0)for(const i of s.bodyParts){if(!i)continue;const s=new $t(i);t.set(s.id,s);for(const t of s._Str_1456(null))e.set(t,s)}this._geometryTypes.set(s.id,t),this._itemIdToBodyPartMap.set(s.id,e)}}_Str_2101(t){for(const e of this._geometryTypes.values())if(e)for(const s of e.values())s&&s._Str_2004(t)}_Str_1307(t){const e=this._avatarSet._Str_1498(t);return e?e._Str_755():[]}_Str_1939(t){const e=this._avatarSet._Str_1498(t);return!!e&&e._Str_779}_Str_1664(t,e){const s=this._canvases.get(t);return s&&s.get(e)||null}_Str_1342(t){return!!this._geometryTypes.get(t)}_Str_1332(t,e){if(this._Str_1342(t)){const s=this._geometryTypes.get(t);if(s&&s.get(e))return!0}return!1}_Str_2072(t){const e=this._Str_1280(t),s=[];if(e)for(const i of e.values())i&&s.push(i.id);return s}_Str_1280(t){return this._Str_1342(t)?this._geometryTypes.get(t):new Map}_Str_1919(t,e){return this._Str_1280(t).get(e)||null}_Str_1701(t,e,s){const i=this._itemIdToBodyPartMap.get(t);if(i){const r=i.get(e);if(r)return r;const n=this._Str_1280(t);if(n)for(const t of n.values())if(t&&t._Str_2030(e,s))return t}return null}_Str_1787(t,e){const s=this._Str_1307(e),i=[];for(const r of s){if(!r)continue;const e=t.get(r);e&&i.push(e)}return i}_Str_2250(t,e,s){if(!s)return[];const i=this._Str_1280(s),r=this._Str_1787(i,t),n=[],a=[];this._transformation=te._Str_1560(e);for(const o of r.values())o&&(o._Str_1101(this._transformation),n.push([o._Str_1522(this._camera),o]));n.sort((t,e)=>{const s=t[0],i=e[0];return s<i?-1:s>i?1:0});for(const o of n)o&&a.push(o[1].id);return a}_Str_713(t,e,s,i,r){if(this._Str_1332(t,e)){const n=this._Str_1280(t).get(e);return this._transformation=te._Str_1560(s),n._Str_713(this._transformation,this._camera,i,r)}return[]}}class se{constructor(t){if(this._frames=[],t.frames&&t.frames.length>0)for(const e of t.frames){if(!e)continue;this._frames.push(new Zt(e));let t=e.repeats||0;if(t>1)for(;--t>0;)this._frames.push(this._frames[this._frames.length-1])}}get frames(){return this._frames}}let ie=(()=>{class t{constructor(t){if(this._id=t.id,this._actionParts=new Map,this._bodyPartOffsets=new Map,this._frameCount=0,this._frameIndexes=[],t.parts&&t.parts.length>0)for(const e of t.parts){if(!e)continue;const t=new se(e);this._actionParts.set(e.setType,t),this._frameCount=Math.max(this._frameCount,t.frames.length)}if(t.offsets&&t.offsets.frames&&t.offsets.frames.length>0)for(const e of t.offsets.frames){if(!e)continue;const t=e.id;this._frameCount=Math.max(this._frameCount,t);const s=new Map;if(this._bodyPartOffsets.set(t,s),e.directions&&e.directions.length>0)for(const i of e.directions){if(!i)continue;const t=i.id,e=new Map;if(s.set(t,e),i.bodyParts&&i.bodyParts.length>0)for(const s of i.bodyParts){if(!s)continue;let t=0,i=0;void 0!==s.dx&&(t=s.dx),void 0!==s.dy&&(i=s.dy),e.set(s.id,new A.j(t,i))}}if(this._frameIndexes.push(t),void 0!==e.repeats){let s=e.repeats||0;if(s>1)for(;--s>0;)this._frameIndexes.push(t)}}}_Str_989(t){return t&&this._actionParts.get(t)||null}_Str_1888(e,s,i){const r=this._bodyPartOffsets.get(this._frameIndexes[s%this._frameIndexes.length]);if(!r)return t._Str_1934;const n=r.get(e);return n&&n.get(i)||t._Str_1934}get id(){return this._id}get _Str_806(){return this._actionParts}get _Str_2185(){return this._frameCount}}return t._Str_1934=new A.j(0,0),t})();class re{constructor(){this._actions=new Map}parse(t){if(t&&t.length>0)for(const e of t){if(!e)continue;const t=new ie(e);this._actions.set(t.id,t)}return!0}_Str_1017(t){for(const e of t.action)this._actions.set(e.id,new ie(e));return!0}_Str_2244(t){return this._actions.get(t.id)||null}_Str_1408(t){const e=this._Str_2244(t);return e?e._Str_2185:0}}class ne{constructor(t){if(!t)throw new Error("invalid_data");this._id=parseInt(t.$.id),this._index=parseInt(t.$.index),this._clubLevel=parseInt(t.$.club),this._isSelectable=1===parseInt(t.$.selectable),this._rgb=parseInt("0x"+t._,16)}get id(){return this._id}get index(){return this._index}get clubLevel(){return this._clubLevel}get isSelectable(){return this._isSelectable}get _Str_915(){return this._rgb}}class ae{constructor(t){if(!t)throw new Error("invalid_data");this._id=parseInt(t.$.id),this._colors=new Map,this._Str_2015(t)}_Str_2015(t){for(const e of t.color){const t=new ne(e);this._colors.set(e.$.id.toString(),t)}}_Str_751(t){return void 0===t||t<0?null:this._colors.get(t.toString())||null}get id(){return this._id}get colors(){return this._colors}}class oe{constructor(t){if(!t)throw new Error("invalid_data");this._id=parseInt(t.$.id),this._type=t.$.type,this._index=parseInt(t.$.index),this._colorLayerIndex=parseInt(t.$.colorindex);const e=t.$.palettemapid;this._paletteMapId=isNaN(e)?-1:parseInt(e);const s=t.$.palettemapid;this._breed=isNaN(s)?-1:parseInt(s)}dispose(){}get id(){return this._id}get type(){return this._type}get breed(){return this._breed}get index(){return this._index}get _Str_827(){return this._colorLayerIndex}get paletteMap(){return this._paletteMapId}}class ce{constructor(t,e){if(!t||!e)throw new Error("invalid_data");this._id=parseInt(e.$.id),this._type=t,this._gender=e.$.gender,this._clubLevel=parseInt(e.$.club),this._isColorable=1===parseInt(e.$.colorable),this._isSelectable=1===parseInt(e.$.selectable),this._parts=[],this._hiddenLayers=[],this._isPreSelectable=1===parseInt(e.$.preselectable),this._isSellable=1===parseInt(e.$.sellable);for(const s of e.part){const t=new oe(s),e=this.getPartIndex(t);-1!==e?this._parts.splice(e,0,t):this._parts.push(t)}if(e.hiddenlayers){const t=e.hiddenlayers[0];for(const e of t.layer)this._hiddenLayers.push(e.$.parttype)}}dispose(){for(const t of this._parts)t.dispose();this._parts=null,this._hiddenLayers=null}getPartIndex(t){const e=this._parts.length;if(!e)return-1;for(let s=0;s<e;s++){const e=this._parts[s];if(e&&!(e.type!==t.type||e.index>t.index))return s}return-1}_Str_989(t,e){for(const s of this._parts)if(s.type===t&&s.id===e)return s;return null}get id(){return this._id}get type(){return this._type}get gender(){return this._gender}get clubLevel(){return this._clubLevel}get isColorable(){return this._isColorable}get _Str_608(){return this._isSelectable}get _Str_806(){return this._parts}get _Str_790(){return this._hiddenLayers}get _Str_653(){return this._isPreSelectable}get _Str_651(){return this._isSellable}}class _e{constructor(t){if(!t)throw new Error("invalid_data");this._type=t.$.type,this._paletteId=parseInt(t.$.paletteid),this._isMandatory={},this._isMandatory.F=[1===parseInt(t.$.mand_f_0),1===parseInt(t.$.mand_f_1)],this._isMandatory.M=[1===parseInt(t.$.mand_m_0),1===parseInt(t.$.mand_m_1)],this._partSets=new X,this._Str_2015(t)}dispose(){for(const t of this._partSets.getValues())t.dispose();this._partSets=null}_Str_1874(t){for(const e of t){const t=e.id,s=this._partSets.getValue(t);s&&(s.dispose(),this._partSets.remove(t))}}_Str_2015(t){if(t&&t.set)for(const e of t.set)this._partSets.add(e.$.id,new ce(this._type,e))}_Str_2264(t){for(const e of this._partSets.getValues())if(e&&0===e.clubLevel&&(e.gender===t||"U"===e.gender))return e;return null}_Str_1020(t){return this._partSets.getValue(t.toString())}get type(){return this._type}get _Str_734(){return this._paletteId}_Str_895(t,e){return this._isMandatory[t.toUpperCase()][Math.min(e,1)]}_Str_1002(t){return this._isMandatory[t.toUpperCase()].indexOf(!1)}get _Str_710(){return this._partSets}}class he{constructor(){this._palettes=new Map,this._setTypes=new Map}dispose(){}parse(t){if(!t)return!1;for(const e of t.colors[0].palette){const t=new ae(e);t&&this._palettes.set(t.id.toString(),t)}for(const e of t.sets[0].settype){const t=new _e(e);t&&this._setTypes.set(t.type,t)}return!0}_Str_1133(t){for(const e of t.sets[0].settype){const t=this._setTypes.get(e.$.type);t?t._Str_1874(e):this._setTypes.set(e.$.type,new _e(e))}this._Str_1017(t)}_Str_1017(t){if(!t)return!1;for(const e of t.colors[0].palette){const t=e.$.id.toString(),s=this._palettes.get(t);s?s._Str_2015(e):this._palettes.set(t,new ae(e))}for(const e of t.sets[0].settype){const t=e.$.type,s=this._setTypes.get(t);s?s._Str_2015(e):this._setTypes.set(t,new _e(e))}return!1}_Str_1733(t,e){const s=[];for(const i of this._setTypes.values())i&&i._Str_895(t,e)&&s.push(i.type);return s}_Str_2264(t,e){const s=this._setTypes.get(t);return s?s._Str_2264(e):null}_Str_740(t){return this._setTypes.get(t)||null}_Str_783(t){return this._palettes.get(t.toString())||null}_Str_938(t){for(const e of this._setTypes.values()){const s=e._Str_1020(t);if(s)return s}return null}}class le{constructor(t){if(this._id=t.id,this._parts=[],t.activeParts&&t.activeParts.length>0)for(const e of t.activeParts)e&&this._parts.push(e.setType)}get _Str_806(){return this._parts}}class ue{constructor(t){if(!t)throw new Error("invalid_data");this._setType=t.setType,this._flippedSetType=t.flippedSetType||null,this._removeSetType=t.removeSetType||null,this._appendToFigure=!1,this._staticId=-1}_Str_2234(){return this._staticId>=0}get _Str_1734(){return this._staticId}set _Str_1734(t){this._staticId=t}get _Str_2174(){return this._setType}get _Str_1693(){return this._flippedSetType}set _Str_1693(t){this._flippedSetType=t}get _Str_1209(){return this._removeSetType}get _Str_1583(){return this._appendToFigure}set _Str_1583(t){this._appendToFigure=t}}class de{constructor(){this._parts=new Map,this._activePartSets=new Map}parse(t){if(t.partSet&&t.partSet.length>0)for(const e of t.partSet)e&&this._parts.set(e.setType,new ue(e));if(t.activePartSets&&t.activePartSets.length>0)for(const e of t.activePartSets)e&&this._activePartSets.set(e.id,new le(e));return!0}_Str_1017(t){if(t.partSet&&t.partSet.length>0)for(const e of t.partSet)e&&this._parts.set(e.setType,new ue(e));if(t.activePartSets&&t.activePartSets.length>0)for(const e of t.activePartSets)e&&this._activePartSets.set(e.id,new le(e));return!1}_Str_1795(t){const e=this._activePartSets.get(t.activePartSet);return e?e._Str_806:[]}_Str_1102(t){return this._parts.get(t)||null}_Str_1520(t){const e=t.setType;let s=this._parts.get(e);return s||(s=new ue(t),this._parts.set(e,s)),s}_Str_1113(t){return this._activePartSets.get(t.activePartSet)||null}get _Str_806(){return this._parts}get _Str_1979(){return this._activePartSets}}class ge extends N{constructor(t){super(),this._renderManager=t,this._geometry=null,this._figureData=new he,this._partSetsData=new de,this._animationData=new re,this._animationManager=new Wt,this._mandatorySetTypeIds={},this._actionManager=null,this._defaultAction=null}init(){}dispose(){this.disposed||(super.dispose(),this._renderManager=null,this._figureData=null,this._partSetsData=null,this._animationData=null,this._mandatorySetTypeIds=null)}_Str_1825(t){t&&(this._geometry=new ee(t))}_Str_1060(t,e){e&&(this._actionManager=new Vt(t,e),this._defaultAction=this._actionManager._Str_1027())}_Str_1620(t){this._actionManager._Str_1620(t),this._defaultAction=this._actionManager._Str_1027()}_Str_1296(t){return!!t&&!!this._partSetsData.parse(t)&&(this._partSetsData._Str_1102("ri")._Str_1583=!0,this._partSetsData._Str_1102("li")._Str_1583=!0,!0)}_Str_2229(t){return!!t&&this._animationData.parse(t)}_Str_1569(t){return!!t&&this._figureData.parse(t)}_Str_882(t){this._figureData._Str_1133(t)}_Str_1849(t,e="fx",s=200){let i=0;for(;i<s;){const s=t.getCollection(e+i);s&&this._animationManager._Str_2061(this,s.data),i++}}_Str_2061(t){this._animationManager._Str_2061(this,t)}_Str_867(t,e,s=0){const i=t._Str_815(e);if(!i||i.length<s)return null;const r=this._figureData._Str_740(e);if(null==r)return null;const n=this._figureData._Str_783(r._Str_734);return n?n._Str_751(i[s]):null}_Str_1881(t,e,s){return this._animationManager._Str_607(t,e,s)}_Str_720(t){return this._animationManager._Str_720(t)}_Str_1675(t){return this._actionManager._Str_1675(t)}_Str_2018(t){return this._actionManager._Str_2018(t)}_Str_1939(t){return this._geometry._Str_1939(t)}_Str_711(t){return this._actionManager._Str_711(t)}_Str_1936(t){let e=0;for(const s of t)e=Math.max(e,this._animationData._Str_1408(s._Str_742));return e}_Str_1733(t,e){return this._mandatorySetTypeIds[t]||(this._mandatorySetTypeIds[t]=[]),this._mandatorySetTypeIds[t][e]||(this._mandatorySetTypeIds[t][e]=this._figureData._Str_1733(t,e)),this._mandatorySetTypeIds[t][e]}_Str_2264(t,e){return this._figureData._Str_2264(t,e)}_Str_781(t,e,s){return this._actionManager._Str_781(t,e,s)}_Str_1664(t,e){return this._geometry._Str_1664(t,e)}_Str_2101(t){this._geometry._Str_2101(t)}_Str_2021(t,e){let s=[];const i=[],r=t._Str_742._Str_868;if(t._Str_742._Str_861){const n=this._animationManager._Str_720(t._Str_742.state+"."+t._Str_727);if(n&&(s=n._Str_1065(0,t._Str_707),n._Str_706())){const t={id:"",x:0,y:0,z:0,radius:.01,nx:0,ny:0,nz:-1,double:1},s={setType:""};for(const a of n._Str_687){const n=this._geometry._Str_1919(r,a.align);if(n){t.id=a.id,n._Str_2020(t,e),s.setType=a.id;const r=this._partSetsData._Str_1520(s);r._Str_1583=!0,""===a.base&&(r._Str_1734=1),-1===i.indexOf(n.id)&&i.push(n.id)}}}for(const t of s){const e=this._geometry._Str_1919(r,t);e&&-1===i.indexOf(e.id)&&i.push(e.id)}}else{s=this._partSetsData._Str_1795(t._Str_742);for(const t of s){const s=this._geometry._Str_1701(r,t,e);s&&-1===i.indexOf(s.id)&&i.push(s.id)}}return i}_Str_1695(t){return this._geometry._Str_1307(t)}_Str_755(t,e,s){return this._geometry._Str_2250(t,Ot.DIRECTION_TO_ANGLE[s],e)}_Str_1888(t,e,s,i){const r=this._animationData._Str_2244(t._Str_742);return r?r._Str_1888(e,s,i):ie._Str_1934}_Str_713(t,e,s,i,r,n,a,o=null){let c=null,_=[],h=null;if(null==!s)return[];const l=this._partSetsData._Str_1795(s._Str_742),u=[];let d=[0];const g=this._animationData._Str_2244(s._Str_742);if(s._Str_742._Str_861){const e=this._animationManager._Str_720(s._Str_742.state+"."+s._Str_727);if(e){d=this._Str_1768(e._Str_2185(s._Str_707));for(const r of e._Str_1065(0,s._Str_707))if(r===t){const t=this._geometry._Str_1919(i,r);if(t)for(const e of t._Str_1883(a))l.push(e.id)}}}const m=this._geometry._Str_713(i,t,r,l,a),p=e._Str_1016();for(const f of p){if(o&&o.get(f))continue;const i=e.getPartSetId(f),r=e._Str_815(f),a=this._figureData._Str_740(f);if(a){const e=this._figureData._Str_783(a._Str_734);if(e){const o=a._Str_1020(i);if(o){n=n.concat(o._Str_790);for(const i of o._Str_806)if(m.indexOf(i.type)>-1){if(g){const t=g._Str_989(i.type);_=t?t.frames:d}else _=d;c=s._Str_742,-1===l.indexOf(i.type)&&(c=this._defaultAction);const n=this._partSetsData._Str_1102(i.type);let a=n?n._Str_1693:i.type;a&&""!==a||(a=i.type),r&&r.length>i._Str_827-1&&(h=e._Str_751(r[i._Str_827-1]));const o=i._Str_827>0,m=new zt(t,i.type,i.id.toString(),h,_,c,o,i.paletteMap,a);u.push(m)}}}}}const E=[];for(const f of m){let e=null,r=!1;const c=o&&o.get(f);for(const t of u)t._Str_1669===f&&(c?e=t.color:(r=!0,-1===n.indexOf(f)&&E.push(t)));if(!r)if(c){const i=o.get(f);let r=0,n=0;for(;n<i.length;)r+=i.charCodeAt(n),n++;if(g){const t=g._Str_989(f);_=t?t.frames:d}else _=d;const a=new zt(t,f,i,e,_,s._Str_742,!(null==e),-1,f,!1,1);E.push(a)}else if(l.indexOf(f)>-1)if(t!==this._geometry._Str_1701(i,f,a).id);else{const e=this._partSetsData._Str_1102(f);let i=!1,r=1;if(e._Str_1583){let n="1";if(""!==s._Str_727&&(n=s._Str_727),e._Str_2234()&&(n=e._Str_1734.toString()),g){const t=g._Str_989(f);_=t?t.frames:d}else _=d;const a=new zt(t,f,n,null,_,s._Str_742,!1,-1,f,i,r);E.push(a)}}}return E}_Str_1768(t){const e=[];let s=0;for(;s<t;)e.push(s),s++;return e}_Str_672(){if(this._actionManager){const t=this._actionManager._Str_1675("CarryItem").params,e=[];for(const s of t.values())e.push(s);return e}return[]}get renderManager(){return this._renderManager}get figureData(){return this._figureData}get partData(){return this._partSetsData}get animationManager(){return this._animationManager}}var me=s("yp5t"),pe=s("JY8D"),Ee=s("LPTP");let fe=(()=>{class t extends y{constructor(t,e){super(t),this._library=e}get library(){return this._library}}return t.DOWNLOAD_COMPLETE="ARELE_DOWNLOAD_COMPLETE",t})(),Se=(()=>{class t extends N{constructor(e,s,i,r){super(),this._state=t.NOT_LOADED,this._libraryName=e,this._revision=s,this._downloadUrl=r,this._assets=i,this._animation=null,this._downloadUrl=this._downloadUrl.replace(/%libname%/gi,this._libraryName),this._downloadUrl=this._downloadUrl.replace(/%revision%/gi,this._revision),this._assets.getCollection(this._libraryName)&&(this._state=t.LOADED)}downloadAsset(){if(this._assets&&this._state!==t.LOADING&&this._state!==t.LOADED)return this._assets.getCollection(this._libraryName)?(this._state=t.LOADED,void this.dispatchEvent(new fe(fe.DOWNLOAD_COMPLETE,this))):(this._state=t.LOADING,void this._assets.downloadAsset(this._downloadUrl,e=>{if(e){this._state=t.LOADED;const e=this._assets.getCollection(this._libraryName);e&&(this._animation=e.data.animations),this.dispatchEvent(new fe(fe.DOWNLOAD_COMPLETE,this))}}))}get libraryName(){return this._libraryName}get animation(){return this._animation}get isLoaded(){return this._state===t.LOADED}}return t.DOWNLOAD_COMPLETE="EADL_DOWNLOAD_COMPLETE",t.NOT_LOADED=0,t.LOADING=1,t.LOADED=2,t})(),be=(()=>{class t extends N{constructor(t,e){super(),this._assets=t,this._structure=e,this._missingMandatoryLibs=um.instance.getConfiguration("avatar.mandatory.effect.libraries"),this._effectMap=new Map,this._effectListeners=new Map,this._incompleteEffects=new Map,this._initDownloadBuffer=[],this._pendingDownloadQueue=[],this._currentDownloads=[],this._libraryNames=[],this._isReady=!1,this.onLibraryLoaded=this.onLibraryLoaded.bind(this),this.onAvatarRenderReady=this.onAvatarRenderReady.bind(this),this.loadEffectMap(),this._structure.renderManager.events.addEventListener(Et.AVATAR_RENDER_READY,this.onAvatarRenderReady)}loadEffectMap(){const e=new XMLHttpRequest;try{e.open("GET",um.instance.getConfiguration("avatar.effectmap.url")),e.send(),e.onloadend=s=>{if(e.responseText){const s=JSON.parse(e.responseText);this.processEffectMap(s.effects),this.processMissingLibraries(),this._isReady=!0,this.dispatchEvent(new y(t.DOWNLOADER_READY))}},e.onerror=t=>{throw new Error("invalid_avatar_effect_map")}}catch(s){D.log(s)}}processEffectMap(t){if(t)for(const e of t){if(!e)continue;const t=e.id,s=e.lib,i=e.revision||"";if(this._libraryNames.indexOf(s)>=0)continue;this._libraryNames.push(s);const r=new Se(s,i,this._assets,um.instance.getConfiguration("avatar.asset.effect.url"));r.addEventListener(fe.DOWNLOAD_COMPLETE,this.onLibraryLoaded);let n=this._effectMap.get(t);n||(n=[]),n.push(r),this._effectMap.set(t,n)}}downloadAvatarEffect(t,e){if(!this._isReady||!this._structure.renderManager.isReady)return void this._initDownloadBuffer.push([t,e]);const s=this.getAvatarEffectPendingLibraries(t);if(s&&s.length){if(e&&!e.disposed){let s=this._effectListeners.get(t.toString());s||(s=[]),s.push(e),this._effectListeners.set(t.toString(),s)}this._incompleteEffects.set(t.toString(),s);for(const t of s)t&&this.downloadLibrary(t)}else e&&!e.disposed&&e.resetEffect(t)}onAvatarRenderReady(t){if(t){for(const[t,e]of this._initDownloadBuffer)this.downloadAvatarEffect(t,e);this._initDownloadBuffer=[]}}onLibraryLoaded(e){if(!e||!e.library)return;const s=[];this._structure._Str_2061(e.library.animation);for(const[r,n]of this._incompleteEffects.entries()){let e=!0;for(const t of n)if(t&&!t.isLoaded){e=!1;break}if(e){s.push(r);const e=this._effectListeners.get(r);for(const t of e)t&&!t.disposed&&t.resetEffect(parseInt(r));this._effectListeners.delete(r),this.dispatchEvent(new y(t.LIBRARY_LOADED))}}for(const t of s)this._incompleteEffects.delete(t);let i=0;for(;i<this._currentDownloads.length;){const t=this._currentDownloads[i];t&&t.libraryName===e.library.libraryName&&this._currentDownloads.splice(i,1),i++}}processMissingLibraries(){const t=this._missingMandatoryLibs.slice();for(const e of t){if(!e)continue;const t=this._effectMap.get(e);if(t)for(const e of t)e&&this.downloadLibrary(e)}}isAvatarEffectReady(t){return!(!this._isReady||!this._structure.renderManager.isReady||this.getAvatarEffectPendingLibraries(t).length)}getAvatarEffectPendingLibraries(t){const e=[];if(!this._structure)return e;const s=this._effectMap.get(t.toString());if(s)for(const i of s)i&&!i.isLoaded&&-1===e.indexOf(i)&&e.push(i);return e}downloadLibrary(t){t&&!t.isLoaded&&(this._pendingDownloadQueue.indexOf(t)>=0||this._currentDownloads.indexOf(t)>=0||(this._pendingDownloadQueue.push(t),this.processDownloadQueue()))}processDownloadQueue(){for(;this._pendingDownloadQueue.length;)this._pendingDownloadQueue[0].downloadAsset(),this._currentDownloads.push(this._pendingDownloadQueue.shift())}}return t.DOWNLOADER_READY="EADM_DOWNLOADER_READY",t.LIBRARY_LOADED="EADM_LIBRARY_LOADED",t.MAX_DOWNLOADS=2,t})();class Re extends xt{constructor(t,e,s,i,r){super(t,e,s,i,r,null)}isPlaceholder(){return!0}}let Ie=(()=>{class t extends N{constructor(t,e){super(),this._dataReceiver=e,this.download(t)}download(e){const s=new XMLHttpRequest;try{s.open("GET",e),s.send(),s.onloadend=e=>{(new lt.Parser).parseString(s.responseText,(e,s)=>{if(e||!s||!s.figuredata)throw new Error("invalid_figure_data");this._dataReceiver&&this._dataReceiver._Str_1017(s.figuredata),this.dispatchEvent(new y(t.AVATAR_STRUCTURE_DONE))})},s.onerror=t=>{throw new Error("invalid_avatar_figure_data")}}catch(i){D.log(i)}}}return t.AVATAR_STRUCTURE_DONE="AVATAR_STRUCTURE_DONE",t})(),ve=(()=>{class t extends z{constructor(){super(),this._structure=null,this._avatarAssetDownloadManager=null,this._placeHolderFigure=null,this._figureMapReady=!1,this._effectMapReady=!1,this._actionsReady=!1,this._geometryReady=!1,this._partSetsReady=!1,this._animationsReady=!1,this._isReady=!1,this.onAvatarAssetDownloaderReady=this.onAvatarAssetDownloaderReady.bind(this),this.onAvatarAssetDownloaded=this.onAvatarAssetDownloaded.bind(this),this.onEffectAssetDownloaderReady=this.onEffectAssetDownloaderReady.bind(this),this.onEffectAssetDownloaded=this.onEffectAssetDownloaded.bind(this),this.onAvatarStructureDownloadDone=this.onAvatarStructureDownloadDone.bind(this)}onInit(){this._structure=new ge(this),this.loadGeometry(),this.loadPartSets(),this.loadActions(),this.loadAnimations(),this.loadFigureData(),this._aliasCollection=new gt(this,um.instance.core.asset),this._aliasCollection.init(),this._avatarAssetDownloadManager||(this._avatarAssetDownloadManager=new ft(um.instance.core.asset,this._structure),this._avatarAssetDownloadManager.addEventListener(ft.DOWNLOADER_READY,this.onAvatarAssetDownloaderReady),this._avatarAssetDownloadManager.addEventListener(ft.LIBRARY_LOADED,this.onAvatarAssetDownloaded)),this._effectAssetDownloadManager||(this._effectAssetDownloadManager=new be(um.instance.core.asset,this._structure),this._effectAssetDownloadManager.addEventListener(be.DOWNLOADER_READY,this.onEffectAssetDownloaderReady),this._effectAssetDownloadManager.addEventListener(be.LIBRARY_LOADED,this.onEffectAssetDownloaded)),this.checkReady()}onDispose(){this._avatarAssetDownloadManager&&(this._avatarAssetDownloadManager.removeEventListener(ft.DOWNLOADER_READY,this.onAvatarAssetDownloaderReady),this._avatarAssetDownloadManager.removeEventListener(ft.LIBRARY_LOADED,this.onAvatarAssetDownloaded)),this._effectAssetDownloadManager&&(this._effectAssetDownloadManager.removeEventListener(be.DOWNLOADER_READY,this.onEffectAssetDownloaderReady),this._effectAssetDownloadManager.removeEventListener(be.LIBRARY_LOADED,this.onEffectAssetDownloaded))}loadGeometry(){this._structure&&(this._structure._Str_1825(pe.a),this._geometryReady=!0,this.checkReady())}loadPartSets(){this._structure&&(this._structure._Str_1296(Ee.a),this._partSetsReady=!0,this.checkReady())}loadActions(){const t=um.instance.getConfiguration("avatar.default.actions");t&&this._structure._Str_1060(um.instance.core.asset,t);const e=new XMLHttpRequest;try{e.open("GET",um.instance.getConfiguration("avatar.actions.url")),e.send(),e.onloadend=t=>{this._structure&&(this._structure._Str_1620(JSON.parse(e.responseText)),this._actionsReady=!0,this.checkReady())},e.onerror=t=>{throw new Error("invalid_avatar_actions")}}catch(s){this.logger.error(s)}}loadAnimations(){this._structure&&(this._structure._Str_2229(me.a),this._animationsReady=!0,this.checkReady())}loadFigureData(){const t=um.instance.getConfiguration("avatar.default.figuredata");t&&(new lt.Parser).parseString(t,(t,e)=>{if(t||!e||!e.figuredata)throw new Error("invalid_default_figure_data");this._structure&&this._structure._Str_1569(e.figuredata)}),new Ie(um.instance.getConfiguration("avatar.figuredata.url"),this._structure.figureData).addEventListener(Ie.AVATAR_STRUCTURE_DONE,this.onAvatarStructureDownloadDone)}onAvatarStructureDownloadDone(t){this._structureReady=!0,this._structure.init(),this.checkReady()}onAvatarAssetDownloaderReady(t){t&&(this._figureMapReady=!0,this.checkReady())}onAvatarAssetDownloaded(t){t&&this._aliasCollection.reset()}onEffectAssetDownloaderReady(t){t&&(this._effectMapReady=!0,this.checkReady())}onEffectAssetDownloaded(t){t&&this._aliasCollection.reset()}checkReady(){this._isReady||this._geometryReady&&this._partSetsReady&&this._actionsReady&&this._animationsReady&&this._figureMapReady&&this._effectMapReady&&this._structureReady&&(this._isReady=!0,this.events&&this.events.dispatchEvent(new y(Et.AVATAR_RENDER_READY)))}createFigureContainer(t){return new St(t)}isFigureContainerReady(t){return!!this._avatarAssetDownloadManager&&this._avatarAssetDownloadManager.isAvatarFigureContainerReady(t)}createAvatarImage(e,s,i,r=null,n=null){if(!this._structure||!this._avatarAssetDownloadManager)return null;const a=new St(e);return i&&this.validateAvatarFigure(a,i),this._avatarAssetDownloadManager.isAvatarFigureContainerReady(a)?new xt(this._structure,this._aliasCollection,a,s,this._effectAssetDownloadManager,n):(this._placeHolderFigure||(this._placeHolderFigure=new St(t.DEFAULT_FIGURE)),this._avatarAssetDownloadManager.downloadAvatarFigure(a,r),new Re(this._structure,this._aliasCollection,this._placeHolderFigure,s,this._effectAssetDownloadManager))}downloadAvatarFigure(t,e){this._avatarAssetDownloadManager&&this._avatarAssetDownloadManager.downloadAvatarFigure(t,e)}validateAvatarFigure(t,e){let s=!1;const i=this._structure._Str_1733(e,2);if(i){const r=this._structure.figureData;for(const n of i)if(t._Str_744(n)){const i=r._Str_740(n);if(i&&!i._Str_1020(t.getPartSetId(n))){const i=this._structure._Str_2264(n,e);i&&(t._Str_830(n,i.id,[0]),s=!0)}}else{const i=this._structure._Str_2264(n,e);i&&(t._Str_830(n,i.id,[0]),s=!0)}}return!s}isValidFigureSetForGender(t,e){const s=this.structureData._Str_938(t);return!(!s||"U"!==s.gender.toUpperCase()&&s.gender.toUpperCase()!==e.toUpperCase())}getFigureStringWithFigureIds(t,e,s){const i=new ut;i._Str_2153(t,e);const r=this._Str_1667(s);for(const n of r)i._Str_2088(n.type,n.id,i.getColourIds(n.type));return i._Str_1008()}_Str_1667(t){const e=this.structureData,s=[];for(const i of t){const t=e._Str_938(i);t&&s.push(t)}return s}_Str_838(t,e){return this._structure?this._structure._Str_1733(t,e):null}getAssetByName(t){return this._aliasCollection.getAsset(t)}get assets(){return um.instance.core.asset}get isReady(){return this._isReady}get structure(){return this._structure}get structureData(){return this._structure?this._structure.figureData:null}get downloadManager(){return this._avatarAssetDownloadManager}}return t.DEFAULT_FIGURE="hd-99999-99999",t})();class Te{flush(){return!0}parse(t){return!!t}}class Oe extends E{constructor(t){super(t,Te)}getParser(){return this.parser}}class Ae{flush(){return!0}parse(t){return!!t}}class ye extends E{constructor(t){super(t,Ae)}getParser(){return this.parser}}class Ce{constructor(){this._data=[]}getMessageArray(){return this._data}dispose(){}}let Me=(()=>{class t{}return t.UNKNOWN=0,t.BROWSER=1,t})(),De=(()=>{class t{}return t.UNKNOWN=0,t.FLASH=1,t.HTML5=2,t})();class Ne{constructor(t,e,s,i){this._data=[um.RELEASE_VERSION,"HTML5",De.HTML5,Me.BROWSER]}getMessageArray(){return this._data}dispose(){}}class we{constructor(t){this._data=[t]}getMessageArray(){return this._data}dispose(){}}class Ue{constructor(){this._data=[]}getMessageArray(){return this._data}dispose(){}}let Le=(()=>{class t extends y{constructor(t,e){super(t),this._connection=e}get connection(){return this._connection}}return t.CONNECTION_ESTABLISHED="NCE_ESTABLISHED",t.CONNECTION_CLOSED="NCE_CLOSED",t.CONNECTION_ERROR="NCE_ERROR",t.CONNECTION_HANDSHAKING="NCE_HANDSHAKING",t.CONNECTION_HANDSHAKED="NCE_HANDSHAKED",t.CONNECTION_HANDSHAKE_FAILED="NCE_HANDSHAKE_FAILED",t.CONNECTION_AUTHENTICATED="NCE_AUTHENTICATED",t})();class Pe extends z{constructor(t){super(),this._communication=t,this._sso=null,this._handShaking=!1,this._didConnect=!1,this._pongInterval=null,this.onConnectionOpenedEvent=this.onConnectionOpenedEvent.bind(this),this.onConnectionClosedEvent=this.onConnectionClosedEvent.bind(this),this.onConnectionErrorEvent=this.onConnectionErrorEvent.bind(this),this.sendPong=this.sendPong.bind(this)}onInit(){const t=this._communication.connection;t&&(t.addEventListener(j.CONNECTION_OPENED,this.onConnectionOpenedEvent),t.addEventListener(j.CONNECTION_CLOSED,this.onConnectionClosedEvent),t.addEventListener(j.CONNECTION_ERROR,this.onConnectionErrorEvent)),this._communication.registerMessageEvent(new Oe(this.onClientPingEvent.bind(this))),this._communication.registerMessageEvent(new ye(this.onAuthenticatedEvent.bind(this)))}onDispose(){const t=this._communication.connection;t&&(t.removeEventListener(j.CONNECTION_OPENED,this.onConnectionOpenedEvent),t.removeEventListener(j.CONNECTION_CLOSED,this.onConnectionClosedEvent),t.removeEventListener(j.CONNECTION_ERROR,this.onConnectionErrorEvent)),this._sso=null,this._handShaking=!1,this.stopPonging(),super.onDispose()}onConnectionOpenedEvent(t){const e=this._communication.connection;e&&(this._didConnect=!0,this.dispatchCommunicationDemoEvent(Le.CONNECTION_ESTABLISHED,e),um.instance.getConfiguration("communication.pong.manually",!1)&&this.startPonging(),this.startHandshake(e),e.send(new Ne(null,null,null,null)),this.tryAuthentication(e))}onConnectionClosedEvent(t){const e=this._communication.connection;e&&(this.stopPonging(),this._didConnect&&this.dispatchCommunicationDemoEvent(Le.CONNECTION_CLOSED,e))}onConnectionErrorEvent(t){const e=this._communication.connection;e&&(this.stopPonging(),this.dispatchCommunicationDemoEvent(Le.CONNECTION_ERROR,e))}tryAuthentication(t){if(!t||!this._sso)return this._sso||D.log("Login without an SSO ticket is not supported"),void this.dispatchCommunicationDemoEvent(Le.CONNECTION_HANDSHAKE_FAILED,t);t.send(new we(this._sso))}onClientPingEvent(t){t instanceof Oe&&t.connection&&this.sendPong(t.connection)}onAuthenticatedEvent(t){t instanceof ye&&t.connection&&(this.completeHandshake(t.connection),this.dispatchCommunicationDemoEvent(Le.CONNECTION_AUTHENTICATED,t.connection),t.connection.send(new Ue))}setSSO(t){t&&""!==t&&!this._sso&&(this._sso=t)}startHandshake(t){this.dispatchCommunicationDemoEvent(Le.CONNECTION_HANDSHAKING,t),this._handShaking=!0}completeHandshake(t){this.dispatchCommunicationDemoEvent(Le.CONNECTION_HANDSHAKED,t),this._handShaking=!1}startPonging(){this.stopPonging(),this._pongInterval=setInterval(this.sendPong,um.instance.getConfiguration("communication.pong.interval.ms",2e4))}stopPonging(){this._pongInterval&&(clearInterval(this._pongInterval),this._pongInterval=null)}sendPong(t=null){(t=t||this._communication.connection||null)&&t.send(new Ce)}dispatchCommunicationDemoEvent(t,e){um.instance.events.dispatchEvent(new Le(t,e))}}class xe{constructor(t,e,s,i){this._id=t,this._type=e,this._color=s,this._light=i}get id(){return this._id}get type(){return this._type}get color(){return this._color}get _Str_4272(){return this._light}}let Fe=(()=>{class t extends y{constructor(t,e,s=!0){super(t),this._session=e,this._openLandingView=s}get session(){return this._session}get openLandingView(){return this._openLandingView}}return t.CREATED="RSE_CREATED",t.STARTED="RSE_STARTED",t.ENDED="RSE_ENDED",t.ROOM_DATA="RSE_ROOM_DATA",t})(),Ge=(()=>{class t extends Fe{constructor(t,e){super(t,e),this._selectedPresetId=0,this._presets=[]}get _Str_10888(){return this._presets.length}get _Str_6226(){return this._selectedPresetId}set _Str_6226(t){this._selectedPresetId=t}_Str_17287(t,e,s,i){const r=new xe(t,e,s,i);this._presets[t-1]=r}_Str_14989(t){return t<0||t>=this._presets.length?null:this._presets[t]}}return t.RSDPE_PRESETS="RSDPE_PRESETS",t})();class Ve{flush(){return this._isOpen=!1,this._onShutdown=!1,this._isAuthenticUser=!1,!0}parse(t){return!!t&&(this._isOpen=t.readBoolean(),this._onShutdown=t.readBoolean(),t.bytesAvailable&&(this._isAuthenticUser=t.readBoolean()),!0)}get isOpen(){return this._isOpen}get onShutdown(){return this._onShutdown}get isAuthenticUser(){return this._isAuthenticUser}}class Ye extends E{constructor(t){super(t,Ve)}getParser(){return this.parser}}class ke{flush(){return this._resultCode=-1,this._name="",this._nameSuggestions=[],!0}parse(t){if(!t)return!1;this._resultCode=t.readInt(),this._name=t.readString();let e=t.readInt();for(;e>0;)this._nameSuggestions.push(t.readString()),e--;return!0}get resultCode(){return this._resultCode}get name(){return this._name}get nameSuggestions(){return this._nameSuggestions}}let je=(()=>{class t extends E{constructor(t){super(t,ke)}getParser(){return this.parser}}return t._Str_5797=0,t._Str_7005=1,t._Str_7389=2,t._Str_7137=3,t._Str_7836=4,t._Str_7721=5,t._Str_8620=6,t._Str_9429=7,t})();class Be{constructor(t){if(!t)throw new Error("invalid_wrapper");this.flush(),this.parse(t)}flush(){return this._offerId=-1,this._productCode=null,this._priceCredits=0,this._priceActivityPoints=0,this._priceActivityPointsType=0,this._vip=!1,this._months=0,this._extraDays=0,this._daysLeftAfterPurchase=0,this._year=0,this._month=0,this._day=0,this._giftable=!1,!0}parse(t){return!!t&&(this._offerId=t.readInt(),this._productCode=t.readString(),t.readBoolean(),this._priceCredits=t.readInt(),this._priceActivityPoints=t.readInt(),this._priceActivityPointsType=t.readInt(),this._vip=t.readBoolean(),this._months=t.readInt(),this._extraDays=t.readInt(),this._giftable=t.readBoolean(),this._daysLeftAfterPurchase=t.readInt(),this._year=t.readInt(),this._month=t.readInt(),this._day=t.readInt(),!0)}get offerId(){return this._offerId}get productCode(){return this._productCode}get priceCredits(){return this._priceCredits}get priceActivityPoints(){return this._priceActivityPoints}get priceActivityPointsType(){return this._priceActivityPointsType}get vip(){return this._vip}get months(){return this._months}get extraDays(){return this._extraDays}get daysLeftAfterPurchase(){return this._daysLeftAfterPurchase}get year(){return this._year}get month(){return this._month}get day(){return this._day}get giftable(){return this._giftable}}class He{flush(){return this._offers=[],!0}parse(t){if(!t)return!1;let e=t.readInt();for(;e>0;)this._offers.push(new Be(t)),e--;return!0}get offers(){return this._offers}}class We extends E{constructor(t){super(t,He)}getParser(){return this.parser}}class Ze{flush(){return this._mode=-1,!0}parse(t){return!!t&&(this._mode=t.readInt(),!0)}get mode(){return this._mode}}class ze extends E{constructor(t){super(t,Ze)}getParser(){return this.parser}}let Xe=(()=>{class t{constructor(t){if(!t)throw new Error("invalid_wrapper");this.flush(),this.parse(t)}flush(){return this._type=-1,this._position=null,this._itemName=null,this._itemPromoImage=null,this._catalogPageLocation=null,this._productCode=null,this._productOfferId=0,this._expirationTime=0,!0}parse(e){if(!e)return!1;switch(this._position=e.readInt(),this._itemName=e.readString(),this._itemPromoImage=e.readString(),this._type=e.readInt(),this._type){case t.ITEM_CATALOGUE_PAGE:this._catalogPageLocation=e.readString();break;case t.ITEM_PRODUCT_OFFER:this._productOfferId=e.readInt();break;case t.ITEM_IAP:this._productCode=e.readString()}const s=e.readInt();return this._expirationTime=s>0?1e3*s+um.instance.time:0,!0}get type(){return this._type}get position(){return this._position}get itemName(){return this._itemName}get itemPromoImage(){return this._itemPromoImage}get catalogPageLocation(){return this._catalogPageLocation}get productCode(){return this._productCode}get productOfferId(){return this._productOfferId}get expirationTime(){return this._expirationTime}}return t.ITEM_CATALOGUE_PAGE=0,t.ITEM_PRODUCT_OFFER=1,t.ITEM_IAP=2,t})();class Ke{constructor(t){if(!t)throw new Error("invalid_wrapper");this.flush(),this.parse(t)}flush(){return this._images=[],this._texts=[],!0}parse(t){if(!t)return!1;let e=t.readInt();for(;e>0;)this._images.push(t.readString()),e--;let s=t.readInt();for(;s>0;)this._texts.push(t.readString()),s--;return!0}get images(){return this._images}get texts(){return this._texts}}let qe=(()=>{class t{constructor(t){if(!t)throw new Error("invalid_wrapper");this.flush(),this.parse(t)}flush(){return this._productType=null,this._furniClassId=-1,this._extraParam=null,this._productCount=0,this._uniqueLimitedItem=!1,this._uniqueLimitedItemSeriesSize=0,this._uniqueLimitedItemsLeft=0,!0}parse(e){switch(this._productType=e.readString(),this._productType){case t.B:return this._extraParam=e.readString(),this._productCount=1,!0;default:return this._furniClassId=e.readInt(),this._extraParam=e.readString(),this._productCount=e.readInt(),this._uniqueLimitedItem=e.readBoolean(),this._uniqueLimitedItem&&(this._uniqueLimitedItemSeriesSize=e.readInt(),this._uniqueLimitedItemsLeft=e.readInt()),!0}}get productType(){return this._productType}get furniClassId(){return this._furniClassId}get extraParam(){return this._extraParam}get productCount(){return this._productCount}get uniqueLimitedItem(){return this._uniqueLimitedItem}get uniqueLimitedSeriesSize(){return this._uniqueLimitedItemSeriesSize}get uniqueLimitedItemsLeft(){return this._uniqueLimitedItemsLeft}}return t.I="i",t.S="s",t.E="e",t.B="b",t})();class Je{constructor(t){if(!t)throw new Error("invalid_wrapper");this.flush(),this.parse(t)}flush(){return this._offerId=-1,this._localizationId=null,this._rent=!1,this._priceCredits=0,this._priceActivityPoints=0,this._priceActivityPointsType=0,this._clubLevel=0,this._giftable=!1,this._bundlePurchaseAllowed=!1,this._isPet=!1,this._previewImage=null,this._products=[],!0}parse(t){if(!t)return!1;this._offerId=t.readInt(),this._localizationId=t.readString(),this._rent=t.readBoolean(),this._priceCredits=t.readInt(),this._priceActivityPoints=t.readInt(),this._priceActivityPointsType=t.readInt(),this._giftable=t.readBoolean();let e=t.readInt();for(;e>0;)this._products.push(new qe(t)),e--;return this._clubLevel=t.readInt(),this._bundlePurchaseAllowed=t.readBoolean(),this._isPet=t.readBoolean(),this._previewImage=t.readString(),!0}get offerId(){return this._offerId}get localizationId(){return this._localizationId}get rent(){return this._rent}get priceCredits(){return this._priceCredits}get priceActivityPoints(){return this._priceActivityPoints}get priceActivityPointsType(){return this._priceActivityPointsType}get clubLevel(){return this._clubLevel}get giftable(){return this._giftable}get bundlePurchaseAllowed(){return this._bundlePurchaseAllowed}get isPet(){return this._isPet}get previewImage(){return this._previewImage}get products(){return this._products}}class Qe{flush(){return this._pageId=-1,this._catalogType=null,this._layoutCode=null,this._localization=null,this._offers=[],this._offerId=-1,this._acceptSeasonCurrencyAsCredits=!1,this._frontPageItems=[],!0}parse(t){if(!t)return!1;this._pageId=t.readInt(),this._catalogType=t.readString(),this._layoutCode=t.readString(),this._localization=new Ke(t);let e=t.readInt();for(;e>0;)this._offers.push(new Je(t)),e--;if(this._offerId=t.readInt(),this._acceptSeasonCurrencyAsCredits=t.readBoolean(),t.bytesAvailable){let e=t.readInt();for(;e>0;)this._frontPageItems.push(new Xe(t)),e--}return!0}get pageId(){return this._pageId}get catalogType(){return this._catalogType}get layoutCode(){return this._layoutCode}get localization(){return this._localization}get offers(){return this._offers}get offerId(){return this._offerId}get acceptSeasonCurrencyAsCredits(){return this._acceptSeasonCurrencyAsCredits}get frontPageItems(){return this._frontPageItems}}class $e extends E{constructor(t){super(t,Qe)}getParser(){return this.parser}}class ts{constructor(t){if(!t)throw new Error("invalid_wrapper");this.flush(),this.parse(t)}flush(){return this._visible=!1,this._icon=0,this._pageId=-1,this._pageName=null,this._localization=null,this._children=[],this._offerIds=[],!0}parse(t){if(!t)return!1;this._visible=t.readBoolean(),this._icon=t.readInt(),this._pageId=t.readInt(),this._pageName=t.readString(),this._localization=t.readString();let e=t.readInt();for(;e>0;)this._offerIds.push(t.readInt()),e--;let s=t.readInt();for(;s>0;)this._children.push(new ts(t)),s--;return!0}get visible(){return this._visible}get icon(){return this._icon}get pageId(){return this._pageId}get pageName(){return this._pageName}get localization(){return this._localization}get children(){return this._children}get offerIds(){return this._offerIds}}class es{flush(){return this._root=null,!0}parse(t){return!!t&&(this._root=new ts(t),this._newAdditionsAvailable=t.readBoolean(),this._catalogType=t.readString(),!0)}get root(){return this._root}get newAdditionsAvailable(){return this._newAdditionsAvailable}get catalogType(){return this._catalogType}}class ss extends E{constructor(t){super(t,es)}getParser(){return this.parser}}class is{constructor(t){if(!t)throw new Error("invalid_wrapper");this.flush(),this.parse(t)}flush(){return this._offerId=-1,this._localizationId=null,this._rent=!1,this._priceCredits=0,this._priceActivityPoints=0,this._priceActivityPointsType=0,this._clubLevel=0,this._giftable=!1,this._bundlePurchaseAllowed=!1,this._products=[],!0}parse(t){if(!t)return!1;this._offerId=t.readInt(),this._localizationId=t.readString(),this._rent=t.readBoolean(),this._priceCredits=t.readInt(),this._priceActivityPoints=t.readInt(),this._priceActivityPointsType=t.readInt(),this._giftable=t.readBoolean();let e=t.readInt();for(;e>0;)this._products.push(new qe(t)),e--;return this._clubLevel=t.readInt(),this._bundlePurchaseAllowed=t.readBoolean(),!0}get offerId(){return this._offerId}get localizationId(){return this._localizationId}get rent(){return this._rent}get priceCredits(){return this._priceCredits}get priceActivityPoints(){return this._priceActivityPoints}get priceActivityPointsType(){return this._priceActivityPointsType}get clubLevel(){return this._clubLevel}get giftable(){return this._giftable}get bundlePurchaseAllowed(){return this._bundlePurchaseAllowed}get products(){return this._products}}class rs{flush(){return this._offer=null,!0}parse(t){return!!t&&(this._offer=new is(t),!0)}get offer(){return this._offer}}class ns extends E{constructor(t){super(t,rs)}getParser(){return this.parser}}class as{flush(){return this._code=0,!0}parse(t){return!!t&&(this._code=t.readInt(),!0)}get code(){return this._code}}class os extends E{constructor(t){super(t,as)}getParser(){return this.parser}}class cs{flush(){return this._code=0,!0}parse(t){return!!t&&(this._code=t.readInt(),!0)}get code(){return this._code}}class _s extends E{constructor(t){super(t,cs)}getParser(){return this.parser}}class hs{flush(){return this._offer=null,!0}parse(t){return!!t&&(this._offer=new Je(t),!0)}get offer(){return this._offer}}class ls extends E{constructor(t){super(t,hs)}getParser(){return this.parser}}class us{flush(){return!0}parse(t){return!!t}}class ds extends E{constructor(t){super(t,us)}getParser(){return this.parser}}class gs{flush(){return this._instantlyRefreshCatalogue=!1,this._newFurniDataHash=null,!0}parse(t){return!!t&&(this._instantlyRefreshCatalogue=t.readBoolean(),t.bytesAvailable&&(this._newFurniDataHash=t.readString()),!0)}get instantlyRefreshCatalogue(){return this._instantlyRefreshCatalogue}get newFurniDataHash(){return this._newFurniDataHash}}class ms extends E{constructor(t){super(t,gs)}getParser(){return this.parser}}class ps{flush(){return!0}parse(t){return!!t}}class Es extends E{constructor(t){super(t,ps)}getParser(){return this.parser}}class fs{constructor(t){if(!t)throw new Error("invalid_wrapper");this._senderId=t.readInt(),this._errorCode=t.readInt()}get senderId(){return this._senderId}get errorCode(){return this._errorCode}}class Ss{flush(){return this._failuers=[],!0}parse(t){if(!t)return!1;let e=t.readInt();for(;e>0;)this._failuers.push(new fs(t)),e--;return!0}get failures(){return this._failuers}}class bs extends E{constructor(t){super(t,Ss)}getParser(){return this.parser}}class Rs{flush(){return this._success=!1,!0}parse(t){return!!t&&(this._success=t.readBoolean(),!0)}get success(){return this._success}}class Is extends E{constructor(t){super(t,Rs)}getParser(){return this.parser}}class vs{flush(){return this._errorCode=0,!0}parse(t){return!!t&&(this._errorCode=t.readInt(),!0)}get errorCode(){return this._errorCode}}class Ts extends E{constructor(t){super(t,vs)}getParser(){return this.parser}}class Os{constructor(t){if(!t)throw new Error("invalid_wrapper");this._id=t.readInt(),this._name=t.readString(),this._gender=t.readInt(),this._online=t.readBoolean(),this._followingAllowed=t.readBoolean(),this._figure=t.readString(),this._categoryId=t.readInt(),this._motto=t.readString(),this._realName=t.readString(),this._lastAccess=t.readString(),this._persistedMessageUser=t.readBoolean(),this._vipMember=t.readBoolean(),this._pocketHabboUser=t.readBoolean(),this._relationshipStatus=t.readShort()}get id(){return this._id}get name(){return this._name}get gender(){return this._gender}get online(){return this._online}get followingAllowed(){return this._followingAllowed}get figure(){return this._figure}get categoryId(){return this._categoryId}get motto(){return this._motto}get lastAccess(){return this._lastAccess}get realName(){return this._realName}get persistedMessageUser(){return this._persistedMessageUser}get vipMember(){return this._vipMember}get pocketHabboUser(){return this._pocketHabboUser}get relationshipStatus(){return this._relationshipStatus}}class As{flush(){return this._totalFragments=0,this._fragmentNumber=0,this._fragment=[],!0}parse(t){if(!t)return!1;this._totalFragments=t.readInt(),this._fragmentNumber=t.readInt();let e=t.readInt();for(;e>0;)this._fragment.push(new Os(t)),e--;return!0}get totalFragments(){return this._totalFragments}get fragmentNumber(){return this._fragmentNumber}get fragment(){return this._fragment}}class ys extends E{constructor(t){super(t,As)}getParser(){return this.parser}}class Cs{constructor(t){if(!t)throw new Error("invalid_wrapper");this._id=t.readInt(),this._name=t.readString()}get id(){return this._id}get name(){return this._name}}class Ms{flush(){return this._categories=[],this._removedFriendIds=[],this._addedFriends=[],this._updatedFriends=[],!0}parse(t){if(!t)return!1;let e=t.readInt();for(;e>0;)this._categories.push(new Cs(t)),e--;let s=t.readInt();for(;s>0;){const e=t.readInt();-1===e?this._removedFriendIds.push(t.readInt()):0===e?this._updatedFriends.push(new Os(t)):1===e&&this._addedFriends.push(new Os(t)),s--}return!0}get categories(){return this._categories}get removedFriendIds(){return this._removedFriendIds}get addedFriends(){return this._addedFriends}get updatedFriends(){return this._updatedFriends}}class Ds extends E{constructor(t){super(t,Ms)}getParser(){return this.parser}}class Ns{flush(){return this._typeCode=-1,this._avatarId=0,this._message=null,!0}parse(t){return!!t&&(this._typeCode=t.readInt(),this._avatarId=t.readInt(),this._message=t.readString(),!0)}get typeCode(){return this._typeCode}get avatarId(){return this._avatarId}get message(){return this._message}}class ws extends E{constructor(t){super(t,Ns)}getParser(){return this.parser}}class Us{constructor(t){if(!t)throw new Error("invalid_wrapper");this._requestId=t.readInt(),this._requesterName=t.readString(),this._figureString=t.readString(),this._requesterUserId=this._requestId}get requestId(){return this._requestId}get requesterName(){return this._requesterName}get requesterUserId(){return this._requesterUserId}get figureString(){return this._figureString}}class Ls{flush(){return this._totalRequests=0,this._requests=[],!0}parse(t){if(!t)return!1;this._totalRequests=t.readInt();let e=t.readInt();for(;e>0;)this._requests.push(new Us(t)),e--;return!0}get totalRequests(){return this._totalRequests}get requests(){return this._requests}}class Ps extends E{constructor(t){super(t,Ls)}getParser(){return this.parser}}class xs{constructor(t){if(!t)throw new Error("invalid_wrapper");this._avatarId=t.readInt(),this._avatarName=t.readString(),this._avatarMotto=t.readString(),this._isAvatarOnline=t.readBoolean(),this._canFollow=t.readBoolean(),this._avatarGender=t.readInt(),this._avatarFigure=t.readString(),this._lastOnlineData=t.readString(),this._realName=t.readString()}get avatarId(){return this._avatarId}get avatarName(){return this._avatarName}get avatarMotto(){return this._avatarMotto}get isAvatarOnline(){return this._isAvatarOnline}get canFollow(){return this._canFollow}get avatarGender(){return this._avatarGender}get avatarFigure(){return this._avatarFigure}get lastOnlineData(){return this._lastOnlineData}get realName(){return this._realName}}class Fs{flush(){return this._friends=[],this._others=[],!0}parse(t){if(!t)return!1;let e=t.readInt();for(;e>0;)this._friends.push(new xs(t)),e--;let s=t.readInt();for(;s>0;)this._others.push(new xs(t)),s--;return!0}get friends(){return this._friends}get others(){return this._others}}class Gs extends E{constructor(t){super(t,Fs)}getParser(){return this.parser}}class Vs{flush(){return this._errorCode=0,this._userId=0,this._message=null,!0}parse(t){return!!t&&(this._errorCode=t.readInt(),this._userId=t.readInt(),this._message=t.readString(),!0)}get errorCode(){return this._errorCode}get userId(){return this._userId}get message(){return this._message}}class Ys extends E{constructor(t){super(t,Vs)}getParser(){return this.parser}}class ks{flush(){return this._clientMessageId=0,this._errorCode=0,!0}parse(t){return!!t&&(this._clientMessageId=t.readInt(),this._errorCode=t.readInt(),!0)}get clientMessageId(){return this._clientMessageId}get errorCode(){return this._errorCode}}class js extends E{constructor(t){super(t,ks)}getParser(){return this.parser}}class Bs{flush(){return this._userFriendLimit=0,this._normalFriendLimit=0,this._extendedFriendLimit=0,this._categories=[],!0}parse(t){if(!t)return!1;this._userFriendLimit=t.readInt(),this._normalFriendLimit=t.readInt(),this._extendedFriendLimit=t.readInt();const e=t.readInt();for(;e>0;)this._categories.push(new Cs(t));return!0}get userFriendLimit(){return this._userFriendLimit}get normalFriendLimit(){return this._normalFriendLimit}get extendedFriendLimit(){return this._extendedFriendLimit}get categories(){return this._categories}}class Hs extends E{constructor(t){super(t,Bs)}getParser(){return this.parser}}class Ws{flush(){return!0}parse(t){return!!t}}class Zs extends E{constructor(t){super(t,Ws)}getParser(){return this.parser}}class zs{flush(){return this._senderId=0,this._messageText=null,this._secondsSinceSent=0,this._extraData=null,!0}parse(t){return!!t&&(this._senderId=t.readInt(),this._messageText=t.readString(),this._secondsSinceSent=t.readInt(),t.bytesAvailable&&(this._extraData=t.readString()),!0)}get senderId(){return this._senderId}get messageText(){return this._messageText}get secondsSinceSent(){return this._secondsSinceSent}get extraData(){return this._extraData}}class Xs extends E{constructor(t){super(t,zs)}getParser(){return this.parser}}class Ks{flush(){return this._request=null,!0}parse(t){return!!t&&(this._request=new Us(t),!0)}get request(){return this._request}}class qs extends E{constructor(t){super(t,Ks)}getParser(){return this.parser}}class Js{flush(){return this._errorCode=0,this._failedRecipients=[],!0}parse(t){if(!t)return!1;this._errorCode=t.readInt();let e=t.readInt();for(;e>0;)this._failedRecipients.push(t.readInt()),e--;return!0}get errorCode(){return this._errorCode}get failedRecipients(){return this._failedRecipients}}class Qs extends E{constructor(t){super(t,Js)}getParser(){return this.parser}}class $s{flush(){return this._senderId=0,this._messageText=null,!0}parse(t){return!!t&&(this._senderId=t.readInt(),this._messageText=t.readString(),!0)}get senderId(){return this._senderId}get messageText(){return this._messageText}}class ti extends E{constructor(t){super(t,$s)}getParser(){return this.parser}}class ei{flush(){return this._gameTypeId=0,this._url=null,this._gameClientId=null,!0}parse(t){return!!t&&(this._gameTypeId=t.readInt(),this._gameClientId=t.readString(),this._url=t.readString(),!0)}get gameTypeId(){return this._gameTypeId}get url(){return this._url}get gameClientId(){return this._gameClientId}}class si extends E{constructor(t){super(t,ei)}getParser(){return this.parser}}class ii{flush(){return this._resultType=0,this._messageText=null,!0}parse(t){return!!t&&(this._resultType=t.readInt(),this._messageText=t.readString(),!0)}get resultType(){return this._resultType}get messageText(){return this._messageText}}class ri extends E{constructor(t){super(t,ii)}getParser(){return this.parser}}let ni=(()=>{class t{}return t.ACHIEVEMENT_LIST=305,t.AUTHENTICATED=2491,t.AVAILABILITY_STATUS=2033,t.BUILDERS_CLUB_EXPIRED=1452,t.CAMERA_PRICE=3878,t.CAMERA_THUMBNAIL_SAVED=3595,t.CAMERA_URL=3696,t.CATALOG_CLUB=2405,t.CATALOG_MODE=3828,t.CATALOG_PAGE=804,t.CATALOG_PAGES=1032,t.CATALOG_PURCHASE=869,t.CATALOG_PURCHASE_FAILED=1404,t.CATALOG_PURCHASE_UNAVAILABLE=3770,t.CATALOG_SEARCH=3388,t.CATALOG_SOLD_OUT=377,t.CATALOG_UPDATED=1866,t.CFH_RESULT_MESSAGE=934,t.CLIENT_LATENCY=10,t.CLIENT_PING=3928,t.DESKTOP_CAMPAIGN=1745,t.DESKTOP_NEWS=286,t.DESKTOP_VIEW=122,t.DISCOUNT_CONFIG=2347,t.FIRST_LOGIN_OF_DAY=793,t.FURNITURE_ALIASES=1723,t.FURNITURE_DATA=2547,t.FURNITURE_FLOOR=1778,t.FURNITURE_FLOOR_ADD=1534,t.FURNITURE_FLOOR_REMOVE=2703,t.FURNITURE_FLOOR_UPDATE=3776,t.FURNITURE_ITEMDATA=2202,t.FURNITURE_STATE=2376,t.GAME_CENTER_ACHIEVEMENTS=2265,t.GAME_CENTER_GAME_LIST=222,t.GAME_CENTER_STATUS=2893,t.GENERIC_ALERT=3801,t.GENERIC_ALERT_LINK=2030,t.GENERIC_ERROR=1600,t.GIFT_CONFIG=2234,t.GROUP_BADGES=2402,t.GROUP_CREATE_OPTIONS=2159,t.GROUP_FORUM_INFO=3011,t.GROUP_FORUM_LIST=3001,t.GROUP_FORUM_THREADS=1073,t.GROUP_INFO=1702,t.GROUP_LIST=420,t.GROUP_MEMBER=265,t.GROUP_MEMBERS=1200,t.GROUP_MEMBERS_REFRESH=2445,t.GROUP_SETTINGS=3965,t.ITEM_DIMMER_SETTINGS=2710,t.ITEM_STACK_HELPER=2816,t.ITEM_WALL=1369,t.ITEM_WALL_ADD=2187,t.ITEM_WALL_REMOVE=3208,t.ITEM_WALL_UPDATE=2009,t.LOAD_GAME_URL=2624,t.MARKETPLACE_CONFIG=1823,t.MESSENGER_ACCEPT_FRIENDS=896,t.MESSENGER_CHAT=1587,t.MESSENGER_FIND_FRIENDS=1210,t.MESSENGER_FOLLOW_FAILED=3048,t.MESSENGER_FRIEND_NOTIFICATION=3082,t.MESSENGER_FRIENDS=3130,t.MESSENGER_INIT=1605,t.MESSENGER_INSTANCE_MESSAGE_ERROR=3359,t.MESSENGER_INVITE=3870,t.MESSENGER_INVITE_ERROR=462,t.MESSENGER_MESSAGE_ERROR=892,t.MESSENGER_MINIMAIL_COUNT=2803,t.MESSENGER_MINIMAIL_NEW=1911,t.MESSENGER_RELATIONSHIPS=2016,t.MESSENGER_REQUEST=2219,t.MESSENGER_REQUEST_ERROR=892,t.MESSENGER_REQUESTS=280,t.MESSENGER_ROOM_INVITE=3870,t.MESSENGER_SEARCH=973,t.MESSENGER_UPDATE=2800,t.MODERATION_REPORT_DISABLED=1651,t.MODERATION_TOOL=2696,t.MODERATION_TOPICS=325,t.MODERATION_USER_INFO=2866,t.MOTD_MESSAGES=2035,t.NAVIGATOR_CATEGORIES=1562,t.NAVIGATOR_COLLAPSED=1543,t.NAVIGATOR_EVENT_CATEGORIES=3244,t.NAVIGATOR_LIFTED=3104,t.NAVIGATOR_METADATA=3052,t.NAVIGATOR_OPEN_ROOM_CREATOR=2064,t.NAVIGATOR_SEARCH=2690,t.NAVIGATOR_SEARCHES=3984,t.NAVIGATOR_SETTINGS=518,t.NOTIFICATION_LIST=1992,t.PET_FIGURE_UPDATE=1924,t.PET_INFO=2901,t.RECYCLER_PRIZES=3164,t.ROOM_BAN_LIST=1869,t.ROOM_BAN_REMOVE=3429,t.ROOM_CREATED=1304,t.ROOM_DOORBELL=2309,t.ROOM_DOORBELL_ACCEPTED=3783,t.ROOM_DOORBELL_REJECTED=878,t.ROOM_ENTER=758,t.ROOM_ENTER_ERROR=899,t.ROOM_FORWARD=160,t.ROOM_HEIGHT_MAP=2753,t.ROOM_HEIGHT_MAP_UPDATE=558,t.ROOM_INFO=687,t.ROOM_INFO_OWNER=749,t.ROOM_MODEL=1301,t.ROOM_MODEL_BLOCKED_TILES=3990,t.ROOM_MODEL_DOOR=1664,t.ROOM_MODEL_NAME=2031,t.ROOM_MUTE=2533,t.ROOM_MUTE_USER=826,t.ROOM_PAINT=2454,t.ROOM_PROMOTION=2274,t.ROOM_QUEUE_STATUS=2208,t.ROOM_RIGHTS=780,t.ROOM_RIGHTS_CLEAR=2392,t.ROOM_RIGHTS_LIST=1284,t.ROOM_RIGHTS_LIST_ADD=2088,t.ROOM_RIGHTS_LIST_REMOVE=1327,t.ROOM_RIGHTS_OWNER=339,t.ROOM_ROLLING=3207,t.ROOM_SCORE=482,t.ROOM_SETTINGS=1498,t.ROOM_SETTINGS_CHAT=1191,t.ROOM_SETTINGS_SAVE=948,t.ROOM_SETTINGS_SAVE_ERROR=1555,t.ROOM_SETTINGS_UPDATED=3297,t.ROOM_SPECTATOR=1033,t.ROOM_THICKNESS=3547,t.SECURITY_DEBUG=3284,t.SECURITY_MACHINE=1488,t.SECURITY_UNKNOWN2=2833,t.TRADE_ACCEPTED=2568,t.TRADE_CLOSED=1373,t.TRADE_COMPLETED=1001,t.TRADE_CONFIRMATION=2720,t.TRADE_LIST_ITEM=2024,t.TRADE_NOT_OPEN=3128,t.TRADE_OPEN=2505,t.TRADE_OPEN_FAILED=217,t.TRADE_OTHER_NOT_ALLOWED=2154,t.TRADE_YOU_NOT_ALLOWED=3058,t.UNIT=374,t.UNIT_CHANGE_NAME=2182,t.UNIT_CHAT=1446,t.UNIT_CHAT_SHOUT=1036,t.UNIT_CHAT_WHISPER=2704,t.UNIT_DANCE=2233,t.UNIT_EFFECT=1167,t.UNIT_EXPRESSION=1631,t.UNIT_HAND_ITEM=1474,t.UNIT_IDLE=1797,t.UNIT_INFO=3920,t.UNIT_NUMBER=2324,t.UNIT_REMOVE=2661,t.UNIT_STATUS=1640,t.UNIT_TYPING=1717,t.UNSEEN_ITEMS=2103,t.USER_ACHIEVEMENT_SCORE=1968,t.USER_BADGES=717,t.USER_BADGES_ADD=2493,t.USER_BADGES_CURRENT=1087,t.USER_BOT_ADD=1352,t.USER_BOT_REMOVE=233,t.USER_BOTS=3086,t.USER_CHANGE_NAME=118,t.USER_CLOTHING=1450,t.USER_CREDITS=3475,t.USER_CURRENCY=2018,t.USER_CURRENCY_UPDATE=2275,t.USER_EFFECTS=340,t.USER_FAVORITE_ROOM=2524,t.USER_FAVORITE_ROOM_COUNT=151,t.USER_FIGURE=2429,t.USER_FURNITURE=994,t.USER_FURNITURE_ADD=104,t.USER_FURNITURE_POSTIT_PLACED=1501,t.USER_FURNITURE_REFRESH=3151,t.USER_FURNITURE_REMOVE=159,t.USER_HOME_ROOM=2875,t.USER_IGNORED=126,t.USER_INFO=2725,t.USER_OUTFITS=3315,t.USER_PERKS=2586,t.USER_PERMISSIONS=411,t.USER_PET_ADD=2101,t.USER_PET_REMOVE=3253,t.USER_PETS=3522,t.USER_PROFILE=3898,t.USER_RESPECT=2815,t.USER_SANCTION_STATUS=3679,t.USER_SETTINGS=513,t.USER_SUBSCRIPTION=954,t.WIRED_ACTION=1434,t.WIRED_CONDITION=1108,t.WIRED_ERROR=156,t.WIRED_OPEN=1830,t.WIRED_REWARD=178,t.WIRED_SAVE=1155,t.WIRED_TRIGGER=383,t.PLAYING_GAME=448,t.FURNITURE_STATE_2=3431,t.REMOVE_BOT_FROM_INVENTORY=233,t.ADD_BOT_TO_INVENTORY=1352,t.ACHIEVEMENT_PROGRESSED=2107,t})();class ai{constructor(t){if(!t)throw new Error("invalid_parser");this._id=t.readInt(),this._name=t.readString(),this._motto=t.readString(),this._gender=t.readString(),this._figure=t.readString()}get id(){return this._id}get name(){return this._name}get motto(){return this._motto}get figure(){return this._figure}get gender(){return this._gender}}class oi{flush(){return this._item=null,this._openInventory=!1,!0}parse(t){return!!t&&(this._item=new ai(t),this._openInventory=t.readBoolean(),!0)}get item(){return this._item}openInventory(){return this._openInventory}}class ci extends E{constructor(t){super(t,oi)}getParser(){return this.parser}}class _i{flush(){return this._items&&(this._items.dispose(),this._items=null),!0}parse(t){this._items=new X;let e=t.readInt();for(;e>0;){const s=new ai(t);this._items.add(s.id,s),e--}return!0}get items(){return this._items}}class hi extends E{constructor(t){super(t,_i)}getParser(){return this.parser}}class li{flush(){return this._itemId=0,!0}parse(t){return!!t&&(this._itemId=t.readInt(),!0)}get itemId(){return this._itemId}}class ui extends E{constructor(t){super(t,li)}getParser(){return this.parser}}class di{flush(){return this._figureSetIds=[],this._boundFurnitureNames=[],!0}parse(t){if(!t)return!1;let e=t.readInt();for(;e>0;)this._figureSetIds.push(t.readInt()),e--;let s=t.readInt();for(;s>0;)this._boundFurnitureNames.push(t.readString()),s--;return!0}get figureSetIds(){return this._figureSetIds}get boundsFurnitureNames(){return this._boundFurnitureNames}}class gi extends E{constructor(t){super(t,di)}getParser(){return this.parser}}let mi=(()=>{class t{}return t.UNIQUE_SET=256,t})();class pi{constructor(){this._flags=0,this._uniqueNumber=0,this._uniqueSeries=0}parseWrapper(t){(this._flags&mi.UNIQUE_SET)>0&&(this._uniqueNumber=t.readInt(),this._uniqueSeries=t.readInt())}initializeFromRoomObjectModel(t){this._uniqueNumber=t.getValue(st.FURNITURE_UNIQUE_SERIAL_NUMBER),this._uniqueSeries=t.getValue(st.FURNITURE_UNIQUE_EDITION_SIZE)}writeRoomObjectModel(t){t&&(t.setValue(st.FURNITURE_UNIQUE_SERIAL_NUMBER,this._uniqueNumber),t.setValue(st.FURNITURE_UNIQUE_EDITION_SIZE,this._uniqueSeries))}getLegacyString(){return""}compare(t){return!1}get state(){const t=parseInt(this.getLegacyString());return isNaN(t)?0:t}get isUnique(){return this._uniqueSeries>0}get uniqueNumber(){return this._uniqueNumber}get uniqueSeries(){return this._uniqueSeries}get flags(){return this._flags}set flags(t){this._flags=t}}let Ei=(()=>{class t{}return t.LEGACY_KEY=0,t.MAP_KEY=1,t.STRING_KEY=2,t.VOTE_KEY=3,t.EMPTY_KEY=4,t.NUMBER_KEY=5,t.HIGHSCORE_KEY=6,t.CRACKABLE_KEY=7,t})(),fi=(()=>{class t extends pi{constructor(){super(),this._state="",this._hits=0,this._target=0}parseWrapper(t){t&&(this._state=t.readString(),this._hits=t.readInt(),this._target=t.readInt(),super.parseWrapper(t))}initializeFromRoomObjectModel(t){super.initializeFromRoomObjectModel(t),this._state=t.getValue(st.FURNITURE_CRACKABLE_STATE),this._hits=t.getValue(st.FURNITURE_CRACKABLE_HITS),this._target=t.getValue(st.FURNITURE_CRACKABLE_TARGET)}writeRoomObjectModel(e){super.writeRoomObjectModel(e),e.setValue(st.FURNITURE_DATA_FORMAT,t.FORMAT_KEY),e.setValue(st.FURNITURE_CRACKABLE_STATE,this._state),e.setValue(st.FURNITURE_CRACKABLE_HITS,this._hits),e.setValue(st.FURNITURE_CRACKABLE_TARGET,this._target)}getLegacyString(){return this._state}compare(t){return!0}get hits(){return this._hits}get target(){return this._target}}return t.FORMAT_KEY=Ei.CRACKABLE_KEY,t})(),Si=(()=>{class t extends pi{parseWrapper(t){t&&(this._state="",super.parseWrapper(t))}writeRoomObjectModel(e){super.writeRoomObjectModel(e),e.setValue(st.FURNITURE_DATA_FORMAT,t.FORMAT_KEY)}getLegacyString(){return this._state}compare(t){return super.compare(t)}}return t.FORMAT_KEY=Ei.EMPTY_KEY,t})();class bi{constructor(){this._score=-1,this._users=[]}get score(){return this._score}set score(t){this._score=t}get users(){return this._users}set users(t){this._users=t}addUsername(t){this._users.push(t)}}let Ri=(()=>{class t extends pi{constructor(){super(),this._state="",this._scoreType=-1,this._clearType=-1,this._entries=[]}parseWrapper(t){if(!t)return;this._state=t.readString(),this._scoreType=t.readInt(),this._clearType=t.readInt();let e=t.readInt();for(;e>0;){const s=new bi;s.score=t.readInt();let i=t.readInt();for(;i>0;)s.addUsername(t.readString()),i--;this._entries.push(s),e--}super.parseWrapper(t)}initializeFromRoomObjectModel(t){this._scoreType=t.getValue(st.FURNITURE_HIGHSCORE_SCORE_TYPE),this._clearType=t.getValue(st.FURNITURE_HIGHSCORE_CLEAR_TYPE),this._entries=[];const e=t.getValue(st.FURNITURE_HIGHSCORE_DATA_ENTRY_COUNT);let s=0;for(;s<e;){const e=new bi;e.score=t.getValue(st.FURNITURE_HIGHSCORE_DATA_ENTRY_BASE_SCORE_+s),e.users=t.getValue(st.FURNITURE_HIGHSCORE_DATA_ENTRY_BASE_USERS_+s),this._entries.push(e),s++}super.initializeFromRoomObjectModel(t)}writeRoomObjectModel(e){if(super.writeRoomObjectModel(e),e.setValue(st.FURNITURE_DATA_FORMAT,t.FORMAT_KEY),e.setValue(st.FURNITURE_HIGHSCORE_SCORE_TYPE,this._scoreType),e.setValue(st.FURNITURE_HIGHSCORE_CLEAR_TYPE,this._clearType),this._entries){e.setValue(st.FURNITURE_HIGHSCORE_DATA_ENTRY_COUNT,this._entries.length);let t=0;for(;t<this._entries.length;){const s=this._entries[t];e.setValue(st.FURNITURE_HIGHSCORE_DATA_ENTRY_BASE_SCORE_+t,s.score),e.setValue(st.FURNITURE_HIGHSCORE_DATA_ENTRY_BASE_USERS_+t,s.users),t++}}}getLegacyString(){return this._state}get entries(){return this._entries}}return t.FORMAT_KEY=Ei.HIGHSCORE_KEY,t})(),Ii=(()=>{class t extends pi{constructor(){super(),this._data=""}parseWrapper(t){t&&(this._data=t.readString(),super.parseWrapper(t))}initializeFromRoomObjectModel(t){super.initializeFromRoomObjectModel(t),this._data=t.getValue(st.FURNITURE_DATA)}writeRoomObjectModel(e){super.writeRoomObjectModel(e),e.setValue(st.FURNITURE_DATA_FORMAT,t.FORMAT_KEY),e.setValue(st.FURNITURE_DATA,this._data)}getLegacyString(){return this._data}compare(t){return this._data===t.getLegacyString()}setString(t){this._data=t}}return t.FORMAT_KEY=Ei.LEGACY_KEY,t})(),vi=(()=>{class t extends pi{constructor(){super(),this._data={}}parseWrapper(t){if(!t)return;this._data={};const e=t.readInt();if(e)for(let s=0;s<e;s++)this._data[t.readString()]=t.readString();super.parseWrapper(t)}initializeFromRoomObjectModel(t){super.initializeFromRoomObjectModel(t),this._data=t.getValue(st.FURNITURE_DATA)||{}}writeRoomObjectModel(e){super.writeRoomObjectModel(e),e.setValue(st.FURNITURE_DATA_FORMAT,t.FORMAT_KEY),e.setValue(st.FURNITURE_DATA,this._data)}getLegacyString(){if(!this._data||!this._data.length)return"";const e=this._data[t.STATE];return null==e?"":e}compare(t){return!1}getValue(t){return this._data[t]}get data(){return this._data}}return t.FORMAT_KEY=Ei.MAP_KEY,t.STATE="state",t.RARITY="rarity",t})(),Ti=(()=>{class t extends pi{constructor(){super(),this._data=[]}parseWrapper(t){if(!t)return;this._data=[];const e=t.readInt();if(e)for(let s=0;s<e;s++)this._data.push(t.readInt());super.parseWrapper(t)}initializeFromRoomObjectModel(t){super.initializeFromRoomObjectModel(t),this._data=t.getValue(st.FURNITURE_DATA)}writeRoomObjectModel(e){super.writeRoomObjectModel(e),e.setValue(st.FURNITURE_DATA_FORMAT,t.FORMAT_KEY),e.setValue(st.FURNITURE_DATA,this._data)}getLegacyString(){return this._data&&this._data.length?this._data[t.STATE].toString():""}compare(e){if(!(e instanceof t))return!1;let s=0;for(;s<this._data.length;){if(0===s);else if(this._data[s]!==e.getValue(s))return!1;s++}return!0}getValue(t){if(!this._data||!this._data.length)return-1;const e=this._data[t];return null==e?-1:e}}return t.FORMAT_KEY=Ei.NUMBER_KEY,t.STATE=0,t})(),Oi=(()=>{class t extends pi{constructor(){super(),this._data=[]}parseWrapper(t){if(!t)return;this._data=[];const e=t.readInt();if(e)for(let s=0;s<e;s++)this._data.push(t.readString());super.parseWrapper(t)}initializeFromRoomObjectModel(t){super.initializeFromRoomObjectModel(t),this._data=t.getValue(st.FURNITURE_DATA)}writeRoomObjectModel(e){super.writeRoomObjectModel(e),e.setValue(st.FURNITURE_DATA_FORMAT,t.FORMAT_KEY),e.setValue(st.FURNITURE_DATA,this._data)}getLegacyString(){return this._data&&this._data.length?this._data[t.STATE]:""}compare(e){if(!(e instanceof t))return!1;let s=0;for(;s<this._data.length;){if(0===s);else if(this._data[s]!==e.getValue(s))return!1;s++}return!0}getValue(t){return this._data[t]||""}}return t.FORMAT_KEY=Ei.STRING_KEY,t.STATE=0,t})(),Ai=(()=>{class t extends pi{constructor(){super(),this._state="",this._result=0}parseWrapper(t){t&&(this._state=t.readString(),this._result=t.readInt(),super.parseWrapper(t))}writeRoomObjectModel(e){super.writeRoomObjectModel(e),e.setValue(st.FURNITURE_DATA_FORMAT,t.FORMAT_KEY);const s={};s.S=this._state,s.R=this._result.toString(),e.setValue(st.FURNITURE_DATA,s)}getLegacyString(){return this._state}compare(t){return!0}setString(t){this._state=t}get result(){return this._result}}return t.FORMAT_KEY=Ei.VOTE_KEY,t})();class yi{static getData(t){let e=null;switch(255&t){case fi.FORMAT_KEY:e=new fi;break;case Si.FORMAT_KEY:e=new Si;break;case Ri.FORMAT_KEY:e=new Ri;break;case Ii.FORMAT_KEY:e=new Ii;break;case vi.FORMAT_KEY:e=new vi;break;case Ti.FORMAT_KEY:e=new Ti;break;case Oi.FORMAT_KEY:e=new Oi;break;case Ai.FORMAT_KEY:e=new Ai}return e?(e.flags=65280&t,e):null}}class Ci{flush(){return this._itemId=0,this._data=null,!0}parse(t){return!!t&&(this._itemId=parseInt(t.readString()),this._data=Ci.parseObjectData(t),!0)}static parseObjectData(t){if(!t)return null;const e=yi.getData(t.readInt());return e?(e.parseWrapper(t),e):null}static parseWallStuffData(t){if(!t)return null;const e=new Ii;return e.setString(t.readString()),e}get furnitureId(){return this._itemId}get objectData(){return this._data}}let Mi=(()=>{class t{constructor(t){if(!t)throw new Error("invalid_wrapper");this.flush(),this.parse(t)}flush(){return this._rentable=!1,this._itemId=0,this._furniType=null,this._ref=0,this._spriteId=0,this._category=0,this._stuffData=null,this._isGroupable=!1,this._isRecyclable=!1,this._tradable=!1,this._sellable=!1,this._secondsToExpiration=0,this._Str_3182=0,this._flatId=0,this._isWallItem=!1,this._hasRentPeriodStarted=!1,this._Str_5390=0,this._slotId="",this._Str_2808=-1,!0}parse(e){return!!e&&(this._itemId=e.readInt(),this._furniType=e.readString(),this._ref=e.readInt(),this._spriteId=e.readInt(),this._category=e.readInt(),this._stuffData=Ci.parseObjectData(e),this._isRecyclable=e.readBoolean(),this._tradable=e.readBoolean(),this._isGroupable=e.readBoolean(),this._sellable=e.readBoolean(),this._secondsToExpiration=e.readInt(),this._Str_5390=um.instance.time,this.secondsToExpiration>-1?this._rentable=!0:(this._rentable=!1,this._secondsToExpiration=-1),this._hasRentPeriodStarted=e.readBoolean(),this._flatId=e.readInt(),this._isWallItem=this._furniType===t.WALL_ITEM,this._furniType===t.FLOOR_ITEM&&(this._slotId=e.readString(),this._Str_3182=e.readInt()),!0)}get itemId(){return this._itemId}get furniType(){return this._furniType}get ref(){return this._ref}get spriteId(){return this._spriteId}get category(){return this._category}get stuffData(){return this._stuffData}get isGroupable(){return this._isGroupable}get isRecycleable(){return this._isRecyclable}get tradable(){return this._tradable}get sellable(){return this._sellable}get secondsToExpiration(){return this._secondsToExpiration}get flatId(){return this._flatId}get slotId(){return this._slotId}get _Str_3951(){return this._Str_2808}get _Str_2794(){return this._Str_3182}get rentable(){return this._rentable}get isWallItem(){return this._isWallItem}get hasRentPeriodStarted(){return this._hasRentPeriodStarted}get _Str_10616(){return this._Str_5390}get _Str_8932(){return 0}get _Str_9050(){return 0}get _Str_9408(){return 0}get _Str_19297(){return!(-1===this._furniType.indexOf("external_image"))}}return t.WALL_ITEM="I",t.FLOOR_ITEM="S",t})();class Di{flush(){return this._items=[],!0}parse(t){return!!t&&(this._items.push(new Mi(t)),!0)}get items(){return this._items}}class Ni extends E{constructor(t){super(t,Di)}getParser(){return this.parser}}class wi{flush(){return this._totalFragments=0,this._fragmentNumber=0,this._fragment=new Map,!0}parse(t){if(!t)return!1;this._totalFragments=t.readInt(),this._fragmentNumber=t.readInt();let e=t.readInt();for(;e>0;){const s=new Mi(t);s&&this._fragment.set(s.itemId,s),e--}return!0}get totalFragments(){return this._totalFragments}get fragmentNumber(){return this._fragmentNumber}get fragment(){return this._fragment}}class Ui extends E{constructor(t){super(t,wi)}getParser(){return this.parser}}class Li{flush(){return!0}parse(t){return!!t}}class Pi extends E{constructor(t){super(t,Li)}getParser(){return this.parser}}class xi{flush(){return this._itemId=0,!0}parse(t){return!!t&&(this._itemId=t.readInt(),!0)}get itemId(){return this._itemId}}class Fi extends E{constructor(t){super(t,xi)}getParser(){return this.parser}}class Gi{flush(){return this._itemId=0,this._itemsLeft=0,!0}parse(t){return!!t&&(this._itemId=t.readInt(),this._itemsLeft=t.readInt(),!0)}get itemId(){return this._itemId}get itemsLeft(){return this._itemsLeft}}class Vi extends E{constructor(t){super(t,Gi)}getParser(){return this.parser}}class Yi{flush(){return this._userID=-1,this._userAccepts=!1,!0}parse(t){return!!t&&(this._userID=t.readInt(),this._userAccepts=t.readInt()>0,!0)}get _Str_4963(){return this._userID}get _Str_15794(){return this._userAccepts}}class ki extends E{constructor(t){super(t,Yi)}get _Str_4963(){return this.getParser()._Str_4963}get _Str_15794(){return this.getParser()._Str_15794}getParser(){return this.parser}}let ji=(()=>{class t{flush(){return!0}parse(t){return!!t&&(this._userId=t.readInt(),this._reason=t.readInt(),!0)}get _Str_4963(){return this._userId}get reason(){return this._reason}}return t._Str_16410=1,t})();class Bi extends E{constructor(t){super(t,ji)}get _Str_4963(){return this.getParser()._Str_4963}getParser(){return this.parser}}class Hi{flush(){return!0}parse(t){return!!t}}class Wi extends E{constructor(t){super(t,Hi)}getParser(){return this.parser}}class Zi{flush(){return!0}parse(t){return!!t}}class zi extends E{constructor(t){super(t,Zi)}getParser(){return this.parser}}class Xi{constructor(t){this._itemId=t.readInt(),this._furniType=t.readString().toUpperCase(),this._ref=t.readInt(),this._spriteId=t.readInt(),this._category=t.readInt(),this._isGroupable=t.readBoolean(),this._stuffData=Ci.parseObjectData(t),this._secondsToExpiration=-1,this._Str_5390=um.instance.time,this._hasRentPeriodStarted=!1,this._Str_9291=t.readInt(),this._Str_8744=t.readInt(),this._Str_9700=t.readInt(),this._Str_3182="S"===this.furniType?t.readInt():-1,this._flatId=-1,this._rentable=!1,this._isWallItem="I"===this._furniType}get itemId(){return this._itemId}get furniType(){return this._furniType}get ref(){return this._ref}get spriteId(){return this._spriteId}get category(){return this._category}get stuffData(){return this._stuffData}get _Str_2794(){return this._Str_3182}get secondsToExpiration(){return this._secondsToExpiration}get _Str_8932(){return this._Str_9291}get _Str_9050(){return this._Str_8744}get _Str_9408(){return this._Str_9700}get isGroupable(){return this._isGroupable}get _Str_3951(){return this._Str_3182}get flatId(){return this._flatId}get rentable(){return this._rentable}get isWallItem(){return this._isWallItem}get hasRentPeriodStarted(){return this._hasRentPeriodStarted}get _Str_10616(){return this._Str_5390}get isRecycleable(){return!0}get tradable(){return!0}get sellable(){return!0}get slotId(){return null}get _Str_19297(){return-1!==this._furniType.indexOf("external_image")}}class Ki{flush(){return this._firstUserID=-1,this._firstUserItemArray=null,this._firstUserNumItems=0,this._firstUserNumCredits=0,this._secondUserID=-1,this._secondUserItemArray=null,this._secondUserNumItems=0,this._secondUserNumCredits=0,!0}parse(t){return!(!t||(this._firstUserID=t.readInt(),this._firstUserItemArray=[],!this.parseItems(t,this._firstUserItemArray)||(this._firstUserNumItems=t.readInt(),this._firstUserNumCredits=t.readInt(),this._secondUserID=t.readInt(),this._secondUserItemArray=[],!this.parseItems(t,this._secondUserItemArray)||(this._secondUserNumItems=t.readInt(),this._secondUserNumCredits=t.readInt(),0))))}parseItems(t,e){let s=t.readInt();for(;s>0;)e.push(new Xi(t)),s--;return!0}get _Str_15162(){return this._firstUserID}get _Str_17841(){return this._firstUserItemArray}get _Str_14946(){return this._firstUserNumItems}get _Str_15709(){return this._firstUserNumCredits}get _Str_18215(){return this._secondUserID}get _Str_17465(){return this._secondUserItemArray}get _Str_13801(){return this._secondUserNumItems}get _Str_9138(){return this._secondUserNumCredits}}class qi extends E{constructor(t){super(t,Ki)}get _Str_15162(){return this.getParser()._Str_15162}get _Str_18215(){return this.getParser()._Str_18215}get _Str_14946(){return this.getParser()._Str_14946}get _Str_13801(){return this.getParser()._Str_13801}get _Str_15709(){return this.getParser()._Str_15709}get _Str_9138(){return this.getParser()._Str_9138}get _Str_17841(){return this.getParser()._Str_17841}get _Str_17465(){return this.getParser()._Str_17465}getParser(){return this.parser}}class Ji{flush(){return!0}parse(t){return!!t}}class Qi extends E{constructor(t){super(t,Ji)}getParser(){return this.parser}}class $i{flush(){return this._userId=-1,this._userCanTrade=!1,this._otherUserId=-1,this._otherUserCanTrade=!1,!0}parse(t){return!!t&&(this._userId=t.readInt(),this._userCanTrade=1===t.readInt(),this._otherUserId=t.readInt(),this._otherUserCanTrade=1===t.readInt(),!0)}get _Str_4963(){return this._userId}get _Str_16764(){return this._userCanTrade}get _Str_17613(){return this._otherUserId}get _Str_13374(){return this._otherUserCanTrade}}class tr extends E{constructor(t){super(t,$i)}get _Str_4963(){return this.getParser()._Str_4963}get _Str_16764(){return this.getParser()._Str_16764}get _Str_17613(){return this.getParser()._Str_17613}get _Str_13374(){return this.getParser()._Str_13374}getParser(){return this.parser}}let er=(()=>{class t{flush(){return!0}parse(t){return!!t&&(this._reason=t.readInt(),this._Str_10068=t.readString(),!0)}get reason(){return this._reason}get _Str_17035(){return this._Str_10068}}return t._Str_18150=7,t._Str_18383=8,t})();class sr extends E{constructor(t){super(t,er)}getParser(){return this.parser}}class ir{flush(){return!0}parse(t){return!!t}}class rr extends E{constructor(t){super(t,ir)}getParser(){return this.parser}}class nr{flush(){return!0}parse(t){return!!t}}class ar extends E{constructor(t){super(t,nr)}getParser(){return this.parser}}class or{flush(){return this._message=null,this._link=null,!0}parse(t){return!!t&&(this._message=t.readString(),this._link=t.readString(),!0)}get message(){return this._message}get link(){return this._link}}class cr extends E{constructor(t){super(t,or)}getParser(){return this.parser}}class _r{constructor(t){if(!t)throw new Error("invalid_wrapper");this.flush(),this.parse(t)}flush(){return this._id=-1,this._name=null,this._visible=!1,this._automatic=!1,this._automaticCategoryKey=null,this._globalCategoryKey=null,this._staffOnly=!1,!0}parse(t){return!!t&&(this._id=t.readInt(),this._name=t.readString(),this._visible=t.readBoolean(),this._automatic=t.readBoolean(),this._automaticCategoryKey=t.readString(),this._globalCategoryKey=t.readString(),this._staffOnly=t.readBoolean(),!0)}get id(){return this._id}get name(){return this._name}get visible(){return this._visible}get automatic(){return this._automatic}get automaticCategoryKey(){return this._automaticCategoryKey}get globalCategoryKey(){return this._globalCategoryKey}get staffOnly(){return this._staffOnly}}class hr{flush(){return this._categories=[],!0}parse(t){if(!t)return!1;let e=t.readInt();for(;e>0;)this._categories.push(new _r(t)),e--;return!0}get categories(){return this._categories}}class lr extends E{constructor(t){super(t,hr)}getParser(){return this.parser}}class ur{flush(){return this._categories=[],!0}parse(t){if(!t)return!1;let e=t.readInt();for(;e>0;)this._categories.push(t.readString()),e--;return!0}get categories(){return this._categories}}class dr extends E{constructor(t){super(t,ur)}getParser(){return this.parser}}class gr{constructor(t){if(!t)throw new Error("invalid_wrapper");this.flush(),this.parse(t)}flush(){return this._id=-1,this._name=null,this._visible=!1,!0}parse(t){return!!t&&(this._id=t.readInt(),this._name=t.readString(),this._visible=t.readBoolean(),!0)}get id(){return this._id}get name(){return this._name}get visible(){return this._visible}}class mr{flush(){return this._categories=[],!0}parse(t){if(!t)return!1;let e=t.readInt();for(;e>0;)this._categories.push(new gr(t)),e--;return!0}get categories(){return this._categories}}class pr extends E{constructor(t){super(t,mr)}getParser(){return this.parser}}class Er{flush(){return this._homeRoomId=-1,this._roomIdToEnter=-1,!0}parse(t){return!!t&&(this._homeRoomId=t.readInt(),this._roomIdToEnter=t.readInt(),!0)}get homeRoomId(){return this._homeRoomId}get roomIdToEnter(){return this._roomIdToEnter}}class fr extends E{constructor(t){super(t,Er)}getParser(){return this.parser}}class Sr{constructor(t){if(!t)throw new Error("invalid_wrapper");this.flush(),this.parse(t)}flush(){return this._roomId=-1,this._areaId=-1,this._image=null,this._caption=null,!0}parse(t){return!!t&&(this._roomId=t.readInt(),this._areaId=t.readInt(),this._image=t.readString(),this._caption=t.readString(),!0)}get roomId(){return this._roomId}get areaId(){return this._areaId}get image(){return this._image}get caption(){return this._caption}}class br{flush(){return this._rooms=[],!0}parse(t){if(!t)return!1;let e=t.readInt();for(;e>0;)this._rooms.push(new Sr(t)),e--;return!0}get rooms(){return this._rooms}}class Rr extends E{constructor(t){super(t,br)}getParser(){return this.parser}}class Ir{constructor(t){if(!t)throw new Error("invalid_wrapper");this.flush(),this.parse(t)}flush(){return this._id=-1,this._code=null,this._filter=null,this._localization=null,!0}parse(t){return!!t&&(this._id=t.readInt(),this._code=t.readString(),this._filter=t.readString(),this._localization=t.readString(),!0)}get id(){return this._id}get code(){return this._code}get filter(){return this._filter}get localization(){return this._localization}}class vr{constructor(t){if(!t)throw new Error("invalid_wrapper");this.flush(),this.parse(t)}flush(){return this._code=null,this._savedSearches=[],!0}parse(t){if(!t)return!1;this._code=t.readString();let e=t.readInt();for(;e>0;)this._savedSearches.push(new Ir(t)),e--;return!0}get code(){return this._code}get savedSearches(){return this._savedSearches}}class Tr{flush(){return this._topLevelContexts=[],!0}parse(t){if(!t)return!1;let e=t.readInt();for(;e>0;)this._topLevelContexts.push(new vr(t)),e--;return!0}get topLevelContexts(){return this._topLevelContexts}}class Or extends E{constructor(t){super(t,Tr)}getParser(){return this.parser}}class Ar{flush(){return!0}parse(t){return!!t}}class yr extends E{constructor(t){super(t,Ar)}getParser(){return this.parser}}class Cr{flush(){return this._searches=[],!0}parse(t){if(!t)return!1;let e=t.readInt();for(;e>0;)this._searches.push(new Ir(t)),e--;return!0}get searches(){return this._searches}}class Mr extends E{constructor(t){super(t,Cr)}getParser(){return this.parser}}let Dr=(()=>{class t{constructor(t){if(!t)throw new Error("invalid_wrapper");this.flush(),this.parse(t)}flush(){return this._roomId=0,this._roomName=null,this._ownerId=0,this._ownerName=null,this._doorMode=0,this._userCount=0,this._maxUserCount=0,this._description=null,this._tradeMode=2,this._score=0,this._ranking=0,this._categoryId=0,this._totalStars=0,this._groupId=0,this._groupName=null,this._groupBadge=null,this._tags=[],this._bitMask=0,this._thumbnail=null,this._allowPets=!1,this._showOwner=!0,this._displayAd=!1,this._adName=null,this._adDescription=null,this._adExpiresIn=0,this._allMuted=!1,this._canMute=!1,this._officialRoomPicRef=null,!0}parse(t){return!!t&&(this._roomId=t.readInt(),this._roomName=t.readString(),this._ownerId=t.readInt(),this._ownerName=t.readString(),this._doorMode=t.readInt(),this._userCount=t.readInt(),this._maxUserCount=t.readInt(),this._description=t.readString(),this._tradeMode=t.readInt(),this._score=t.readInt(),this._ranking=t.readInt(),this._categoryId=t.readInt(),this.parseTags(t),this.parseBitMask(t),!0)}parseTags(t){if(!t)return!1;this._tags=[];let e=t.readInt();for(;e>0;)this._tags.push(t.readString()),e--;return!0}parseBitMask(e){return!!e&&(this._bitMask=e.readInt(),this._bitMask&t.THUMBNAIL_BITMASK&&(this._officialRoomPicRef=e.readString()),this._bitMask&t.GROUPDATA_BITMASK&&(this._groupId=e.readInt(),this._groupName=e.readString(),this._groupBadge=e.readString()),this._bitMask&t.ROOMAD_BITMASK&&(this._adName=e.readString(),this._adDescription=e.readString(),this._adExpiresIn=e.readInt()),this._showOwner=(this._bitMask&t.SHOWOWNER_BITMASK)>0,this._allowPets=(this._bitMask&t.ALLOW_PETS_BITMASK)>0,this._displayAd=(this._bitMask&t.DISPLAY_ROOMAD_BITMASK)>0,this._thumbnail=null,!0)}get roomId(){return this._roomId}get roomName(){return this._roomName}get ownerId(){return this._ownerId}get ownerName(){return this._ownerName}get doorMode(){return this._doorMode}get userCount(){return this._userCount}get maxUserCount(){return this._maxUserCount}get description(){return this._description}get tradeMode(){return this._tradeMode}get score(){return this._score}get ranking(){return this._ranking}get categoryId(){return this._categoryId}get tags(){return this._tags}get officialRoomPicRef(){return this._officialRoomPicRef}get habboGroupId(){return this._groupId}get groupName(){return this._groupName}get groupBadgeCode(){return this._groupBadge}get roomAdName(){return this._adName}get roomAdDescription(){return this._adDescription}get roomAdExpiresInMin(){return this._adExpiresIn}get showOwner(){return this._showOwner}get allowPets(){return this._allowPets}get displayRoomEntryAd(){return this._displayAd}}return t.THUMBNAIL_BITMASK=1,t.GROUPDATA_BITMASK=2,t.ROOMAD_BITMASK=4,t.SHOWOWNER_BITMASK=8,t.ALLOW_PETS_BITMASK=16,t.DISPLAY_ROOMAD_BITMASK=32,t.OPEN_STATE=0,t.DOORBELL_STATE=1,t.PASSWORD_STATE=2,t})();class Nr{constructor(t){if(!t)throw new Error("invalid_wrapper");this.flush(),this.parse(t)}flush(){return this._code=null,this._data=null,this._action=-1,this._closed=!1,this._mode=-1,this._rooms=[],!0}parse(t){if(!t)return!1;this._code=t.readString(),this._data=t.readString(),this._action=t.readInt(),this._closed=t.readBoolean(),this._mode=t.readInt();let e=t.readInt();for(;e>0;)this._rooms.push(new Dr(t)),e--;return!0}get code(){return this._code}get data(){return this._data}get action(){return this._action}get closed(){return this._closed}get mode(){return this._mode}get rooms(){return this._rooms}}class wr{constructor(t){if(!t)throw new Error("invalid_wrapper");this.flush(),this.parse(t)}flush(){return this._code=null,this._data=null,this._results=[],!0}parse(t){if(!t)return!1;this._code=t.readString(),this._data=t.readString();let e=t.readInt();for(;e>0;)this._results.push(new Nr(t)),e--;return!0}get code(){return this._code}get data(){return this._data}get results(){return this._results}}class Ur{flush(){return this._result=null,!0}parse(t){return!!t&&(this._result=new wr(t),!0)}get result(){return this._result}}class Lr extends E{constructor(t){super(t,Ur)}getParser(){return this.parser}}class Pr{flush(){return this._windowX=0,this._windowY=0,this._windowWidth=0,this._windowHeight=0,this._leftPanelHidden=!1,this._resultsMode=0,!0}parse(t){return!!t&&(this._windowX=t.readInt(),this._windowY=t.readInt(),this._windowWidth=t.readInt(),this._windowHeight=t.readInt(),this._leftPanelHidden=t.readBoolean(),this._resultsMode=t.readInt(),!0)}get windowX(){return this._windowX}get windowY(){return this._windowY}get windowWidth(){return this._windowWidth}get windowHeight(){return this._windowHeight}get leftPanelHidden(){return this._leftPanelHidden}get resultsMode(){return this._resultsMode}}class xr extends E{constructor(t){super(t,Pr)}getParser(){return this.parser}}class Fr{flush(){return this._message=null,!0}parse(t){return!!t&&(this._message=t.readString(),!0)}get message(){return this._message}}class Gr extends E{constructor(t){super(t,Fr)}getParser(){return this.parser}}class Vr{flush(){return this._messages=[],!0}parse(t){if(!t)return!1;let e=t.readInt();for(;e>0;)this._messages.push(t.readString()),e--;return!0}get messages(){return this._messages}}class Yr extends E{constructor(t){super(t,Vr)}getParser(){return this.parser}}class kr{flush(){return this._type=null,this._parameters=new Map,!0}parse(t){if(!t)return!1;this._type=t.readString();let e=t.readInt();for(;e>0;)this._parameters.set(t.readString(),t.readString()),e--;return!0}get type(){return this._type}get parameters(){return this._parameters}}class jr extends E{constructor(t){super(t,kr)}getParser(){return this.parser}}class Br{flush(){return this._userId=0,this._respectsReceived=0,!0}parse(t){return!!t&&(this._userId=t.readInt(),this._respectsReceived=t.readInt(),!0)}get userId(){return this._userId}get respectsReceived(){return this._respectsReceived}}class Hr extends E{constructor(t){super(t,Br)}getParser(){return this.parser}}class Wr{flush(){return this._items=new X,!0}parse(t){if(!t)return!1;let e=t.readInt();for(;e>0;){const s=t.readInt();let i=t.readInt();const r=[];for(;i>0;)r.push(t.readInt()),i--;this._items.add(s,r),e--}return!0}getItemsByCategory(t){return this._items.getValue(t)}get categories(){return this._items.getKeys()}}class Zr extends E{constructor(t){super(t,Wr)}getParser(){return this.parser}}class zr{flush(){return this._userName=null,!0}parse(t){return!!t&&(this._userName=t.readString(),!0)}get userName(){return this._userName}}class Xr extends E{constructor(t){super(t,zr)}getParser(){return this.parser}}class Kr{flush(){return this._userName=null,!0}parse(t){return!!t&&(this._userName=t.readString(),!0)}get userName(){return this._userName}}class qr extends E{constructor(t){super(t,Kr)}getParser(){return this.parser}get userName(){return this.getParser().userName}}class Jr{flush(){return this._userName=null,!0}parse(t){return!!t&&(this._userName=t.readString(),!0)}get userName(){return this._userName}}class Qr extends E{constructor(t){super(t,Jr)}getParser(){return this.parser}}class $r{flush(){return!0}parse(t){return!!t}}class tn extends E{constructor(t){super(t,$r)}getParser(){return this.parser}}let en=(()=>{class t{}return t.NONE=0,t.GUEST=1,t.GUILD_MEMBER=2,t.GUILD_ADMIN=3,t.ROOM_OWNER=4,t.MODERATOR=5,t})();class sn{flush(){return this._controllerLevel=en.NONE,!0}parse(t){return!!t&&(this._controllerLevel=t.readInt(),!0)}get controllerLevel(){return this._controllerLevel}}class rn extends E{constructor(t){super(t,sn)}getParser(){return this.parser}}class nn{flush(){return!0}parse(t){return!!t}}class an extends E{constructor(t){super(t,nn)}getParser(){return this.parser}}let on=(()=>{class t{flush(){return this._reason=0,this._parameter="",!0}parse(t){return!!t&&(this._reason=t.readInt(),this._parameter=t.readString(),!0)}get reason(){return this._reason}get parameter(){return this._parameter}}return t.FULL_ERROR=1,t._Str_19431=2,t.QUEUE_ERROR=3,t.BANNED=4,t})();class cn extends E{constructor(t){super(t,on)}getParser(){return this.parser}}class _n{flush(){return!0}parse(t){return!!t}}class hn extends E{constructor(t){super(t,_n)}getParser(){return this.parser}}class ln{flush(){return this._roomId=0,!0}parse(t){return!!t&&(this._roomId=t.readInt(),!0)}get roomId(){return this._roomId}}class un extends E{constructor(t){super(t,ln)}getParser(){return this.parser}}let dn=(()=>{class t{constructor(t){if(!t)throw new Error("invalid_wrapper");this.flush(),this.parse(t)}flush(){return this._mode=0,this._weight=0,this._speed=0,this._distance=0,this._protection=0,!0}parse(t){return!!t&&(this._mode=t.readInt(),this._weight=t.readInt(),this._speed=t.readInt(),this._distance=t.readInt(),this._protection=t.readInt(),!0)}get mode(){return this._mode}get weight(){return this._weight}get speed(){return this._speed}get distance(){return this._distance}get protection(){return this._protection}}return t._Str_19408=0,t._Str_12787=1,t._Str_16907=0,t._Str_12581=1,t._Str_16484=2,t._Str_18404=0,t._Str_17874=1,t._Str_16469=2,t._Str_21099=0,t._Str_20763=1,t._Str_22060=2,t})();class gn{flush(){return this._chat=null,!0}parse(t){return!!t&&(this._chat=new dn(t),!0)}get chat(){return this._chat}}class mn extends E{constructor(t){super(t,gn)}getParser(){return this.parser}}let pn=(()=>{class t{constructor(t){this.reset(),this.parse(t)}reset(){this._allowMute=0,this._allowKick=0,this._allowBan=0}parse(t){this._allowMute=t.readInt(),this._allowKick=t.readInt(),this._allowBan=t.readInt()}get allowMute(){return this._allowMute}get allowKick(){return this._allowKick}get allowBan(){return this._allowBan}}return t._Str_10707=0,t._Str_5047=1,t._Str_11537=2,t})();class En{flush(){return this._roomEnter=!1,this._roomForward=!1,this._staffPick=!1,this._data=null,this._isGroupMember=!1,this._isMuted=!1,this._moderation=null,this._allowMuteAll=!1,this._chat=null,!0}parse(t){return!!t&&(this._roomEnter=t.readBoolean(),this._data=new Dr(t),this._roomForward=t.readBoolean(),this._staffPick=t.readBoolean(),this._isGroupMember=t.readBoolean(),this._isMuted=t.readBoolean(),this._moderation=new pn(t),this._allowMuteAll=t.readBoolean(),this._chat=new dn(t),!0)}get roomEnter(){return this._roomEnter}get roomForward(){return this._roomForward}get staffPick(){return this._staffPick}get data(){return this._data}get isGroupMember(){return this._isGroupMember}get isMuted(){return this._isMuted}get moderation(){return this._moderation}get allowMuteAll(){return this._allowMuteAll}get chat(){return this._chat}}class fn extends E{constructor(t){super(t,En)}getParser(){return this.parser}}class Sn{flush(){return this._roomId=0,this._isOwner=!1,!0}parse(t){return!!t&&(this._roomId=t.readInt(),this._isOwner=t.readBoolean(),!0)}get roomId(){return this._roomId}get isOwner(){return this._isOwner}}class bn extends E{constructor(t){super(t,Sn)}getParser(){return this.parser}}class Rn{flush(){return this._totalLikes=0,this._canLike=!1,!0}parse(t){return!!t&&(this._totalLikes=t.readInt(),this._canLike=t.readBoolean(),!0)}get totalLikes(){return this._totalLikes}get canLike(){return this._canLike}}class In extends E{constructor(t){super(t,Rn)}getParser(){return this.parser}}class vn{flush(){return this._roomId=0,this._code=0,this._message=null,!0}parse(t){return!!t&&(this._roomId=t.readInt(),this._code=t.readInt(),this._message=t.readString(),!0)}get roomId(){return this._roomId}get code(){return this._code}get message(){return this._message}}class Tn extends E{constructor(t){super(t,vn)}getParser(){return this.parser}}class On{flush(){return this._roomId=0,!0}parse(t){return!!t&&(this._roomId=t.readInt(),this._name=t.readString(),this._description=t.readString(),this._state=t.readInt(),this._categoryId=t.readInt(),this._userCount=t.readInt(),this._maxUserCount=t.readInt(),this.parseTags(t),this._allowPets=t.readInt(),this._allowPetsEat=t.readInt(),this._allowWalkthrough=t.readInt(),this._hideWalls=t.readInt(),this._thicknessWall=t.readInt(),this._thicknessFloor=t.readInt(),this._chat=new dn(t),this._moderation=new pn(t),!0)}parseTags(t){if(!t)return!1;this._tags=[];let e=t.readInt();for(;e>0;)this._tags.push(t.readString()),e--;return!0}get roomId(){return this._roomId}}class An extends E{constructor(t){super(t,On)}getParser(){return this.parser}}class yn{flush(){return this._roomId=0,!0}parse(t){return!!t&&(this._roomId=t.readInt(),!0)}get roomId(){return this._roomId}}class Cn extends E{constructor(t){super(t,yn)}getParser(){return this.parser}}class Mn{flush(){return this._roomId=0,!0}parse(t){return!!t&&(this._roomId=t.readInt(),!0)}get roomId(){return this._roomId}}class Dn extends E{constructor(t){super(t,Mn)}getParser(){return this.parser}}let Nn=(()=>{class t{constructor(t,e,s,i=null){this._id=t,this._location=e,this._targetLocation=s,this._movementType=i}get id(){return this._id}get location(){return this._location}get targetLocation(){return this._targetLocation}get movementType(){return this._movementType}}return t.MOVE="mv",t.SLIDE="sld",t})();class wn{flush(){return this._rollerId=0,this._itemsRolling=[],this._unitRolling=null,!0}parse(t){if(!t)return;const e=t.readInt(),s=t.readInt(),i=t.readInt(),r=t.readInt();let n=t.readInt();for(;n>0;){const a=t.readInt(),o=parseFloat(t.readString()),c=parseFloat(t.readString()),_=new Nn(a,new ot(e,s,o),new ot(i,r,c));this._itemsRolling.push(_),n--}if(this._rollerId=t.readInt(),!t.bytesAvailable)return!0;const a=t.readInt(),o=t.readInt(),c=parseFloat(t.readString()),_=parseFloat(t.readString());switch(a){case 0:break;case 1:this._unitRolling=new Nn(o,new ot(e,s,c),new ot(i,r,_),Nn.MOVE);break;case 2:this._unitRolling=new Nn(o,new ot(e,s,c),new ot(i,r,_),Nn.SLIDE)}return!0}get rollerId(){return this._rollerId}get itemsRolling(){return this._itemsRolling}get unitRolling(){return this._unitRolling}}class Un extends E{constructor(t){super(t,wn)}getParser(){return this.parser}}class Ln{flush(){return this._roomId=-1,this._roomName=null,!0}parse(t){if(t)return this._roomId=t.readInt(),this._roomName=t.readString(),!0}get roomId(){return this._roomId}get roomName(){return this._roomName}}class Pn extends E{constructor(t){super(t,Ln)}getParser(){return this.parser}}class xn{constructor(t){if(!t)throw new Error("invalid_wrapper");this.flush(),this.parse(t)}flush(){return this._itemId=0,this._spriteId=0,this._spriteName=null,this._x=0,this._y=0,this._direction=0,this._z=0,this._stackHeight=0,this._type=0,this._data=null,this._state=0,this._expires=0,this._usagePolicy=0,this._userId=0,this._username=null,!0}parse(t){return!!t&&(this._itemId=t.readInt(),this._spriteId=t.readInt(),this._x=t.readInt(),this._y=t.readInt(),this._direction=t.readInt()%8*45,this._z=parseFloat(t.readString()),this._stackHeight=parseFloat(t.readString()),this._type=t.readInt(),this._data=Ci.parseObjectData(t),this._state=parseFloat(this._data&&this._data.getLegacyString())||0,this._expires=t.readInt(),this._usagePolicy=t.readInt(),this._userId=t.readInt(),this._username=null,this._spriteId<0&&(this._spriteName=t.readString()),!0)}get itemId(){return this._itemId}get spriteId(){return this._spriteId}get x(){return this._x}get y(){return this._y}get direction(){return this._direction}get z(){return isNaN(this._z)?0:this._z}get stackHeight(){return isNaN(this._stackHeight)?0:this._stackHeight}get type(){return this._type}get data(){return this._data}get state(){return this._state}get expires(){return this._expires}get usagePolicy(){return this._usagePolicy}get userId(){return this._userId}get username(){return this._username}set username(t){this._username=t}get spriteName(){return this._spriteName}set spriteName(t){this._spriteName=t}}class Fn{flush(){return this._item=null,!0}parse(t){return!!t&&(this._item=new xn(t),this._item.username=t.readString(),!0)}get item(){return this._item}}class Gn extends E{constructor(t){super(t,Fn)}getParser(){return this.parser}}class Vn{flush(){return this._owners=new Map,this._items=[],!0}parse(t){if(!t)return!1;if(!this.parseOwners(t))return!1;let e=t.readInt();for(;e>0;){const s=new xn(t);if(!s)continue;const i=this._owners.get(s.userId);i&&(s.username=i),this._items.push(s),e--}return!0}parseOwners(t){if(!t)return!1;let e=t.readInt();for(;e>0;)this._owners.set(t.readInt(),t.readString()),e--;return!0}get owners(){return this._owners}get items(){return this._items}}class Yn extends E{constructor(t){super(t,Vn)}getParser(){return this.parser}}class kn{flush(){return this._itemId=0,this._isExpired=!0,this._userId=0,this._delay=0,!0}parse(t){return!!t&&(this._itemId=parseInt(t.readString()),this._isExpired=t.readBoolean(),this._userId=t.readInt(),this._delay=t.readInt(),!0)}get itemId(){return this._itemId}get isExpired(){return this._isExpired}get userId(){return this._userId}get delay(){return this._delay}}class jn extends E{constructor(t){super(t,kn)}getParser(){return this.parser}}class Bn{flush(){return this._item=null,!0}parse(t){return!!t&&(this._item=new xn(t),!0)}get item(){return this._item}}class Hn extends E{constructor(t){super(t,Bn)}getParser(){return this.parser}}class Wn{flush(){return this._aliases=new Map,!0}parse(t){if(!t)return!1;let e=t.readInt();for(;e>0;)this._aliases.set(t.readString(),t.readString()),e--;return!0}get aliases(){return this._aliases}}class Zn extends E{constructor(t){super(t,Wn)}getParser(){return this.parser}}class zn extends E{constructor(t){super(t,Ci)}getParser(){return this.parser}}class Xn{flush(){return this._itemId=0,this._data="",!0}parse(t){return!!t&&(this._itemId=parseInt(t.readString()),this._data=t.readString(),!0)}get furnitureId(){return this._itemId}get data(){return this._data}}class Kn extends E{constructor(t){super(t,Xn)}getParser(){return this.parser}}class qn{flush(){return this._furniId=-1,this._height=0,!0}parse(t){return!!t&&(this._furniId=t.readInt(),this._height=t.readInt()/100,!0)}get furniId(){return this._furniId}get height(){return this._height}}class Jn extends E{constructor(t){super(t,qn)}getParser(){return this.parser}}class Qn{flush(){return this._itemId=0,this._value=0,!0}parse(t){return!!t&&(this._itemId=t.readInt(),this._value=t.readInt(),!0)}get itemId(){return this._itemId}get value(){return this._value}}class $n extends E{constructor(t){super(t,Qn)}getParser(){return this.parser}}class ta{flush(){return this._itemId=0,this._state=0,!0}parse(t){return!!t&&(this._itemId=t.readInt(),this._state=t.readInt(),!0)}get itemId(){return this._itemId}get state(){return this._state}}class ea extends E{constructor(t){super(t,ta)}getParser(){return this.parser}}class sa{constructor(t){if(!t)throw new Error("invalid_wrapper");this.flush(),this.parse(t)}flush(){return this._itemId=0,this._spriteId=0,this._location=null,this._stuffData=null,this._state=0,this._secondsToExpiration=0,this._usagePolicy=-1,this._userId=0,this._username=null,this._width=0,this._height=0,this._localX=0,this._localY=0,this._y=0,this._z=0,this._direction=null,this._Str_19875=!1,!0}parse(t){if(!t)return!1;this._itemId=parseInt(t.readString()),this._spriteId=t.readInt(),this._location=t.readString(),this._stuffData=t.readString(),this._secondsToExpiration=t.readInt(),this._usagePolicy=t.readInt(),this._userId=t.readInt(),this._username=null;const e=parseFloat(this._stuffData);if(isNaN(e)||(this._state=e),0===this._location.indexOf(":")){this._Str_19875=!1;let t=this._location.split(" ");if(t.length>=3){let e=t[0],s=t[1];const i=t[2];if(e.length>3&&s.length>2&&(e=e.substr(3),s=s.substr(2),t=e.split(","),t.length>=2)){const e=parseInt(t[0]),r=parseInt(t[1]);if(t=s.split(","),t.length>=2){const s=parseInt(t[0]),n=parseInt(t[1]);this._width=e,this._height=r,this._localX=s,this._localY=n,this._direction=i}}}}else this._Str_19875=!0;return!0}get itemId(){return this._itemId}get spriteId(){return this._spriteId}get wallPosition(){return this._location}get stuffData(){return this._stuffData}get state(){return this._state}get secondsToExpiration(){return this._secondsToExpiration}get usagePolicy(){return this._usagePolicy}get userId(){return this._userId}get username(){return this._username}set username(t){this._username=t}get width(){return this._width}get height(){return this._height}get localX(){return this._localX}get localY(){return this._localY}get direction(){return this._direction}get _Str_22379(){return this._Str_19875}}class ia{flush(){return this._item=null,!0}parse(t){return!!t&&(this._item=new sa(t),this._item.username=t.readString(),!0)}get item(){return this._item}}class ra extends E{constructor(t){super(t,ia)}getParser(){return this.parser}}class na{flush(){return this._owners=new Map,this._items=[],!0}parse(t){if(!t)return!1;if(!this.parseOwners(t))return!1;let e=t.readInt();for(;e>0;){const s=new sa(t);if(!s)continue;const i=this._owners.get(s.userId);i&&(s.username=i),this._items.push(s),e--}return!0}parseOwners(t){if(!t)return!1;let e=t.readInt();for(;e>0;)this._owners.set(t.readInt(),t.readString()),e--;return!0}get owners(){return this._owners}get items(){return this._items}}class aa extends E{constructor(t){super(t,na)}getParser(){return this.parser}}class oa{flush(){return this._itemId=0,this._userId=0,!0}parse(t){return!!t&&(this._itemId=parseInt(t.readString()),this._userId=t.readInt(),!0)}get itemId(){return this._itemId}get userId(){return this._userId}}class ca extends E{constructor(t){super(t,oa)}getParser(){return this.parser}}class _a{flush(){return this._item=null,!0}parse(t){return!!t&&(this._item=new sa(t),this._item.username=t.readString(),!0)}get item(){return this._item}}class ha extends E{constructor(t){super(t,_a)}getParser(){return this.parser}}class la{flush(){return this._x=0,this._y=0,this._direction=0,!0}parse(t){return!!t&&(this._x=t.readInt(),this._y=t.readInt(),this._direction=t.readInt(),!0)}get x(){return this._x}get y(){return this._y}get direction(){return this._direction}}class ua extends E{constructor(t){super(t,la)}getParser(){return this.parser}}class da{static decodeTileHeight(t){return t<0?-1:(16383&t)/256}static decodeIsStackingBlocked(t){return!!(16384&t)}static decodeIsRoomTile(t){return t>=0}getTileHeight(t,e){return t<0||t>=this._width||e<0||e>=this._height?-1:da.decodeTileHeight(this._heights[e*this._width+t])}getStackingBlocked(t,e){return t<0||t>=this._width||e<0||e>=this._height||da.decodeIsStackingBlocked(this._heights[e*this._width+t])}isRoomTile(t,e){return!(t<0||t>=this._width||e<0||e>=this._height)&&da.decodeIsRoomTile(this._heights[e*this._width+t])}flush(){return this._width=0,this._height=0,this._heights=[],!0}parse(t){if(!t)return!1;this._width=t.readInt();const e=t.readInt();this._height=e/this._width;let s=0;for(;s<e;)this._heights[s]=t.readShort(),s++;return!0}get width(){return this._width}get height(){return this._height}get heights(){return this._heights}}class ga extends E{constructor(t){super(t,da)}getParser(){return this.parser}}class ma{flush(){return this._wrapper=null,this._count=0,this._x=0,this._y=0,this._value=0,!0}tileHeight(){return da.decodeTileHeight(this._value)}isStackingBlocked(){return da.decodeIsStackingBlocked(this._value)}isRoomTile(){return da.decodeIsRoomTile(this._value)}next(){return!!this._count&&(this._count--,this._x=this._wrapper.readByte(),this._y=this._wrapper.readByte(),this._value=this._wrapper.readShort(),!0)}parse(t){return!!t&&(this._wrapper=t,this._count=t.readByte(),!0)}get x(){return this._x}get y(){return this._y}get height(){return this._value}}class pa extends E{constructor(t){super(t,ma)}getParser(){return this.parser}}class Ea{constructor(t,e,s,i){this._x=t,this._y=e,this._width=s,this._height=i}get x(){return this._x}get y(){return this._y}get width(){return this._width}get height(){return this._height}}class fa{constructor(){this._width=0,this._height=0,this._wallHeight=0,this._fixedWallsHeight=0,this._tileMap=[],this._holeMap=[],this._doors=[],this._dimensions={minX:0,maxX:0,minY:0,maxY:0},this._restrictsDragging=!1,this._restrictedScale=1,this._restrictsScaling=!1}get width(){return this._width}set width(t){this._width=t}get height(){return this._height}set height(t){this._height=t}get wallHeight(){return this._wallHeight}set wallHeight(t){this._wallHeight=t}get fixedWallsHeight(){return this._fixedWallsHeight}set fixedWallsHeight(t){this._fixedWallsHeight=t}get tileMap(){return this._tileMap}get holeMap(){return this._holeMap}get doors(){return this._doors}get dimensions(){return this._dimensions}get restrictsDragging(){return this._restrictsDragging}set restrictsDragging(t){this._restrictsDragging=t}get restrictsScaling(){return this._restrictsScaling}set restrictsScaling(t){this._restrictsScaling=t}get restrictedScale(){return this._restrictedScale}set restrictedScale(t){this._restrictedScale=t}}class Sa{constructor(t,e,s,i){this._leftSideLoc=0,this._rightSideLoc=0,this._leftSideLength=0,this._rightSideLength=0,this._leftSideLoc=t,this._rightSideLoc=e,this._leftSideLength=s,this._rightSideLength=i}get _Str_5120(){return this._leftSideLoc}get _Str_4659(){return this._rightSideLoc}get _Str_9124(){return this._leftSideLength}get _Str_12156(){return this._rightSideLength}}let ba=(()=>{class t{constructor(t,e,s,i,r){let n,a,o,c,_,h,l,u;if(this._type=0,this._loc=null,this._leftSide=null,this._rightSide=null,this._normal=null,this._normalDirection=null,this._secondaryNormals=[],this._masks=[],this._loc=new ot,this._loc.assign(e),this._leftSide=new ot,this._leftSide.assign(s),this._rightSide=new ot,this._rightSide.assign(i),this._type=t,null!=s&&null!=i&&(this._normal=ot.crossProduct(s,i),n=0,a=0,o=0,c=0,_=0,0!=this.normal.x||0!=this.normal.y?(c=this.normal.x,_=this.normal.y,n=360+Math.atan2(_,c)/Math.PI*180,n>=360&&(n-=360),c=Math.sqrt(this.normal.x*this.normal.x+this.normal.y*this.normal.y),_=this.normal.z,a=360+Math.atan2(_,c)/Math.PI*180,a>=360&&(a-=360)):a=this.normal.z<0?90:270,this._normalDirection=new ot(n,a,0)),null!=r&&r.length>0)for(h=0;h<r.length;)l=r[h],null!=l&&l.length>0&&(u=new ot,u.assign(l),u.multiply(1/u.length),this._secondaryNormals.push(u)),h++}get type(){return this._type}get loc(){return this._loc}get _Str_5424(){return this._leftSide}get _Str_4968(){return this._rightSide}get normal(){return this._normal}get _Str_25207(){return this._normalDirection}get _Str_20277(){return this._secondaryNormals.length}get _Str_6845(){return this._masks.length}_Str_22585(t){if(t<0||t>=this._Str_20277)return null;const e=new ot;return e.assign(this._secondaryNormals[t]),e}addMask(t,e,s,i){const r=new Sa(t,e,s,i);this._masks.push(r)}_Str_8361(t){return t<0||t>=this._Str_6845?null:this._masks[t]}_Str_25133(t){const e=this._Str_8361(t);return null!=e?e._Str_5120:-1}_Str_23609(t){const e=this._Str_8361(t);return null!=e?e._Str_4659:-1}_Str_25097(t){const e=this._Str_8361(t);return null!=e?e._Str_9124:-1}_Str_25617(t){const e=this._Str_8361(t);return null!=e?e._Str_12156:-1}}return t.PLANE_UNDEFINED=0,t.PLANE_FLOOR=1,t.PLANE_WALL=2,t.PLANE_LANDSCAPE=3,t.PLANE_BILLBOARD=4,t})(),Ra=(()=>{class t{constructor(){this._corners=[],this._endPoints=[],this._directions=[],this._lengths=[],this._leftTurns=[],this._borders=[],this._hideWalls=[],this._manuallyLeftCut=[],this._manuallyRightCut=[],this._addDuplicates=!1,this._count=0}_Str_17862(t,e,s,i,r){(this._addDuplicates||this._Str_22484(t,e,s,i,r))&&(this._corners.push(t),this._directions.push(e),this._lengths.push(s),this._borders.push(i),this._leftTurns.push(r),this._hideWalls.push(!1),this._manuallyLeftCut.push(!1),this._manuallyRightCut.push(!1),this._count++)}_Str_22484(t,e,s,i,r){let n=0;for(;n<this._count;){if(this._corners[n].x==t.x&&this._corners[n].y==t.y&&this._directions[n]==e&&this._lengths[n]==s&&this._borders[n]==i&&this._leftTurns[n]==r)return!1;n++}return!0}get count(){return this._count}_Str_10778(t){return this._corners[t]}_Str_19138(t){return this._Str_23674(),this._endPoints[t]}_Str_13743(t){return this._lengths[t]}getDirection(t){return this._directions[t]}_Str_25208(t){return this._borders[t]}_Str_10019(t){return this._hideWalls[t]}_Str_17084(t){return this._leftTurns[t]}_Str_25455(t){return this._manuallyLeftCut[t]}_Str_24163(t){return this._manuallyRightCut[t]}_Str_15901(t,e){this._hideWalls[t]=e}_Str_24531(t,e){e<this._lengths[t]&&(this._lengths[t]=e,this._manuallyRightCut[t]=!0)}_Str_23976(e,s){let i;if(s>0&&s<this._lengths[e]){const r=this._corners[e];i=t.WALL_DIRECTION_VECTORS[this.getDirection(e)],this._corners[e]=new A.j(r.x+s*i.x,r.y+s*i.y),this._lengths[e]=this._lengths[e]-s,this._manuallyLeftCut[e]=!0}}_Str_23674(){let e,s,i,r,n;if(this._endPoints.length!=this.count)for(this._endPoints=[],e=0;e<this.count;)s=this._Str_10778(e),i=new A.j(s.x,s.y),r=t.WALL_DIRECTION_VECTORS[this.getDirection(e)],n=this._Str_13743(e),i.x=i.x+r.x*n,i.y=i.y+r.y*n,this._endPoints.push(i),e++}}return t.WALL_DIRECTION_VECTORS=[new ot(1,0,0),new ot(0,1,0),new ot(-1,0,0),new ot(0,-1,0)],t.WALL_NORMAL_VECTORS=[new ot(0,1,0),new ot(-1,0,0),new ot(0,-1,0),new ot(1,0,0)],t})(),Ia=(()=>{class t{constructor(){this._width=0,this._height=0,this._minX=0,this._maxX=0,this._minY=0,this._maxY=0,this._fixedWallHeight=-1,this._floorHeight=0,this._restrictsScaling=!1,this._restrictedScale=1,this._tileMatrix=[],this._tileMatrixOriginal=[],this._planes=[],this._floorHoleMatrix=[],this._wallHeight=3.6,this._wallThicknessMultiplier=1,this._floorThicknessMultiplier=1,this._floorHoles=new Map}static getFloorHeight(t){const e=t.length;if(!e)return 0;let s=0,i=0;for(;i<e;){const e=t[i];let r=0;for(;r<e.length;){const t=e[r];t>s&&(s=t),r++}i++}return s}static findEntranceTile(t){if(!t)return null;const e=t.length;if(!e)return null;const s=[];let i=0;for(;i<e;){const e=t[i];if(!e||!e.length)return null;let r=0;for(;r<e.length;){if(e[r]>=0){s.push(r);break}r++}s.length<i+1&&s.push(e.length+1),i++}for(i=1;i<s.length-1;){if(Math.trunc(s[i])<=Math.trunc(s[i-1])-1&&Math.trunc(s[i])<=Math.trunc(s[i+1])-1)return new A.j(Math.trunc(0|s[i]),i);i++}return null}static expandFloorTiles(t){let e,s,i,r,n,a,o,c,_,h,l,u;const d=t.length,g=t[0].length,m=[];for(s=0;s<4*d;)m[s]=[],s++;let p=0;for(s=0;s<d;){for(n=0,e=0;e<g;){if(a=t[s][e],a<0||a<=255)for(r=0;r<4;){for(i=0;i<4;)void 0===m[p+r]&&(m[p+r]=[]),m[p+r][n+i]=a<0?a:4*a,i++;r++}else{for(o=4*(255&a),c=o+3*(a>>11&1),_=o+3*(a>>10&1),h=o+3*(a>>9&1),l=o+3*(a>>8&1),i=0;i<3;)u=i+1,m[p][n+i]=(c*(3-i)+_*i)/3,m[p+3][n+u]=(h*(3-u)+l*u)/3,m[p+u][n]=(c*(3-u)+h*u)/3,m[p+i][n+3]=(_*(3-i)+l*i)/3,i++;m[p+1][n+1]=c>o?o+2:o+1,m[p+1][n+2]=_>o?o+2:o+1,m[p+2][n+1]=h>o?o+2:o+1,m[p+2][n+2]=l>o?o+2:o+1}n+=4,e++}p+=4,s++}return m}static addTileTypes(t){let e,s,i,r,n,a,o,c,_,h,l,u,d,g;const m=t.length-1,p=t[0].length-1;for(s=1;s<m;){for(e=1;e<p;)i=t[s][e],i<0||(r=255&t[s-1][e-1],n=255&t[s-1][e],a=255&t[s-1][e+1],o=255&t[s][e-1],c=255&t[s][e+1],_=255&t[s+1][e-1],h=255&t[s+1][e],l=255&t[s+1][e+1],u=i+1,d=i-1,g=(r==u||n==u||o==u?8:0)|(a==u||n==u||c==u?4:0)|(_==u||h==u||o==u?2:0)|(l==u||h==u||c==u?1:0),15==g&&(g=0),t[s][e]=i|g<<8),e++;s++}}static unpadHeightMap(t){t.shift(),t.pop();for(const e of t)e.shift(),e.pop()}static padHeightMap(e){const s=[],i=[];for(const r of e)r.push(t.TILE_BLOCKED),r.unshift(t.TILE_BLOCKED);for(const r of e[0])s.push(t.TILE_BLOCKED),i.push(t.TILE_BLOCKED);e.push(i),e.unshift(s)}get minX(){return this._minX}get maxX(){return this._maxX}get minY(){return this._minY}get maxY(){return this._maxY}get tileMapWidth(){return this._width}get tileMapHeight(){return this._height}get planeCount(){return this._planes.length}get floorHeight(){return-1!=this._fixedWallHeight?this._fixedWallHeight:this._floorHeight}get wallHeight(){return-1!=this._fixedWallHeight?this._fixedWallHeight+3.6:this._wallHeight}set wallHeight(t){t<0&&(t=0),this._wallHeight=t}get wallThicknessMultiplier(){return this._wallThicknessMultiplier}set wallThicknessMultiplier(t){t<0&&(t=0),this._wallThicknessMultiplier=t}get floorThicknessMultiplier(){return this._floorThicknessMultiplier}set floorThicknessMultiplier(t){t<0&&(t=0),this._floorThicknessMultiplier=t}dispose(){this._planes=null,this._tileMatrix=null,this._tileMatrixOriginal=null,this._floorHoleMatrix=null,null!=this._floorHoles&&(this._floorHoles.clear(),this._floorHoles=null)}reset(){this._planes=[],this._tileMatrix=[],this._tileMatrixOriginal=[],this._width=0,this._height=0,this._minX=0,this._maxX=0,this._minY=0,this._maxY=0,this._floorHeight=0,this._floorHoleMatrix=[]}initializeTileMap(e,s){e<0&&(e=0),s<0&&(s=0),this._tileMatrix=[],this._tileMatrixOriginal=[],this._floorHoleMatrix=[];let i=0;for(;i<s;){const s=[],r=[],n=[];let a=0;for(;a<e;)s[a]=t.TILE_BLOCKED,r[a]=t.TILE_BLOCKED,n[a]=!1,a++;this._tileMatrix.push(s),this._tileMatrixOriginal.push(r),this._floorHoleMatrix.push(n),i++}return this._width=e,this._height=s,this._minX=this._width,this._maxX=-1,this._minY=this._height,this._maxY=-1,!0}setTileHeight(t,e,s){let i,r,n,a,o;if(t>=0&&t<this._width&&e>=0&&e<this._height){if(i=this._tileMatrix[e],i[t]=s,s>=0)t<this._minX&&(this._minX=t),t>this._maxX&&(this._maxX=t),e<this._minY&&(this._minY=e),e>this._maxY&&(this._maxY=e);else{if(t==this._minX||t==this._maxX){for(r=!1,n=this._minY;n<this._maxY;){if(this.getTileHeightInternal(t,n)>=0){r=!0;break}n++}r||(t==this._minX&&this._minX++,t==this._maxX&&this._maxX--)}if(e==this._minY||e==this._maxY){for(a=!1,o=this._minX;o<this._maxX;){if(this.getTileHeight(o,e)>=0){a=!0;break}o++}a||(e==this._minY&&this._minY++,e==this._maxY&&this._maxY--)}}return!0}return!1}getTileHeight(e,s){if(e<0||e>=this._width||s<0||s>=this._height)return t.TILE_BLOCKED;const i=this._tileMatrix[s];return void 0===i[e]?0:Math.abs(i[e])}getTileHeightOriginal(e,s){return e<0||e>=this._width||s<0||s>=this._height?t.TILE_BLOCKED:this._floorHoleMatrix[s][e]?t.TILE_HOLE:this._tileMatrixOriginal[s][e]}getTileHeightInternal(e,s){return e<0||e>=this._width||s<0||s>=this._height?t.TILE_BLOCKED:this._tileMatrix[s][e]}initializeFromTileData(e=-1){let s,i;for(this._fixedWallHeight=e,i=0;i<this._height;){for(s=0;s<this._width;)void 0===this._tileMatrixOriginal[i]&&(this._tileMatrixOriginal[i]=[]),this._tileMatrixOriginal[i][s]=this._tileMatrix[i][s],s++;i++}const r=t.findEntranceTile(this._tileMatrix);for(i=0;i<this._height;){for(s=0;s<this._width;)void 0===this._floorHoleMatrix[i]&&(this._floorHoleMatrix[i]=[]),this._floorHoleMatrix[i][s]&&this.setTileHeight(s,i,t.TILE_HOLE),s++;i++}return this.initialize(r)}initialize(e){let s=0;null!=e&&(s=this.getTileHeight(e.x,e.y),this.setTileHeight(e.x,e.y,t.TILE_BLOCKED)),this._floorHeight=t.getFloorHeight(this._tileMatrix),this.createWallPlanes();const i=[];for(const t of this._tileMatrix)i.push(t.concat());t.padHeightMap(i),t.addTileTypes(i),t.unpadHeightMap(i);const r=t.expandFloorTiles(i);return this.extractPlanes(r),null!=e&&(this.setTileHeight(e.x,e.y,s),this.addFloor(new ot(e.x+.5,e.y+.5,s),new ot(-1,0,0),new ot(0,-1,0),!1,!1,!1,!1)),!0}generateWallData(t,e){let s,i,r,n,a;const o=new Ra,c=[this.extractTopWall.bind(this),this.extractRightWall.bind(this),this.extractBottomWall.bind(this),this.extractLeftWall.bind(this)];let _=0,h=new A.j(t.x,t.y),l=0;for(;l++<1e3;){if(s=!1,i=!1,r=_,(h.x<this.minX||h.x>this.maxX||h.y<this.minY||h.y>this.maxY)&&(s=!0),n=c[_](h,e),null==n)return null;if(a=Math.abs(n.x-h.x)+Math.abs(n.y-h.y),h.x==n.x||h.y==n.y?(_=(_-1+c.length)%c.length,a+=1,i=!0):(_=(_+1)%c.length,a--),o._Str_17862(h,r,a,s,i),n.x==t.x&&n.y==t.y&&(n.x!=h.x||n.y!=h.y))break;h=n}return 0==o.count?null:o}hidePeninsulaWallChains(t){let e,s,i,r,n=0;const a=t.count;for(;n<a;){const o=n;for(e=n,s=0,i=!1;!t._Str_25208(n)&&n<a;)t._Str_17084(n)?s++:s>0&&s--,s>1&&(i=!0),e=n,n++;if(i)for(r=o;r<=e;)t._Str_15901(r,!0),r++;n++}}updateWallsNextToHoles(e){let s,i,r,n,a,o,c;const _=e.count;let h=0;for(;h<_;){if(!e._Str_10019(h)){for(s=e._Str_10778(h),i=e.getDirection(h),r=e._Str_13743(h),n=Ra.WALL_DIRECTION_VECTORS[i],a=Ra.WALL_NORMAL_VECTORS[i],o=0,c=0;c<r;){if(this.getTileHeightInternal(s.x+c*n.x-a.x,s.y+c*n.y-a.y)==t.TILE_HOLE){if(c>0&&0==o){e._Str_24531(h,c);break}o++}else if(o>0){e._Str_23976(h,o);break}c++}o==r&&e._Str_15901(h,!0)}h++}}resolveOriginalWallIndex(t,e,s){let i,r,n,a,o,c;const _=Math.min(t.y,e.y),h=Math.max(t.y,e.y),l=Math.min(t.x,e.x),u=Math.max(t.x,e.x),d=s.count;let g=0;for(;g<d;){if(i=s._Str_10778(g),r=s._Str_19138(g),t.x==e.x){if(i.x==t.x&&r.x==t.x&&(n=Math.min(i.y,r.y),a=Math.max(i.y,r.y),n<=_&&h<=a))return g}else if(t.y==e.y&&i.y==t.y&&r.y==t.y&&(o=Math.min(i.x,r.x),c=Math.max(i.x,r.x),o<=l&&u<=c))return g;g++}return-1}hideOriginallyHiddenWalls(t,e){let s,i,r,n,a;const o=t.count;let c=0;for(;c<o;)t._Str_10019(c)||(s=t._Str_10778(c),i=new A.j(s.x,s.y),r=Ra.WALL_DIRECTION_VECTORS[t.getDirection(c)],n=t._Str_13743(c),i.x=i.x+r.x*n,i.y=i.y+r.y*n,a=this.resolveOriginalWallIndex(s,i,e),a>=0?e._Str_10019(a)&&t._Str_15901(c,!0):t._Str_15901(c,!0)),c++}checkWallHiding(t,e){this.hidePeninsulaWallChains(e),this.updateWallsNextToHoles(t),this.hideOriginallyHiddenWalls(t,e)}addWalls(e,s){const i=e.count,r=s.count;let n=0;for(;n<i;){if(!e._Str_10019(n)){const a=e._Str_10778(n),o=e.getDirection(n),c=e._Str_13743(n),_=Ra.WALL_DIRECTION_VECTORS[o],h=Ra.WALL_NORMAL_VECTORS[o];let l=-1,u=0;for(;u<c;){const t=this.getTileHeightInternal(a.x+u*_.x+h.x,a.y+u*_.y+h.y);t>=0&&(t<l||l<0)&&(l=t),u++}let d=new ot(a.x,a.y,l);d=ot.sum(d,ot.product(h,.5)),d=ot.sum(d,ot.product(_,-.5));const g=this.wallHeight+Math.min(t.MAX_WALL_ADDITIONAL_HEIGHT,this.floorHeight)-l,m=ot.product(_,-c),p=new ot(0,0,g);d=ot.dif(d,m);const E=this.resolveOriginalWallIndex(a,e._Str_19138(n),s);let f=0,S=0;E>=0?(f=s.getDirection((E+1)%r),S=s.getDirection((E-1+r)%r)):(f=e.getDirection((n+1)%i),S=e.getDirection((n-1+i)%i));let b=null;(f-o+4)%4==3?b=Ra.WALL_NORMAL_VECTORS[f]:(o-S+4)%4==3&&(b=Ra.WALL_NORMAL_VECTORS[S]);const R=e._Str_17084(n),I=e._Str_17084((n-1+i)%i),v=e._Str_10019((n+1)%i),T=e._Str_25455(n),O=e._Str_24163(n);this.addWall(d,m,p,b,!I||T,!R||O,!v)}n++}}createWallPlanes(){let e,s;const i=this._tileMatrix;if(null==i)return!1;let r,n,a;const o=i.length;let c=0;if(0==o)return!1;for(r=0;r<o;){if(a=i[r],null==a||0==a.length)return!1;c=c>0?Math.min(c,a.length):a.length,r++}const _=Math.min(t.MAX_WALL_ADDITIONAL_HEIGHT,-1!=this._fixedWallHeight?this._fixedWallHeight:t.getFloorHeight(i)),h=this.minX;let l=this.minY;for(l=this.minY;l<=this.maxY;){if(this.getTileHeightInternal(h,l)>t.TILE_HOLE){l--;break}l++}if(l>this.maxY)return!1;const u=new A.j(h,l),d=this.generateWallData(u,!0),g=this.generateWallData(u,!1);for(null!=d&&(e=d.count,s=g.count,this.checkWallHiding(d,g),this.addWalls(d,g)),n=0;n<this.tileMapHeight;){for(r=0;r<this.tileMapWidth;)this.getTileHeightInternal(r,n)<0&&this.setTileHeight(r,n,-(_+this.wallHeight)),r++;n++}return!0}extractTopWall(e,s){if(null==e)return null;let i=1,r=t.TILE_HOLE;for(s||(r=t.TILE_BLOCKED);i<1e3;){if(this.getTileHeightInternal(e.x+i,e.y)>r)return new A.j(e.x+i-1,e.y);if(this.getTileHeightInternal(e.x+i,e.y+1)<=r)return new A.j(e.x+i,e.y+1);i++}return null}extractRightWall(e,s){if(null==e)return null;let i=1,r=t.TILE_HOLE;for(s||(r=t.TILE_BLOCKED);i<1e3;){if(this.getTileHeightInternal(e.x,e.y+i)>r)return new A.j(e.x,e.y+(i-1));if(this.getTileHeightInternal(e.x-1,e.y+i)<=r)return new A.j(e.x-1,e.y+i);i++}return null}extractBottomWall(e,s){if(null==e)return null;let i=1,r=t.TILE_HOLE;for(s||(r=t.TILE_BLOCKED);i<1e3;){if(this.getTileHeightInternal(e.x-i,e.y)>r)return new A.j(e.x-(i-1),e.y);if(this.getTileHeightInternal(e.x-i,e.y-1)<=r)return new A.j(e.x-i,e.y-1);i++}return null}extractLeftWall(e,s){if(null==e)return null;let i=1,r=t.TILE_HOLE;for(s||(r=t.TILE_BLOCKED);i<1e3;){if(this.getTileHeightInternal(e.x,e.y-i)>r)return new A.j(e.x,e.y-(i-1));if(this.getTileHeightInternal(e.x+1,e.y-i)<=r)return new A.j(e.x+1,e.y-i);i++}return null}addWall(e,s,i,r,n,a,o){this.addPlane(ba.PLANE_WALL,e,s,i,[r]);const c=t.WALL_THICKNESS*this._wallThicknessMultiplier,_=t.FLOOR_THICKNESS*this._floorThicknessMultiplier,h=ot.crossProduct(s,i),l=ot.product(h,1/h.length*-c);if(this.addPlane(ba.PLANE_WALL,ot.sum(e,i),s,l,[h,r]),n&&this.addPlane(ba.PLANE_WALL,ot.sum(ot.sum(e,s),i),ot.product(i,-(i.length+_)/i.length),l,[h,r]),a&&(this.addPlane(ba.PLANE_WALL,ot.sum(e,ot.product(i,-_/i.length)),ot.product(i,(i.length+_)/i.length),l,[h,r]),o)){const t=ot.product(s,c/s.length);this.addPlane(ba.PLANE_WALL,ot.sum(ot.sum(e,i),ot.product(t,-1)),t,l,[h,s,r])}}addFloor(e,s,i,r,n,a,o){let c,_,h;null!=this.addPlane(ba.PLANE_FLOOR,e,s,i)&&(c=t.FLOOR_THICKNESS*this._floorThicknessMultiplier,_=new ot(0,0,c),h=ot.dif(e,_),a&&this.addPlane(ba.PLANE_FLOOR,h,s,_),o&&this.addPlane(ba.PLANE_FLOOR,ot.sum(h,ot.sum(s,i)),ot.product(s,-1),_),r&&this.addPlane(ba.PLANE_FLOOR,ot.sum(h,i),ot.product(i,-1),_),n&&this.addPlane(ba.PLANE_FLOOR,ot.sum(h,s),i,_))}initializeFromMapData(t){if(!t)return!1;this.reset(),this.resetFloorHoles();const e=t.wallHeight,s=t.fixedWallsHeight;if(this.initializeTileMap(t.width,t.height),t.tileMap){let e=0;for(;e<t.tileMap.length;){const s=t.tileMap[e];if(s){let t=0;for(;t<s.length;){const i=s[t];i&&this.setTileHeight(t,e,i.height),t++}}e++}}if(t.holeMap&&t.holeMap.length){let e=0;for(;e<t.holeMap.length;){const s=t.holeMap[e];s&&(this.addFloorHole(s.id,s.x,s.y,s.width,s.height),e++)}this.initializeHoleMap()}return this.wallHeight=e,this.restrictsDragging=t.restrictsDragging,this.restrictsScaling=t.restrictsScaling,this.restrictedScale=t.restrictedScale,this.initializeFromTileData(s),!0}addPlane(t,e,s,i,r=null){if(0==s.length||0==i.length)return null;const n=new ba(t,e,s,i,r);return this._planes.push(n),n}getMapData(){const t=new fa;t.width=this._width,t.height=this._height,t.wallHeight=this._wallHeight,t.fixedWallsHeight=this._fixedWallHeight,t.dimensions.minX=this.minX,t.dimensions.maxX=this.maxX,t.dimensions.minY=this.minY,t.dimensions.maxY=this.maxY,t.restrictsDragging=this.restrictsDragging,t.restrictsScaling=this.restrictsScaling,t.restrictedScale=this.restrictedScale;let e=0;for(;e<this._height;){const s=[],i=this._tileMatrixOriginal[e];let r=0;for(;r<this._width;)s.push({height:i[r]}),r++;t.tileMap.push(s),e++}for(const[s,i]of this._floorHoles.entries())i&&t.holeMap.push({id:s,x:i.x,y:i.y,width:i.width,height:i.height});return t}getPlaneLocation(t){if(t<0||t>=this.planeCount)return null;const e=this._planes[t];return e?e.loc:null}getPlaneNormal(t){if(t<0||t>=this.planeCount)return null;const e=this._planes[t];return e?e.normal:null}getPlaneLeftSide(t){if(t<0||t>=this.planeCount)return null;const e=this._planes[t];return e?e._Str_5424:null}getPlaneRightSide(t){if(t<0||t>=this.planeCount)return null;const e=this._planes[t];return e?e._Str_4968:null}getPlaneNormalDirection(t){if(t<0||t>=this.planeCount)return null;const e=this._planes[t];return e?e._Str_25207:null}getPlaneSecondaryNormals(t){let e,s;if(t<0||t>=this.planeCount)return null;const i=this._planes[t];if(null!=i){for(e=[],s=0;s<i._Str_20277;)e.push(i._Str_22585(s)),s++;return e}return null}getPlaneType(t){if(t<0||t>=this.planeCount)return ba.PLANE_UNDEFINED;const e=this._planes[t];return e?e.type:ba.PLANE_UNDEFINED}getPlaneMaskCount(t){if(t<0||t>=this.planeCount)return 0;const e=this._planes[t];return e?e._Str_6845:0}getPlaneMaskLeftSideLoc(t,e){if(t<0||t>=this.planeCount)return-1;const s=this._planes[t];return s?s._Str_25133(e):-1}getPlaneMaskRightSideLoc(t,e){if(t<0||t>=this.planeCount)return-1;const s=this._planes[t];return s?s._Str_23609(e):-1}getPlaneMaskLeftSideLength(t,e){if(t<0||t>=this.planeCount)return-1;const s=this._planes[t];return s?s._Str_25097(e):-1}getPlaneMaskRightSideLength(t,e){if(t<0||t>=this.planeCount)return-1;const s=this._planes[t];return s?s._Str_25617(e):-1}addFloorHole(t,e,s,i,r){this.removeFloorHole(t),this._floorHoles.set(t,new Ea(e,s,i,r))}removeFloorHole(t){this._floorHoles.delete(t)}resetFloorHoles(){this._floorHoles.clear()}initializeHoleMap(){let t,e,s,i,r,n,a,o;for(e=0;e<this._height;){for(s=this._floorHoleMatrix[e],t=0;t<this._width;)s[t]=!1,t++;e++}for(const c of this._floorHoles.values())if(i=c,null!=i)for(r=i.x,n=i.x+i.width-1,a=i.y,o=i.y+i.height-1,r=r<0?0:r,n=n>=this._width?this._width-1:n,a=a<0?0:a,o=o>=this._height?this._height-1:o,e=a;e<=o;){for(s=this._floorHoleMatrix[e],t=r;t<=n;)s[t]=!0,t++;e++}}extractPlanes(t){let e,s,i,r,n,a,o,c,_,h,l,u,d,g,m;const p=t.length,E=t[0].length,f=[];let S=0;for(;S<p;)f[S]=[],S++;let b=0;for(;b<p;){for(e=0;e<E;){if(s=t[b][e],s<0||f[b][e]);else{for(n=0==e||!(t[b][e-1]==s),a=0==b||!(t[b-1][e]==s),i=e+1;i<E&&!(t[b][i]!=s||f[b][i]||b>0&&t[b-1][i]==s==a);)i++;for(o=i==E||!(t[b][i]==s),l=!1,r=b+1;r<p&&!l;){for(c=!(t[r][e]==s),l=c||e>0&&t[r][e-1]==s==n||i<E&&t[r][i]==s==o,_=e;_<i;){if(t[r][_]==s==c){l=!0,i=_;break}_++}if(l)break;r++}for(c=c||r==p,o=i==E||!(t[b][i]==s),h=b;h<r;){for(_=e;_<i;)f[h][_]=!0,_++;h++}u=e/4-.5,d=b/4-.5,g=(i-e)/4,m=(r-b)/4,this.addFloor(new ot(u+g,d+m,s/4),new ot(-g,0,0),new ot(0,-m,0),o,n,c,a)}e++}b++}}get restrictsDragging(){return this._restrictsDragging}set restrictsDragging(t){this._restrictsDragging=t}get restrictsScaling(){return this._restrictsScaling}set restrictsScaling(t){this._restrictsScaling=t}get restrictedScale(){return this._restrictedScale}set restrictedScale(t){this._restrictedScale=t}}return t.FLOOR_THICKNESS=.25,t.WALL_THICKNESS=.25,t.MAX_WALL_ADDITIONAL_HEIGHT=20,t.TILE_BLOCKED=-110,t.TILE_HOLE=-100,t})();class va{flush(){return this._model=null,this._width=0,this._height=0,this._wallHeight=-1,this._heightMap=[],this._scale=64,this._model=null,!0}parse(t){if(!t)return!1;this._scale=t.readBoolean()?32:64,this._wallHeight=t.readInt(),this._model=t.readString();const e=this._model.split("\r"),s=e.length;let i=0,r=0;for(;r<s;){const t=e[r];t.length>i&&(i=t.length),r++}for(this._heightMap=[],r=0;r<s;){const t=[];let e=0;for(;e<i;)t.push(Ia.TILE_BLOCKED),e++;this._heightMap.push(t),r++}for(this._width=i,this._height=s,r=0;r<s;){const t=this._heightMap[r],s=e[r];if(s.length>0){let e=0;for(;e<s.length;){const i=s.charAt(e);let r=Ia.TILE_BLOCKED;"x"!==i&&"X"!==i&&(r=parseInt(i,36)),t[e]=r,e++}}r++}return!0}getHeight(t,e){if(t<0||t>=this._width||e<0||e>=this._height)return-110;const s=this._heightMap[e];if(void 0===s)return-110;const i=s[t];return void 0===i?-110:i}get model(){return this._model}get width(){return this._width}get height(){return this._height}get heightMap(){return this._heightMap}get wallHeight(){return this._wallHeight}get scale(){return this._scale}}class Ta extends E{constructor(t){super(t,va)}getParser(){return this.parser}}class Oa{flush(){return this._name=null,this._roomId=0,!0}parse(t){return!!t&&(this._name=t.readString(),this._roomId=t.readInt(),!0)}get name(){return this._name}get roomId(){return this._roomId}}class Aa extends E{constructor(t){super(t,Oa)}getParser(){return this.parser}}class ya{flush(){return this._floorType=null,this._wallType=null,this._landscapeType=null,this._landscapeAnimation=null,!0}parse(t){if(!t)return!1;const e=t.readString(),s=t.readString();switch(e){case"floor":this._floorType=s;break;case"wallpaper":this._wallType=s;break;case"landscape":this._landscapeType=s;break;case"landscapeanim":this._landscapeAnimation=s}return!0}get floorType(){return this._floorType}get wallType(){return this._wallType}get landscapeType(){return this._landscapeType}get landscapeAnimation(){return this._landscapeAnimation}}class Ca extends E{constructor(t){super(t,ya)}getParser(){return this.parser}}class Ma{flush(){return this._hideWalls=!1,this._thicknessWall=0,this._thicknessFloor=0,!0}parse(t){if(!t)return!1;this._hideWalls=t.readBoolean();let e=t.readInt(),s=t.readInt();return e=e<-2?-2:e>1?1:e,s=s<-2?-2:s>1?1:s,this._thicknessWall=Math.pow(2,e),this._thicknessFloor=Math.pow(2,s),!0}get hideWalls(){return this._hideWalls}get thicknessWall(){return this._thicknessWall}get thicknessFloor(){return this._thicknessFloor}}class Da extends E{constructor(t){super(t,Ma)}getParser(){return this.parser}}class Na{constructor(t){this._typeId=t.readInt(),this._paletteId=t.readInt(),this._color=t.readString(),this._breedId=t.readInt(),this._customParts=[],this._customPartCount=t.readInt();let e=0;for(;e<this._customPartCount;)this._customParts.push(t.readInt()),this._customParts.push(t.readInt()),this._customParts.push(t.readInt()),e++}get typeId(){return this._typeId}get paletteId(){return this._paletteId}get color(){return this._color}get breedId(){return this._breedId}get figuredata(){let t=this.typeId+" "+this.paletteId+" "+this.color;t=t+" "+this.custompartCount;for(const e of this.customParts)t=t+" "+e;return t}get customParts(){return this._customParts}get custompartCount(){return this._customPartCount}}class wa{flush(){return!0}parse(t){return!!t&&(this._roomIndex=t.readInt(),this._petId=t.readInt(),this._figureData=new Na(t),this._hasSaddle=t.readBoolean(),this._isRiding=t.readBoolean(),!0)}get roomIndex(){return this._roomIndex}get petId(){return this._petId}get figureData(){return this._figureData}get hasSaddle(){return this._hasSaddle}get isRiding(){return this._isRiding}}class Ua extends E{constructor(t){super(t,wa)}getParser(){return this.parser}}class La{flush(){return this._isPlaying=!1,!0}parse(t){return!!t&&(this._isPlaying=t.readBoolean(),!0)}get isPlaying(){return this._isPlaying}}class Pa extends E{constructor(t){super(t,La)}getParser(){return this.parser}}class xa{flush(){return this._roomIndex=null,this._message=null,this._gesture=0,this._bubble=0,this._urls=[],this._messageLength=0,!0}parse(t){return!!t&&(this._roomIndex=t.readInt(),this._message=t.readString(),this._gesture=t.readInt(),this._bubble=t.readInt(),this.parseUrls(t),this._messageLength=t.readInt(),!0)}parseUrls(t){if(!t)return!1;this._urls=[];let e=t.readInt();for(;e>0;)this._urls.push(t.readString()),e--;return!0}get roomIndex(){return this._roomIndex}get message(){return this._message}get gesture(){return this._gesture}get bubble(){return this._bubble}get urls(){return this._urls}get messageLength(){return this._messageLength}}class Fa extends E{constructor(t){super(t,xa)}getParser(){return this.parser}}class Ga extends E{constructor(t){super(t,xa)}getParser(){return this.parser}}class Va extends E{constructor(t){super(t,xa)}getParser(){return this.parser}}class Ya{flush(){return this._unitId=null,this._isTyping=!1,!0}parse(t){return!!t&&(this._unitId=t.readInt(),this._isTyping=1===t.readInt(),!0)}get unitId(){return this._unitId}get isTyping(){return this._isTyping}}class ka extends E{constructor(t){super(t,Ya)}getParser(){return this.parser}}class ja{flush(){return this._unitId=null,this._danceId=0,!0}parse(t){return!!t&&(this._unitId=t.readInt(),this._danceId=t.readInt(),!0)}get unitId(){return this._unitId}get danceId(){return this._danceId}}class Ba extends E{constructor(t){super(t,ja)}getParser(){return this.parser}}class Ha{flush(){return this._unitId=null,this._effectId=0,this._delay=0,!0}parse(t){return!!t&&(this._unitId=t.readInt(),this._effectId=t.readInt(),this._delay=t.readInt(),!0)}get unitId(){return this._unitId}get effectId(){return this._effectId}get delay(){return this._delay}}class Wa extends E{constructor(t){super(t,Ha)}getParser(){return this.parser}}let Za=(()=>{class t{}return t.USER=1,t.PET=2,t.BOT=3,t.RENTABLE_BOT=4,t})(),za=(()=>{class t{constructor(t){this._roomIndex=0,this._x=0,this._y=0,this._z=0,this._dir=0,this._name="",this._userType=0,this._sex="",this._figure="",this._custom="",this._activityPoints=0,this._webID=0,this._groupID="",this._groupStatus=0,this._groupName="",this._subType="",this._ownerId=0,this._ownerName="",this._rarityLevel=0,this._hasSaddle=!1,this._isRiding=!1,this._canBreed=!1,this._canHarvest=!1,this._canRevive=!1,this._hasBreedingPermission=!1,this._petLevel=0,this._petPosture="",this._botSkills=[],this._isModerator=!1,this._isReadOnly=!1,this._roomIndex=t}_Str_4710(){this._isReadOnly=!0}get roomIndex(){return this._roomIndex}get x(){return this._x}set x(t){this._isReadOnly||(this._x=t)}get y(){return this._y}set y(t){this._isReadOnly||(this._y=t)}get z(){return this._z}set z(t){this._isReadOnly||(this._z=t)}get dir(){return this._dir}set dir(t){this._isReadOnly||(this._dir=t)}get name(){return this._name}set name(t){this._isReadOnly||(this._name=t)}get userType(){return this._userType}set userType(t){this._isReadOnly||(this._userType=t)}get sex(){return this._sex}set sex(t){this._isReadOnly||(this._sex=t)}get figure(){return this._figure}set figure(t){this._isReadOnly||(this._figure=t)}get custom(){return this._custom}set custom(t){this._isReadOnly||(this._custom=t)}get activityPoints(){return this._activityPoints}set activityPoints(t){this._isReadOnly||(this._activityPoints=t)}get webID(){return this._webID}set webID(t){this._isReadOnly||(this._webID=t)}get groupID(){return this._groupID}set groupID(t){this._isReadOnly||(this._groupID=t)}get groupName(){return this._groupName}set groupName(t){this._isReadOnly||(this._groupName=t)}get groupStatus(){return this._groupStatus}set groupStatus(t){this._isReadOnly||(this._groupStatus=t)}get subType(){return this._subType}set subType(t){this._isReadOnly||(this._subType=t)}get ownerId(){return this._ownerId}set ownerId(t){this._isReadOnly||(this._ownerId=t)}get ownerName(){return this._ownerName}set ownerName(t){this._isReadOnly||(this._ownerName=t)}get rarityLevel(){return this._rarityLevel}set rarityLevel(t){this._isReadOnly||(this._rarityLevel=t)}get hasSaddle(){return this._hasSaddle}set hasSaddle(t){this._isReadOnly||(this._hasSaddle=t)}get isRiding(){return this._isRiding}set isRiding(t){this._isReadOnly||(this._isRiding=t)}get canBreed(){return this._canBreed}set canBreed(t){this._isReadOnly||(this._canBreed=t)}get canHarvest(){return this._canHarvest}set canHarvest(t){this._isReadOnly||(this._canHarvest=t)}get canRevive(){return this._canRevive}set canRevive(t){this._isReadOnly||(this._canRevive=t)}get hasBreedingPermission(){return this._hasBreedingPermission}set hasBreedingPermission(t){this._isReadOnly||(this._hasBreedingPermission=t)}get petLevel(){return this._petLevel}set petLevel(t){this._isReadOnly||(this._petLevel=t)}get petPosture(){return this._petPosture}set petPosture(t){this._isReadOnly||(this._petPosture=t)}get botSkills(){return this._botSkills}set botSkills(t){this._botSkills=t}get isModerator(){return this._isModerator}set isModerator(t){this._isReadOnly||(this._isModerator=t)}}return t.M="M",t.F="F",t})();class Xa{flush(){return this._users=[],!0}parse(t){if(!t)return!1;this._users=[];const e=t.readInt();let s=0;for(;s<e;){const e=t.readInt(),i=t.readString(),r=t.readString();let n=t.readString();const a=t.readInt(),o=t.readInt(),c=t.readInt(),_=parseFloat(t.readString()),h=t.readInt(),l=t.readInt(),u=new za(a);if(u.dir=h,u.name=i,u.custom=r,u.x=o,u.y=c,u.z=_,this._users.push(u),1===l){u.webID=e,u.userType=Za.USER,u.sex=this.resolveSex(t.readString()),u.groupID=""+t.readInt(),u.groupStatus=t.readInt(),u.groupName=t.readString();const s=t.readString();""!==s&&(n=this.convertSwimFigure(s,n,u.sex)),u.figure=n,u.activityPoints=t.readInt(),u.isModerator=t.readBoolean()}else if(2===l)u.userType=Za.PET,u.figure=n,u.webID=e,u.subType=t.readInt().toString(),u.ownerId=t.readInt(),u.ownerName=t.readString(),u.rarityLevel=t.readInt(),u.hasSaddle=t.readBoolean(),u.isRiding=t.readBoolean(),u.canBreed=t.readBoolean(),u.canHarvest=t.readBoolean(),u.canRevive=t.readBoolean(),u.hasBreedingPermission=t.readBoolean(),u.petLevel=t.readInt(),u.petPosture=t.readString();else if(3===l)u.userType=Za.BOT,u.webID=-1*a,u.figure=-1===n.indexOf("/")?n:"hr-100-.hd-180-1.ch-876-66.lg-270-94.sh-300-64",u.sex=za.M;else if(4===l){u.userType=Za.RENTABLE_BOT,u.webID=e,u.sex=this.resolveSex(t.readString()),u.figure=n,u.ownerId=t.readInt(),u.ownerName=t.readString();const s=t.readInt();if(s){const e=[];let i=0;for(;i<s;)e.push(t.readShort()),i++;u.botSkills=e}}s++}return!0}resolveSex(t){return"f"===t.substr(0,1).toLowerCase()?za.F:za.M}convertSwimFigure(t,e,s){const i=e.split(".");let r=1,n=1,a=1,o=0;for(;o<i.length;){const t=i[o].split("-");t.length>2&&"hd"===t[0]&&(r=parseInt(t[2])),o++}const c=["238,238,238","250,56,49","253,146,160","42,199,210","53,51,44","239,255,146","198,255,152","255,146,90","157,89,126","182,243,255","109,255,51","51,120,201","255,182,49","223,161,233","249,251,50","202,175,143","197,198,197","71,98,61","138,131,97","255,140,51","84,198,39","30,108,153","152,79,136","119,200,255","255,192,142","60,75,135","124,44,71","215,255,227","143,63,28","255,99,147","31,155,121","253,255,51"],_=t.split("=");if(_.length>1){const t=_[1].split("/");a="F"===s?10010:10011,n=1e4+c.indexOf(t[1])+1}return e+".bds-10001-"+r+".ss-"+a+"-"+n}get users(){return this._users}}class Ka extends E{constructor(t){super(t,Xa)}getParser(){return this.parser}}class qa{flush(){return this._unitId=null,this._expression=0,!0}parse(t){return!!t&&(this._unitId=t.readInt(),this._expression=t.readInt(),!0)}get unitId(){return this._unitId}get expression(){return this._expression}}class Ja extends E{constructor(t){super(t,qa)}getParser(){return this.parser}}class Qa{flush(){return this._unitId=null,this._handId=0,!0}parse(t){return!!t&&(this._unitId=t.readInt(),this._handId=t.readInt(),!0)}get unitId(){return this._unitId}get handId(){return this._handId}}class $a extends E{constructor(t){super(t,Qa)}getParser(){return this.parser}}class to{flush(){return this._unitId=null,this._isIdle=!1,!0}parse(t){return!!t&&(this._unitId=t.readInt(),this._isIdle=t.readBoolean(),!0)}get unitId(){return this._unitId}get isIdle(){return this._isIdle}}class eo extends E{constructor(t){super(t,to)}getParser(){return this.parser}}class so{flush(){return this._unitId=null,this._figure=null,this._gender="M",this._motto=null,this._achievementScore=0,!0}parse(t){return!!t&&(this._unitId=t.readInt(),this._figure=t.readString(),this._gender=t.readString().toLocaleUpperCase(),this._motto=t.readString(),this._achievementScore=t.readInt(),!0)}get unitId(){return this._unitId}get figure(){return this._figure}get gender(){return this._gender}get motto(){return this._motto}get achievementScore(){return this._achievementScore}}class io extends E{constructor(t){super(t,so)}getParser(){return this.parser}}class ro{flush(){return this._unitId=null,this._value=0,!0}parse(t){return!!t&&(this._unitId=t.readInt(),this._value=t.readInt(),!0)}get unitId(){return this._unitId}get value(){return this._value}}class no extends E{constructor(t){super(t,ro)}getParser(){return this.parser}}class ao{flush(){return this._unitId=null,!0}parse(t){return!!t&&(this._unitId=parseInt(t.readString()),!0)}get unitId(){return this._unitId}}class oo extends E{constructor(t){super(t,ao)}getParser(){return this.parser}}class co{constructor(t,e){this._action=t,this._value=e}get action(){return this._action}get value(){return this._value}}class _o{constructor(t,e,s,i,r,n,a,o=0,c=0,_=0,h,l,u){this._id=t,this._x=e,this._y=s,this._z=i,this._height=r,this._headDirection=n,this._direction=a,this._targetX=o,this._targetY=c,this._targetZ=_,this._didMove=h,this._canStandUp=l,this._actions=u||[]}get id(){return this._id}get x(){return this._x}get y(){return this._y}get z(){return this._z}get height(){return this._height}get headDirection(){return this._headDirection}get direction(){return this._direction}get targetX(){return this._targetX}get targetY(){return this._targetY}get targetZ(){return this._targetZ}get didMove(){return this._didMove}get canStandUp(){return this._canStandUp}get actions(){return this._actions}}class ho{flush(){return this._statuses=[],!0}parse(t){if(!t)return!1;let e=t.readInt();for(;e>0;){const s=this.parseStatus(t);s?(this._statuses.push(s),e--):e--}return!0}parseStatus(t){if(!t)return null;const e=t.readInt(),s=t.readInt(),i=t.readInt(),r=parseFloat(t.readString()),n=t.readInt()%8*45,a=t.readInt()%8*45,o=t.readString();let c=0,_=0,h=0,l=0,u=!1,d=!1;if(o){const t=o.split("/"),g=t.length,m=[];if(g)for(let e=0;e<g;e++){const s=t[e];if(!s)continue;const[i,r,n]=s.split(" ");if(i&&r){switch(i){case"mv":[c,_,h]=r.split(",").map(t=>parseFloat(t)),d=!0;break;case"sit":void 0!==n&&(u="1"===r),l=parseFloat(r);break;case"lay":l=parseFloat(r)}m.push(new co(i,r))}}this._statuses.push(new _o(e,s,i,r,l,n,a,c,_,h,d,u,m))}}get statuses(){return this._statuses}}class lo extends E{constructor(t){super(t,ho)}getParser(){return this.parser}}class uo{constructor(t){this._stuffIds=[],this._intParams=[],this._stuffTypeSelectionEnabled=t.readBoolean(),this._furniLimit=t.readInt();let e=t.readInt();for(;e>0;)this._stuffIds.push(t.readInt()),e--;for(this._stuffTypeId=t.readInt(),this._id=t.readInt(),this._stringParam=t.readString(),e=t.readInt();e>0;)this._intParams.push(t.readInt()),e--;this._stuffTypeSelectionCode=t.readInt()}getBoolean(t){return 1===this._intParams[t]}get _Str_21824(){return this._stuffTypeSelectionEnabled}get _Str_6040(){return this._stuffTypeSelectionCode}set _Str_6040(t){this._stuffTypeSelectionCode=t}get maximumItemSelectionCount(){return this._furniLimit}get selectedItems(){return this._stuffIds}get id(){return this._id}get stringData(){return this._stringParam}get intData(){return this._intParams}get code(){return 0}get spriteId(){return this._stuffTypeId}}class go extends uo{constructor(t){super(t),this._conflictingTriggers=[],this._type=t.readInt(),this._delayInPulses=t.readInt();let e=t.readInt();for(;e>0;)this._conflictingTriggers.push(t.readInt()),e--}get type(){return this._type}get code(){return this._type}get delayInPulses(){return this._delayInPulses}get conflictingTriggers(){return this._conflictingTriggers}}class mo{flush(){return this._definition=null,!0}parse(t){return!!t&&(this._definition=new go(t),!0)}get definition(){return this._definition}}class po extends E{constructor(t){super(t,mo)}getParser(){return this.parser}}class Eo extends uo{constructor(t){super(t),this._type=t.readInt()}get type(){return this._type}get code(){return this._type}}class fo{flush(){return this._definition=null,!0}parse(t){return!!t&&(this._definition=new Eo(t),!0)}get definition(){return this._definition}}class So extends E{constructor(t){super(t,fo)}getParser(){return this.parser}}class bo extends uo{constructor(t){super(t),this._conflictingActions=[],this._triggerConf=t.readInt();let e=t.readInt();for(;e>0;)this._conflictingActions.push(t.readInt()),e--}get type(){return this._triggerConf}get code(){return this._triggerConf}get _Str_21837(){return this._conflictingActions}}class Ro{flush(){return this._definition=null,!0}parse(t){return!!t&&(this._definition=new bo(t),!0)}get definition(){return this._definition}}class Io extends E{constructor(t){super(t,Ro)}getParser(){return this.parser}}class vo{flush(){return this._stuffId=0,!0}parse(t){return!!t&&(this._stuffId=t.readInt(),!0)}get stuffId(){return this._stuffId}}class To extends E{constructor(t){super(t,vo)}getParser(){return this.parser}}class Oo{flush(){return this._reason=0,!0}parse(t){return!!t&&(this._reason=t.readInt(),!0)}get reason(){return this._reason}}let Ao=(()=>{class t extends E{constructor(t){super(t,Oo)}getParser(){return this.parser}}return t._Str_18436=6,t._Str_17787=7,t})();class yo{flush(){return!0}parse(t){return!!t}}class Co extends E{constructor(t){super(t,yo)}getParser(){return this.parser}}class Mo{flush(){return this._info=null,!0}parse(t){return!!t&&(this._info=t.readString(),!0)}get info(){return this._info}}class Do extends E{constructor(t){super(t,Mo)}getParser(){return this.parser}}class No{flush(){return!0}parse(t){return!!t}}class wo extends E{constructor(t){super(t,No)}getParser(){return this.parser}}class Uo{flush(){return this._clubLevel=0,this._securityLevel=0,this._isAmbassador=!1,!0}parse(t){return!!t&&(this._clubLevel=t.readInt(),this._securityLevel=t.readInt(),this._isAmbassador=t.readBoolean(),!0)}get clubLevel(){return this._clubLevel}get securityLevel(){return this._securityLevel}get isAmbassador(){return this._isAmbassador}}class Lo extends E{constructor(t){super(t,Uo)}getParser(){return this.parser}}class Po{flush(){return this._userId=null,this._badges=[],!0}parse(t){if(!t)return!1;this._userId=t.readInt();let e=t.readInt();for(;e>0;){t.readInt();const s=t.readString();this._badges.push(s),e--}return!0}get userId(){return this._userId}get badges(){return this._badges}}class xo extends E{constructor(t){super(t,Po)}getParser(){return this.parser}}class Fo{flush(){return this._figure=null,this._gender=null,!0}parse(t){return!!t&&(this._figure=t.readString(),this._gender=t.readString(),!0)}get figure(){return this._figure}get gender(){return this._gender}}class Go extends E{constructor(t){super(t,Fo)}getParser(){return this.parser}}class Vo{constructor(t){if(!t)throw new Error("invalid_wrapper");this.flush(),this.parse(t)}flush(){return this._userId=0,this._username=null,this._figure=null,this._gender=null,this._motto=null,this._realName=null,this._directMail=!1,this._respectsReceived=0,this._respectsRemaining=0,this._respectsPetRemaining=0,this._streamPublishingAllowed=!1,this._lastAccessDate=null,this._canChangeName=!1,this._safetyLocked=!1,!0}parse(t){return!!t&&(this._userId=t.readInt(),this._username=t.readString(),this._figure=t.readString(),this._gender=t.readString(),this._motto=t.readString(),this._realName=t.readString(),this._directMail=t.readBoolean(),this._respectsReceived=t.readInt(),this._respectsRemaining=t.readInt(),this._respectsPetRemaining=t.readInt(),this._streamPublishingAllowed=t.readBoolean(),this._lastAccessDate=t.readString(),this._canChangeName=t.readBoolean(),this._safetyLocked=t.readBoolean(),!0)}get userId(){return this._userId}get username(){return this._username}get figure(){return this._figure}get gender(){return this._gender}get motto(){return this._motto}get realName(){return this._realName}get directMail(){return this._directMail}get respectsReceived(){return this._respectsReceived}get respectsRemaining(){return this._respectsRemaining}get respectsPetRemaining(){return this._respectsPetRemaining}get streamPublishingAllowed(){return this._streamPublishingAllowed}get lastAccessedDate(){return this._lastAccessDate}get canChangeName(){return this._canChangeName}get safetyLocked(){return this._safetyLocked}}class Yo{flush(){return this._userInfo=null,!0}parse(t){return!!t&&(this._userInfo=new Vo(t),!!this._userInfo)}get userInfo(){return this._userInfo}}class ko extends E{constructor(t){super(t,Yo)}getParser(){return this.parser}}class jo{flush(){return this._webId=-1,this._id=-1,this._newName="",!0}parse(t){return!!t&&(this._webId=t.readInt(),this._id=t.readInt(),this._newName=t.readString(),!0)}get webId(){return this._webId}get id(){return this._id}get newName(){return this._newName}}class Bo extends E{constructor(t){super(t,jo)}getParser(){return this.parser}}class Ho{flush(){return this._volumeSystem=0,this._volumeFurni=0,this._volumeTrax=0,this._oldChat=!1,this._roomInvites=!1,this._cameraFollow=!1,this._flags=0,this._chatType=0,!0}parse(t){return!!t&&(this._volumeSystem=t.readInt(),this._volumeFurni=t.readInt(),this._volumeTrax=t.readInt(),this._oldChat=t.readBoolean(),this._roomInvites=t.readBoolean(),this._cameraFollow=t.readBoolean(),this._flags=t.readInt(),this._chatType=t.readInt(),!0)}get volumeSystem(){return this._volumeSystem}get volumeFurni(){return this._volumeFurni}get volumeTrax(){return this._volumeTrax}get oldChat(){return this._oldChat}get roomInvites(){return this._roomInvites}get cameraFollow(){return this._cameraFollow}get flags(){return this._flags}get chatType(){return this._chatType}}class Wo extends E{constructor(t){super(t,Ho)}getParser(){return this.parser}}class Zo{flush(){return this._credits=null,!0}parse(t){return!!t&&(this._credits=t.readString(),!0)}get credits(){return this._credits}}class zo extends E{constructor(t){super(t,Zo)}getParser(){return this.parser}}class Xo{flush(){return this._currencies=new Map,!0}parse(t){if(!t)return!1;let e=t.readInt();for(;e>0;)this._currencies.set(t.readInt(),t.readInt()),e--;return!0}get currencies(){return this._currencies}}class Ko extends E{constructor(t){super(t,Xo)}getParser(){return this.parser}}class qo{flush(){return this._amount=0,this._amountChanged=0,this._type=-1,!0}parse(t){return!!t&&(this._amount=t.readInt(),this._amountChanged=t.readInt(),this._type=t.readInt(),!0)}get amount(){return this._amount}get amountChanged(){return this._amountChanged}get type(){return this._type}}class Jo extends E{constructor(t){super(t,qo)}getParser(){return this.parser}}let Qo=(()=>{class t{flush(){return this._name=null,this._days=0,this._int1=0,this._months=0,this._years=0,this._bool1=!1,this._isVip=!1,this._pastClubDays=0,this._int3=0,this._totalSeconds=0,!0}parse(t){return!!t&&(this._name=t.readString(),this._days=t.readInt(),this._int1=t.readInt(),this._months=t.readInt(),this._years=t.readInt(),this._bool1=t.readBoolean(),this._isVip=t.readBoolean(),this._pastClubDays=t.readInt(),this._int3=t.readInt(),this._totalSeconds=t.readInt(),!0)}get name(){return this._name}get days(){return this._days}get int1(){return this._int1}get months(){return this._months}get years(){return this._years}get bool1(){return this._bool1}get isVip(){return this._isVip}get pastClubDays(){return this._pastClubDays}get int3(){return this._int3}get totalSeconds(){return this._totalSeconds}}return t._Str_14729=3,t})();class $o extends E{constructor(t){super(t,Qo)}getParser(){return this.parser}}class tc{constructor(t){this._data=[t]}getMessageArray(){return this._data}dispose(){}}class ec{constructor(t,e,s){this._data=[t,e,s]}getMessageArray(){return this._data}dispose(){}}class sc{constructor(t,e,s,i){this._data=[t,e,s,i]}getMessageArray(){return this._data}dispose(){}}class ic{constructor(t){this._data=[t]}getMessageArray(){return this._data}dispose(){}}class rc{constructor(t){this._data=[t]}getMessageArray(){return this._data}dispose(){}}class nc{constructor(){this._data=[]}getMessageArray(){return this._data}dispose(){}}class ac{constructor(...t){this._data=[t.length,...t]}getMessageArray(){return this._data}dispose(){}}class oc{constructor(t,...e){this._data=[t,e.length,...e]}getMessageArray(){return this._data}dispose(){}}class cc{constructor(){this._data=[]}getMessageArray(){return this._data}dispose(){}}class _c{constructor(t){this._data=[t]}getMessageArray(){return this._data}dispose(){}}class hc{constructor(){this._data=[]}getMessageArray(){return this._data}dispose(){}}class lc{constructor(){this._data=[]}getMessageArray(){return this._data}dispose(){}}class uc{constructor(t){this._data=[t]}getMessageArray(){return this._data}dispose(){}}class dc{constructor(){this._data=[]}getMessageArray(){return this._data}dispose(){}}class gc{constructor(...t){this._data=[t.length,...t]}getMessageArray(){return this._data}dispose(){}}class mc{constructor(t){this._data=[t]}getMessageArray(){return this._data}dispose(){}}class pc{constructor(t,e){this._data=[t,e]}getMessageArray(){return this._data}dispose(){}}class Ec{constructor(t,...e){this._data=[t,e.length,...e]}getMessageArray(){return this._data}dispose(){}}class fc{constructor(t,e){this._data=[t,e]}getMessageArray(){return this._data}dispose(){}}class Sc{constructor(t){this._data=[t]}getMessageArray(){return this._data}dispose(){}}class bc{constructor(){this._data=[]}getMessageArray(){return this._data}dispose(){}}class Rc{constructor(){this._data=[]}getMessageArray(){return this._data}dispose(){}}class Ic{constructor(){this._data=[]}getMessageArray(){return this._data}dispose(){}}class vc{constructor(){this._data=[]}getMessageArray(){return this._data}dispose(){}}class Tc{constructor(){this._data=[]}getMessageArray(){return this._data}dispose(){}}class Oc{constructor(){this._data=[]}getMessageArray(){return this._data}dispose(){}}class Ac{constructor(){this._data=[]}getMessageArray(){return this._data}dispose(){}}class yc{constructor(t){this._data=[t]}getMessageArray(){return this._data}dispose(){}}class Cc{constructor(...t){this._data=[t.length,...t]}getMessageArray(){return this._data}dispose(){}}class Mc{constructor(t){this._data=[t]}getMessageArray(){return this._data}dispose(){}}class Dc{constructor(t){this._data=[t]}getMessageArray(){return this._data}dispose(){}}class Nc{constructor(){this._data=[]}getMessageArray(){return this._data}dispose(){}}class wc{constructor(){this._data=[]}getMessageArray(){return this._data}dispose(){}}class Uc{constructor(t,e){this._data=[t,e]}getMessageArray(){return this._data}dispose(){}}class Lc{constructor(){this._data=[]}getMessageArray(){return this._data}dispose(){}}class Pc{constructor(t){this._data=[t]}getMessageArray(){return this._data}dispose(){}}class xc{constructor(t,e){this._data=[t,e]}getMessageArray(){return this._data}dispose(){}}class Fc{constructor(t){this._data=[t]}getMessageArray(){return this._data}dispose(){}}class Gc{constructor(t,e){this._data=[t,e]}getMessageArray(){return this._data}dispose(){}}class Vc{constructor(){this._data=[]}getMessageArray(){return this._data}dispose(){}}class Yc{constructor(t,e,s,i,r,n){this._data=[t,e,s,i,r,n]}getMessageArray(){return this._data}dispose(){}}let kc=(()=>{class t{}return t.ACHIEVEMENT_LIST=219,t.BOT_INFO=1986,t.BOT_PICKUP=3323,t.BOT_PLACE=1592,t.BOT_SETTINGS_SAVE=2624,t.CAMERA_PRICE=796,t.CAMERA_SAVE=3226,t.CAMERA_THUMBNAIL=1982,t.CATALOG_CLUB=3285,t.CATALOG_MODE=1195,t.CATALOG_PAGE=412,t.CATALOG_PURCHASE=3492,t.CATALOG_SEARCH=2594,t.CLIENT_LATENCY=295,t.CLIENT_LATENCY_MEASURE=96,t.CLIENT_POLICY=26979,t.CLIENT_PONG=2596,t.CLIENT_TOOLBAR_TOGGLE=2313,t.CLIENT_VARIABLES=1053,t.DESKTOP_CAMPAIGNS=2912,t.DESKTOP_NEWS=1827,t.DESKTOP_VIEW=105,t.DISCOUNT_CONFIG=223,t.EVENT_TRACKER=3457,t.FIND_FRIENDS=516,t.FURNITURE_ALIASES=3898,t.FURNITURE_FLOOR_UPDATE=248,t.FURNITURE_MULTISTATE=99,t.FURNITURE_PICKUP=3456,t.FURNITURE_PLACE=1258,t.FURNITURE_POSTIT_PLACE=2248,t.FURNITURE_RANDOMSTATE=3617,t.FURNITURE_WALL_MULTISTATE=210,t.FURNITURE_WALL_UPDATE=168,t.GAMES_INIT=2914,t.GAMES_LIST=741,t.GIFT_CONFIG=418,t.GROUP_ADMIN_ADD=2894,t.GROUP_ADMIN_REMOVE=722,t.GROUP_CREATE_OPTIONS=798,t.GROUP_FORUM_INFO=3149,t.GROUP_FORUM_LIST=873,t.GROUP_FORUM_THREADS=436,t.GROUP_INFO=2991,t.GROUP_MEMBER_REMOVE=3593,t.GROUP_MEMBERS=312,t.GROUP_MEMBERSHIPS=367,t.GROUP_REQUEST=998,t.GROUP_REQUEST_ACCEPT=3386,t.GROUP_REQUEST_DECLINE=1894,t.GROUP_SETTINGS=1004,t.INVENTORY_UNKNOWN=1371,t.ITEM_CLOTHING_REDEEM=3374,t.ITEM_COLOR_WHEEL_CLICK=2144,t.ITEM_DICE_CLICK=1990,t.ITEM_DICE_CLOSE=1533,t.ITEM_DIMMER_SAVE=1648,t.ITEM_DIMMER_SETTINGS=2813,t.ITEM_DIMMER_TOGGLE=2296,t.ITEM_EXCHANGE_REDEEM=3115,t.ITEM_PAINT=711,t.ITEM_SAVE_BACKGROUND=3608,t.ITEM_STACK_HELPER=3839,t.ITEM_WALL_CLICK=210,t.ITEM_WALL_UPDATE=168,t.MARKETPLACE_CONFIG=2597,t.MESSENGER_ACCEPT=137,t.MESSENGER_CHAT=3567,t.MESSENGER_DECLINE=2890,t.MESSENGER_FOLLOW=3997,t.MESSENGER_FRIENDS=1523,t.MESSENGER_INIT=2781,t.MESSENGER_RELATIONSHIPS=2138,t.MESSENGER_RELATIONSHIPS_UPDATE=3768,t.MESSENGER_REMOVE=1689,t.MESSENGER_REQUEST=3157,t.MESSENGER_REQUESTS=2448,t.MESSENGER_ROOM_INVITE=1276,t.MESSENGER_SEARCH=1210,t.MESSENGER_UPDATES=1419,t.MOD_TOOL_USER_INFO=3295,t.NAVIGATOR_CATEGORIES=3027,t.NAVIGATOR_INIT=2110,t.NAVIGATOR_SEARCH=249,t.NAVIGATOR_SEARCH_CLOSE=1834,t.NAVIGATOR_SEARCH_OPEN=637,t.NAVIGATOR_SEARCH_SAVE=2226,t.NAVIGATOR_SETTINGS=1782,t.NAVIGATOR_SETTINGS_SAVE=3159,t.NAVIGATOR_CATEGORY_LIST_MODE=1202,t.PET_INFO=2934,t.PET_PICKUP=1581,t.PET_PLACE=2647,t.PET_RESPECT=3202,t.PET_RIDE=1036,t.RECYCLER_PRIZES=398,t.RELEASE_VERSION=4e3,t.REPORT=1691,t.ROOM_AMBASSADOR_ALERT=2996,t.ROOM_BAN_GIVE=1477,t.ROOM_BAN_LIST=2267,t.ROOM_BAN_REMOVE=992,t.ROOM_CREATE=2752,t.ROOM_DELETE=532,t.ROOM_DOORBELL=1644,t.ROOM_ENTER=2312,t.ROOM_FAVORITE=3817,t.ROOM_FAVORITE_REMOVE=309,t.ROOM_INFO=2230,t.ROOM_KICK=1320,t.ROOM_LIKE=3582,t.ROOM_MODEL=2300,t.ROOM_MODEL_BLOCKED_TILES=1687,t.ROOM_MODEL_DOOR=3559,t.ROOM_MODEL_SAVE=875,t.ROOM_MUTE=3637,t.ROOM_MUTE_USER=3485,t.ROOM_RIGHTS_GIVE=808,t.ROOM_RIGHTS_LIST=3385,t.ROOM_RIGHTS_REMOVE=2064,t.ROOM_RIGHTS_REMOVE_ALL=2683,t.ROOM_RIGHTS_REMOVE_OWN=3182,t.ROOM_SETTINGS=3129,t.ROOM_SETTINGS_SAVE=1969,t.SECURITY_MACHINE=2490,t.SECURITY_TICKET=2419,t.TRADE=1481,t.TRADE_ACCEPT=3863,t.TRADE_CANCEL=2341,t.TRADE_CLOSE=2551,t.TRADE_CONFIRM=2760,t.TRADE_ITEM=3107,t.TRADE_ITEM_REMOVE=3845,t.TRADE_ITEMS=1263,t.TRADE_UNACCEPT=1444,t.UNIT_ACTION=2456,t.UNIT_CHAT=1314,t.UNIT_CHAT_SHOUT=2085,t.UNIT_CHAT_WHISPER=1543,t.UNIT_DANCE=2080,t.UNIT_DROP_HAND_ITEM=2814,t.UNIT_GIVE_HANDITEM=2941,t.UNIT_LOOK=3301,t.UNIT_POSTURE=2235,t.UNIT_SIGN=1975,t.UNIT_TYPING=1597,t.UNIT_TYPING_STOP=1474,t.UNIT_WALK=3320,t.USER_BADGES=2769,t.USER_BADGES_CURRENT=2091,t.USER_BADGES_CURRENT_UPDATE=644,t.USER_BOTS=3848,t.USER_CURRENCY=273,t.USER_EFFECT_ACTIVATE=2959,t.USER_EFFECT_ENABLE=1752,t.USER_FIGURE=2730,t.USER_FURNITURE=3150,t.USER_FURNITURE2=3500,t.USER_HOME_ROOM=1740,t.USER_INFO=357,t.USER_MOTTO=2228,t.USER_ONLINE=3878,t.USER_OUTFIT_SAVE=800,t.USER_OUTFITS=2742,t.USER_PETS=3095,t.USER_PROFILE=3265,t.USER_RESPECT=2694,t.USER_SETTINGS=2388,t.USER_SETTINGS_CAMERA=1461,t.USER_SETTINGS_CHAT_STYLE=1030,t.USER_SETTINGS_INVITES=1086,t.USER_SETTINGS_OLD_CHAT=1262,t.USER_SETTINGS_VOLUME=1367,t.USER_SUBSCRIPTION=3166,t.USER_TAGS=17,t.USER_VISIT=2970,t.WIRED_ACTION_SAVE=2281,t.WIRED_APPLY_SNAPSHOT=3373,t.WIRED_CONDITION_SAVE=3203,t.WIRED_OPEN=768,t.WIRED_TRIGGER_SAVE=1520,t.GET_ITEM_DATA=3964,t.ONE_WAY_DOOR_CLICK=2765,t.REMOVE_WALL_ITEM=3336,t.MODIFY_WALL_ITEM_DATA=3666,t.CATALOG_REDEEM_VOUCHER=339,t})();class jc{constructor(t){this._data=[t]}getMessageArray(){return this._data}dispose(){}}class Bc{constructor(t,e=null){this._data=[t,e]}getMessageArray(){return this._data}dispose(){}}class Hc{constructor(t){this._data=[t]}getMessageArray(){return this._data}dispose(){}}class Wc{constructor(t,e,s=0){this._data=[t,e,s]}getMessageArray(){return this._data}dispose(){}}class Zc{constructor(t){this._data=[t]}getMessageArray(){return this._data}dispose(){}}class zc{constructor(t){this._data=[t]}getMessageArray(){return this._data}dispose(){}}class Xc{constructor(t,e,s=0){this._data=[t,e,s]}getMessageArray(){return this._data}dispose(){}}class Kc{constructor(...t){this._data=[t.length,...t]}getMessageArray(){return this._data}dispose(){}}class qc{constructor(t,e,s){this._data=[t,e?1:0,s?1:0]}getMessageArray(){return this._data}dispose(){}}class Jc{constructor(t){this._data=[t]}getMessageArray(){return this._data}dispose(){}}class Qc{constructor(t,e,s){this._data=[t,e,s]}getMessageArray(){return this._data}dispose(){}}class $c{constructor(t,e,s){this._data=[t,e,s]}getMessageArray(){return this._data}dispose(){}}class t_{constructor(t){this._data=[t]}getMessageArray(){return this._data}dispose(){}}class e_{constructor(t){this._data=[t]}getMessageArray(){return this._data}dispose(){}}class s_{constructor(t,e){this._data=[t,2*e.size];for(const[s,i]of e.entries())this._data.push(s,i)}getMessageArray(){return this._data}dispose(){}}class i_{constructor(t,e,s,i){this._data=[t,e,s,i]}getMessageArray(){return this._data}dispose(){}}class r_{constructor(){this._data=[]}getMessageArray(){return this._data}dispose(){}}class n_{constructor(t,e){this._data=[t,e]}getMessageArray(){return this._data}dispose(){}}class a_{constructor(t,e,s,i,r,n){this._itemId=t,this._category=e,this._wallLocation=s,this._x=i,this._y=r,this._direction=n}getMessageArray(){switch(this._category){case tt.FLOOR:return[`${this._itemId} ${this._x} ${this._y} ${this._direction}`];case tt.WALL:return[`${this._itemId} ${this._wallLocation} `];default:return[]}}dispose(){}}class o_{constructor(t){this._data=[t]}getMessageArray(){return this._data}dispose(){}}class c_{constructor(t,e){this._data=[t,e]}getMessageArray(){return this._data}dispose(){}}class __{constructor(t){this._data=[t]}getMessageArray(){return this._data}dispose(){}}class h_{constructor(t){this._data=[t]}getMessageArray(){return this._data}dispose(){}}class l_{constructor(t){this._data=[t]}getMessageArray(){return this._data}dispose(){}}class u_{constructor(t,e){this._data=[t,e]}getMessageArray(){return this._data}dispose(){}}class d_{constructor(t){this._data=[t]}getMessageArray(){return this._data}dispose(){}}class g_{constructor(t,e){this._data=[t,e]}getMessageArray(){return this._data}dispose(){}}class m_{constructor(t,e=-100){this._data=[t,e]}getMessageArray(){return this._data}dispose(){}}class p_{constructor(t,e){this._data=[t,e]}getMessageArray(){return this._data}dispose(){}}class E_{constructor(t,e){this._data=[t,e]}getMessageArray(){return this._data}dispose(){}}class f_{constructor(){this._data=[]}getMessageArray(){return this._data}dispose(){}}class S_{constructor(t,e,s,i,r,n){this._data=[t,e,s,i,r,n]}getMessageArray(){return this._data}dispose(){}}class b_{constructor(t,e=0){this._data=[t,e]}getMessageArray(){return this._data}dispose(){}}class R_{constructor(t,e){this._data=[t,e]}getMessageArray(){return this._data}dispose(){}}class I_{constructor(t,e,s){this._data=[t+" "+e,s]}getMessageArray(){return this._data}dispose(){}}class v_{constructor(){this._data=[]}getMessageArray(){return this._data}dispose(){}}class T_{constructor(){this._data=[]}getMessageArray(){return this._data}dispose(){}}class O_{constructor(t){this._data=[t]}getMessageArray(){return this._data}dispose(){}}class A_{constructor(t){this._data=[t]}getMessageArray(){return this._data}dispose(){}}class y_{constructor(){this._data=[]}getMessageArray(){return this._data}dispose(){}}class C_{constructor(t){this._data=[t]}getMessageArray(){return this._data}dispose(){}}class M_{constructor(t,e){this._data=[t,e]}getMessageArray(){return this._data}dispose(){}}class D_{constructor(t){this._data=[t]}getMessageArray(){return this._data}dispose(){}}class N_{constructor(t){this._data=[t]}getMessageArray(){return this._data}dispose(){}}class w_{constructor(t,e){this._data=[t,e]}getMessageArray(){return this._data}dispose(){}}class U_{constructor(t){this._data=[t]}getMessageArray(){return this._data}dispose(){}}class L_{constructor(t){this._data=[t]}getMessageArray(){return this._data}dispose(){}}class P_{constructor(t,e,s,i,r,n){this._data=[t,e.length,...e,s,i.length,...i,r,n]}getMessageArray(){return this._data}dispose(){}}class x_{constructor(t,e,s,i,r){this._data=[t,e.length,...e,s,i.length,...i,r]}getMessageArray(){return this._data}dispose(){}}class F_{constructor(t,e,s,i,r){this._data=[t,e.length,...e,s,i.length,...i,r]}getMessageArray(){return this._data}dispose(){}}class G_{constructor(t){this._data=[t]}getMessageArray(){return this._data}dispose(){}}class V_{constructor(t,e){this._data=[t,e]}getMessageArray(){return this._data}dispose(){}}class Y_{constructor(t){this._data=[t]}getMessageArray(){return this._data}dispose(){}}class k_{constructor(t){this._data=[t]}getMessageArray(){return this._data}dispose(){}}class j_{constructor(){this._data=[]}getMessageArray(){return this._data}dispose(){}}class B_{constructor(t){this._data=[t]}getMessageArray(){return this._data}dispose(){}}class H_{constructor(t){this._data=[t]}getMessageArray(){return this._data}dispose(){}}class W_{flush(){return this._count=0,!0}parse(t){return!!t&&(this._count=t.readInt(),!0)}get count(){return this._count}}class Z_{constructor(t){this._data=[t]}getMessageArray(){return this._data}dispose(){this._data=null}}class z_{constructor(t,e){this._data=[t,e]}getMessageArray(){return this._data}dispose(){}}class X_{flush(){return this._errorCode=0,!0}parse(t){return!!t&&(this._errorCode=t.readInt(),!0)}get errorCode(){return this._errorCode}}class K_ extends E{constructor(t){super(t,X_)}getParser(){return this.parser}}class q_{constructor(){this._events=new Map,this._composers=new Map,this.registerEvents(),this.registerComposers()}registerEvents(){this._events.set(ni.AVAILABILITY_STATUS,Ye),this._events.set(ni.GENERIC_ERROR,K_),this._events.set(ni.USER_CHANGE_NAME,je),this._events.set(ni.CATALOG_CLUB,We),this._events.set(ni.CATALOG_MODE,ze),this._events.set(ni.CATALOG_PAGE,$e),this._events.set(ni.CATALOG_PAGES,ss),this._events.set(ni.CATALOG_PURCHASE,ns),this._events.set(ni.CATALOG_PURCHASE_FAILED,os),this._events.set(ni.CATALOG_PURCHASE_UNAVAILABLE,_s),this._events.set(ni.CATALOG_SEARCH,ls),this._events.set(ni.CATALOG_SOLD_OUT,ds),this._events.set(ni.CATALOG_UPDATED,ms),this._events.set(ni.CLIENT_PING,Oe),this._events.set(ni.DESKTOP_VIEW,Es),this._events.set(ni.MESSENGER_ACCEPT_FRIENDS,bs),this._events.set(ni.MESSENGER_FIND_FRIENDS,Is),this._events.set(ni.MESSENGER_FOLLOW_FAILED,Ts),this._events.set(ni.MESSENGER_FRIENDS,ys),this._events.set(ni.MESSENGER_UPDATE,Ds),this._events.set(ni.MESSENGER_FRIEND_NOTIFICATION,ws),this._events.set(ni.MESSENGER_REQUESTS,Ps),this._events.set(ni.MESSENGER_SEARCH,Gs),this._events.set(ni.MESSENGER_INSTANCE_MESSAGE_ERROR,Ys),this._events.set(ni.MESSENGER_MESSAGE_ERROR,js),this._events.set(ni.MESSENGER_INIT,Hs),this._events.set(ni.MESSENGER_MINIMAIL_NEW,Zs),this._events.set(ni.MESSENGER_MINIMAIL_COUNT,W_),this._events.set(ni.MESSENGER_CHAT,Xs),this._events.set(ni.MESSENGER_REQUEST,qs),this._events.set(ni.MESSENGER_INVITE_ERROR,Qs),this._events.set(ni.MESSENGER_INVITE,ti),this._events.set(ni.CFH_RESULT_MESSAGE,ri),this._events.set(ni.USER_CLOTHING,gi),this._events.set(ni.USER_FURNITURE_ADD,Ni),this._events.set(ni.USER_FURNITURE,Ui),this._events.set(ni.USER_FURNITURE_REFRESH,Pi),this._events.set(ni.USER_FURNITURE_REMOVE,Fi),this._events.set(ni.USER_FURNITURE_POSTIT_PLACED,Vi),this._events.set(ni.TRADE_ACCEPTED,ki),this._events.set(ni.TRADE_CLOSED,Bi),this._events.set(ni.TRADE_COMPLETED,Wi),this._events.set(ni.TRADE_CONFIRMATION,zi),this._events.set(ni.TRADE_LIST_ITEM,qi),this._events.set(ni.TRADE_NOT_OPEN,Qi),this._events.set(ni.TRADE_OPEN_FAILED,sr),this._events.set(ni.TRADE_OPEN,tr),this._events.set(ni.TRADE_OTHER_NOT_ALLOWED,rr),this._events.set(ni.TRADE_YOU_NOT_ALLOWED,ar),this._events.set(ni.GENERIC_ALERT_LINK,cr),this._events.set(ni.NAVIGATOR_CATEGORIES,lr),this._events.set(ni.NAVIGATOR_COLLAPSED,dr),this._events.set(ni.NAVIGATOR_EVENT_CATEGORIES,pr),this._events.set(ni.USER_HOME_ROOM,fr),this._events.set(ni.NAVIGATOR_LIFTED,Rr),this._events.set(ni.NAVIGATOR_METADATA,Or),this._events.set(ni.NAVIGATOR_OPEN_ROOM_CREATOR,yr),this._events.set(ni.NAVIGATOR_SEARCHES,Mr),this._events.set(ni.NAVIGATOR_SEARCH,Lr),this._events.set(ni.NAVIGATOR_SETTINGS,xr),this._events.set(ni.GENERIC_ALERT,Gr),this._events.set(ni.MOTD_MESSAGES,Yr),this._events.set(ni.NOTIFICATION_LIST,jr),this._events.set(ni.USER_RESPECT,Hr),this._events.set(ni.UNSEEN_ITEMS,Zr),this._events.set(ni.ROOM_ENTER_ERROR,cn),this._events.set(ni.ROOM_ENTER,hn),this._events.set(ni.ROOM_FORWARD,un),this._events.set(ni.ROOM_DOORBELL,qr),this._events.set(ni.ROOM_DOORBELL_ACCEPTED,Xr),this._events.set(ni.ROOM_DOORBELL_REJECTED,Qr),this._events.set(ni.ROOM_RIGHTS_CLEAR,tn),this._events.set(ni.ROOM_RIGHTS_OWNER,an),this._events.set(ni.ROOM_RIGHTS,rn),this._events.set(ni.ROOM_SETTINGS_CHAT,mn),this._events.set(ni.ROOM_INFO,fn),this._events.set(ni.ROOM_INFO_OWNER,bn),this._events.set(ni.ROOM_SCORE,In),this._events.set(ni.ROOM_SETTINGS_SAVE_ERROR,Tn),this._events.set(ni.ROOM_SETTINGS,An),this._events.set(ni.ROOM_SETTINGS_SAVE,Cn),this._events.set(ni.ROOM_SETTINGS_UPDATED,Dn),this._events.set(ni.ROOM_ROLLING,Un),this._events.set(ni.ROOM_CREATED,Pn),this._events.set(ni.FURNITURE_ALIASES,Zn),this._events.set(ni.FURNITURE_DATA,zn),this._events.set(ni.FURNITURE_ITEMDATA,Kn),this._events.set(ni.ITEM_STACK_HELPER,Jn),this._events.set(ni.FURNITURE_STATE,ea),this._events.set(ni.ITEM_DIMMER_SETTINGS,Ge),this._events.set(ni.FURNITURE_STATE_2,$n),this._events.set(ni.FURNITURE_FLOOR_ADD,Gn),this._events.set(ni.FURNITURE_FLOOR,Yn),this._events.set(ni.FURNITURE_FLOOR_REMOVE,jn),this._events.set(ni.FURNITURE_FLOOR_UPDATE,Hn),this._events.set(ni.ITEM_WALL_ADD,ra),this._events.set(ni.ITEM_WALL,aa),this._events.set(ni.ITEM_WALL_REMOVE,ca),this._events.set(ni.ITEM_WALL_UPDATE,ha),this._events.set(ni.ROOM_MODEL_DOOR,ua),this._events.set(ni.ROOM_HEIGHT_MAP,ga),this._events.set(ni.ROOM_HEIGHT_MAP_UPDATE,pa),this._events.set(ni.ROOM_MODEL,Ta),this._events.set(ni.ROOM_MODEL_NAME,Aa),this._events.set(ni.ROOM_PAINT,Ca),this._events.set(ni.ROOM_THICKNESS,Da),this._events.set(ni.PET_FIGURE_UPDATE,Ua),this._events.set(ni.PLAYING_GAME,Pa),this._events.set(ni.UNIT_DANCE,Ba),this._events.set(ni.UNIT_EFFECT,Wa),this._events.set(ni.UNIT,Ka),this._events.set(ni.UNIT_EXPRESSION,Ja),this._events.set(ni.UNIT_HAND_ITEM,$a),this._events.set(ni.UNIT_IDLE,eo),this._events.set(ni.UNIT_INFO,io),this._events.set(ni.UNIT_NUMBER,no),this._events.set(ni.UNIT_REMOVE,oo),this._events.set(ni.UNIT_STATUS,lo),this._events.set(ni.UNIT_CHAT,Fa),this._events.set(ni.UNIT_CHAT_SHOUT,Ga),this._events.set(ni.UNIT_CHAT_WHISPER,Va),this._events.set(ni.UNIT_TYPING,ka),this._events.set(ni.WIRED_ACTION,po),this._events.set(ni.WIRED_CONDITION,So),this._events.set(ni.WIRED_TRIGGER,Io),this._events.set(ni.WIRED_OPEN,To),this._events.set(ni.WIRED_REWARD,Ao),this._events.set(ni.WIRED_SAVE,Co),this._events.set(ni.WIRED_ERROR,Do),this._events.set(ni.AUTHENTICATED,ye),this._events.set(ni.USER_PERKS,wo),this._events.set(ni.USER_PERMISSIONS,Lo),this._events.set(ni.USER_BADGES_CURRENT,xo),this._events.set(ni.USER_FIGURE,Go),this._events.set(ni.USER_INFO,ko),this._events.set(ni.UNIT_CHANGE_NAME,Bo),this._events.set(ni.USER_SETTINGS,Wo),this._events.set(ni.USER_BOTS,hi),this._events.set(ni.REMOVE_BOT_FROM_INVENTORY,ui),this._events.set(ni.ADD_BOT_TO_INVENTORY,ci),this._events.set(ni.USER_CREDITS,zo),this._events.set(ni.USER_CURRENCY,Ko),this._events.set(ni.USER_CURRENCY_UPDATE,Jo),this._events.set(ni.USER_SUBSCRIPTION,$o),this._events.set(ni.LOAD_GAME_URL,si),this._events.set(ni.ACHIEVEMENT_PROGRESSED,b),this._events.set(ni.ACHIEVEMENT_LIST,I),this._events.set(ni.USER_ACHIEVEMENT_SCORE,T)}registerComposers(){this._composers.set(kc.CATALOG_MODE,tc),this._composers.set(kc.CATALOG_PAGE,ec),this._composers.set(kc.CATALOG_PURCHASE,sc),this._composers.set(kc.CATALOG_SEARCH,ic),this._composers.set(kc.CATALOG_CLUB,Z_),this._composers.set(kc.CATALOG_REDEEM_VOUCHER,rc),this._composers.set(kc.CLIENT_PONG,Ce),this._composers.set(kc.RELEASE_VERSION,Ne),this._composers.set(kc.DESKTOP_VIEW,nc),this._composers.set(kc.MESSENGER_ACCEPT,ac),this._composers.set(kc.MESSENGER_DECLINE,oc),this._composers.set(kc.FIND_FRIENDS,cc),this._composers.set(kc.MESSENGER_FOLLOW,_c),this._composers.set(kc.MESSENGER_UPDATES,hc),this._composers.set(kc.MESSENGER_REQUESTS,lc),this._composers.set(kc.MESSENGER_SEARCH,uc),this._composers.set(kc.MESSENGER_INIT,dc),this._composers.set(kc.MESSENGER_REMOVE,gc),this._composers.set(kc.MESSENGER_REQUEST,mc),this._composers.set(kc.MESSENGER_CHAT,pc),this._composers.set(kc.MESSENGER_ROOM_INVITE,Ec),this._composers.set(kc.MESSENGER_RELATIONSHIPS_UPDATE,fc),this._composers.set(kc.USER_VISIT,Sc),this._composers.set(kc.NAVIGATOR_CATEGORIES,wc),this._composers.set(kc.NAVIGATOR_INIT,Lc),this._composers.set(kc.NAVIGATOR_SEARCH_CLOSE,Pc),this._composers.set(kc.NAVIGATOR_SEARCH,xc),this._composers.set(kc.NAVIGATOR_SEARCH_OPEN,Fc),this._composers.set(kc.NAVIGATOR_SEARCH_SAVE,Gc),this._composers.set(kc.NAVIGATOR_SETTINGS,Vc),this._composers.set(kc.NAVIGATOR_SETTINGS_SAVE,Yc),this._composers.set(kc.NAVIGATOR_CATEGORY_LIST_MODE,Uc),this._composers.set(kc.USER_FURNITURE,Ic),this._composers.set(kc.USER_FURNITURE2,Rc),this._composers.set(kc.ITEM_SAVE_BACKGROUND,s_),this._composers.set(kc.TRADE_ACCEPT,vc),this._composers.set(kc.TRADE_CANCEL,Tc),this._composers.set(kc.TRADE_CLOSE,Oc),this._composers.set(kc.TRADE_CONFIRM,Ac),this._composers.set(kc.TRADE_ITEM,yc),this._composers.set(kc.TRADE_ITEMS,Cc),this._composers.set(kc.TRADE_ITEM_REMOVE,Mc),this._composers.set(kc.TRADE,Dc),this._composers.set(kc.TRADE_UNACCEPT,Nc),this._composers.set(kc.ACHIEVEMENT_LIST,O),this._composers.set(kc.PET_RESPECT,jc),this._composers.set(kc.ROOM_CREATE,S_),this._composers.set(kc.ROOM_ENTER,Bc),this._composers.set(kc.ROOM_DOORBELL,z_),this._composers.set(kc.ROOM_AMBASSADOR_ALERT,Hc),this._composers.set(kc.ROOM_BAN_GIVE,Wc),this._composers.set(kc.ROOM_RIGHTS_GIVE,Zc),this._composers.set(kc.ROOM_KICK,zc),this._composers.set(kc.ROOM_MUTE_USER,Xc),this._composers.set(kc.ROOM_RIGHTS_REMOVE,Kc),this._composers.set(kc.ROOM_INFO,qc),this._composers.set(kc.GET_ITEM_DATA,Jc),this._composers.set(kc.REMOVE_WALL_ITEM,e_),this._composers.set(kc.MODIFY_WALL_ITEM_DATA,Qc),this._composers.set(kc.BOT_PLACE,$c),this._composers.set(kc.BOT_PICKUP,t_),this._composers.set(kc.FURNITURE_ALIASES,r_),this._composers.set(kc.FURNITURE_PICKUP,n_),this._composers.set(kc.FURNITURE_PLACE,a_),this._composers.set(kc.ITEM_PAINT,o_),this._composers.set(kc.FURNITURE_POSTIT_PLACE,c_),this._composers.set(kc.FURNITURE_FLOOR_UPDATE,i_),this._composers.set(kc.FURNITURE_WALL_UPDATE,E_),this._composers.set(kc.ITEM_COLOR_WHEEL_CLICK,__),this._composers.set(kc.ITEM_DICE_CLICK,h_),this._composers.set(kc.ITEM_DICE_CLOSE,l_),this._composers.set(kc.FURNITURE_MULTISTATE,u_),this._composers.set(kc.FURNITURE_RANDOMSTATE,g_),this._composers.set(kc.ITEM_STACK_HELPER,m_),this._composers.set(kc.FURNITURE_WALL_MULTISTATE,p_),this._composers.set(kc.ONE_WAY_DOOR_CLICK,d_),this._composers.set(kc.ROOM_MODEL,f_),this._composers.set(kc.UNIT_ACTION,O_),this._composers.set(kc.UNIT_DANCE,A_),this._composers.set(kc.UNIT_DROP_HAND_ITEM,y_),this._composers.set(kc.UNIT_GIVE_HANDITEM,C_),this._composers.set(kc.UNIT_LOOK,M_),this._composers.set(kc.UNIT_SIGN,N_),this._composers.set(kc.UNIT_POSTURE,D_),this._composers.set(kc.UNIT_WALK,w_),this._composers.set(kc.UNIT_CHAT,b_),this._composers.set(kc.UNIT_CHAT_SHOUT,R_),this._composers.set(kc.UNIT_CHAT_WHISPER,I_),this._composers.set(kc.UNIT_TYPING,v_),this._composers.set(kc.UNIT_TYPING_STOP,T_),this._composers.set(kc.WIRED_APPLY_SNAPSHOT,U_),this._composers.set(kc.WIRED_OPEN,L_),this._composers.set(kc.WIRED_ACTION_SAVE,P_),this._composers.set(kc.WIRED_CONDITION_SAVE,x_),this._composers.set(kc.WIRED_TRIGGER_SAVE,F_),this._composers.set(kc.SECURITY_TICKET,we),this._composers.set(kc.USER_RESPECT,H_),this._composers.set(kc.USER_BADGES_CURRENT,G_),this._composers.set(kc.USER_FIGURE,V_),this._composers.set(kc.USER_HOME_ROOM,Y_),this._composers.set(kc.USER_INFO,Ue),this._composers.set(kc.USER_MOTTO,k_),this._composers.set(kc.USER_BOTS,bc),this._composers.set(kc.USER_CURRENCY,j_),this._composers.set(kc.USER_SUBSCRIPTION,B_)}get events(){return this._events}get composers(){return this._composers}}class J_ extends z{constructor(t){super(),this._communication=t,this._connection=null,this._messages=new q_,this._demo=new Pe(this),this.onConnectionOpenedEvent=this.onConnectionOpenedEvent.bind(this),this.onConnectionClosedEvent=this.onConnectionClosedEvent.bind(this),this.onConnectionErrorEvent=this.onConnectionErrorEvent.bind(this),this.onConnectionAuthenticatedEvent=this.onConnectionAuthenticatedEvent.bind(this)}onInit(){this._connection||(um.instance.events.addEventListener(Le.CONNECTION_AUTHENTICATED,this.onConnectionAuthenticatedEvent),this._connection=this._communication.createConnection(this),this._connection.registerMessages(this._messages),this._connection.addEventListener(j.CONNECTION_OPENED,this.onConnectionOpenedEvent),this._connection.addEventListener(j.CONNECTION_CLOSED,this.onConnectionClosedEvent),this._connection.addEventListener(j.CONNECTION_ERROR,this.onConnectionErrorEvent),this._demo&&this._demo.init(),this._connection.init(um.instance.getConfiguration("socket.url")))}onDispose(){this._demo&&this._demo.dispose(),this._connection&&(this._connection.removeEventListener(j.CONNECTION_OPENED,this.onConnectionOpenedEvent),this._connection.removeEventListener(j.CONNECTION_CLOSED,this.onConnectionClosedEvent),this._connection.removeEventListener(j.CONNECTION_ERROR,this.onConnectionErrorEvent)),um.instance.events.removeEventListener(Le.CONNECTION_AUTHENTICATED,this.onConnectionAuthenticatedEvent),super.onDispose()}onConnectionOpenedEvent(t){this.logger.log("Connection Initialized")}onConnectionClosedEvent(t){this.logger.log("Connection Closed")}onConnectionErrorEvent(t){this.logger.log("Connection Error")}onConnectionAuthenticatedEvent(t){this.logger.log("Connection Authenticated"),this._connection&&this._connection.authenticated()}connectionInit(t){this.logger.log("Initializing Connection: "+t)}registerMessageEvent(t){return this._connection&&this._connection.addMessageEvent(t),t}removeMessageEvent(t){this._connection&&this._connection.removeMessageEvent(t)}get demo(){return this._demo}get connection(){return this._connection}}class Q_{static get available(){return!0}static call(t,...e){if(window.top!==window&&window.top.postMessage("Nitro_LegacyExternalInterface"+JSON.stringify({method:t,params:e}),"*"),!("FlashExternalInterface"in window))return;const s=window.FlashExternalInterface[t];return void 0!==s?s(...e):void 0}static callGame(t,...e){if(window.top!==window&&window.top.postMessage("Nitro_LegacyExternalGameInterface"+JSON.stringify({method:t,params:e}),"*"),!("FlashExternalGameInterface"in window))return;const s=window.FlashExternalGameInterface[t];return void 0!==s?s(...e):void 0}}class $_{constructor(t){t.addMessageEvent(new si(this.onLoadGameUrl.bind(this)))}onLoadGameUrl(t){if(!t)return;const e=t.getParser();e&&Q_.callGame("showGame",e.url)}}class th{constructor(t){this._badgeId="",this._level=1,this._base="",this._badgeId=t,this.parseText()}parseText(){let t=this._badgeId.length-1;for(;t>0&&this.isNumber(this._badgeId.charAt(t));)t--;this._base=this._badgeId.substr(0,t+1);const e=this._badgeId.substr(t+1,this._badgeId.length);e&&""!==e&&(this._level=Number.parseInt(e))}isNumber(t){const e=t.charCodeAt(0);return e>=48&&e<=57}get level(){return this._level}set level(t){this._level=Math.max(1,t)}get getBadgeId(){return this._base+this._level}get base(){return this._base}}let eh=(()=>{class t extends y{constructor(t){super(t)}}return t.LOADED="NLE_LOADED",t.FAILED="NLE_FAILED",t})();class sh extends z{constructor(){super(),this._definitions=new Map,this._parameters=new Map,this._romanNumerals=["I","II","III","IV","V","VI","VII","VIII","IX","X","XI","XII","XIII","XIV","XV","XVI","XVII","XVIII","XIX","XX","XXI","XXII","XXIII","XXIV","XXV","XXVI","XXVII","XXVIII","XXIX","XXX"]}onInit(){this.loadLocalizationFromURL(um.instance.getConfiguration("external.texts.url"))}loadLocalizationFromURL(t){const e=new XMLHttpRequest;try{e.open("GET",t),e.onloadend=this.onLocalizationLoaded.bind(this),e.onerror=this.onLocalizationFailed.bind(this),e.send()}catch(s){this.logger.error(s)}}onLocalizationLoaded(t){t&&(this.parseLocalization(t.target.response),this.events&&this.events.dispatchEvent(new eh(eh.LOADED)))}onLocalizationFailed(t){this.events&&this.events.dispatchEvent(new eh(eh.FAILED))}parseLocalization(t){if(t){t=JSON.parse(t);for(const e in t)this._definitions.set(e,t[e])}}getRomanNumeral(t){return this._romanNumerals[Math.max(0,t-1)]}getBadgeBaseAndLevel(t){const e=new th(t);return e.level--,e.getBadgeId}getValue(t,e=!0){t.startsWith("${")&&(t=t.substr(2,t.length-3));let s=this._definitions.get(t)||t;if(e){const e=this._parameters.get(t);if(e)for(const[t,i]of e)s=s.replace("%"+t+"%",i)}return s}getValueWithParameter(t,e,s){let i=this.getValue(t,!1);return i=i.replace("%"+e+"%",s),i}setValue(t,e){this._definitions.set(t,e)}registerParameter(t,e,s){if(!t||0===t.length||!e||0===e.length)return;let i=this._parameters.get(t);i||(i=new Map,this._parameters.set(t,i)),i.set(e,s)}}let ih=(()=>{class t extends y{constructor(t,e){super(t),this._roomId=e}get roomId(){return this._roomId}}return t.INITIALIZED="REE_INITIALIZED",t.ENGINE_INITIALIZED="REE_ENGINE_INITIALIZED",t.OBJECTS_INITIALIZED="REE_OBJECTS_INITIALIZED",t.NORMAL_MODE="REE_NORMAL_MODE",t.GAME_MODE="REE_GAME_MODE",t.ROOM_ZOOMED="REE_ROOM_ZOOMED",t.DISPOSED="REE_DISPOSED",t})();class rh extends y{constructor(t,e){super(t),this._object=e}get object(){return this._object}get objectId(){return this._object?this._object.id:-1}get objectType(){return this._object?this._object.type:null}}let nh=(()=>{class t extends rh{constructor(t,e,s,i=!1,r=!1,n=!1,a=!1){super(t,e),this._eventId="",this._eventId=s,this._altKey=i,this._ctrlKey=r,this._shiftKey=n,this._buttonDown=a}get eventId(){return this._eventId}get altKey(){return this._altKey}get ctrlKey(){return this._ctrlKey}get shiftKey(){return this._shiftKey}get buttonDown(){return this._buttonDown}get localX(){return this._localX}set localX(t){this._localX=t}get localY(){return this._localY}set localY(t){this._localY=t}get spriteOffsetX(){return this._spriteOffsetX}set spriteOffsetX(t){this._spriteOffsetX=t}get spriteOffsetY(){return this._spriteOffsetY}set spriteOffsetY(t){this._spriteOffsetY=t}}return t.CLICK="ROE_MOUSE_CLICK",t.DOUBLE_CLICK="ROE_MOUSE_DOUBLE_CLICK",t.MOUSE_MOVE="ROE_MOUSE_MOVE",t.MOUSE_DOWN="ROE_MOUSE_DOWN",t.MOUSE_UP="ROE_MOUSE_UP",t.MOUSE_ENTER="ROE_MOUSE_ENTER",t.MOUSE_LEAVE="ROE_MOUSE_LEAVE",t})();class ah{constructor(t,e){this._location=t,this._direction=e}get location(){return this._location}get direction(){return this._direction}}let oh=(()=>{class t{}return t.MOUSE_CLICK="click",t.DOUBLE_CLICK="double_click",t.MOUSE_MOVE="mousemove",t.MOUSE_DOWN="mousedown",t.MOUSE_UP="mouseup",t.ROLL_OVER="mouseover",t.ROLL_OUT="mouseout",t})();class ch{constructor(t,e,s,i,r,n,a=0,o=0,c=!1,_=!1,h=!1,l=!1){this._type=t,this._eventId=e,this._canvasId=s,this._spriteTag=i,this._screenX=r,this._screenY=n,this._localX=a,this._localY=o,this._ctrlKey=c,this._altKey=_,this._shiftKey=h,this._buttonDown=l,this._spriteOffsetX=0,this._spriteOffsetY=0}get type(){return this._type}get _Str_3463(){return this._eventId}get canvasId(){return this._canvasId}get spriteTag(){return this._spriteTag}get screenX(){return this._screenX}get screenY(){return this._screenY}get localX(){return this._localX}get localY(){return this._localY}get ctrlKey(){return this._ctrlKey}get altKey(){return this._altKey}get shiftKey(){return this._shiftKey}get buttonDown(){return this._buttonDown}get spriteOffsetX(){return this._spriteOffsetX}set spriteOffsetX(t){this._spriteOffsetX=t}get spriteOffsetY(){return this._spriteOffsetY}set spriteOffsetY(t){this._spriteOffsetY=t}}let _h=(()=>{class t{}return t.DEFAULT=1,t._Str_8616=2,t._Str_11629=3,t._Str_10494=4,t})(),hh=(()=>{class t{static init(e,s){t._currentDelta=0,t._startDelayMs=e,t._effectDurationMs=s,t._initializationTimeMs=um.instance.time,t._state=t.STATE_START_DELAY}static turnVisualizationOn(){if(t._state===t.STATE_NOT_INITIALIZED||t._state===t.STATE_OVER)return;const e=um.instance.time-t._initializationTimeMs;e>t._startDelayMs+t._effectDurationMs?t._state=t.STATE_OVER:(t._visualizationOn=!0,e<t._startDelayMs?t._state=t.STATE_START_DELAY:(t._state=t.STATE_RUNNING,t._currentDelta=(e-t._startDelayMs)/t._effectDurationMs))}static turnVisualizationOff(){t._visualizationOn=!1}static isVisualizationOn(){return t._visualizationOn&&t.isRunning()}static isRunning(){return t._state===t.STATE_START_DELAY||t._state===t.STATE_RUNNING}static getDelta(e=0,s=1){return Math.min(Math.max(t._currentDelta,e),s)}static get totalRunningTime(){return t._startDelayMs+t._effectDurationMs}}return t.STATE_NOT_INITIALIZED=0,t.STATE_START_DELAY=1,t.STATE_RUNNING=2,t.STATE_OVER=3,t._state=t.STATE_NOT_INITIALIZED,t._visualizationOn=!1,t._currentDelta=0,t._initializationTimeMs=0,t._startDelayMs=2e4,t._effectDurationMs=2e3,t})(),lh=(()=>{class t{constructor(t,e,s,i=null){this._updateId=0,this._scale=1,this._x_scale=1,this._y_scale=1,this._z_scale=1,this._x_scale_internal=1,this._y_scale_internal=1,this._z_scale_internal=1,this._clipNear=-500,this._clipFar=500,this._displacements=null,this.scale=t,this._x=new ot,this._y=new ot,this._z=new ot,this._directionAxis=new ot,this._location=new ot,this._direction=new ot,this._depth=new ot,this._x_scale_internal=1,this._y_scale_internal=1,this.x_scale=1,this.y_scale=1,this._z_scale_internal=Math.sqrt(.5)/Math.sqrt(3/4),this.z_scale=1,this.location=new ot(s.x,s.y,s.z),this.direction=new ot(e.x,e.y,e.z),this.setDepthVector(null!=i?i:e),this._displacements=new Map}static getIntersectionVector(t,e,s,i){const r=ot.dotProduct(e,i);if(Math.abs(r)<1e-5)return null;const n=ot.dif(t,s),a=-ot.dotProduct(i,n)/r;return ot.sum(t,ot.product(e,a))}get updateId(){return this._updateId}get scale(){return this._scale/Math.sqrt(.5)}set scale(t){t<=1&&(t=1),(t*=Math.sqrt(.5))!=this._scale&&(this._scale=t,this._updateId++)}get directionAxis(){return this._directionAxis}get location(){return this._location.assign(this._loc),this._location.x=this._location.x*this._x_scale,this._location.y=this._location.y*this._y_scale,this._location.z=this._location.z*this._z_scale,this._location}set location(t){if(null==t)return;null==this._loc&&(this._loc=new ot);const e=this._loc.x,s=this._loc.y,i=this._loc.z;this._loc.assign(t),this._loc.x=this._loc.x/this._x_scale,this._loc.y=this._loc.y/this._y_scale,this._loc.z=this._loc.z/this._z_scale,this._loc.x==e&&this._loc.y==s&&this._loc.z==i||this._updateId++}get direction(){return this._direction}set direction(t){let e,s,i,r,n;if(null==t)return;null==this._dir&&(this._dir=new ot);const a=this._dir.x,o=this._dir.y,c=this._dir.z;this._dir.assign(t),this._direction.assign(t),this._dir.x==a&&this._dir.y==o&&this._dir.z==c||this._updateId++;const _=new ot(0,1,0),h=new ot(0,0,1),l=new ot(1,0,0),u=t.x/180*Math.PI,d=t.y/180*Math.PI,g=t.z/180*Math.PI,m=Math.cos(u),p=Math.sin(u),E=ot.sum(ot.product(_,m),ot.product(l,-p)),f=new ot(h.x,h.y,h.z),S=ot.sum(ot.product(_,p),ot.product(l,m)),b=Math.cos(d),R=Math.sin(d),I=new ot(E.x,E.y,E.z),v=ot.sum(ot.product(f,b),ot.product(S,R)),T=ot.sum(ot.product(f,-R),ot.product(S,b));0!=g?(e=Math.cos(g),s=Math.sin(g),i=ot.sum(ot.product(I,e),ot.product(v,s)),r=ot.sum(ot.product(I,-s),ot.product(v,e)),n=new ot(T.x,T.y,T.z),this._x.assign(i),this._y.assign(r),this._z.assign(n),this._directionAxis.assign(this._z)):(this._x.assign(I),this._y.assign(v),this._z.assign(T),this._directionAxis.assign(this._z))}set x_scale(t){this._x_scale!=t*this._x_scale_internal&&(this._x_scale=t*this._x_scale_internal,this._updateId++)}set y_scale(t){this._y_scale!=t*this._y_scale_internal&&(this._y_scale=t*this._y_scale_internal,this._updateId++)}set z_scale(t){this._z_scale!=t*this._z_scale_internal&&(this._z_scale=t*this._z_scale_internal,this._updateId++)}dispose(){this._x=null,this._y=null,this._z=null,this._loc=null,this._dir=null,this._directionAxis=null,this._location=null,null!=this._displacements&&(this._displacements.clear(),this._displacements=null)}setDisplacement(t,e){let s,i;null!=t&&null!=e&&null!=this._displacements&&(s=Math.trunc(Math.round(t.x))+"_"+Math.trunc(Math.round(t.y))+"_"+Math.trunc(Math.round(t.z)),this._displacements.delete(s),i=new ot,i.assign(e),this._displacements.set(s,i),this._updateId++)}getDisplacenent(t){let e;return null!=this._displacements?(e=Math.trunc(Math.round(t.x))+"_"+Math.trunc(Math.round(t.y))+"_"+Math.trunc(Math.round(t.z)),this._displacements.get(e)):null}setDepthVector(t){let e,s,i,r,n;const a=new ot(0,1,0),o=new ot(0,0,1),c=new ot(1,0,0),_=t.x/180*Math.PI,h=t.y/180*Math.PI,l=t.z/180*Math.PI,u=Math.cos(_),d=Math.sin(_),g=ot.sum(ot.product(a,u),ot.product(c,-d)),m=new ot(o.x,o.y,o.z),p=ot.sum(ot.product(a,d),ot.product(c,u)),E=Math.cos(h),f=Math.sin(h),S=new ot(g.x,g.y,g.z),b=ot.sum(ot.product(m,E),ot.product(p,f)),R=ot.sum(ot.product(m,-f),ot.product(p,E));0!=l?(e=Math.cos(l),s=Math.sin(l),i=ot.sum(ot.product(S,e),ot.product(b,s)),r=ot.sum(ot.product(S,-s),ot.product(b,e)),n=new ot(R.x,R.y,R.z),this._depth.assign(n)):this._depth.assign(R),this._updateId++}adjustLocation(t,e){if(null==t||null==this._z)return;const s=ot.product(this._z,-e),i=new ot(t.x+s.x,t.y+s.y,t.z+s.z);this.location=i}getCoordinatePosition(t){if(null==t)return null;const e=ot.scalarProjection(t,this._x),s=ot.scalarProjection(t,this._y),i=ot.scalarProjection(t,this._z);return new ot(e,s,i)}getScreenPosition(t){let e=ot.dif(t,this._loc);e.x=e.x*this._x_scale,e.y=e.y*this._y_scale,e.z=e.z*this._z_scale;let s=ot.scalarProjection(e,this._depth);if(s<this._clipNear||s>this._clipFar)return null;let i=ot.scalarProjection(e,this._x),r=-ot.scalarProjection(e,this._y);i*=this._scale,r*=this._scale;const n=this.getDisplacenent(t);return null!=n&&(e=ot.dif(t,this._loc),e.add(n),e.x=e.x*this._x_scale,e.y=e.y*this._y_scale,e.z=e.z*this._z_scale,s=ot.scalarProjection(e,this._depth)),e.x=i,e.y=r,e.z=s,e}getScreenPoint(t){const e=this.getScreenPosition(t);return null==e?null:new A.j(e.x,e.y)}getPlanePosition(e,s,i,r){let n,a;const o=-e.y/this._scale,c=ot.product(this._x,e.x/this._scale);c.add(ot.product(this._y,o));const _=new ot(this._loc.x*this._x_scale,this._loc.y*this._y_scale,this._loc.z*this._z_scale);_.add(c);const h=this._z,l=new ot(s.x*this._x_scale,s.y*this._y_scale,s.z*this._z_scale),u=new ot(i.x*this._x_scale,i.y*this._y_scale,i.z*this._z_scale),d=new ot(r.x*this._x_scale,r.y*this._y_scale,r.z*this._z_scale),g=ot.crossProduct(u,d),m=new ot;return m.assign(t.getIntersectionVector(_,h,l,g)),null!=m?(m.subtract(l),n=ot.scalarProjection(m,i)/u.length*i.length,a=ot.scalarProjection(m,r)/d.length*r.length,new A.j(n,a)):null}performZoom(){this.scale=this.isZoomedIn()?t.SCALE_ZOOMED_OUT:t.SCALE_ZOOMED_IN}isZoomedIn(){return this.scale==t.SCALE_ZOOMED_IN}performZoomOut(){this.scale=t.SCALE_ZOOMED_OUT}performZoomIn(){this.scale=t.SCALE_ZOOMED_IN}}return t.SCALE_ZOOMED_IN=64,t.SCALE_ZOOMED_OUT=32,t})();class uh{constructor(t){this._roomObjectVariableAccurateZ=t||"",this._location=new ot,this._screenLocation=new ot,this._locationChanged=!1,this._geometryUpdateId=-1,this._objectUpdateId=-1}dispose(){this._screenLocation=null}updateLocation(t,e){if(!t||!e)return null;let s=!1;const i=t.getLocation();if(e.updateId===this._geometryUpdateId&&t.updateCounter===this._objectUpdateId||(this._objectUpdateId=t.updateCounter,e.updateId===this._geometryUpdateId&&i.x===this._location.x&&i.y===this._location.y&&i.z===this._location.z||(this._geometryUpdateId=e.updateId,this._location.assign(i),s=!0)),this._locationChanged=s,this._locationChanged){const s=e.getScreenPosition(i);if(!s)return null;const r=t.model.getValue(this._roomObjectVariableAccurateZ);if(isNaN(r)||0===r){const t=new ot(Math.round(i.x),Math.round(i.y),i.z);if(t.x!==i.x||t.y!==i.y){const i=e.getScreenPosition(t);this._screenLocation.assign(s),i&&(this._screenLocation.z=i.z)}else this._screenLocation.assign(s)}else this._screenLocation.assign(s);this._screenLocation.x=Math.round(this._screenLocation.x),this._screenLocation.y=Math.round(this._screenLocation.y)}return this._screenLocation}get locationChanged(){return this._locationChanged}}class dh{constructor(){this._sprites=[],this._updateId1=-1,this._updateId2=-1,this._isEmpty=!1}get _Str_3008(){return this._sprites.length}get isEmpty(){return this._isEmpty}dispose(){this._Str_20276(0)}_Str_12937(t){this._sprites.push(t)}_Str_2505(t){return this._sprites[t]}get _Str_9272(){return this._sprites}_Str_17574(t,e){return(t!==this._updateId1||e!==this._updateId2)&&(this._updateId1=t,this._updateId2=e,!0)}_Str_20276(t){if(t<this._sprites.length){let e=t;for(;e<this._sprites.length;){const t=this._sprites[e];t&&t.dispose(),e++}this._sprites.splice(t,this._sprites.length-t)}this._isEmpty=!this._sprites.length}}class gh{constructor(t){this._location=new uh(t),this._sprites=new dh}get location(){return this._location}get sprites(){return this._sprites}dispose(){this._location&&(this._location.dispose(),this._location=null),this._sprites&&(this._sprites.dispose(),this._sprites=null)}get _Str_1577(){return this._objectId}set _Str_1577(t){this._objectId=t}}let mh=(()=>{class t{constructor(t){this._data=new Map,this._roomObjectVariableAccurateZ=t}dispose(){if(this._data){for(const[t,e]of this._data.entries())e&&(this._data.delete(t),e.dispose());this._data=null}}getObjectCache(t){let e=this._data.get(t);return e||(e=new gh(this._roomObjectVariableAccurateZ),this._data.set(t,e)),e}removeObjectCache(t){const e=this._data.get(t);e&&(this._data.delete(t),e.dispose())}getSortableSpriteList(){const e=[];for(const s of this._data.values()){if(!s)continue;const i=s.sprites&&s.sprites._Str_9272;if(i&&i.length)for(const r of i)if(r&&r.sprite.spriteType!==_h._Str_8616&&""!==r.sprite.name){const i=new It;i.objectId=s._Str_1577,i.x=r.x,i.y=r.y,i.z=r.z,i.name=r.sprite.name||"",i.flipH=r.sprite.flipH,i.alpha=r.sprite.alpha,i.color=r.sprite.color.toString(),i.blendMode=r.sprite.blendMode.toString(),i.width=r.sprite.width,i.height=r.sprite.height,i.type=r.sprite.type,i.posture=r.sprite.posture;const n=this.isSkewedSprite(r.sprite);n&&(i.skew=r.sprite.direction%4==0?-.5:.5),(n||r.name.indexOf("%image.library.url%")>=0||r.name.indexOf("%group.badge.url%")>=0)&&i.width<=t.MAX_SIZE_FOR_AVG_COLOR&&i.height<=t.MAX_SIZE_FOR_AVG_COLOR&&0===r.sprite.name.indexOf("external_image_wallitem")&&(i.frame=!0),e.push(i)}}return e&&e.length?e:null}isSkewedSprite(t){return!!t.type&&(0===t.type.indexOf("external_image_wallitem")&&"THUMBNAIL"===t.tag||0===t.type.indexOf("guild_forum")&&"THUMBNAIL"===t.tag)}getPlaneSortableSprites(){const t=[];for(const e of this._data.values())for(const s of e.sprites._Str_9272)s.sprite.spriteType===_h._Str_8616&&t.push(s);return t}}return t.MAX_SIZE_FOR_AVG_COLOR=200,t})();class ph extends A.n{constructor(t=null){super(t),this._offsetX=0,this._offsetY=0,this._tag="",this._alphaTolerance=128,this._Str_8253=!1,this._clickHandling=!1,this._pairedSpriteId=-1,this._pairedSpriteUpdateCounter=-1}needsUpdate(t,e){return(this._pairedSpriteId!==t||this._pairedSpriteUpdateCounter!==e)&&(this._pairedSpriteId=t,this._pairedSpriteUpdateCounter=e,!0)}render(t){super.render(t)}setTexture(t){t||(t=A.p.EMPTY),t!==this.texture&&(t===A.p.EMPTY&&(this._pairedSpriteId=-1,this._pairedSpriteUpdateCounter=-1),this.texture=t)}containsPoint(t){return ph.containsPoint(this,t)}static containsPoint(t,e){if(!t||!e||t.alphaTolerance>255)return!1;if(!(t instanceof A.n))return!1;if(t.texture===A.p.EMPTY||t.blendMode!==A.b.NORMAL)return;const s=t.texture,i=s.baseTexture;if(!s||!i||!i.valid)return!1;const r=e.x*t.scale.x,n=e.y*t.scale.y;if(!t.getLocalBounds().contains(r,n))return!1;if(!i.hitMap){let t=null;if(!i.resource)if(s.getLocalBounds)t=um.instance.renderer.extract.canvas(s);else{const e=A.n.from(s);t=um.instance.renderer.extract.canvas(e),e.destroy()}if(!ph.generateHitMap(i,t))return!1}const a=i.hitMap,o=i.hitMapWidth,c=i.resolution,_=Math.round((r+s.frame.x)*c),h=4*(Math.round((n+s.frame.y)*c)*o+_);return void 0!==a[h+3]&&a[h+3]>t.alphaTolerance}static generateHitMap(t,e=null){let s=null,i=null;if(e)s=e,i=s.getContext("2d");else{if(!t.resource)return!1;const e=t.resource.source;if(!e)return!1;if(e.getContext)s=e,i=s.getContext("2d");else{if(!(e instanceof Image))return!1;s=document.createElement("canvas"),s.width=e.width,s.height=e.height,i=s.getContext("2d"),i.drawImage(e,0,0)}}const r=s.width,n=i.getImageData(0,0,r,s.height);return t.hitMap=n.data,t.hitMapWidth=r,!0}get offsetX(){return this._offsetX}set offsetX(t){this._offsetX=t}get offsetY(){return this._offsetY}set offsetY(t){this._offsetY=t}get tag(){return this._tag}set tag(t){this._tag=t}get alphaTolerance(){return this._alphaTolerance}set alphaTolerance(t){this._alphaTolerance=t}get _Str_4593(){return this._Str_8253}set _Str_4593(t){this._Str_8253=t}get clickHandling(){return this._clickHandling}set clickHandling(t){this._clickHandling=t}}class Eh{constructor(){this._objectId="",this._spriteTag=""}get objectId(){return this._objectId}set objectId(t){this._objectId=t}get spriteTag(){return this._spriteTag}set spriteTag(t){this._spriteTag=t}}let fh=(()=>{class t{constructor(){this._name="",this._sprite=null,this._x=0,this._y=0,this._z=0}dispose(){this._z=-t._Str_17154,this._sprite=null}get name(){return this._name}set name(t){this._name=t}get sprite(){return this._sprite}set sprite(t){this._sprite=t}get x(){return this._x}set x(t){this._x=t}get y(){return this._y}set y(t){this._y=t}get z(){return this._z}set z(t){this._z=t}}return t._Str_17154=1e8,t})();class Sh{constructor(t,e,s,i,r){this._id=e,this._container=t,this._geometry=new lh(r,new ot(-135,30,0),new ot(11,11,5),new ot(-135,.5,0)),this._renderTimestamp=0,this._master=null,this._display=null,this._mask=null,this._sortableSprites=[],this._spriteCount=0,this._activeSpriteCount=0,this._spritePool=[],this._skipObjectUpdate=!1,this._runningSlow=!1,this._width=0,this._height=0,this._renderedWidth=0,this._renderedHeight=0,this._screenOffsetX=0,this._screenOffsetY=0,this._mouseLocation=new A.j,this._mouseOldX=0,this._mouseOldY=0,this._mouseCheckCount=0,this._mouseSpriteWasHit=!1,this._mouseActiveObjects=new Map,this._eventCache=new Map,this._eventId=0,this._scale=1,this._restrictsScaling=!1,this._noSpriteVisibilityChecking=!1,this._usesExclusionRectangles=!1,this._usesMask=!0,this._canvasUpdated=!1,this._objectCache=new mh(this._container.roomObjectVariableAccurateZ),this._mouseListener=null,this.setupCanvas(),this.initialize(s,i)}setupCanvas(){if(this._master||(this._master=new A.n,this._master.interactiveChildren=!1),!this._display){const t=new A.d;t.name="canvas",this._master.addChild(t),this._display=t}}dispose(){if(this._Str_20677(0,!0),this._geometry&&(this._geometry.dispose(),this._geometry=null),this._mask&&(this._mask=null),this._objectCache&&(this._objectCache.dispose(),this._objectCache=null),this._master){for(;this._master.children.length;)this._master.removeChildAt(0).destroy();this._master.parent&&this._master.parent.removeChild(this._master),this._master.destroy(),this._master=null}if(this._display=null,this._sortableSprites=[],this._mouseActiveObjects&&(this._mouseActiveObjects.clear(),this._mouseActiveObjects=null),this._spritePool){for(const t of this._spritePool)this._Str_21974(t,!0);this._spritePool=[]}this._eventCache&&(this._eventCache.clear(),this._eventCache=null),this._mouseListener=null}initialize(t,e){if(t=t<1?1:t,e=e<1?1:e,this._usesMask&&(this._mask?this._mask.clear().beginFill(16711680).drawRect(0,0,t,e).endFill():(this._mask=(new A.f).beginFill(16711680).drawRect(0,0,t,e).endFill(),this._mask.name="mask",this._master&&(this._master.addChild(this._mask),this._display&&(this._display.mask=this._mask)))),this._master){if(this._master.hitArea){const s=this._master.hitArea;s.width=t,s.height=e}else this._master.hitArea=new A.k(0,0,t,e);if(this._master.filterArea){const s=this._master.filterArea;s.width=t,s.height=e}else this._master.filterArea=new A.k(0,0,t,e)}this._width=t,this._height=e}setMask(t){t&&!this._usesMask?(this._usesMask=!0,this._mask&&this._mask.parent!==this._master&&(this._master.addChild(this._mask),this._display.mask=this._mask)):!t&&this._usesMask&&(this._usesMask=!1,this._mask&&this._mask.parent===this._master&&(this._master.removeChild(this._mask),this._display.mask=null))}setScale(t,e=null,s=null,i=!1,r=!1){this._master&&this._display&&(this._restrictsScaling&&!i||(e||(e=new A.j(this._width/2,this._height/2)),s||(s=e),e=this._display.toLocal(e),r?this._scale*=t:this._scale=t,this.screenOffsetX=s.x-e.x*this._scale,this.screenOffsetY=s.y-e.y*this._scale))}render(t,e=!1){if(this._canvasUpdated=!1,-1===t&&(t=this._renderTimestamp+1),!this._container||!this._geometry)return;if(t===this._renderTimestamp)return;this._width===this._renderedWidth&&this._height===this._renderedHeight||(e=!0),this._display.x===~~this._screenOffsetX&&this._display.y===~~this._screenOffsetY||(this._display.x=~~this._screenOffsetX,this._display.y=~~this._screenOffsetY,e=!0),this._display.scale.x!==this._scale&&(this._display.scale.set(this._scale),e=!0);let s=0;const i=this._container.objects;if(i.size)for(const n of i.values())n&&(s+=this.renderObject(n,n.instanceId.toString(),t,e,s));this._sortableSprites.sort((t,e)=>e.z-t.z),s<this._sortableSprites.length&&this._sortableSprites.splice(s);let r=0;for(;r<s;){const t=this._sortableSprites[r];t&&t.sprite&&this.renderSprite(r,t),r++}this._Str_20677(s),e&&(this._canvasUpdated=!0),this._renderTimestamp=t,this._renderedWidth=this._width,this._renderedHeight=this._height}_Str_20787(){this._noSpriteVisibilityChecking=!0,this.render(-1,!0)}_Str_22174(){this._noSpriteVisibilityChecking=!1}getSortableSpriteList(){return this._objectCache.getSortableSpriteList()}_Str_14588(){return this._objectCache.getPlaneSortableSprites()}removeFromCache(t){this._objectCache.removeObjectCache(t)}renderObject(t,e,s,i,r){if(!t)return 0;const n=t.visualization;if(!n)return this.removeFromCache(e),0;const a=this.getCacheItem(e);a._Str_1577=t.instanceId;const o=a.location,c=a.sprites,_=o.updateLocation(t,this._geometry);if(!_)return this.removeFromCache(e),0;if(n.update(this._geometry,s,!c.isEmpty||i,this._skipObjectUpdate&&this._runningSlow),o.locationChanged&&(i=!0),!c._Str_17574(n.instanceId,n.updateSpriteCounter)&&!i)return c._Str_3008;let h=_.x,l=_.y,u=_.z;u+=h>0?12e-8*h:12e-8*-h,h+=this._width/2,l+=this._height/2;let d=0;for(const g of n.sprites.values()){if(!g||!g.visible)continue;const s=g.texture,i=s&&s.baseTexture;if(!s||!i)continue;const n=h+g.offsetX+this._screenOffsetX,a=l+g.offsetY+this._screenOffsetY;if(g.flipH){if(!this.isSpriteVisible(h+-(s.width+-g.offsetX)+this._screenOffsetX,a,s.width,s.height))continue}else if(g.flipV){if(!this.isSpriteVisible(n,l+-(s.height+-g.offsetY)+this._screenOffsetY,s.width,s.height))continue}else if(!this.isSpriteVisible(n,a,s.width,s.height))continue;let o=c._Str_2505(d);o||(o=new fh,c._Str_12937(o),this._sortableSprites.push(o),o.name=e),o.sprite=g,g.spriteType!==_h._Str_11629&&g.spriteType!==_h._Str_10494||(o.sprite._Str_3582="avatar_"+t.id),o.x=n-this._screenOffsetX,o.y=a-this._screenOffsetY,o.z=u+g.relativeDepth+37e-12*r,d++,r++}return c._Str_20276(d),this._canvasUpdated=!0,d}getExtendedSprite(t){return t<0||t>=this._spriteCount?null:this._display.getChildAt(t)||null}getExtendedSpriteIdentifier(t){return t?t.name:""}renderSprite(t,e){if(t>=this._spriteCount)return this.createAndAddSprite(e),!0;if(!e)return!1;const s=e.sprite,i=this.getExtendedSprite(t);if(!s||!i)return!1;if(i._Str_4593!==s._Str_4593)return i._Str_4593&&!s._Str_4593?(this._display.removeChildAt(t),this._spritePool.push(i),this.renderSprite(t,e)):(this.createAndAddSprite(e,t),!0);if(i.needsUpdate(s.id,s.updateCounter)||hh.isVisualizationOn()){i.tag=s.tag,i.alphaTolerance=s.alphaTolerance,i.name=e.name,i._Str_4593=s._Str_4593,i.clickHandling=s.clickHandling,i.filters=s.filters;const t=s.alpha/255;i.alpha!==t&&(i.alpha=t),i.tint!==s.color&&(i.tint=s.color),i.blendMode!==s.blendMode&&(i.blendMode=s.blendMode),i.texture!==s.texture&&i.setTexture(s.texture),s.updateContainer&&(1===i.children.length&&i.removeChildAt(0),i.addChild(s.container),s.updateContainer=!1),s.flipH?-1!==i.scale.x&&(i.scale.x=-1):1!==i.scale.x&&(i.scale.x=1),s.flipV?-1!==i.scale.y&&(i.scale.y=-1):1!==i.scale.y&&(i.scale.y=1),this._Str_21914(i,s)}return i.x!==e.x&&(i.x=~~e.x),i.y!==e.y&&(i.y=~~e.y),i.offsetX=s.offsetX,i.offsetY=s.offsetY,!0}createAndAddSprite(t,e=-1){const s=t.sprite;if(!s)return;let i=null;this._spritePool.length>0&&(i=this._spritePool.pop()),i||(i=new ph),i.children.length&&i.removeChildren(),i.tag=s.tag,i.alphaTolerance=s.alphaTolerance,i.alpha=s.alpha/255,i.tint=s.color,i.x=~~t.x,i.y=~~t.y,i.offsetX=s.offsetX,i.offsetY=s.offsetY,i.name=s.name,i._Str_4593=s._Str_4593,i.clickHandling=s.clickHandling,i.blendMode=s.blendMode,i.filters=s.filters,i.setTexture(s.texture),s.updateContainer&&(i.addChild(s.container),s.updateContainer=!1),s.flipH&&(i.scale.x=-1),s.flipV&&(i.scale.y=-1),this._Str_21914(i,s),e<0||e>=this._spriteCount?(this._display.addChild(i),this._spriteCount++):this._display.addChildAt(i,e),this._activeSpriteCount++}_Str_20677(t,e=!1){if(this._display){if(t<0&&(t=0),t<this._activeSpriteCount||!this._activeSpriteCount){let s=this._spriteCount-1;for(;s>=t;)this._Str_21974(this.getExtendedSprite(s),e),s--}this._activeSpriteCount=t}}_Str_21914(t,e){if(hh.isVisualizationOn()&&e)switch(e.spriteType){case _h._Str_10494:return;case _h._Str_8616:return void(t.alpha=hh.getDelta(.9));case _h._Str_11629:return void(t.alpha=hh.getDelta(.5));default:t.alpha=hh.getDelta(.1)}}_Str_21974(t,e){t&&(e?(t.parent&&t.parent.removeChild(t),t.destroy({children:!0})):t.setTexture(null))}update(){this._mouseCheckCount=0,this._eventId++}setMouseListener(t){this._mouseListener=t}getCacheItem(t){return this._objectCache.getObjectCache(t)}isSpriteVisible(t,e,s,i){return!!this._noSpriteVisibilityChecking||(e=(e-this._screenOffsetY)*this._scale+this._screenOffsetY,(t=(t-this._screenOffsetX)*this._scale+this._screenOffsetX)<this._width&&t+(s*=this._scale)>=0&&e<this._height&&e+(i*=this._scale)>=0&&!this._usesExclusionRectangles)}_Str_21232(t,e,s,i,r,n,a){return e-=this._screenOffsetY,this._mouseLocation.x=(t-=this._screenOffsetX)/this._scale,this._mouseLocation.y=e/this._scale,this._mouseCheckCount>0&&s==oh.MOUSE_MOVE||(this._mouseSpriteWasHit=this._Str_19207(t/this._scale,e/this._scale,s,i,r,n,a),this._mouseCheckCount++),this._mouseSpriteWasHit}_Str_19207(t,e,s,i=!1,r=!1,n=!1,a=!1){const o=[];let c=!1,_=null,h=this._activeSpriteCount-1;for(;h>=0;){const l=this.getExtendedSprite(h);if(l&&l.containsPoint(new A.j(t-l.x,e-l.y))&&(!l.clickHandling||s!==oh.MOUSE_CLICK&&s!==oh.DOUBLE_CLICK)){const h=this.getExtendedSpriteIdentifier(l);if(-1===o.indexOf(h)){const c=l.tag;let u=this._mouseActiveObjects.get(h);u&&u.spriteTag!==c&&(_=this._Str_11609(0,0,0,0,oh.ROLL_OUT,u.spriteTag,i,r,n,a),this._Str_14715(_,h)),s!==oh.MOUSE_MOVE||u&&u.spriteTag===c?(_=this._Str_11609(t,e,t-l.x,e-l.y,s,c,i,r,n,a),_.spriteOffsetX=l.offsetX,_.spriteOffsetY=l.offsetY):_=this._Str_11609(t,e,t-l.x,e-l.y,oh.ROLL_OVER,c,i,r,n,a),u||(u=new Eh,u.objectId=h,this._mouseActiveObjects.set(h,u)),u.spriteTag=c,s===oh.MOUSE_MOVE&&t===this._mouseOldX&&e===this._mouseOldY||this._Str_14715(_,h),o.push(h)}c=!0}h--}const l=[];for(const d of this._mouseActiveObjects.keys())d&&l.push(d);let u=0;for(;u<l.length;)o.indexOf(l[u])>=0&&(l[u]=null),u++;for(u=0;u<l.length;){const t=l[u];if(null!==t){const e=this._mouseActiveObjects.get(t);e&&this._mouseActiveObjects.delete(t);const s=this._Str_11609(0,0,0,0,oh.ROLL_OUT,e.spriteTag,i,r,n,a);this._Str_14715(s,t)}u++}return this._Str_20604(),this._mouseOldX=t,this._mouseOldY=e,c}_Str_11609(t,e,s,i,r,n,a,o,c,_){const h="canvas_"+this._id;return new ch(r,h+"_"+this._eventId,h,n,t-this._width/2,e-this._height/2,s,i,o,a,c,_)}_Str_14715(t,e){t&&this._eventCache&&(this._eventCache.delete(e),this._eventCache.set(e,t))}_Str_20604(){if(this._container&&this._eventCache){for(const[t,e]of this._eventCache.entries()){if(!this._eventCache)return;if(!e)continue;const s=this._container.getRoomObject(parseInt(t));if(s)if(this._mouseListener)this._mouseListener._Str_20330(e,s,this._geometry);else{const t=s.mouseHandler;t&&t.mouseEvent(e,this._geometry)}}this._eventCache&&this._eventCache.clear()}}getDisplayAsTexture(){this._noSpriteVisibilityChecking=!0;const t=this._scale,e=this._screenOffsetX,s=this._screenOffsetY;this.setScale(1,null,null,!0),this._screenOffsetX=0,this._screenOffsetY=0,this.render(-1,!0);const i=this._display.getBounds(),r=A.l.create({width:this._display.width,height:this._display.height});return um.instance.renderer.render(this._display,r,!0,new A.i(1,0,0,1,-i.x,-i.y)),this._noSpriteVisibilityChecking=!1,this.setScale(t,null,null,!0),this._screenOffsetX=e,this._screenOffsetY=s,r}get id(){return this._id}get geometry(){return this._geometry}get master(){return this._master}get display(){return this._display}get screenOffsetX(){return this._screenOffsetX}set screenOffsetX(t){this._mouseLocation.x=this._mouseLocation.x-(t-this._screenOffsetX),this._screenOffsetX=t}get screenOffsetY(){return this._screenOffsetY}set screenOffsetY(t){this._mouseLocation.y=this._mouseLocation.y-(t-this._screenOffsetY),this._screenOffsetY=t}get scale(){return this._scale}get width(){return this._width*this._scale}get height(){return this._height*this._scale}get restrictsScaling(){return this._restrictsScaling}set restrictsScaling(t){this._restrictsScaling=t}get canvasUpdated(){return this._canvasUpdated}}class bh{constructor(){this._objects=new Map,this._canvases=new Map,this._disposed=!1,this._roomObjectVariableAccurateZ=null}dispose(){if(!this._disposed){if(this._canvases){for(const[t,e]of this._canvases.entries())this._canvases.delete(t),e&&e.dispose();this._canvases=null}this._objects&&(this._objects=null),this._disposed=!0}}reset(){this._objects.clear()}getInstanceId(t){return t?t.instanceId:-1}getRoomObject(t){return this._objects.get(t)}addObject(t){t&&this._objects.set(this.getInstanceId(t),t)}removeObject(t){const e=this.getInstanceId(t);this._objects.delete(e);for(const s of this._canvases.values())s&&s.removeFromCache(e.toString())}render(t,e=!1){if(this._canvases&&this._canvases.size)for(const s of this._canvases.values())s&&s.render(t,e)}update(t,e=!1){if(this._canvases&&this._canvases.size){this.render(t,e);for(const t of this._canvases.values())t&&t.update()}}getCanvas(t){const e=this._canvases.get(t);if(e)return e}createCanvas(t,e,s,i){const r=this._canvases.get(t);if(r)return r.initialize(e,s),r.geometry&&(r.geometry.scale=i),r;const n=this.createSpriteCanvas(t,e,s,i);return n?(this._canvases.set(t,n),n):void 0}createSpriteCanvas(t,e,s,i){return new Sh(this,t,e,s,i)}removeCanvas(t){const e=this._canvases.get(t);e&&(this._canvases.delete(t),e.dispose())}get objects(){return this._objects}get disposed(){return this._disposed}get roomObjectVariableAccurateZ(){return this._roomObjectVariableAccurateZ}set roomObjectVariableAccurateZ(t){this._roomObjectVariableAccurateZ=t}}class Rh{createRenderer(){return new bh}}class Ih{constructor(t){t<0&&(t=0),this._reservedNumbers=[],this._freeNumbers=[];let e=0;for(;e<t;)this._freeNumbers.push(e),e++}dispose(){this._reservedNumbers=null,this._freeNumbers=null}_Str_19709(){if(this._freeNumbers.length>0){const t=this._freeNumbers.pop();return this._reservedNumbers.push(t),t}return-1}_Str_15187(t){const e=this._reservedNumbers.indexOf(t);e>=0&&(this._reservedNumbers.splice(e,1),this._freeNumbers.push(t))}}class vh{constructor(t,e,s){this._layerId=t,this._partId=e,this._paletteId=s}get layerId(){return this._layerId}set layerId(t){this._layerId=t}get partId(){return this._partId}set partId(t){this._partId=t}get paletteId(){return this._paletteId}set paletteId(t){this._paletteId=t}}class Th{constructor(t){this._typeId=this.getTypeId(t),this._paletteId=this.getPaletteId(t),this._color=this.getColor(t),this._headOnly=this.getHeadOnly(t);const e=this.getCustomData(t);this._customLayerIds=this.getCustomLayerIds(e),this._customPartIds=this.getCustomPartIds(e),this._customPaletteIds=this.getCustomPaletteIds(e),this._customParts=[];let s=0;for(;s<this._customLayerIds.length;)this._customParts.push(new vh(this._customLayerIds[s],this._customPartIds[s],this._customPaletteIds[s])),s++}get typeId(){return this._typeId}get paletteId(){return this._paletteId}get color(){return this._color}get customLayerIds(){return this._customLayerIds}get customPartIds(){return this._customPartIds}get customPaletteIds(){return this._customPaletteIds}get customParts(){return this._customParts}getCustomPart(t){if(this._customParts)for(const e of this._customParts)if(e.layerId===t)return e;return null}get hasCustomParts(){return!(null==this._customLayerIds)&&this._customLayerIds.length>0}get headOnly(){return this._headOnly}get figureString(){let t=this.typeId+" "+this.paletteId+" "+this.color.toString(16);t=t+" "+this.customParts.length;for(const e of this.customParts)t=t+" "+e.layerId+" "+e.partId+" "+e.paletteId;return t}getCustomData(t){let e=[];if(t){const s=t.split(" "),i=this._headOnly?1:0,r=4+i;if(s.length>r){const t=parseInt(s[3+i]);e=s.slice(r,r+3*t)}}return e}getCustomLayerIds(t){const e=[];let s=0;for(;s<t.length;)e.push(parseInt(t[s+0])),s+=3;return e}getCustomPartIds(t){const e=[];let s=0;for(;s<t.length;)e.push(parseInt(t[s+1])),s+=3;return e}getCustomPaletteIds(t){const e=[];let s=0;for(;s<t.length;)e.push(parseInt(t[s+2])),s+=3;return e}getTypeId(t){if(t){const e=t.split(" ");if(e.length>=1)return parseInt(e[0])}return 0}getPaletteId(t){if(t){const e=t.split(" ");if(e.length>=2)return parseInt(e[1])}return 0}getColor(t){if(t){const e=t.split(" ");if(e.length>=3)return parseInt(e[2],16)}return 16777215}getHeadOnly(t){if(t){const e=t.split(" ");if(e.length>=4)return"head"===e[3]}return!1}}let Oh=(()=>{class t{}return t.HOTEL_VIEW="hotel_view",t.HOME_ROOM="home_room",t.NAVIGATOR="navigator",t.CATALOG="catalog",t.INVENTORY="inventory",t.ME_MENU="me_menu",t.FRIEND_LIST="friendlist",t})(),Ah=(()=>{class t extends y{constructor(t){super(t)}get iconId(){return this._iconId}set iconId(t){this._iconId=t}get iconName(){return this._iconName}set iconName(t){this._iconName=t}}return t.TOOLBAR_CLICK="NTE_TOOLBAR_CLICK",t.SELECT_OWN_AVATAR="NTE_SELECT_OWN_AVATAR",t})(),yh=(()=>{class t extends Ah{constructor(e,s,i){super(t.ANIMATE_ICON),this._image=e,this._x=s,this._y=i}get image(){return this._image}get x(){return this._x}get y(){return this._y}}return t.ANIMATE_ICON="NTAIE_ANIMATE_ICON",t})(),Ch=(()=>{class t extends y{constructor(e,s){super(t.IMAGE_READY),this._badgeId=e,this._image=s}get badgeId(){return this._badgeId}get image(){return this._image}}return t.IMAGE_READY="BIME_BADGE_IMAGE_READY",t})(),Mh=(()=>{class t{static isBuilderClubId(e){return e>=t.BUILDER_CLUB_FURNI_ID_BASE}}return t.BUILDER_CLUB_FURNI_ID_BASE=2147418112,t})(),Dh=(()=>{class t extends ih{constructor(e,s,i,r){super(t.ROOM_COLOR,e),this._color=s,this._Str_21672=i,this._Str_6930=r}get color(){return this._color}get _Str_5123(){return this._Str_21672}get _Str_11464(){return this._Str_6930}}return t.ROOM_COLOR="REE_ROOM_COLOR",t})(),Nh=(()=>{class t extends ih{constructor(t,e,s,i){super(t,e),this._objectId=s,this._category=i}get objectId(){return this._objectId}get category(){return this._category}}return t.SELECTED="REOE_SELECTED",t.DESELECTED="REOE_DESELECTED",t.ADDED="REOE_ADDED",t.REMOVED="REOE_REMOVED",t.PLACED="REOE_PLACED",t.PLACED_ON_USER="REOE_PLACED_ON_USER",t.CONTENT_UPDATED="REOE_CONTENT_UPDATED",t.REQUEST_MOVE="REOE_REQUEST_MOVE",t.REQUEST_ROTATE="REOE_REQUEST_ROTATE",t.MOUSE_ENTER="REOE_MOUSE_ENTER",t.MOUSE_LEAVE="REOE_MOUSE_LEAVE",t})(),wh=(()=>{class t extends rh{}return t.DICE_OFF="ROFCAE_DICE_OFF",t.DICE_ACTIVATE="ROFCAE_DICE_ACTIVATE",t.USE_HABBOWHEEL="ROFCAE_USE_HABBOWHEEL",t.STICKIE="ROFCAE_STICKIE",t.ENTER_ONEWAYDOOR="ROFCAE_ENTER_ONEWAYDOOR",t.SOUND_MACHINE_INIT="ROFCAE_SOUND_MACHINE_INIT",t.SOUND_MACHINE_START="ROFCAE_SOUND_MACHINE_START",t.SOUND_MACHINE_STOP="ROFCAE_SOUND_MACHINE_STOP",t.SOUND_MACHINE_DISPOSE="ROFCAE_SOUND_MACHINE_DISPOSE",t.JUKEBOX_INIT="ROFCAE_JUKEBOX_INIT",t.JUKEBOX_START="ROFCAE_JUKEBOX_START",t.JUKEBOX_MACHINE_STOP="ROFCAE_JUKEBOX_MACHINE_STOP",t.JUKEBOX_DISPOSE="ROFCAE_JUKEBOX_DISPOSE",t.MOUSE_BUTTON="ROFCAE_MOUSE_BUTTON",t.MOUSE_ARROW="ROFCAE_MOUSE_ARROW",t})();class Uh extends y{constructor(t){super(t)}}let Lh=(()=>{class t extends Uh{constructor(t,e){super(t),this._targetLocation=e}get targetLocation(){return this._targetLocation}}return t.ROAME_MOVE_TO="ROAME_MOVE_TO",t})();class Ph{constructor(){this.id=0,this.data=null,this.image=null}getImage(){return this.image?this.image:this.data?bt.generateImage(this.data):null}}class xh extends ah{constructor(){super(null,null)}}class Fh extends xh{constructor(t,e){super(),this._itemType=t,this._itemName=e}get itemType(){return this._itemType}get itemName(){return this._itemName}}class Gh extends xh{constructor(t=0){super(),this._numberOfWords=t}get numberOfWords(){return this._numberOfWords}}class Vh extends xh{constructor(t=0){super(),this._danceStyle=t}get danceStyle(){return this._danceStyle}}class Yh extends xh{constructor(t,e=0){super(),this._effect=t,this._delayMilliseconds=e}get effect(){return this._effect}get delayMilliseconds(){return this._delayMilliseconds}}class kh extends xh{constructor(t){super(),this._gainedExperience=t}get gainedExperience(){return this._gainedExperience}}class jh extends xh{constructor(t=0){super(),this._expressionType=t}get expressionType(){return this._expressionType}}class Bh extends xh{constructor(t,e=null,s=null,i=!1){super(),this._figure=t,this._gender=e,this._subType=s,this._isRiding=i}get figure(){return this._figure}get gender(){return this._gender}get subType(){return this._subType}get isRiding(){return this._isRiding}}class Hh extends xh{constructor(t=0){super(),this._level=t}get level(){return this._level}}class Wh extends xh{constructor(t=0){super(),this._gesture=t}get gesture(){return this._gesture}}class Zh extends xh{constructor(t){super(),this._guideStatus=t}get guideStatus(){return this._guideStatus}}class zh extends xh{constructor(t=!1){super(),this._isMuted=t}get isMuted(){return this._isMuted}}class Xh extends xh{}class Kh extends xh{constructor(t){super(),this._gesture=t}get gesture(){return this._gesture}}class qh extends xh{constructor(t){super(),this._value=t}get value(){return this._value}}class Jh extends xh{constructor(t){super(),this._isPlayingGame=t}get isPlayingGame(){return this._isPlayingGame}}class Qh extends xh{constructor(t,e=""){super(),this._postureType=t,this._parameter=e}get postureType(){return this._postureType}get parameter(){return this._parameter}}class $h extends xh{constructor(t=0){super(),this._signType=t}get signType(){return this._signType}}class tl extends xh{constructor(t=!1){super(),this._isSleeping=t}get isSleeping(){return this._isSleeping}}class el extends xh{constructor(t=!1){super(),this._isTyping=t}get isTyping(){return this._isTyping}}class sl extends ah{constructor(t,e,s,i=!1){super(t,s),this._targetLocation=e,this._isSlide=i}get targetLocation(){return this._targetLocation?this._targetLocation:this.location}get isSlide(){return this._isSlide}}class il extends sl{constructor(t,e,s,i,r,n){super(t,e,s),this._headDirection=i,this._canStandUp=r,this._baseY=n}get headDirection(){return this._headDirection}get canStandUp(){return this._canStandUp}get baseY(){return this._baseY}}class rl extends xh{constructor(t){super(),this._itemType=t}get itemType(){return this._itemType}}class nl extends ah{constructor(t,e,s=NaN){super(null,null),this._state=t,this._data=e,this._extra=s}get state(){return this._state}get data(){return this._data}get extra(){return this._extra}}let al=(()=>{class t extends ah{constructor(t,e){super(null,null),this._badgeId=t,this._assetName=e}get badgeId(){return this._badgeId}get assetName(){return this._assetName}}return t.BADGE_LOADED="ROGBUM_BADGE_LOADED",t})();class ol extends ah{constructor(t,e,s){super(t,e),this._height=s}get height(){return this._height}}class cl extends ah{constructor(t){super(null,null),this._data=t}get data(){return this._data}}let _l=(()=>{class t extends ah{constructor(t,e,s,i){super(null,null),this._type=t,this._color=e,this._light=s,this._backgroundOnly=i}get type(){return this._type}get color(){return this._color}get light(){return this._light}get backgroundOnly(){return this._backgroundOnly}}return t.BACKGROUND_COLOR="RORCUM_BACKGROUND_COLOR",t})(),hl=(()=>{class t extends ah{constructor(t,e,s=0,i=0,r=0,n=0){super(null,null),this._type=t,this._id=e,this._x=s,this._y=i,this._width=r,this._height=n}get type(){return this._type}get id(){return this._id}get x(){return this._x}get y(){return this._y}get width(){return this._width}get height(){return this._height}}return t.ADD="ORPFHUM_ADD",t.REMOVE="ORPFHUM_REMOVE",t})(),ll=(()=>{class t extends ah{constructor(t,e,s=null,i=null,r="window"){super(null,null),this._type=t,this._maskId=e,this._maskType=s,this._maskLocation=i?new ot(i.x,i.y,i.z):null,this._maskCategory=r}get type(){return this._type}get maskId(){return this._maskId}get maskType(){return this._maskType}get maskLocation(){return this._maskLocation}get maskCategory(){return this._maskCategory}}return t.ADD_MASK="RORMUM_ADD_MASK",t._Str_10260="RORMUM_ADD_MASK",t.DOOR="door",t.WINDOW="window",t.HOLE="hole",t})(),ul=(()=>{class t extends ah{constructor(t,e){super(null,null),this._type=t,this._value=e}get type(){return this._type}get value(){return this._value}}return t.WALL_THICKNESS="RORPPUM_WALL_THICKNESS",t.FLOOR_THICKNESS="RORPVUM_FLOOR_THICKNESS",t})(),dl=(()=>{class t extends ah{constructor(t,e){super(null,null),this._type=t,this._visible=e}get type(){return this._type}get visible(){return this._visible}}return t.WALL_VISIBILITY="RORPVUM_WALL_VISIBILITY",t.FLOOR_VISIBILITY="RORPVUM_FLOOR_VISIBILITY",t})(),gl=(()=>{class t extends ah{constructor(t,e){super(null,null),this._type=t,this._value=e}get type(){return this._type}get value(){return this._value}}return t.ROOM_WALL_UPDATE="RORUM_ROOM_WALL_UPDATE",t.ROOM_FLOOR_UPDATE="RORUM_ROOM_FLOOR_UPDATE",t.ROOM_LANDSCAPE_UPDATE="RORUM_ROOM_LANDSCAPE_UPDATE",t})(),ml=(()=>{class t{}return t._Str_16646=-1,t._Str_9735=128,t._Str_9268=256,t})(),pl=(()=>{class t{constructor(){this._id=t.SPRITE_COUNTER++,this._name="",this._type="",this._spriteType=_h.DEFAULT,this._texture=null,this._container=null,this._width=0,this._height=0,this._offsetX=0,this._offsetY=0,this._flipH=!1,this._flipV=!1,this._direction=0,this._alpha=255,this._blendMode=A.b.NORMAL,this._color=16777215,this._relativeDepth=0,this._Str_8253=!1,this._Str_11397="",this._clickHandling=!1,this._visible=!0,this._tag="",this._posture=null,this._alphaTolerance=ml._Str_9735,this._filters=[],this._updateCounter=0,this._updateContainer=!1}dispose(){this._texture=null,this._width=0,this._height=0}get id(){return this._id}set id(t){this._id=t}get name(){return this._name}set name(t){this._name!==t&&(this._name=t,this._updateCounter++)}get type(){return this._type}set type(t){this._type=t}get spriteType(){return this._spriteType}set spriteType(t){this._spriteType=t}get texture(){return this._texture}set texture(t){this._texture!==t&&(t&&(this._width=t.width,this._height=t.height),this._texture=t,this._updateCounter++)}get container(){return this._container}set container(t){this._container!==t&&(this.texture=A.p.EMPTY,t&&(this._width=t.width,this._height=t.height),this._container=t,this._updateCounter++,this._updateContainer=!0)}get width(){return this._width}get height(){return this._height}get offsetX(){return this._offsetX}set offsetX(t){this._offsetX!==t&&(this._offsetX=t,this._updateCounter++)}get offsetY(){return this._offsetY}set offsetY(t){this._offsetY!==t&&(this._offsetY=t,this._updateCounter++)}get flipH(){return this._flipH}set flipH(t){this._flipH!==t&&(this._flipH=t,this._updateCounter++)}get flipV(){return this._flipV}set flipV(t){this._flipV!==t&&(this._flipV=t,this._updateCounter++)}get direction(){return this._direction}set direction(t){this._direction=t}get alpha(){return this._alpha}set alpha(t){this._alpha!==(t&=255)&&(this._alpha=t,this._updateCounter++)}get blendMode(){return this._blendMode}set blendMode(t){this._blendMode!==t&&(this._blendMode=t,this._updateCounter++)}get color(){return this._color}set color(t){this._color!==(t&=16777215)&&(this._color=t,this._updateCounter++)}get relativeDepth(){return this._relativeDepth}set relativeDepth(t){this._relativeDepth!==t&&(this._relativeDepth=t,this._updateCounter++)}get _Str_4593(){return this._Str_8253}set _Str_4593(t){t!==this._Str_8253&&(this._Str_8253=t,this._updateCounter++)}get _Str_3582(){return this._Str_11397}set _Str_3582(t){this._Str_11397=t}get clickHandling(){return this._clickHandling}set clickHandling(t){this._clickHandling=t}get visible(){return this._visible}set visible(t){this._visible!==t&&(this._visible=t,this._updateCounter++)}get tag(){return this._tag}set tag(t){this._tag!==t&&(this._tag=t,this._updateCounter++)}get posture(){return this._posture}set posture(t){this._posture!==t&&(this._posture=t,this._updateCounter++)}get alphaTolerance(){return this._alphaTolerance}set alphaTolerance(t){this._alphaTolerance!==t&&(this._alphaTolerance=t,this._updateCounter++)}get filters(){return this._filters}set filters(t){this._filters=t,this._updateCounter++}get updateCounter(){return this._updateCounter}get updateContainer(){return this._updateContainer}set updateContainer(t){this._updateContainer=t}}return t.SPRITE_COUNTER=0,t})(),El=(()=>{class t{constructor(){this._id=t.VISUALIZATION_COUNTER++,this._object=null,this._asset=null,this._sprites=[],this._scale=-1,this._updateObjectCounter=-1,this._updateModelCounter=-1,this._updateSpriteCounter=-1}initialize(t){return!1}update(t,e,s,i){}reset(){this._scale=-1}dispose(){if(this._sprites){for(;this._sprites.length;){const t=this._sprites[0];t&&t.dispose(),this._sprites.pop()}this._sprites=null}this._object=null,this._asset=null}getSprite(t){return t>=0&&t<this._sprites.length?this._sprites[t]:null}getSpriteList(){return null}createSprite(){return this.createSpriteAtIndex(this._sprites.length)}createSpriteAtIndex(t){const e=new pl;return t>=this._sprites.length?this._sprites.push(e):this._sprites.splice(t,0,e),e}setSpriteCount(t){for(;this._sprites.length>t;){const t=this._sprites[this._sprites.length-1];t&&t.dispose(),this._sprites.pop()}for(;this._sprites.length<t;)this._sprites.push(new pl)}get image(){return this.getImage(0,-1)}getImage(t,e){const s=this.getBoundingRectangle();if(s.width*s.height==0)return null;const i=this.totalSprites,r=[];let n=0;for(;n<i;){const t=this.getSprite(n);t&&t.visible&&t.texture&&r.push(t),n++}r.sort((t,e)=>e.relativeDepth-t.relativeDepth);const a=new A.d;for(n=0;n<r.length;){const t=r[n],e=t.texture;if(e){const s=A.n.from(e);s.alpha=t.alpha/255,s.tint=t.color,s.x=t.offsetX,s.y=t.offsetY,s.blendMode=t.blendMode,s.filters=t.filters,t.flipH&&(s.scale.x=-1),t.flipV&&(s.scale.y=-1),a.addChild(s)}n++}return bt.generateTexture(a)||null}getBoundingRectangle(){const t=this.totalSprites,e=new A.k;let s=0;for(;s<t;){const t=this.getSprite(s);if(t&&t.texture&&t.visible){const i=new A.j(t.flipH?-t.width+t.offsetX:t.offsetX,t.flipV?-t.height+t.offsetY:t.offsetY);0===s?(e.x=i.x,e.y=i.y,e.width=t.width,e.height=t.height):(i.x<e.x&&(e.x=i.x),i.y<e.y&&(e.y=i.y),i.x+t.width>e.right&&(e.width=i.x+t.width-e.x),i.y+t.height>e.bottom&&(e.height=i.y+t.height-e.y))}s++}return e}get instanceId(){return this._id}get object(){return this._object}set object(t){this._object=t}get asset(){return this._asset}set asset(t){this._asset&&this._asset.removeReference(),this._asset=t,this._asset&&this._asset.addReference()}get sprites(){return this._sprites}get totalSprites(){return this._sprites.length}get updateObjectCounter(){return this._updateObjectCounter}set updateObjectCounter(t){this._updateObjectCounter=t}get updateModelCounter(){return this._updateModelCounter}set updateModelCounter(t){this._updateModelCounter=t}get updateSpriteCounter(){return this._updateSpriteCounter}set updateSpriteCounter(t){this._updateSpriteCounter=t}}return t.VISUALIZATION_COUNTER=0,t})();class fl{constructor(t,e,s){this._id=t,this._type=e,this._visualization=s}dispose(){this._visualization=null}update(t,e){}animate(t){return!1}get id(){return this._id}get type(){return this._type}get visualization(){return this._visualization}}let Sl=(()=>{class t extends fl{constructor(t,e,s){super(t,e,s),this._asset=null,this._startTime=um.instance.time,this._delta=0,this._offsetY=0,this._scale=0,this._state=0}update(t,e){if(!t)return;this._scale=e;let s=64,i=0;if(e<48?(this._asset=this.visualization.getAvatarRenderAsset("user_blowkiss_small"),i=90===this.visualization.angle||270===this.visualization.angle?0:135===this.visualization.angle||180===this.visualization.angle||225===this.visualization.angle?6:-6,this._offsetY=-38,s=32):(this._asset=this.visualization.getAvatarRenderAsset("user_blowkiss"),i=90===this.visualization.angle||270===this.visualization.angle?-3:135===this.visualization.angle||180===this.visualization.angle||225===this.visualization.angle?22:-30,this._offsetY=-70),"sit"===this.visualization.posture?this._offsetY+=s/2:"lay"===this.visualization.posture&&(this._offsetY+=s),this._asset){t.texture=this._asset,t.offsetX=i,t.offsetY=this._offsetY,t.relativeDepth=-.02,t.alpha=0;const e=this._delta;this.animate(t),this._delta=e}}animate(e){if(!e)return!1;if(this._asset&&(e.texture=this._asset),this._state===t.STATE_DELAY)return!(um.instance.time-this._startTime<t.DELAY_BEFORE_ANIMATION||(this._state=t.STATE_FADE_IN,e.alpha=0,e.visible=!0,this._delta=0,0));if(this._state===t.STATE_FADE_IN)return this._delta+=.1,e.offsetY=this._offsetY,e.alpha=255*Math.pow(this._delta,.9),this._delta>=1&&(e.alpha=255,this._delta=0,this._state=t.STATE_FLOAT),!0;if(this._state===t.STATE_FLOAT){const s=Math.pow(this._delta,.9);return this._delta+=.05,e.offsetY=this._offsetY+(this._delta<1?s:1)*(this._scale<48?-30:-40),e.alpha=255*(1-s),e.alpha<=0&&(e.visible=!1,this._state=t.STATE_COMPLETE),!0}return!1}}return t.DELAY_BEFORE_ANIMATION=300,t.STATE_DELAY=0,t.STATE_FADE_IN=1,t.STATE_FLOAT=2,t.STATE_COMPLETE=3,t})(),bl=(()=>{class t{static getExpressionAddition(t,e,s){switch(e){case this.BLOW:return new Sl(t,this.BLOW,s);default:return new fl(t,e,s)}}}return t.WAVE=1,t.BLOW=2,t.LAUGH=3,t.CRY=4,t.IDLE=5,t})(),Rl=(()=>{class t{constructor(t,e){this._id=t,this._visualization=e,this._asset=null,this._startTime=um.instance.time,this._offsetY=0,this._scale=0,this._state=0}dispose(){this._visualization=null,this._asset=null}getSpriteAssetName(t){let e="left";return 135!==this._visualization.angle&&180!==this._visualization.angle&&225!==this._visualization.angle&&270!==this._visualization.angle||(e="right"),"user_idle_"+e+"_"+t+(this._scale<48?"_small":"")}update(e,s){if(!e)return;this._scale=s,this._asset=this._visualization.getAvatarRenderAsset(this.getSpriteAssetName(this._state===t.STATE_FRAME_A?1:2));let i=64,r=0;s<48?(r=135===this._visualization.angle||180===this._visualization.angle||225===this._visualization.angle||270===this._visualization.angle?10:-16,this._offsetY=-38,i=32):(r=135===this._visualization.angle||180===this._visualization.angle||225===this._visualization.angle||270===this._visualization.angle?22:-30,this._offsetY=-70),"sit"===this._visualization.posture?this._offsetY+=i/2:"lay"===this._visualization.posture&&(this._offsetY+=i-.3*i),this._asset&&(e.texture=this._asset,e.offsetX=r,e.offsetY=this._offsetY,e.relativeDepth=-.02,e.alpha=0)}animate(e){if(!e)return!1;const s=um.instance.time;return this._state===t.STATE_DELAY&&s-this._startTime>=t.DELAY_BEFORE_ANIMATION&&(this._state=t.STATE_FRAME_A,this._startTime=s,this._asset=this._visualization.getAvatarRenderAsset(this.getSpriteAssetName(1))),this._state===t.STATE_FRAME_A&&s-this._startTime>=t.DELAY_PER_FRAME&&(this._state=t.STATE_FRAME_B,this._startTime=s,this._asset=this._visualization.getAvatarRenderAsset(this.getSpriteAssetName(2))),this._state===t.STATE_FRAME_B&&s-this._startTime>=t.DELAY_PER_FRAME&&(this._state=t.STATE_FRAME_A,this._startTime=s,this._asset=this._visualization.getAvatarRenderAsset(this.getSpriteAssetName(1))),this._asset?(e.texture=this._asset,e.alpha=255,e.visible=!0):e.visible=!1,!1}get id(){return this._id}}return t.DELAY_BEFORE_ANIMATION=2e3,t.DELAY_PER_FRAME=2e3,t.STATE_DELAY=0,t.STATE_FRAME_A=1,t.STATE_FRAME_B=2,t})();class Il{constructor(t,e,s){this._id=t,this._visualization=s,this._asset=null,this._scale=0,this._number=e,this._numberValueFadeDirection=0,this._numberValueMoving=!1,this._numberValueMoveCounter=0}dispose(){this._visualization=null,this._asset=null}update(t,e){if(!t)return;this._scale=e;let s=64,i=0,r=0;this._number>0?(e<48?(this._asset=this._visualization.getAvatarRenderAsset("number_"+this._number+"_small"),s=32,i=-6,r=-52):(this._asset=this._visualization.getAvatarRenderAsset("number_"+this._number),i=-8,r=-105),"sit"===this._visualization.posture?r+=s/2:"lay"===this._visualization.posture&&(r+=e),this._asset?(t.visible=!0,t.texture=this._asset,t.offsetX=i,t.offsetY=r,t.relativeDepth=-.01,t.alpha=0,this._numberValueFadeDirection=1,this._numberValueMoving=!0,this._numberValueMoveCounter=0):t.visible=!1):t.visible&&(this._numberValueFadeDirection=-1)}animate(t){if(!t)return!1;this._asset&&(t.texture=this._asset);let e=t.alpha,s=!1;if(this._numberValueMoving){if(this._numberValueMoveCounter++,this._numberValueMoveCounter<10)return!1;if(this._numberValueFadeDirection<0)t.offsetY-=this._scale<48?2:4;else{let e=4;this._scale<48&&(e=8),this._numberValueMoveCounter%e||(t.offsetY--,s=!0)}}return this._numberValueFadeDirection>0?(e<255&&(e+=32),e>=255&&(e=255,this._numberValueFadeDirection=0),t.alpha=e,!0):this._numberValueFadeDirection<0?(e>=0&&(e-=32),e<=0&&(this._numberValueFadeDirection=0,this._numberValueMoving=!1,e=0,t.visible=!1),t.alpha=e,!0):s}get id(){return this._id}}class vl{constructor(t,e){this._id=t,this._visualization=e,this._asset=null,this._relativeDepth=0}dispose(){this._visualization=null,this._asset=null}update(t,e){if(!t)return;t.visible=!0,t.relativeDepth=this._relativeDepth,t.alpha=255;let s=64,i=0,r=0;e<48?(this._asset=this._visualization.getAvatarRenderAsset("user_typing_small"),i=3,r=-42,s=32):(this._asset=this._visualization.getAvatarRenderAsset("user_typing"),i=14,r=-83),"sit"===this._visualization.posture?r+=s/2:"lay"===this._visualization.posture&&(r+=e),this._asset&&(t.texture=this._asset,t.offsetX=i,t.offsetY=r,t.relativeDepth=-.02)}animate(t){return this._asset&&t&&(t.texture=this._asset),!1}get id(){return this._id}get relativeDepth(){return this._relativeDepth}set relativeDepth(t){this._relativeDepth=t}}class Tl extends M{constructor(){super()}initialize(t){return!0}onDispose(){this._avatarRenderer=null}createAvatarImage(t,e,s=null,i=null,r=null){let n=null;return n=this._avatarRenderer.createAvatarImage(t,e>48?yt.LARGE:yt.SMALL,s,i,r),n}getAvatarRendererAsset(t){return this._avatarRenderer?this._avatarRenderer.assets.getTexture(t):null}get avatarManager(){return this._avatarRenderer}set avatarManager(t){this._avatarRenderer=t}get layerCount(){return 0}}let Ol=(()=>{class t extends El{constructor(){super(),this._data=null,this._avatarImage=null,this._cachedAvatars=new X,this._cachedAvatarEffects=new X,this._shadow=null,this._lastUpdate=-1e3,this._disposed=!1,this._figure=null,this._gender=null,this._direction=-1,this._headDirection=-1,this._posture="",this._postureParameter="",this._canStandUp=!1,this._postureOffset=0,this._verticalOffset=0,this._angle=-1,this._headAngle=-1,this._talk=!1,this._expression=0,this._sleep=!1,this._blink=!1,this._gesture=0,this._sign=-1,this._highlightEnabled=!1,this._highlight=!1,this._dance=0,this._effect=0,this._carryObject=0,this._useObject=0,this._ownUser=!1,this._Str_8935=!1,this._Str_17860=!1,this._Str_1222=!1,this._Str_16697=2,this._Str_12697=0,this._Str_14276=0,this._isAvatarReady=!1,this._needsUpdate=!1,this._geometryUpdateCounter=-1,this._additions=new Map}initialize(e){return e instanceof Tl&&(this._data=e,this.setSpriteCount(t._Str_11587),super.initialize(e),!0)}dispose(){this._disposed||(super.dispose(),this._avatarImage&&this._avatarImage.dispose(),this._shadow=null,this._disposed=!0)}update(e,s,i,r){if(!this.object||!e||!this._data)return;if(s<this._lastUpdate+t.UPDATE_TIME_INCREASER)return;this._lastUpdate+=t.UPDATE_TIME_INCREASER,this._lastUpdate+t.UPDATE_TIME_INCREASER<s&&(this._lastUpdate=s-t.UPDATE_TIME_INCREASER);const n=e.scale,a=this._effect;let o=!1,c=!1,_=!1,h=!1;const l=this.updateModel(this.object.model,n);if(l||n!==this._scale||!this._avatarImage){if(n!==this._scale&&(o=!0,this.updateScale(n)),a!==this._effect&&(c=!0),o||!this._avatarImage||c){if(this._avatarImage=this.createAvatarImage(n,this._effect),!this._avatarImage)return;_=!0;const e=this.getSprite(t.AVATAR_LAYER_ID);e&&this._avatarImage&&this._avatarImage.isPlaceholder()?e.alpha=150:e&&(e.alpha=255)}if(!this._avatarImage)return;if(c&&this._avatarImage.animationHasResetOnToggle&&this._avatarImage.resetAnimationFrameCounter(),this.updateShadow(n),h=this.updateObject(this.object,e,i,!0),this.processActionsForAvatar(this._avatarImage),this._additions){let t=this._Str_16697;for(const e of this._additions.values())e.update(this.getSprite(t++),n)}this._scale=n}else h=this.updateObject(this.object,e,i);if(this._additions){let t=this._Str_16697;for(const e of this._additions.values())e.animate(this.getSprite(t++))&&this.updateSpriteCounter++}const u=h||l||o,d=(this._Str_1222||this._Str_12697>0)&&i;if(u&&(this._Str_12697=t._Str_14491),u||d){if(this.updateSpriteCounter++,this._Str_12697--,this._Str_14276--,!(this._Str_14276<=0||o||l||_))return;this._avatarImage.updateAnimationByFrames(1),this._Str_14276=t._Str_14491;let e=this._avatarImage.getCanvasOffsets();(!e||e.length<3)&&(e=t._Str_18338);const s=this.getSprite(t._Str_9540);if(s){const i=1===this.object.model.getValue(st.FIGURE_HIGHLIGHT_ENABLE)&&1===this.object.model.getValue(st.FIGURE_HIGHLIGHT),r=this._avatarImage.getImage(Pt.FULL,i);r&&(s.texture=r,i||(s.filters=[])),s.texture&&(s.offsetX=-1*n/2+e[0]-(s.texture.width-n)/2,s.offsetY=n/4-s.texture.height+e[1]+this._postureOffset),s.relativeDepth=this._Str_8935?this._Str_17860?-.5:t._Str_9235+e[2]:t._Str_11358+e[2],this._ownUser?(s.relativeDepth-=t._Str_17708,s.spriteType=_h._Str_10494):s.spriteType=_h._Str_11629}const i=this.getAddition(t.TYPING_BUBBLE_ID);i&&(i.relativeDepth=this._Str_8935?t._Str_9235-.01+e[2]:t._Str_11358-.01+e[2]),this._Str_1222=this._avatarImage.isAnimating();let r=t._Str_11587;const a=this._avatarImage.getDirection();for(const o of this._avatarImage.getSprites())if(o.id===t.AVATAR){const e=this.getSprite(t._Str_9540);if(e){const t=this._avatarImage.getLayerData(o);let s=o._Str_809(a),i=o._Str_739(a);t&&(s+=t.dx,i+=t.dy),n<48&&(s/=2,i/=2),this._canStandUp||(e.offsetX+=s,e.offsetY+=i)}}else{const e=this.getSprite(r);if(e){e.alphaTolerance=ml._Str_9268,e.visible=!0;const s=this._avatarImage.getLayerData(o);let i=0,r=o._Str_809(a),c=o._Str_739(a);const _=o._Str_839(a);let h=0;o._Str_949&&(h=a),s&&(i=s._Str_891,r+=s.dx,c+=s.dy,h+=s.dd),n<48&&(r/=2,c/=2),h<0?h+=8:h>7&&(h-=8);const l=this._avatarImage.getScale()+"_"+o.member+"_"+h+"_"+i,u=this._avatarImage.getAsset(l);if(!u)continue;e.texture=u.texture,e.offsetX=u.offsetX-n/2+r,e.offsetY=u.offsetY+c,e.flipH=u.flipH,e.offsetY+=o._Str_767?this._verticalOffset*n/(2*t._Str_12370):this._postureOffset,e.relativeDepth=this._Str_8935?t._Str_9235-.001*this.totalSprites*_:t._Str_11358-.001*this.totalSprites*_,e.blendMode=33===o.ink?A.b.ADD:A.b.NORMAL}r++}}}createAvatarImage(e,s){let i=null,r="avatarImage"+e.toString();if(s?(r+="-"+s,i=this._cachedAvatarEffects.getValue(r)):i=this._cachedAvatars.getValue(r),!i&&(i=this._data.createAvatarImage(this._figure,e,this._gender,this,this),i))if(s){if(this._cachedAvatarEffects.length>=t.MAX_EFFECT_CACHE){const t=this._cachedAvatarEffects.remove(this._cachedAvatarEffects.getKey(0));t&&t.dispose()}this._cachedAvatarEffects.add(r,i)}else this._cachedAvatars.add(r,i);return i}updateObject(t,e,s,i=!1){if(!i&&this.updateObjectCounter===t.updateCounter&&this._geometryUpdateCounter===e.updateId)return!1;let r=t.getDirection().x-e.direction.x,n=this._headDirection-e.direction.x;return"float"===this._posture&&(n=r),r=(r%360+360)%360,n=(n%360+360)%360,"sit"===this._posture&&this._canStandUp&&(r-=r%90-45,n-=n%90-45),(r!==this._angle||i)&&(s=!0,this._angle=r,r-=112.5,r=(r+360)%360,this._avatarImage.setDirectionAngle(Pt.FULL,r)),(n!==this._headAngle||i)&&(s=!0,this._headAngle=n,this._headAngle!==this._angle&&(n-=112.5,n=(n+360)%360,this._avatarImage.setDirectionAngle(Pt.HEAD,n))),this._geometryUpdateCounter=e.updateId,this.updateObjectCounter=this.object.updateCounter,s}updateModel(e,s){if(!e)return!1;if(this.updateModelCounter===e.updateCounter)return!1;let i=!1;const r=e.getValue(st.FIGURE_TALK)>0;r!==this._talk&&(this._talk=r,i=!0);const n=e.getValue(st.FIGURE_EXPRESSION);n!==this._expression&&(this._expression=n,i=!0);const a=e.getValue(st.FIGURE_SLEEP)>0;a!==this._sleep&&(this._sleep=a,i=!0);const o=e.getValue(st.FIGURE_BLINK)>0;o!==this._blink&&(this._blink=o,i=!0);const c=e.getValue(st.FIGURE_GESTURE)||0;c!==this._gesture&&(this._gesture=c,i=!0);const _=e.getValue(st.FIGURE_POSTURE);_!==this._posture&&(this._posture=_,i=!0);const h=e.getValue(st.FIGURE_POSTURE_PARAMETER);h!==this._postureParameter&&(this._postureParameter=h,i=!0);const l=e.getValue(st.FIGURE_CAN_STAND_UP);l!==this._canStandUp&&(this._canStandUp=l,i=!0);const u=e.getValue(st.FIGURE_VERTICAL_OFFSET)*t.OFFSET_MULTIPLIER;u!==this._verticalOffset&&(this._verticalOffset=u,i=!0);const d=e.getValue(st.FIGURE_DANCE)||0;d!==this._dance&&(this._dance=d,i=!0);const g=e.getValue(st.FIGURE_EFFECT)||0;g!==this._effect&&(this._effect=g,i=!0);const m=e.getValue(st.FIGURE_CARRY_OBJECT)||0;m!==this._carryObject&&(this._carryObject=m,i=!0);const p=e.getValue(st.FIGURE_USE_OBJECT)||0;p!==this._useObject&&(this._useObject=p,i=!0);const E=e.getValue(st.HEAD_DIRECTION);E!==this._headDirection&&(this._headDirection=E,i=!0),this._carryObject>0&&p>0?this._useObject!==this._carryObject&&(this._useObject=this._carryObject,i=!0):0!==this._useObject&&(this._useObject=0,i=!0);let f=this.getAddition(t.FLOATING_IDLE_Z_ID);this._sleep?(f||(f=this.addAddition(new Rl(t.FLOATING_IDLE_Z_ID,this))),i=!0):f&&this.removeAddition(t.FLOATING_IDLE_Z_ID);const S=e.getValue(st.FIGURE_IS_TYPING)>0;let b=this.getAddition(t.TYPING_BUBBLE_ID);S?(b||(b=this.addAddition(new vl(t.TYPING_BUBBLE_ID,this))),i=!0):b&&this.removeAddition(t.TYPING_BUBBLE_ID);const R=e.getValue(st.FIGURE_NUMBER_VALUE);let I=this.getAddition(t.NUMBER_BUBBLE_ID);R>0?(I||(I=this.addAddition(new Il(t.NUMBER_BUBBLE_ID,R,this))),i=!0):I&&this.removeAddition(t.NUMBER_BUBBLE_ID);let v=this.getAddition(t.EXPRESSION_ID);this._expression>0?v||(v=bl.getExpressionAddition(t.EXPRESSION_ID,this._expression,this),v&&this.addAddition(v)):v&&this.removeAddition(t.EXPRESSION_ID),this.updateScale(s);const T=e.getValue(st.GENDER);T!==this._gender&&(this._gender=T,i=!0),this.updateFigure(e.getValue(st.FIGURE))&&(i=!0);let O=e.getValue(st.FIGURE_SIGN);null===O&&(O=-1),this._sign!==O&&(this._sign=O,i=!0);const A=e.getValue(st.FIGURE_HIGHLIGHT_ENABLE)>0;if(A!==this._highlightEnabled&&(this._highlightEnabled=A,i=!0),this._highlightEnabled){const t=e.getValue(st.FIGURE_HIGHLIGHT)>0;t!==this._highlight&&(this._highlight=t,i=!0)}const y=e.getValue(st.OWN_USER)>0;return y!==this._ownUser&&(this._ownUser=y,i=!0),this.updateModelCounter=e.updateCounter,i}setDirection(t){this._direction!==t&&(this._direction=t,this._needsUpdate=!0)}updateScale(t){t<48&&(this._blink=!1),this._postureOffset="sit"===this._posture||"lay"===this._posture?t/2:0,this._Str_17860=!1,this._Str_8935=!1,"lay"===this._posture&&(this._Str_8935=!0,parseInt(this._postureParameter)<0&&(this._Str_17860=!0))}processActionsForAvatar(e){if(!e)return;if(e.initActionAppends(),e.appendAction(Lt.POSTURE,this._posture,this._postureParameter),this._gesture>0&&this._avatarImage.appendAction(Lt.GESTURE,Lt.getGesture(this._gesture)),this._dance>0&&this._avatarImage.appendAction(Lt.DANCE,this._dance),this._sign>-1&&this._avatarImage.appendAction(Lt.SIGN,this._sign),this._carryObject>0&&this._avatarImage.appendAction(Lt.CARRY_OBJECT,this._carryObject),this._useObject>0&&this._avatarImage.appendAction(Lt.USE_OBJECT,this._useObject),this._talk&&this._avatarImage.appendAction(Lt.TALK),(this._sleep||this._blink)&&this._avatarImage.appendAction(Lt.SLEEP),this._expression>0){const t=Lt.getExpression(this._expression);if(""!==t)switch(t){case Lt.DANCE:this._avatarImage.appendAction(Lt.DANCE,2);break;default:this._avatarImage.appendAction(t)}}this._effect>0&&this._avatarImage.appendAction(Lt.EFFECT,this._effect),e.endActionAppends(),this._Str_1222=e.isAnimating();let s=t._Str_11587;for(const i of this._avatarImage.getSprites())i.id!==t.AVATAR&&s++;if(s!==this.totalSprites&&this.setSpriteCount(s),this._Str_16697=s,this._additions)for(const t of this._additions.values())this.createSprite()}updateFigure(t){return this._figure!==t&&(this._figure=t,this.clearAvatar(),!0)}resetFigure(t){this.clearAvatar()}resetEffect(t){this.clearAvatar()}clearAvatar(){for(const t of this._cachedAvatars.getValues())t&&t.dispose();for(const t of this._cachedAvatarEffects.getValues())t&&t.dispose();this._cachedAvatars.reset(),this._cachedAvatarEffects.reset(),this._avatarImage=null;const e=this.getSprite(t.AVATAR_LAYER_ID);e&&(e.texture=A.p.EMPTY,e.alpha=255)}getAddition(t){return this._additions&&this._additions.get(t)||null}addAddition(t){if(!this.getAddition(t.id))return this._additions.set(t.id,t),t}removeAddition(t){const e=this.getAddition(t);e&&(this._additions.delete(e.id),e.dispose())}updateShadow(e){this._shadow=null;const s=this.getSprite(t.SHADOW_LAYER_ID);if(!s)return;let i="mv"===this._posture||"std"===this._posture||"sit"===this._posture&&this._canStandUp;if(this._effect===t._Str_17502&&(i=!1),i){if(s.visible=!0,!this._shadow||e!==this._scale){let t=0,i=0;e<48?(s._Str_3582="sh_std_sd_1_0_0",this._shadow=this._avatarImage.getAsset(s._Str_3582),t=-8,i=this._canStandUp?6:-3):(s._Str_3582="h_std_sd_1_0_0",this._shadow=this._avatarImage.getAsset(s._Str_3582),t=-17,i=this._canStandUp?10:-7),this._shadow?(s.texture=this._shadow.texture,s.offsetX=t,s.offsetY=i,s.alpha=50,s.relativeDepth=1):s.visible=!1}}else this._shadow=null,s.visible=!1}getAvatarRenderAsset(t){const e=um.instance.getConfiguration("images.url")+"/additions/"+t+".png";return this._data?this._data.getAvatarRendererAsset(e):null}get direction(){return this._direction}get posture(){return this._posture}get angle(){return this._angle}get disposed(){return this._disposed}}return t.AVATAR="avatar",t.FLOATING_IDLE_Z_ID=1,t.TYPING_BUBBLE_ID=2,t.EXPRESSION_ID=3,t.NUMBER_BUBBLE_ID=4,t.OWN_USER_ID=4,t.UPDATE_TIME_INCREASER=41,t.OFFSET_MULTIPLIER=1e3,t.AVATAR_LAYER_ID=0,t.SHADOW_LAYER_ID=1,t._Str_17502=97,t._Str_11587=2,t._Str_14491=2,t._Str_18338=[0,0,0],t.MAX_EFFECT_CACHE=2,t._Str_9540=0,t._Str_12370=1e3,t._Str_11358=-.01,t._Str_17708=.001,t._Str_9235=-.409,t})(),Al=(()=>{class t{static allocate(e,s,i,r,n,a,o=-1,c=0){const _=t.POOL.length?t.POOL.pop():new t;return r<1&&(r=1),n<0&&(n=t.FRAME_REPEAT_FOREVER),_._id=e,_._x=s||0,_._y=i||0,_._repeats=r,_._frameRepeats=n,_._remainingFrameRepeats=n,_._isLastFrame=a,_._isRecycled=!1,o>=0?(_._activeSequence=o,_._activeSequenceOffset=c):(_._activeSequence=-1,_._activeSequenceOffset=0),_}get id(){return this._id>=0?this._id:-this._id*Math.random()}get x(){return this._x}get y(){return this._y}get repeats(){return this._repeats}get frameRepeats(){return this._frameRepeats}get isLastFrame(){return this._isLastFrame}get remainingFrameRepeats(){return this._frameRepeats<0?t.FRAME_REPEAT_FOREVER:this._remainingFrameRepeats}set remainingFrameRepeats(t){t<0&&(t=0),this._frameRepeats>0&&t>this._frameRepeats&&(t=this._frameRepeats),this._remainingFrameRepeats=t}get activeSequence(){return this._activeSequence}get activeSequenceOffset(){return this._activeSequenceOffset}recycle(){this._isRecycled||(this._isRecycled=!0,t.POOL.length<t.POOL_SIZE_LIMIT&&t.POOL.push(this))}}return t.FRAME_REPEAT_FOREVER=-1,t.SEQUENCE_NOT_DEFINED=-1,t.POOL_SIZE_LIMIT=3e3,t.POOL=[],t})();class yl{constructor(t,e,s,i,r,n){this._id=0,this._x=0,this._y=0,this._randomX=0,this._randomY=0,this._repeats=1,this._id=t,this._x=e,this._y=s,this._randomX=i,this._randomY=r,this._repeats=n}get id(){return this._id}hasDirectionalOffsets(){return!1}getX(t){return this._x}getY(t){return this._y}get x(){return this._x}get y(){return this._x}get randomX(){return this._randomX}get randomY(){return this._randomY}get repeats(){return this._repeats}}class Cl extends yl{constructor(t,e,s,i,r,n,a){super(t,e,s,i,r,a),this._directionalOffsets=n}hasDirectionalOffsets(){return null!==this._directionalOffsets}getX(t){return this._directionalOffsets?this._directionalOffsets.getXOffset(t,super.getX(t)):super.getX(t)}getY(t){return this._directionalOffsets?this._directionalOffsets.getYOffset(t,super.getY(t)):super.getY(t)}}class Ml{constructor(t,e){this._frames=[],this._frameIndexes=[],this._frameRepeats=[],this._isRandom=e,this._loopCount=t<1?1:t}get isRandom(){return this._isRandom}get frameCount(){return this._frameIndexes.length*this._loopCount}dispose(){this._frames=[]}initialize(){let t=this._frameIndexes.length-1,e=-1,s=1;for(;t>=0;)this._frameIndexes[t]===e?s++:(e=this._frameIndexes[t],s=1),this._frameRepeats[t]=s,t--}addFrame(t,e,s,i,r,n){let a=1;if(this._frames.length>0){const n=this._frames[this._frames.length-1];n.id!==t||n.hasDirectionalOffsets()||n.x!==e||n.y!==s||n.randomX!==i||0!==i||n.randomY!==r||0!==r||(a+=n.repeats,this._frames.pop())}const o=n?new Cl(t,e,s,i,r,n,a):new yl(t,e,s,i,r,a);this._frames.push(o),this._frameIndexes.push(this._frames.length-1),this._frameRepeats.push(1)}getFrame(t){return!this._frames.length||t<0||t>=this.frameCount?null:this._frames[this._frameIndexes[t%this._frameIndexes.length]]}getFrameIndex(t){return t<0||t>=this.frameCount?-1:(this._isRandom&&(t=Math.round(Math.random()*this._frameIndexes.length))===this._frameIndexes.length&&t--,t)}getRepeats(t){return t<0||t>=this.frameCount?0:this._frameRepeats[t%this._frameRepeats.length]}}class Dl{constructor(t,e,s){this._frameSequences=[],this._frameCount=-1,this._loopCount=t<0?0:t,this._frameRepeat=e<1?1:e,this._isRandom=s}get frameCount(){return this._frameCount<0&&this.calculateLength(),this._frameCount}dispose(){if(this._frameSequences&&this._frameSequences.length){for(const t of this._frameSequences)t&&t.dispose();this._frameSequences=[]}}addFrameSequence(t,e){const s=new Ml(t,e);return this._frameSequences.push(s),s}calculateLength(){this._frameCount=0;for(const t of this._frameSequences)t&&(this._frameCount+=t.frameCount)}getFrame(t,e){if(this._frameCount<1)return null;if(e/=this._frameRepeat,!this._isRandom){const s=Math.floor(e/this._frameCount);e=Math.floor(e%this._frameCount);let i=!1,r=null;(this._loopCount>0&&s>=this._loopCount||this._loopCount<=0&&1===this._frameCount)&&(e=this._frameCount-1,i=!0);let n=0,a=0;for(;a<this._frameSequences.length;){if(r=this._frameSequences[a],r){if(e<n+r.frameCount)break;n+=r.frameCount}a++}return this.getFrameFromSpecificSequence(t,r,a,e-n,i)}const s=Math.trunc(this._frameSequences.length*Math.random()),i=this._frameSequences[s];return i.frameCount<1?null:this.getFrameFromSpecificSequence(t,i,s,0,!1)}getFrameFromSequence(t,e,s,i){if(e<0||e>=this._frameSequences.length)return null;const r=this._frameSequences[e];return r?s>=r.frameCount?this.getFrame(t,i):this.getFrameFromSpecificSequence(t,r,e,s,!1):null}getFrameFromSpecificSequence(t,e,s,i,r){if(!e)return null;const n=e.getFrameIndex(i),a=e.getFrame(n);if(!a)return null;let o=a.getX(t),c=a.getY(t);const _=a.randomX,h=a.randomY;let l=a.repeats,u=!1;_&&(o=Math.trunc(o+_*Math.random())),h&&(c=Math.trunc(c+h*Math.random())),l>1&&(l=e.getRepeats(n));let d=this._frameRepeat*l;return r&&(d=Al.FRAME_REPEAT_FOREVER),this._isRandom||e.isRandom||s===this._frameSequences.length-1&&i===e.frameCount-1&&(u=!0),Al.allocate(a.id,o,c,l,d,u,s,i)}}class Nl{constructor(){this._offsetX=new Map,this._offsetY=new Map}getXOffset(t,e){const s=this._offsetX.get(t);return null==s?e:s}getYOffset(t,e){const s=this._offsetY.get(t);return null==s?e:s}setDirection(t,e,s){this._offsetX.set(t,e),this._offsetY.set(t,s)}}let wl=(()=>{class t{constructor(){this._layers=new Map,this._frameCount=-1,this._randomStart=!1,this._immediateChanges=null}static getTransitionToAnimationId(e){return t.TRANSITION_TO_ANIMATION_OFFSET+e}static getTransitionFromAnimationId(e){return t.TRANSITION_FROM_ANIMATION_OFFSET+e}static isTransitionToAnimation(e){return e>=t.TRANSITION_TO_ANIMATION_OFFSET&&e<t.TRANSITION_FROM_ANIMATION_OFFSET}static isTransitionFromAnimation(e){return e>=t.TRANSITION_FROM_ANIMATION_OFFSET}dispose(){for(const t of this._layers.values())t&&t.dispose();this._layers.clear(),this._immediateChanges=null}setImmediateChanges(t){this._immediateChanges=t}isImmediateChange(t){return!(!this._immediateChanges||-1===this._immediateChanges.indexOf(t))}getStartFrame(t){return this._randomStart?Math.random()*this._frameCount:0}initialize(t){if(this._randomStart=!1,t.layers)for(const e in t.layers){const s=t.layers[e];if(!s)return!1;const i=parseInt(e);if(!this.addLayer(i,void 0!==s.loopCount?s.loopCount:1,void 0!==s.frameRepeat?s.frameRepeat:1,void 0!==s.random&&0!==s.random,s))return!1}return!0}addLayer(t,e,s,i,r){const n=new Dl(e,s,i);if(r.frameSequences)for(const o in r.frameSequences){const t=r.frameSequences[o];if(!t)continue;const e=n.addFrameSequence(void 0!==t.loopCount?t.loopCount:1,void 0!==t.random&&0!==t.random);if(t.frames)for(const s in t.frames){const i=t.frames[s];if(!i)return n.dispose(),!1;e.addFrame(i.id,i.x||0,i.y||0,i.randomX||0,i.randomY||0,this.readDirectionalOffsets(i))}e.initialize()}n.calculateLength(),this._layers.set(t,n);const a=n.frameCount;return a>this._frameCount&&(this._frameCount=a),!0}readDirectionalOffsets(t){let e=null;if(t&&t.offsets)for(const s in t.offsets){const i=t.offsets[s];i&&(e||(e=new Nl),e.setDirection(i.direction,i.x,i.y))}return e}getFrame(t,e,s){const i=this._layers.get(e);return i?i.getFrame(t,s):null}getFrameFromSequence(t,e,s,i,r){const n=this._layers.get(e);return n?n.getFrameFromSequence(t,s,i,r):null}}return t.TRANSITION_TO_ANIMATION_OFFSET=1e6,t.TRANSITION_FROM_ANIMATION_OFFSET=2e6,t.DEFAULT_FRAME_NUMBER=0,t})();class Ul{constructor(){this._animationId=-1,this._animationAfterTransitionId=0,this._animationOver=!1,this._frameCounter=0,this._frames=[],this._lastFramePlayed=[],this._animationPlayed=[],this._layerCount=0}get animationOver(){return this._animationOver}set animationOver(t){this._animationOver=t}get frameCounter(){return this._frameCounter}set frameCounter(t){this._frameCounter=t}get animationId(){return this._animationId}set animationId(t){t!==this._animationId&&(this._animationId=t,this.resetAnimationFrames(!1))}get animationAfterTransitionId(){return this._animationAfterTransitionId}set animationAfterTransitionId(t){this._animationAfterTransitionId=t}dispose(){this.recycleFrames(),this._frames=null,this._lastFramePlayed=null,this._animationPlayed=null}setLayerCount(t){this._layerCount=t,this.resetAnimationFrames()}resetAnimationFrames(t=!0){!t&&this._frames||(this.recycleFrames(),this._frames=[]),this._lastFramePlayed=[],this._animationPlayed=[],this._animationOver=!1,this._frameCounter=0;let e=0;for(;e<this._layerCount;){if(t||this._frames.length<=e)this._frames[e]=null;else{const t=this._frames[e];t&&(t.recycle(),this._frames[e]=Al.allocate(t.id,t.x,t.y,t.repeats,0,t.isLastFrame))}this._lastFramePlayed[e]=!1,this._animationPlayed[e]=!1,e++}}recycleFrames(){if(this._frames&&this._frames.length)for(const t of this._frames)t&&t.recycle()}getFrame(t){return t<0||t>=this._layerCount?null:this._frames[t]}setFrame(t,e){if(t<0||t>=this._layerCount)return;const s=this._frames[t];s&&s.recycle(),this._frames[t]=e}getAnimationPlayed(t){return t<0||t>=this._layerCount||this._animationPlayed[t]}setAnimationPlayed(t,e){t<0||t>=this._layerCount||(this._animationPlayed[t]=e)}getLastFramePlayed(t){return t<0||t>=this._layerCount||this._lastFramePlayed[t]}setLastFramePlayed(t,e){t<0||t>=this._layerCount||(this._lastFramePlayed[t]=e)}}class Ll{static hex2int(t){return parseInt(t,16)}static inkToBlendMode(t){return"ADD"==t||33==t?A.b.ADD:A.b.NORMAL}}let Pl=(()=>{class t{constructor(t){this._colors=[],this.createColors(t)}createColors(e){if(e)for(let s=0;s<e;s++)this._colors.push(t.DEFAULT_COLOR)}dispose(){this._colors=[]}getLayerColor(e){return this._colors[e]||t.DEFAULT_COLOR}setColorLayer(t,e){this._colors[t]&&(this._colors[t]=e)}}return t.DEFAULT_COLOR=16777215,t})(),xl=(()=>{class t{constructor(){this._tag=t.DEFAULT_TAG,this._ink=t.DEFAULT_INK,this._alpha=t.DEFAULT_ALPHA,this._ignoreMouse=t.DEFAULT_IGNORE_MOUSE,this._xOffset=t.DEFAULT_XOFFSET,this._yOffset=t.DEFAULT_YOFFSET,this._zOffset=t.DEFAULT_ZOFFSET}setFromLayer(t){t&&(this._tag=t.tag,this._ink=t.ink,this._alpha=t.alpha,this._ignoreMouse=t.ignoreMouse,this._xOffset=t.xOffset,this._yOffset=t.yOffset,this._zOffset=t.zOffset)}get tag(){return this._tag}set tag(t){this._tag=t}get ink(){return this._ink}set ink(t){this._ink=t}get alpha(){return this._alpha}set alpha(t){this._alpha=t}get ignoreMouse(){return this._ignoreMouse}set ignoreMouse(t){this._ignoreMouse=t}get xOffset(){return this._xOffset}set xOffset(t){this._xOffset=t}get yOffset(){return this._yOffset}set yOffset(t){this._yOffset=t}get zOffset(){return this._zOffset}set zOffset(t){this._zOffset=t}}return t.DEFAULT_COUNT=0,t.DEFAULT_DIRECTION=0,t.DEFAULT_TAG="",t.DEFAULT_INK=A.b.NORMAL,t.DEFAULT_ALPHA=255,t.DEFAULT_IGNORE_MOUSE=!1,t.DEFAULT_XOFFSET=0,t.DEFAULT_YOFFSET=0,t.DEFAULT_ZOFFSET=0,t.ADD_INK=A.b.ADD,t.SUBTRACT_INK=A.b.NORMAL,t.DARKEN_INK=A.b.NORMAL,t})(),Fl=(()=>{class t{constructor(t){this._layers=[],this.createLayers(t)}createLayers(t){if(t)for(let e=0;e<t;e++)this._layers.push(new xl)}dispose(){this._layers=[]}setFromDirection(t){if(!t)return;const e=this.layerCount;if(e===t.layerCount)for(let s=0;s<e;s++){const e=this.getLayer(s),i=t.getLayer(s);e&&e.setFromLayer(i)}}getLayer(t){return this._layers[t]||null}getLayerTag(t){const e=this.getLayer(t);return e?e.tag:xl.DEFAULT_TAG}setLayerTag(t,e){const s=this.getLayer(t);s&&(s.tag=e)}getLayerInk(t){const e=this.getLayer(t);return e?e.ink:xl.DEFAULT_INK}setLayerInk(t,e){const s=this.getLayer(t);s&&(isNaN(e)||(s.ink=e))}getLayerAlpha(t){const e=this.getLayer(t);return e?e.alpha:xl.DEFAULT_ALPHA}setLayerAlpha(t,e){const s=this.getLayer(t);s&&(isNaN(e)||(s.alpha=e))}getLayerIgnoreMouse(t){const e=this.getLayer(t);return e?e.ignoreMouse:xl.DEFAULT_IGNORE_MOUSE}setLayerIgnoreMouse(t,e){const s=this.getLayer(t);s&&(s.ignoreMouse=e||!1)}getLayerXOffset(t){const e=this.getLayer(t);return e?e.xOffset:xl.DEFAULT_XOFFSET}setLayerXOffset(t,e){const s=this.getLayer(t);s&&(isNaN(e)||(s.xOffset=e))}getLayerYOffset(t){const e=this.getLayer(t);return e?e.yOffset:xl.DEFAULT_YOFFSET}setLayerYOffset(t,e){const s=this.getLayer(t);s&&(isNaN(e)||(s.yOffset=e))}getLayerZOffset(t){const e=this.getLayer(t);return e?e.zOffset:xl.DEFAULT_ZOFFSET}setLayerZOffset(t,e){const s=this.getLayer(t);s&&(isNaN(e)||(s.zOffset=e))}get layerCount(){return this._layers.length}}return t._Str_9471=-1,t})(),Gl=(()=>{class t{constructor(e,s){this._layerCount=e<0?0:e>t.MAX_LAYERS?t.MAX_LAYERS:e,this._angle=s<1?1:s>360?360:s,this._defaultDirection=new Fl(this._layerCount),this._directions=new Map,this._colors=[],this._lastDirectionData=null,this._lastDirection=-1}dispose(){this._defaultDirection&&this._defaultDirection.dispose();for(const t of this._directions.values())t&&t.dispose();for(const t of this._colors)t&&t.dispose();this.reset()}reset(){this._defaultDirection=null,this._colors=[],this._lastDirectionData=null,this._lastDirection=-1,this._directions.clear()}processLayers(t){return!!t&&this.setDirectionLayers(this._defaultDirection,t)}processDirections(t){if(!t)return!1;for(const e in t){const s=t[e];if(!s)continue;const i=parseInt(e);if(this._directions.get(i))return!1;const r=new Fl(this._layerCount);r.setFromDirection(this._defaultDirection),this.setDirectionLayers(r,s.layers),this._directions.set(i,r),this._lastDirectionData=null,this._lastDirection=-1}return!0}processColors(t){if(!t)return!1;for(const e in t){const s=t[e];if(!s)continue;const i=parseInt(e);if(this._colors[i])return!1;const r=new Pl(this._layerCount);for(const t in s.layers){const e=s.layers[t];if(!e)continue;const i=parseInt(t);r.setColorLayer(i,e.color)}this._colors[i]=r}return!0}setDirectionLayers(t,e){if(!t||!e)return!1;for(const s in e){const i=e[s];if(!i)continue;const r=parseInt(s);if(r<0||r>=this._layerCount)return!1;void 0!==i.ink&&t.setLayerInk(r,Ll.inkToBlendMode(i.ink)),void 0!==i.tag&&t.setLayerTag(r,i.tag),void 0!==i.alpha&&t.setLayerAlpha(r,i.alpha),void 0!==i.ignoreMouse&&t.setLayerIgnoreMouse(r,i.ignoreMouse),void 0!==i.x&&t.setLayerXOffset(r,i.x),void 0!==i.y&&t.setLayerYOffset(r,i.y),void 0!==i.z&&t.setLayerZOffset(r,i.z/-1e3)}return!0}getValidDirection(t){if(this._directions.get(t))return t;t=(t%360+360)%360;let e=-1,s=-1;for(const i of this._directions.keys()){let r=(i*this._angle-t+360)%360;r>180&&(r=360-r),(r<e||e<0)&&(e=r,s=i)}return s>=0?Math.trunc(s):0}getDirectionData(t){if(t===this._lastDirection&&this._lastDirectionData)return this._lastDirectionData;let e=this._directions.get(t);return e||(e=this._defaultDirection),this._lastDirection=t,this._lastDirectionData=e,this._lastDirectionData}getLayerTag(t,e){const s=this.getDirectionData(t);return s?s.getLayerTag(e):xl.DEFAULT_TAG}getLayerInk(t,e){const s=this.getDirectionData(t);return s?s.getLayerInk(e):xl.DEFAULT_INK}getLayerAlpha(t,e){const s=this.getDirectionData(t);return s?s.getLayerAlpha(e):xl.DEFAULT_ALPHA}getLayerColor(t,e){const s=this._colors[e];return s?s.getLayerColor(t):Pl.DEFAULT_COLOR}getLayerIgnoreMouse(t,e){const s=this.getDirectionData(t);return s?s.getLayerIgnoreMouse(e):xl.DEFAULT_IGNORE_MOUSE}getLayerXOffset(t,e){const s=this.getDirectionData(t);return s?s.getLayerXOffset(e):xl.DEFAULT_XOFFSET}getLayerYOffset(t,e){const s=this.getDirectionData(t);return s?s.getLayerYOffset(e):xl.DEFAULT_YOFFSET}getLayerZOffset(t,e){const s=this.getDirectionData(t);return s?s.getLayerZOffset(e):xl.DEFAULT_ZOFFSET}get layerCount(){return this._layerCount}}return t.MAX_LAYERS=26,t})();class Vl extends Gl{constructor(t,e){super(t,e),this._animations=new Map,this._animationIds=[]}dispose(){super.dispose();for(const t of this._animations.values())t&&t.dispose();this._animations.clear(),this._animationIds=[]}defineAnimations(t){if(!t)return!0;for(const e in t){const s=t[e];if(!s)return!1;let i=parseInt(e),r=!1;const n=s.transitionTo,a=s.transitionFrom;void 0!==n&&(i=wl.getTransitionToAnimationId(n),r=!0),void 0!==a&&(i=wl.getTransitionFromAnimationId(a),r=!0);const o=this.createAnimationData();if(!o.initialize(s))return o.dispose(),!1;this._animations.set(i,o),r||this._animationIds.push(i)}return!0}createAnimationData(){return new wl}hasAnimation(t){return!!this._animations.get(t)}getAnimationCount(){return this._animationIds.length||0}getAnimationId(t){const e=this.getAnimationCount();return t<0||e<=0?0:this._animationIds[t%e]}isImmediateChange(t,e){const s=this._animations.get(t);return!!s&&s.isImmediateChange(e)}getStartFrame(t,e){const s=this._animations.get(t);return s?s.getStartFrame(e):0}getFrame(t,e,s,i){const r=this._animations.get(t);return r?r.getFrame(e,s,i):null}getFrameFromSequence(t,e,s,i,r,n){const a=this._animations.get(t);return a?a.getFrameFromSequence(e,s,i,r,n):null}}let Yl=(()=>{class t{constructor(){this._type="",this._sizes=[],this._sizeDatas=new Map,this._lastSize=-1,this._lastSizeScale=-1,this._lastSizeData=null,this._lastSizeDataScale=-1}initialize(t){return this.reset(),!!(t&&t.type&&t.type.length)&&(this._type=t.name,!!this.defineVisualizations(t.visualizations)||(this.reset(),!1))}dispose(){if(this._sizeDatas&&this._sizeDatas.size){for(const t of this._sizeDatas.values())t&&t.dispose();this._sizeDatas=null}this._lastSizeData=null,this._sizes=null}reset(){if(this._type="",this._sizeDatas&&this._sizeDatas.size)for(const t of this._sizeDatas.values())t&&t.dispose();this._sizeDatas.clear(),this._sizes=[],this._lastSizeData=null,this._lastSizeDataScale=-1}createSizeData(t,e,s){return new Gl(e,s)}defineVisualizations(t){if(!t)return!1;for(const e of t){const t=e.layerCount,s=e.angle;let i=e.size;if(i<1&&(i=1),this._sizeDatas.get(i))return!1;const r=this.createSizeData(i,t,s);if(!r)return!1;for(const n in e)if(!this.processVisualElement(r,n,e[n]))return r.dispose(),!1;this._sizeDatas.set(i,r),this._sizes.push(i)}return this._sizes.sort(),!0}processVisualElement(t,e,s){if(!t||!e||!s)return!1;switch(e){case"layers":if(!t.processLayers(s))return!1;break;case"directions":if(!t.processDirections(s))return!1;break;case"colors":if(!t.processColors(s))return!1}return!0}getValidSize(t){if(t===this._lastSizeScale)return this._lastSize;const e=this.getSizeIndex(t);let s=-1;return e<this._sizes.length&&(s=this._sizes[e]),this._lastSizeScale=t,this._lastSize=s,s}getSizeIndex(t){if(t<=0)return 0;let e=0,s=1;for(;s<this._sizes.length;){if(this._sizes[s]>t){this._sizes[s]/t<t/this._sizes[s-1]&&(e=s);break}e=s,s++}return e}getSizeData(t){if(t===this._lastSizeDataScale)return this._lastSizeData;const e=this.getSizeIndex(t);return this._lastSizeData=e<this._sizes.length?this._sizeDatas.get(this._sizes[e]):null,this._lastSizeDataScale=t,this._lastSizeData}getLayerCount(t){const e=this.getSizeData(t);return e?e.layerCount:xl.DEFAULT_COUNT}getValidDirection(t,e){const s=this.getSizeData(t);return s?s.getValidDirection(e):xl.DEFAULT_DIRECTION}getLayerTag(t,e,s){const i=this.getSizeData(t);return i?i.getLayerTag(e,s):xl.DEFAULT_TAG}getLayerInk(t,e,s){const i=this.getSizeData(t);return i?i.getLayerInk(e,s):xl.DEFAULT_INK}getLayerAlpha(t,e,s){const i=this.getSizeData(t);return i?i.getLayerAlpha(e,s):xl.DEFAULT_ALPHA}getLayerColor(t,e,s){const i=this.getSizeData(t);return i?i.getLayerColor(e,s):Pl.DEFAULT_COLOR}getLayerIgnoreMouse(t,e,s){const i=this.getSizeData(t);return i?i.getLayerIgnoreMouse(e,s):xl.DEFAULT_IGNORE_MOUSE}getLayerXOffset(t,e,s){const i=this.getSizeData(t);return i?i.getLayerXOffset(e,s):xl.DEFAULT_XOFFSET}getLayerYOffset(t,e,s){const i=this.getSizeData(t);return i?i.getLayerYOffset(e,s):xl.DEFAULT_YOFFSET}getLayerZOffset(t,e,s){const i=this.getSizeData(t);return i?i.getLayerZOffset(e,s):xl.DEFAULT_ZOFFSET}get type(){return this._type}}return t.LAYER_LETTERS=["a","b","c","d","e","f","g","h","i","j","k","l","m","n","o","p","q","r","s","t","u","v","w","x","y","z"],t})();class kl extends Yl{createSizeData(t,e,s){return new Vl(e,s)}processVisualElement(t,e,s){if(!t||!e||!s)return!1;switch(e){case"animations":if(!(t instanceof Vl&&t.defineAnimations(s)))return!1;break;default:if(!super.processVisualElement(t,e,s))return!1}return!0}hasAnimation(t,e){const s=this.getSizeData(t);return s?s.hasAnimation(e):null}getAnimationCount(t){const e=this.getSizeData(t);return e?e.getAnimationCount():null}getAnimationId(t,e){const s=this.getSizeData(t);return s?s.getAnimationId(e):null}isImmediateChange(t,e,s){const i=this.getSizeData(t);return i?i.isImmediateChange(e,s):null}getStartFrame(t,e,s){const i=this.getSizeData(t);return i?i.getStartFrame(e,s):null}getFrame(t,e,s,i,r){const n=this.getSizeData(t);return n?n.getFrame(e,s,i,r):null}getFrameFromSequence(t,e,s,i,r,n,a){const o=this.getSizeData(t);return o?o.getFrameFromSequence(e,s,i,r,n,a):null}}let jl=(()=>{class t extends El{constructor(){super(),this._data=null,this._type=null,this._direction=0,this._lastCameraAngle=NaN,this._selectedColor=0,this._furnitureLift=0,this._alphaMultiplier=1,this._alphaChanged=!1,this._clickUrl=null,this._cacheDirection=-1,this._cacheScale=0,this._cacheSize=-1,this._layerCount=0,this._shadowLayerIndex=-1,this._updatedLayers=[],this._assetNames=[],this._spriteTags=[],this._spriteInks=[],this._spriteAlphas=[],this._spriteColors=[],this._spriteMouseCaptures=[],this._spriteXOffsets=[],this._spriteYOffsets=[],this._spriteZOffsets=[],this._animationNumber=0}initialize(t){return this.reset(),t instanceof Yl&&(this._type=t.type,this._data=t,!0)}dispose(){super.dispose(),this._data=null,this._updatedLayers=null,this._assetNames=null,this._spriteTags=null,this._spriteInks=null,this._spriteAlphas=null,this._spriteColors=null,this._spriteMouseCaptures=null,this._spriteXOffsets=null,this._spriteYOffsets=null,this._spriteZOffsets=null}reset(){super.reset(),this.setDirection(-1),this._data=null,this._updatedLayers=[],this._assetNames=[],this._spriteTags=[],this._spriteInks=[],this._spriteAlphas=[],this._spriteColors=[],this._spriteMouseCaptures=[],this._spriteXOffsets=[],this._spriteYOffsets=[],this._spriteZOffsets=[],this.setSpriteCount(0)}resetLayers(t,e){this._cacheDirection===e&&this._cacheScale===t||(this._updatedLayers=[],this._assetNames=[],this._spriteTags=[],this._spriteInks=[],this._spriteAlphas=[],this._spriteColors=[],this._spriteMouseCaptures=[],this._spriteXOffsets=[],this._spriteYOffsets=[],this._spriteZOffsets=[],this._cacheDirection=e,this._cacheScale=t,this._cacheSize=this.getValidSize(t),this.setLayerCount((this._data&&this._data.getLayerCount(t)||0)+this.getAdditionalLayerCount()))}update(t,e,s,i){if(!t)return;const r=t.scale;let n=!1;this.updateObject(r,t.direction.x)&&(n=!0),this.updateModel(r)&&(n=!0);let a=0;i?this._animationNumber=this._animationNumber|this.updateAnimation(r):(a=this.updateAnimation(r)|this._animationNumber,this._animationNumber=0),(n||0!==a)&&(this.updateSprites(r,n,a),this._scale=r,this.updateSpriteCounter++)}updateObject(t,e){if(!this.object)return!1;if(this.updateObjectCounter===this.object.updateCounter&&t===this._scale&&this._lastCameraAngle===e)return!1;let s=this.object.getDirection().x-(e+135);if(s=(s%360+360)%360,this._data){const e=this._data.getValidDirection(t,s);this.setDirection(e)}return this._lastCameraAngle=e,this._scale=t,this.updateObjectCounter=this.object.updateCounter,this.resetLayers(t,this._direction),!0}updateModel(t){const e=this.object&&this.object.model;if(!e)return!1;if(this.updateModelCounter===e.updateCounter)return!1;this._selectedColor=e.getValue(st.FURNITURE_COLOR),this._clickUrl=e.getValue(st.FURNITURE_AD_URL),this._furnitureLift=e.getValue(st.FURNITURE_LIFT_AMOUNT)||0;let s=e.getValue(st.FURNITURE_ALPHA_MULTIPLIER);return isNaN(s)&&(s=1),this._alphaMultiplier!==s&&(this._alphaMultiplier=s,this._alphaChanged=!0),this.updateModelCounter=e.updateCounter,!0}updateSprites(t,e,s){if(this._layerCount!==this.totalSprites&&this.setSpriteCount(this._layerCount),e){let e=this.totalSprites-1;for(;e>=0;)this.updateSprite(t,e),e--}else{let e=0;for(;s>0;)s&&this.updateSprite(t,e),e++,s>>=1}this._alphaChanged=!1}updateSprite(e,s){const i=this.getSpriteAssetName(e,s),r=this.getSprite(s);if(i&&r){const n=this.getAsset(i,s);if(n&&n.texture){r.visible=!0,r.type=this._type,r.texture=n.texture,r.flipH=n.flipH,r.flipV=n.flipV,r.direction=this._direction;let a=0;s!==this._shadowLayerIndex?(r.tag=this.getLayerTag(e,this._direction,s),r.alpha=this.getLayerAlpha(e,this._direction,s),r.color=this.getLayerColor(e,s,this._selectedColor),r.offsetX=n.offsetX+this.getLayerXOffset(e,this._direction,s),r.offsetY=n.offsetY+this.getLayerYOffset(e,this._direction,s),r.blendMode=this.getLayerInk(e,this._direction,s),r.alphaTolerance=this.getLayerIgnoreMouse(e,this._direction,s)?ml._Str_9268:ml._Str_9735,a=this.getLayerZOffset(e,this._direction,s),a-=.001*s):(r.offsetX=n.offsetX,r.offsetY=n.offsetY+this.getLayerYOffset(e,this._direction,s),r.alpha=48*this._alphaMultiplier,r.alphaTolerance=ml._Str_9268,a=1),r.relativeDepth=a*t.DEPTH_MULTIPLIER,r.name=i,r._Str_3582=this.getLibraryAssetNameForSprite(n,r),r.posture=this.getPostureForAsset(e,n.source),r.clickHandling=!1}else this.resetSprite(r)}else r&&this.resetSprite(r)}getLibraryAssetNameForSprite(t,e){return t.source}getPostureForAssetFile(t,e){return null}resetSprite(t){t&&(t.texture=null,t.offsetX=0,t.offsetY=0,t.flipH=!1,t.flipV=!1,t.relativeDepth=0)}getSpriteAssetName(t,e){if(!this._data||e>=Yl.LAYER_LETTERS.length)return"";let s=this._assetNames[e],i=this._updatedLayers[e];return s&&s.length||(s=this.cacheSpriteAssetName(t,e,!0),i=1!==this._cacheSize),i&&(s+=this.getFrameNumber(t,e)),s}cacheSpriteAssetName(t,e,s){const i=s?this._cacheSize:this.getValidSize(t);let r="";const n=1!==i;if(r=e!==this._shadowLayerIndex?Yl.LAYER_LETTERS[e]||"":"sd",""===r)return null;const a=this._type+(n?"_"+i+"_"+r+"_"+this._direction+"_":"_icon_"+r);return s&&(this._assetNames[e]=a,this._updatedLayers[e]=n),a}getLayerTag(t,e,s){const i=this._spriteTags[s];if(void 0!==i)return i;if(!this._data)return xl.DEFAULT_TAG;const r=this._data.getLayerTag(t,e,s);return this._spriteTags[s]=r,r}getLayerInk(t,e,s){const i=this._spriteInks[s];if(void 0!==i)return i;if(!this._data)return xl.DEFAULT_INK;const r=this._data.getLayerInk(t,e,s);return this._spriteInks[s]=r,r}getLayerAlpha(t,e,s){if(!this._alphaChanged){const t=this._spriteAlphas[s];if(void 0!==t)return t}if(!this._data)return xl.DEFAULT_ALPHA;let i=this._data.getLayerAlpha(t,e,s);return null!==this._alphaMultiplier&&(i*=this._alphaMultiplier),this._spriteAlphas[s]=i,i}getLayerColor(t,e,s){const i=this._spriteColors[e];if(void 0!==i)return i;if(!this._data)return Pl.DEFAULT_COLOR;const r=this._data.getLayerColor(t,e,s);return this._spriteColors[e]=r,r}getLayerIgnoreMouse(t,e,s){const i=this._spriteMouseCaptures[s];if(void 0!==i)return i;if(!this._data)return xl.DEFAULT_IGNORE_MOUSE;const r=this._data.getLayerIgnoreMouse(t,e,s);return this._spriteMouseCaptures[s]=r,r}getLayerXOffset(t,e,s){const i=this._spriteXOffsets[s];if(void 0!==i)return i;if(!this._data)return xl.DEFAULT_XOFFSET;const r=this._data.getLayerXOffset(t,e,s);return this._spriteXOffsets[s]=r,r}getLayerYOffset(t,e,s){if(s===this._shadowLayerIndex)return Math.ceil(32*this._furnitureLift);const i=this._spriteYOffsets[s];if(void 0!==i)return i;if(!this._data)return xl.DEFAULT_YOFFSET;const r=this._data.getLayerYOffset(t,e,s);return this._spriteYOffsets[s]=r,r}getLayerZOffset(t,e,s){const i=this._spriteZOffsets[s];if(void 0!==i)return i;if(!this._data)return xl.DEFAULT_ZOFFSET;const r=this._data.getLayerZOffset(t,e,s);return this._spriteZOffsets[s]=r,r}getValidSize(t){return this._data?this._data.getValidSize(t):t}setLayerCount(t){this._layerCount=t,this._shadowLayerIndex=t-this.getAdditionalLayerCount()}setDirection(t){this._direction!==t&&(this._direction=t)}getAdditionalLayerCount(){return 1}updateAnimation(t){return 0}getFrameNumber(t,e){return 0}getPostureForAsset(t,e){return null}getAsset(t,e=-1){return this.asset?this.asset.getAsset(t):null}get direction(){return this._direction}}return t.DEPTH_MULTIPLIER=Math.sqrt(.5),t.TYPE=it.FURNITURE_STATIC,t})(),Bl=(()=>{class t extends jl{constructor(){super(),this._state=-1,this._animationData=new Ul,this._animationScale=0,this._animationChangeTime=0,this._animatedLayerCount=0,this._directionChanged=!1}initialize(t){return t instanceof kl&&super.initialize(t)}dispose(){super.dispose(),this._animationData&&(this._animationData.dispose(),this._animationData=null)}get animatedLayerCount(){return this._animatedLayerCount}get animationId(){return this._animationData.animationId}getAnimationId(e){return this.animationId!==t.DEFAULT_ANIMATION_ID&&this._data.hasAnimation(this._animationScale,this.animationId)?this.animationId:t.DEFAULT_ANIMATION_ID}updateObject(t,e){if(super.updateObject(t,e)){const t=this.object.getState(0);return t!==this._state&&(this.setAnimation(t),this._state=t,this._animationChangeTime=this.object.model.getValue(st.FURNITURE_STATE_UPDATE_TIME)||0),!0}return!1}updateModel(t){if(super.updateModel(t)){if(this.usesAnimationResetting()){const t=this.object.model.getValue(st.FURNITURE_STATE_UPDATE_TIME);t>this._animationChangeTime&&(this._animationChangeTime=t,this.setAnimation(this._state))}const t=this.object.model.getValue(st.FURNITURE_AUTOMATIC_STATE_INDEX);if(!isNaN(t)){const e=this._data.getAnimationId(this._animationScale,t);this.setAnimation(e)}return!0}return!1}isPlayingTransition(t,e){return!(!wl.isTransitionFromAnimation(t.animationId)&&!wl.isTransitionToAnimation(t.animationId)||e!==t.animationAfterTransitionId||t.animationOver)}getCurrentState(t){const e=t.animationId;return wl.isTransitionFromAnimation(e)||wl.isTransitionToAnimation(e)?t.animationAfterTransitionId:e}setAnimation(t){this._data&&this.setSubAnimation(this._animationData,t,this._state>=0)}setSubAnimation(t,e,s=!0){const i=t.animationId;if(s){if(this.isPlayingTransition(t,e))return!1;const s=this.getCurrentState(t);if(e!==s){if(!this._data.isImmediateChange(this._animationScale,e,s)){let i=wl.getTransitionFromAnimationId(s);this._data.hasAnimation(this._animationScale,i)?(t.animationAfterTransitionId=e,e=i):(i=wl.getTransitionToAnimationId(e),this._data.hasAnimation(this._animationScale,i)&&(t.animationAfterTransitionId=e,e=i))}}else if(wl.isTransitionFromAnimation(t.animationId)){const s=wl.getTransitionToAnimationId(e);this._data.hasAnimation(this._animationScale,s)&&(t.animationAfterTransitionId=e,e=s)}else if(!wl.isTransitionToAnimation(t.animationId)&&this.usesAnimationResetting()){const i=wl.getTransitionFromAnimationId(s);if(this._data.hasAnimation(this._animationScale,i))t.animationAfterTransitionId=e,e=i;else{const s=wl.getTransitionToAnimationId(e);this._data.hasAnimation(this._animationScale,s)&&(t.animationAfterTransitionId=e,e=s)}}}return i!==e&&(t.animationId=e,!0)}getLastFramePlayed(t){return this._animationData.getLastFramePlayed(t)}resetAllAnimationFrames(){this._animationData&&this._animationData.setLayerCount(this._animatedLayerCount)}updateAnimation(t){if(!this._data)return 0;t!==this._animationScale&&(this._animationScale=t,this._animatedLayerCount=this._data.getLayerCount(t),this.resetAllAnimationFrames());const e=this.updateAnimations(t);return this._directionChanged=!1,e}updateAnimations(t){if(this._animationData.animationOver&&!this._directionChanged)return 0;const e=this.updateFramesForAnimation(this._animationData,t);return this._animationData.animationOver&&(wl.isTransitionFromAnimation(this._animationData.animationId)||wl.isTransitionToAnimation(this._animationData.animationId))&&(this.setAnimation(this._animationData.animationAfterTransitionId),this._animationData.animationOver=!1),e}updateFramesForAnimation(e,s){if(e.animationOver&&!this._directionChanged)return 0;const i=this.getAnimationId(e);let r=e.frameCounter;r||(r=this._data.getStartFrame(s,i,this._direction)),r+=t.FRAME_INCREASE_AMOUNT,e.frameCounter=r,e.animationOver=!0;let n=!1,a=this._animatedLayerCount-1,o=0,c=1<<this._animatedLayerCount-1;for(;a>=0;){let _=0;if(n=e.getAnimationPlayed(a),!n||this._directionChanged){let h=e.getLastFramePlayed(a),l=e.getFrame(a);l&&l.isLastFrame&&l.remainingFrameRepeats<=t.FRAME_INCREASE_AMOUNT&&(h=!0),(this._directionChanged||!l||l.remainingFrameRepeats>=0&&(l.remainingFrameRepeats=l.remainingFrameRepeats-t.FRAME_INCREASE_AMOUNT)<=0)&&(_=Al.SEQUENCE_NOT_DEFINED,l&&(_=l.activeSequence),l=_===Al.SEQUENCE_NOT_DEFINED?this._data.getFrame(s,i,this._direction,a,r):this._data.getFrameFromSequence(s,i,this._direction,a,_,l.activeSequenceOffset+l.repeats,r),e.setFrame(a,l),o|=c),l&&l.remainingFrameRepeats!=Al.FRAME_REPEAT_FOREVER?e.animationOver=!1:(h=!0,n=!0),e.setLastFramePlayed(a,h),e.setAnimationPlayed(a,n)}c>>=1,a--}return o}getFrameNumber(t,e){const s=this._animationData.getFrame(e);return s?s.id:super.getFrameNumber(t,e)}getLayerXOffset(t,e,s){const i=super.getLayerXOffset(t,e,s),r=this._animationData.getFrame(s);return r?i+r.x:i}getLayerYOffset(t,e,s){const i=super.getLayerYOffset(t,e,s),r=this._animationData.getFrame(s);return r?i+r.y:i}usesAnimationResetting(){return!1}setDirection(t){this._direction!==t&&(super.setDirection(t),this._directionChanged=!0)}}return t.FRAME_INCREASE_AMOUNT=1,t.TYPE=it.FURNITURE_ANIMATED,t.DEFAULT_ANIMATION_ID=0,t})(),Hl=(()=>{class t extends Bl{constructor(){super(),this._badgeAssetNameNormalScale="",this._badgeAssetNameSmallScale="",this._badgeVisibleInState=-1}updateModel(t){let e=super.updateModel(t);if(!isNaN(this.object.model.getValue(st.FURNITURE_BADGE_IMAGE_STATUS))&&0!==this.object.model.getValue(st.FURNITURE_BADGE_IMAGE_STATUS)&&""===this._badgeAssetNameNormalScale){this._badgeAssetNameNormalScale=this.object.model.getValue(st.FURNITURE_BADGE_ASSET_NAME),""===this._badgeAssetNameSmallScale&&(this._badgeAssetNameSmallScale=this._badgeAssetNameNormalScale+"_32");const t=this.object.model.getValue(st.FURNITURE_BADGE_VISIBLE_IN_STATE);isNaN||(this._badgeVisibleInState=t),e=!0}return e}getSpriteAssetName(e,s){return this.getLayerTag(e,this.direction,s)!==t.BADGE||-1!==this._badgeVisibleInState&&this.object.getState(0)!==this._badgeVisibleInState?super.getSpriteAssetName(e,s):32===e?this._badgeAssetNameSmallScale:this._badgeAssetNameNormalScale}getLayerXOffset(e,s,i){let r=super.getLayerXOffset(e,s,i);if(this.getLayerTag(e,s,i)===t.BADGE){const t=this.getAsset(32===e?this._badgeAssetNameSmallScale:this._badgeAssetNameNormalScale,i);t&&(r+=64===e?(40-t.width)/2:(20-t.width)/2)}return r}getLayerYOffset(e,s,i){let r=super.getLayerYOffset(e,s,i);if(this.getLayerTag(e,s,i)===t.BADGE){const t=this.getAsset(32===e?this._badgeAssetNameSmallScale:this._badgeAssetNameNormalScale,i);t&&(r+=64===e?(40-t.height)/2:(20-t.height)/2)}return r}}return t.BADGE="BADGE",t})(),Wl=(()=>{class t extends jl{constructor(){super(),this._imageUrl=null,this._shortUrl=null,this._imageReady=!1,this._offsetX=0,this._offsetY=0,this._offsetZ=0}dispose(){super.dispose(),this._imageUrl&&this.asset&&this.asset.disposeAsset(this._imageUrl)}updateObject(t,e){return!!super.updateObject(t,e)&&(this._imageReady&&this.checkAndCreateImageForCurrentState(),!0)}updateModel(t){const e=super.updateModel(t);if(e&&(this._offsetX=this.object.model.getValue(st.FURNITURE_BRANDING_OFFSET_X),this._offsetY=this.object.model.getValue(st.FURNITURE_BRANDING_OFFSET_Y),this._offsetZ=this.object.model.getValue(st.FURNITURE_BRANDING_OFFSET_Z)),this._imageReady){if(this.checkIfImageChanged())return this._imageReady=!1,this._imageUrl=null,!0}else if(this._imageReady=this.checkIfImageReady(),this._imageReady)return this.checkAndCreateImageForCurrentState(),!0;return e}imageReady(t,e){this._imageUrl=t?e:null}checkIfImageChanged(){const t=this.object.model.getValue(st.FURNITURE_BRANDING_IMAGE_URL);return!(t&&t===this._imageUrl||(this.asset&&this.asset.disposeAsset(this._imageUrl),0))}checkIfImageReady(){if(!this.object||!this.object.model)return!1;const t=this.object.model.getValue(st.FURNITURE_BRANDING_IMAGE_URL);if(!t)return!1;if(this._imageUrl&&this._imageUrl===t)return!1;if(1===this.object.model.getValue(st.FURNITURE_BRANDING_IMAGE_STATUS)){const e=um.instance.core.asset.getTexture(t);return!!e&&(this.imageReady(e,t),!0)}return!1}checkAndCreateImageForCurrentState(){if(!this._imageUrl)return;const t=um.instance.core.asset.getTexture(this._imageUrl);t&&this.asset.addAsset(this._imageUrl,t,!0,0,0,!1,!1)}getSpriteAssetName(e,s){return this.getLayerTag(e,this._direction,s)===t.BRANDED_IMAGE&&this._imageUrl?this._imageUrl:super.getSpriteAssetName(e,s)}getLayerIgnoreMouse(e,s,i){return this.getLayerTag(e,s,i)===t.BRANDED_IMAGE||super.getLayerIgnoreMouse(e,s,i)}}return t.BRANDED_IMAGE="branded_image",t})();class Zl extends Wl{getLayerXOffset(t,e,s){return super.getLayerXOffset(t,e,s)+this._offsetX}getLayerYOffset(t,e,s){return super.getLayerYOffset(t,e,s)+this._offsetY}getLayerZOffset(t,e,s){return super.getLayerZOffset(t,e,s)+this._offsetZ}}let zl=(()=>{class t extends Bl{constructor(){super(),this._stateQueue=[],this._running=!1}setAnimation(e){if(-1===e&&!this._running)return this._running=!0,this._stateQueue=[],void this._stateQueue.push(t._Str_4186);if(e>=0&&e<=7){if(this._running)return this._running=!1,this._stateQueue=[],this._stateQueue.push(t.ANIMATION_ID_OFFSET_SLOW1),this._stateQueue.push(t.ANIMATION_ID_OFFSET_SLOW2+e),void this._stateQueue.push(e);super.setAnimation(e)}}updateAnimation(t){return this.getLastFramePlayed(0)&&this._stateQueue.length&&super.setAnimation(this._stateQueue.shift()),super.updateAnimation(t)}}return t.ANIMATION_ID_OFFSET_SLOW1=20,t.ANIMATION_ID_OFFSET_SLOW2=9,t._Str_4186=-1,t})();class Xl extends jl{}let Kl=(()=>{class t extends Bl{getFrameNumber(e,s){const i=this.getLayerTag(e,this.direction,s),r=this.object.getState(0);switch(i){case t.SECONDS_SPRITE:return Math.floor(r%60%10);case t.TEN_SECONDS_SPRITE:return Math.floor(r%60/10);case t.MINUTES_SPRITE:return Math.floor(r/60%10);case t.TEN_MINUTES_SPRITE:return Math.floor(r/60/10%10);default:return super.getFrameNumber(e,s)}}get animationId(){return 0}}return t.SECONDS_SPRITE="seconds_sprite",t.TEN_SECONDS_SPRITE="ten_seconds_sprite",t.MINUTES_SPRITE="minutes_sprite",t.TEN_MINUTES_SPRITE="ten_minutes_sprite",t})();class ql extends El{}let Jl=(()=>{class t extends Bl{constructor(){super(),this._Str_22237=null,this._Str_10040=null,this._Str_21698=-1,this._Str_16232=!1}get _Str_23660(){return!(null==this._Str_10040)}_Str_6645(t){this._Str_10040=t,this._Str_16232=!0}updateModel(t){const e=super.updateModel(t);return this._Str_16232||this._Str_21698!==this.direction?(this._Str_25236(),!0):e}_Str_25236(){null!=this.asset&&(this._Str_10040?this._Str_20857(this._Str_10040,64):this.asset.disposeAsset(this._Str_15493(64)),this._Str_16232=!1,this._Str_21698=this.direction)}_Str_20857(e,s){let i=0;for(;i<this.totalSprites;){if(this.getLayerTag(s,this.direction,i)===t.THUMBNAIL){const t=this.cacheSpriteAssetName(s,i,!1)+this.getFrameNumber(s,i),r=this.getAsset(t,i);if(r){const t=this._Str_25562(e,r),i=this._Str_15493(s);this.asset.disposeAsset(i),this.asset.addAsset(i,t,!0,r.offsetX,r.offsetY,!1,!1)}return}i++}}_Str_25562(t,e){const s=new A.i,i=e.width/t.width;switch(this.direction){case 2:s.a=i,s.b=-.5*i,s.c=0,s.d=1.1*i,s.tx=0,s.ty=.5*i*t.width;break;case 0:case 4:s.a=i,s.b=.5*i,s.c=0,s.d=1.1*i,s.tx=0,s.ty=0;break;default:s.a=i,s.b=0,s.c=0,s.d=i,s.tx=0,s.ty=0}const r=A.n.from(t);return r.transform.setFromMatrix(s),bt.generateTexture(r,new A.k(0,0,e.width,e.height))}getSpriteAssetName(e,s){return this._Str_10040&&this.getLayerTag(e,this.direction,s)===t.THUMBNAIL?this._Str_15493(e):super.getSpriteAssetName(e,s)}_Str_15493(t){return this._Str_22237=this._Str_12961(this.object.id,64),this._Str_22237}_Str_12961(t,e){return[this._type,t,"thumb",e].join("_")}}return t.THUMBNAIL="THUMBNAIL",t})();class Ql extends Jl{constructor(){super(),this._cachedUrl=null}updateModel(t){if(this.object){const t=this.getThumbnailURL();if(this._cachedUrl!==t)if(this._cachedUrl=t,this._cachedUrl&&""!==this._cachedUrl){const e=new Image;e.src=t,e.crossOrigin="*",e.onload=()=>{const t=A.p.from(e);this._Str_6645(t)}}else this._Str_6645(null)}return super.updateModel(t)}getThumbnailURL(){throw new Error("This method must be overridden!")}}class $l extends Ql{constructor(){super(),this._url=null,this._typePrefix=null}getThumbnailURL(){if(!this.object)return null;if(this._url)return this._url;const t=this.object.model.getValue(st.FURNITURE_DATA);if(!t||""===t)return null;this.object.type.indexOf("")>=0&&(this._typePrefix=this.object.type.indexOf("")>=0?"":"postcards/selfie/");let e=JSON.parse(t).w;return e=this._Str_18056(e),this._url=e,this._url}_Str_18056(t){return-1===(t=t.replace(".png","_small.png")).indexOf(".png")&&(t+="_small.png"),t}}class tu extends Bl{}class eu extends tu{}class su extends jl{}let iu=(()=>{class t extends Bl{constructor(){super(),this._color1=t.DEFAULT_COLOR_1,this._color2=t.DEFAULT_COLOR_2}updateModel(t){const e=super.updateModel(t);return!!e&&(this._color1=this.object.model.getValue(st.FURNITURE_GUILD_CUSTOMIZED_COLOR_1),this._color2=this.object.model.getValue(st.FURNITURE_GUILD_CUSTOMIZED_COLOR_2),e)}getLayerColor(t,e,s){switch(this.getLayerTag(t,this._direction,e)){case"COLOR1":return this._color1;case"COLOR2":return this._color2}return super.getLayerColor(t,e,s)}}return t.DEFAULT_COLOR_1=15658734,t.DEFAULT_COLOR_2=4934475,t})();class ru extends Jl{}let nu=(()=>{class t extends Bl{constructor(){super(),this._stateQueue=[],this._running=!1}setAnimation(e){if(-1===e&&!this._running)return this._running=!0,this._stateQueue=[],this._stateQueue.push(t._Str_7627),void this._stateQueue.push(t._Str_4186);if(e>0&&e<=t.ANIMATION_ID_OFFSET_SLOW1){if(this._running)return this._running=!1,this._stateQueue=[],this._stateQueue.push(t.ANIMATION_ID_OFFSET_SLOW1+e),this._stateQueue.push(t.ANIMATION_ID_OFFSET_SLOW2+e),void this._stateQueue.push(e);super.setAnimation(e)}}updateAnimation(t){return this.getLastFramePlayed(1)&&this.getLastFramePlayed(2)&&this.getLastFramePlayed(3)&&this._stateQueue.length&&super.setAnimation(this._stateQueue.shift()),super.updateAnimation(t)}}return t.ANIMATION_ID_OFFSET_SLOW1=10,t.ANIMATION_ID_OFFSET_SLOW2=20,t._Str_7627=31,t._Str_4186=32,t})();class au extends Yl{constructor(){super(),this._avatarData=new Tl}dispose(){super.dispose(),this._avatarData&&(this._avatarData.dispose(),this._avatarData=null)}createAvatarImage(t,e,s=null,i=null,r=null){return this._avatarData.createAvatarImage(t,e,s,i,r)}set avatarManager(t){this._avatarData.avatarManager=t}}let ou=(()=>{class t extends jl{constructor(){super(),this._mannequinScale=-1,this._figure=null,this._gender=null,this._dynamicAssetName=null,this._needsUpdate=!1,this._placeHolderFigure="hd-99999-99998",this._disposed=!1}initialize(t){return t instanceof au&&super.initialize(t)}dispose(){this._disposed||(this._disposed=!0,this._dynamicAssetName&&this.asset&&(this.asset.disposeAsset(this._dynamicAssetName),this._dynamicAssetName=null),super.dispose())}updateObject(t,e){const s=super.updateObject(t,e);return s&&this._mannequinScale!==t&&(this._mannequinScale=t,this.updateAvatar()),s}updateModel(t){let e=super.updateModel(t);if(e){const t=this.object.model.getValue(st.FURNITURE_MANNEQUIN_FIGURE)||null;t&&(this._figure=t+"."+this._placeHolderFigure,this._gender=this.object.model.getValue(st.FURNITURE_MANNEQUIN_GENDER)||null,this.updateAvatar())}return e=e||this._needsUpdate,this._needsUpdate=!1,e}updateAvatar(t=!1){if(!this.avatarExists()||t){const t=this._data.createAvatarImage(this._figure,this._mannequinScale,this._gender,this);t&&(t.setDirection(Pt.FULL,this.direction),this._dynamicAssetName&&this.asset.disposeAsset(this._dynamicAssetName),this.asset.addAsset(this._Str_10185(),t.getImage(Pt.FULL,!1,1,!1),!0),this._dynamicAssetName=this._Str_10185(),this._needsUpdate=!0,t.dispose())}}avatarExists(){return this._figure&&null!==this.getAsset(this._Str_10185())}_Str_10185(){return"mannequin_"+this._figure+"_"+this._mannequinScale+"_"+this.direction+"_"+this.object.id}resetFigure(t){t===this._figure&&this.updateAvatar(!0)}getSpriteAssetName(e,s){const i=this.getLayerTag(e,this.direction,s);return this._figure&&i===t.AVATAR_IMAGE_SPRITE_TAG&&this.avatarExists()?this._Str_10185():super.getSpriteAssetName(e,s)}getLayerXOffset(e,s,i){return this.getLayerTag(e,s,i)===t.AVATAR_IMAGE_SPRITE_TAG&&this.avatarExists()?-this.getSprite(i).width/2:super.getLayerXOffset(e,s,i)}getLayerYOffset(e,s,i){return this.getLayerTag(e,s,i)===t.AVATAR_IMAGE_SPRITE_TAG&&this.avatarExists()?-this.getSprite(i).height:super.getLayerYOffset(e,s,i)}get disposed(){return this._disposed}}return t.AVATAR_IMAGE_SPRITE_TAG="avatar_image",t})();class cu extends Bl{}class _u extends Bl{}class hu extends jl{}let lu=(()=>{class t extends Bl{constructor(){super(),this._stateQueue=[],this._animationCounter=-1}setAnimation(e){return e===t._Str_18395&&(this._stateQueue=[],this._stateQueue.push(t._Str_15915),this._animationCounter=t._Str_16054),super.setAnimation(e)}updateAnimation(t){return this._animationCounter>0&&this._animationCounter--,this._animationCounter||this._stateQueue.length&&super.setAnimation(this._stateQueue.shift()),super.updateAnimation(t)}usesAnimationResetting(){return!0}}return t._Str_4186=3,t._Str_18395=2,t._Str_15915=1,t._Str_16054=15,t})();class uu extends Bl{usesAnimationResetting(){return!0}}class du extends Wl{imageReady(t,e){super.imageReady(t,e),t&&this.setImageOffset(t.width,t.height)}setImageOffset(t,e){const s=new Nl;s.setDirection(1,0,-e),s.setDirection(3,0,0),s.setDirection(5,-t,0),s.setDirection(7,-t,-e),s.setDirection(4,-t/2,-e/2),this._imageOffset=s}getLayerXOffset(t,e,s){if(this._imageOffset){const t=this._imageOffset.getXOffset(e,0);if(void 0!==t)return t+this._offsetX}return super.getLayerXOffset(t,e,s)+this._offsetX}getLayerYOffset(t,e,s){if(this._imageOffset){const t=this._imageOffset.getYOffset(e,0);if(void 0!==t)return t+this._offsetY}return super.getLayerYOffset(t,e,s)+this._offsetY}getLayerZOffset(t,e,s){return super.getLayerZOffset(t,e,s)+-this._offsetZ}}let gu=(()=>{class t extends Bl{getFrameNumber(e,s){const i=this.getLayerTag(e,this.direction,s),r=this.object.getState(0);switch(i){case t.ONES_SPRITE:return Math.floor(r%10);case t.TENS_SPRITE:return Math.floor(r/10%10);case t.HUNDREDS_SPRITE:return Math.floor(r/100%10);case t.THOUSANDS_SPRITE:return Math.floor(r/1e3%10);default:return super.getFrameNumber(e,s)}}}return t.ONES_SPRITE="ones_sprite",t.TENS_SPRITE="tens_sprite",t.HUNDREDS_SPRITE="hundreds_sprite",t.THOUSANDS_SPRITE="thousands_sprite",t})();class mu extends Bl{}class pu extends jl{getLayerColor(t,e,s){return this._data?this._data.getLayerColor(t,e,s):Pl.DEFAULT_COLOR}}let Eu=(()=>{class t extends Bl{constructor(){super(),this._stateQueue=[],this._running=!1,super.setAnimation(t._Str_11236)}setAnimation(e){if(0===e&&!this._running)return this._running=!0,this._stateQueue=[],this._stateQueue.push(t._Str_7627),void this._stateQueue.push(t._Str_4186);if(e>0&&e<=t.ANIMATION_ID_OFFSET_SLOW2){if(this._running)return this._running=!1,this._stateQueue=[],2===this.direction?(this._stateQueue.push(t.ANIMATION_ID_OFFSET_SLOW1+5),this._stateQueue.push(t.ANIMATION_ID_OFFSET_SLOW2+5)):(this._stateQueue.push(t.ANIMATION_ID_OFFSET_SLOW1+e),this._stateQueue.push(t.ANIMATION_ID_OFFSET_SLOW2+e)),void this._stateQueue.push(t._Str_11236);super.setAnimation(t._Str_11236)}}updateAnimation(t){return this.getLastFramePlayed(11)&&this._stateQueue.length&&super.setAnimation(this._stateQueue.shift()),super.updateAnimation(t)}}return t.ANIMATION_ID_OFFSET_SLOW1=20,t.ANIMATION_ID_OFFSET_SLOW2=10,t._Str_7627=31,t._Str_4186=32,t._Str_11236=30,t})(),fu=(()=>{class t extends Bl{updateObject(t,e){return super.updateObject(t,e),!0}getFrameNumber(e,s){const i=this.object.model.getValue(st.FURNITURE_VOTE_COUNTER_COUNT);switch(this.getLayerTag(e,this.direction,s)){case t.ONES_SPRITE:return i%10;case t.TENS_SPRITE:return i/10%10;case t.HUNDREDS_SPRITE:return i/100%10;default:return super.getFrameNumber(e,s)}}getLayerAlpha(e,s,i){if(this.object.model.getValue(st.FURNITURE_VOTE_COUNTER_COUNT)===t._Str_17839)switch(this.getLayerTag(e,s,i)){case t.ONES_SPRITE:case t.TENS_SPRITE:case t.HUNDREDS_SPRITE:return 0}return super.getLayerAlpha(e,s,i)}}return t.ONES_SPRITE="ones_sprite",t.TENS_SPRITE="tens_sprite",t.HUNDREDS_SPRITE="hundreds_sprite",t._Str_17839=-1,t})(),Su=(()=>{class t extends Bl{getFrameNumber(e,s){const i=this.object.model.getValue(st.FURNITURE_VOTE_MAJORITY_RESULT);switch(this.getLayerTag(e,this.direction,s)){case t.ONES_SPRITE:return i%10;case t.TENS_SPRITE:return i/10%10;case t.HUNDREDS_SPRITE:return i/100%10;default:return super.getFrameNumber(e,s)}}getLayerAlpha(e,s,i){const r=this.object.model.getValue(st.FURNITURE_VOTE_MAJORITY_RESULT);if(-1!==t._Str_16109.indexOf(this.object.getState(0))||r===t._Str_17618)switch(this.getLayerTag(e,s,i)){case t.ONES_SPRITE:case t.TENS_SPRITE:case t.HUNDREDS_SPRITE:return 0}return super.getLayerAlpha(e,s,i)}}return t.ONES_SPRITE="ones_sprite",t.TENS_SPRITE="tens_sprite",t.HUNDREDS_SPRITE="hundreds_sprite",t._Str_16109=[-1,1],t._Str_17618=-1,t})();class bu extends Bl{}let Ru=(()=>{class t extends Vl{constructor(t,e){super(t,e),this._posturesToAnimations=new Map,this._gesturesToAnimations=new Map,this._defaultPosture=null}processPostures(t){if(!t)return!1;for(const e in t){const s=t[e];s&&(this._posturesToAnimations.get(s.id)||(null===this._defaultPosture&&(this._defaultPosture=s.id),this._posturesToAnimations.set(s.id,s.animationId)))}return void 0!==this._posturesToAnimations.get(this._defaultPosture)}processGestures(t){if(!t)return!1;for(const e in t){const s=t[e];s&&(this._gesturesToAnimations.get(s.id)||this._gesturesToAnimations.set(s.id,s.animationId))}return!0}postureToAnimation(t){return this._posturesToAnimations.get(t)||(t=this._defaultPosture),this._posturesToAnimations.get(t)}_Str_18284(t){return"ded"===t}gestureToAnimation(e){return this._gesturesToAnimations.get(e)?this._gesturesToAnimations.get(e):t.DEFAULT}_Str_14207(t,e){if(t>=0&&t<this._posturesToAnimations.size){const e=this._posturesToAnimations.keys();for(;;){const s=e.next();if(s.done)return null;if(t<=0)return s.value;--t}}return e?this._defaultPosture:null}_Str_17844(t){if(t>=0&&t<this._gesturesToAnimations.size){const e=this._gesturesToAnimations.keys();for(;;){const s=e.next();if(s.done)return null;if(t<=0)return s.value;--t}}return null}_Str_17976(t){for(const e of this._gesturesToAnimations.keys())if(this._gesturesToAnimations.get(e)===t)return e;return null}get totalPostures(){return this._posturesToAnimations.size}get totalGestures(){return this._gesturesToAnimations.size}}return t.DEFAULT=-1,t})();class Iu extends kl{constructor(){super(),this._isAllowedToTurnHead=!0}createSizeData(t,e,s){return t>1?new Ru(e,s):new Vl(e,s)}defineVisualizations(t){return this._isAllowedToTurnHead=!0,super.defineVisualizations(t)}processVisualElement(t,e,s){if(!t||!e||!s)return!1;switch(e){case"postures":if(!(t instanceof Ru&&t.processPostures(s)))return!1;break;case"gestures":if(!(t instanceof Ru&&t.processGestures(s)))return!1;break;default:if(!super.processVisualElement(t,e,s))return!1}return!0}postureToAnimation(t,e){const s=this.getSizeData(t);return s?s.postureToAnimation(e):Ru.DEFAULT}_Str_18284(t,e){const s=this.getSizeData(t);return!!s&&s._Str_18284(e)}gestureToAnimation(t,e){const s=this.getSizeData(t);return s?s.gestureToAnimation(e):Ru.DEFAULT}_Str_14207(t,e,s){const i=this.getSizeData(t);return i?i._Str_14207(e,s):null}_Str_17844(t,e){const s=this.getSizeData(t);return s?s._Str_17844(e):null}_Str_17976(t,e){const s=this.getSizeData(t);return s?s._Str_17976(e):null}totalPostures(t){const e=this.getSizeData(t);return e?e.totalPostures:0}totalGestures(t){const e=this.getSizeData(t);return e?e.totalGestures:0}get isAllowedToTurnHead(){return this._isAllowedToTurnHead}}let vu=(()=>{class t extends Bl{constructor(){for(super(),this._data=null,this._posture="",this._gesture="",this._isSleeping=!1,this._headDirection=-1,this._headOnly=!1,this._nonHeadSprites=[],this._headSprites=[],this._saddleSprites=[],this._animationOver=!1,this._paletteIndex=-1,this._paletteName="",this._customLayerIds=[],this._customPartIds=[],this._customPaletteIds=[],this._isRiding=!1,this._color=16777215,this._previousAnimationDirection=-1,this._animationStates=[];this._animationStates.length<t._Str_16677;)this._animationStates.push(new Ul)}initialize(t){return t instanceof Iu&&super.initialize(t)}dispose(){if(super.dispose(),this._animationStates){for(;this._animationStates.length;){const t=this._animationStates[0];t&&t.dispose(),this._animationStates.pop()}this._animationStates=null}}getAnimationId(t){return t.animationId}update(t,e,s,i){super.update(t,e,s,i)}updateModel(t){const e=this.object&&this.object.model;if(!e)return!1;if(this.updateModelCounter===e.updateCounter)return!1;const s=e.getValue(st.FIGURE_POSTURE),i=e.getValue(st.FIGURE_GESTURE);e.getValue(st.FIGURE_POSTURE),this.setPostureAndGesture(s,i);let r=e.getValue(st.FURNITURE_ALPHA_MULTIPLIER)||null;(null===r||isNaN(r))&&(r=1),this._alphaMultiplier!==r&&(this._alphaMultiplier=r,this._alphaChanged=!0),this._isSleeping=e.getValue(st.FIGURE_SLEEP)>0;const n=e.getValue(st.HEAD_DIRECTION);this._headDirection=!isNaN(n)&&this._data.isAllowedToTurnHead?n:this.object.getDirection().x;const a=e.getValue(st.PET_PALETTE_INDEX),o=e.getValue(st.PET_CUSTOM_LAYER_IDS),c=e.getValue(st.PET_CUSTOM_PARTS_IDS),_=e.getValue(st.PET_CUSTOM_PALETTE_IDS),h=e.getValue(st.PET_IS_RIDING),l=e.getValue(st.PET_HEAD_ONLY),u=e.getValue(st.PET_COLOR);return a!==this._paletteIndex&&(this._paletteIndex=a,this._paletteName=this._paletteIndex.toString()),this._customLayerIds=o||[],this._customPartIds=c||[],this._customPaletteIds=_||[],this._isRiding=!isNaN(h)&&h>0,this._headOnly=!isNaN(l)&&l>0,isNaN(u)||this._color===u||(this._color=u),this.updateModelCounter=e.updateCounter,!0}updateAnimation(t){if(this.object){const t=this.object.getDirection().x;t!==this._previousAnimationDirection&&(this._previousAnimationDirection=t,this.resetAllAnimationFrames())}return super.updateAnimation(t)}setPostureAndGesture(e,s){e!==this._posture&&(this._posture=e,this._Str_16058(t._Str_16082,this._data.postureToAnimation(this._scale,e))),this._data._Str_18284(this._scale,e)&&(s=null),s!==this._gesture&&(this._gesture=s,this._Str_16058(t._Str_17658,this._data.gestureToAnimation(this._scale,s)))}_Str_22634(t){return t>=0&&t<this._animationStates.length?this._animationStates[t]:null}_Str_16058(t,e){const s=this._Str_22634(t);s&&this.setSubAnimation(s,e)&&(this._animationOver=!1)}resetAllAnimationFrames(){this._animationOver=!1;let t=this._animationStates.length-1;for(;t>=0;){const e=this._animationStates[t];e&&e.setLayerCount(this.animatedLayerCount),t--}}updateAnimations(t){if(this._animationOver)return 0;let e=!0,s=0,i=0;for(;i<this._animationStates.length;){const r=this._animationStates[i];r&&!r.animationOver&&(s|=this.updateFramesForAnimation(r,t),r.animationOver?(wl.isTransitionFromAnimation(r.animationId)||wl.isTransitionToAnimation(r.animationId))&&(this._Str_16058(i,r.animationAfterTransitionId),e=!1):e=!1),i++}return this._animationOver=e,s}getSpriteAssetName(e,s){if(this._headOnly&&this._Str_24824(s))return null;if(this._isRiding&&this._parser3(s))return null;const i=this.totalSprites;if(s<i-t._Str_7490){const r=this.getValidSize(e);if(s<i-(1+t._Str_7490)){if(s>=Yl.LAYER_LETTERS.length)return null;const t=Yl.LAYER_LETTERS[s];return 1===r?this._type+"_icon_"+t:this._type+"_"+r+"_"+t+"_"+this.getDirection(e,s)+"_"+this.getFrameNumber(r,s)}return this._type+"_"+r+"_sd_"+this.getDirection(e,s)+"_0"}return null}getLayerColor(e,s,i){return s<this.totalSprites-t._Str_7490?this._color:16777215}getLayerXOffset(t,e,s){let i=super.getLayerXOffset(t,e,s),r=this._animationStates.length-1;for(;r>=0;){const t=this._animationStates[r];if(t){const e=t.getFrame(s);e&&(i+=e.x)}r--}return i}getLayerYOffset(t,e,s){let i=super.getLayerYOffset(t,e,s),r=this._animationStates.length-1;for(;r>=0;){const t=this._animationStates[r];if(t){const e=t.getFrame(s);e&&(i+=e.y)}r--}return i}getLayerZOffset(t,e,s){return this._data?this._data.getLayerZOffset(t,this.getDirection(t,s),s):xl.DEFAULT_ZOFFSET}getDirection(t,e){return this._Str_23973(e)?this._data.getValidDirection(t,this._headDirection):this._direction}getFrameNumber(t,e){let s=this._animationStates.length-1;for(;s>=0;){const t=this._animationStates[s];if(t){const s=t.getFrame(e);if(s)return s.id}s--}return super.getFrameNumber(t,e)}_Str_23973(e){if(void 0===this._headSprites[e]){const s=this._data.getLayerTag(this._scale,Fl._Str_9471,e)===t.HEAD,i=this._data.getLayerTag(this._scale,Fl._Str_9471,e)===t.HAIR;this._headSprites[e]=!(!s&&!i)}return this._headSprites[e]}_Str_24824(e){if(void 0===this._nonHeadSprites[e])if(e<this.totalSprites-(1+t._Str_7490)){const s=this._data.getLayerTag(this._scale,Fl._Str_9471,e);this._nonHeadSprites[e]=!!(s&&s.length>0&&s!==t.HEAD&&s!==t.HAIR)}else this._nonHeadSprites[e]=!0;return this._nonHeadSprites[e]}_parser3(e){return void 0===this._saddleSprites[e]&&(this._saddleSprites[e]=this._data.getLayerTag(this._scale,Fl._Str_9471,e)===t.SADDLE),this._saddleSprites[e]}getAsset(t,e=-1){if(!this.asset)return null;const s=this._customLayerIds.indexOf(e);let i=this._paletteName,r=-1,n=-1;return s>-1&&(r=this._customPartIds[s],n=this._customPaletteIds[s],i=n>-1?n.toString():this._paletteName),!isNaN(r)&&r>-1&&(t=t+"_"+r),this.asset.getAssetWithPalette(t,i)}getAdditionalLayerCount(){return super.getAdditionalLayerCount()+t._Str_7490}setLayerCount(t){super.setLayerCount(t),this._headSprites=[]}getPostureForAsset(t,e){const s=e.split("_");let i=s.length,r=0;for(;r<s.length;){if("64"===s[r]||"32"===s[r]){i=r+3;break}r++}let n=null;if(i<s.length){let e=s[i];e=e.split("@")[0],n=this._data._Str_14207(t,parseInt(e)/100,!1),n||(n=this._data._Str_17976(t,parseInt(e)/100))}return n}}return t.TYPE=it.PET_ANIMATED,t.HEAD="head",t.SADDLE="saddle",t.HAIR="hair",t._Str_7490=1,t._Str_13277=1e3,t.PET_EXPERIENCE_BUBBLE_PNG="pet_experience_bubble_png",t._Str_16082=0,t._Str_17658=1,t._Str_16677=2,t})(),Tu=(()=>{class t{constructor(t,e,s){this.type=t,this.loc=e,this.category=s}get loc(){return this._loc}set loc(t){this._loc||(this._loc=new ot),this._loc.assign(t)}get type(){return this._type}set type(t){this._type=t}get category(){return this._category}set category(t){this._category=t}dispose(){this._loc=null}}return t.WINDOW="window",t.HOLE="hole",t})();class Ou{constructor(){this._masks=[]}get masks(){return this._masks}}class Au{constructor(){this._masks=new Map}get _Str_6845(){return this._masks.size}dispose(){this._masks&&(this.reset(),this._masks=null)}initialize(t){if(!t)return!1;if(this._masks.clear(),t.masks.length)for(const e of t.masks){if(!e)continue;const t=e.locations.length?e.locations[0]:null;t&&this._masks.set(e.id,new Tu(e.type,t,e.category))}return!0}reset(){for(const t of this._masks.values())t&&t.dispose();this._masks.clear()}addMask(t,e,s,i){const r=new Tu(e,s,i);this._masks.delete(t),this._masks.set(t,r)}_Str_23574(t){const e=this._masks.get(t);return!!e&&(this._masks.delete(t),e.dispose(),!0)}_Str_5598(){const t=new Ou;for(const[e,s]of this._masks.entries()){if(!s)continue;const i=this._Str_21678(s),r=this._Str_21644(s),n=this._Str_19038(s);i&&r&&n&&t.masks.push({id:e,type:i,category:r,locations:[{x:n.x,y:n.y,z:n.z}]})}return t}_Str_19038(t){return t?t.loc:null}_Str_21678(t){return t?t.type:null}_Str_21644(t){return t?t.category:null}get masks(){return this._masks}}class yu{constructor(t=null,e=0,s=!1){this._assetNames=[],this._maskAssetNames=[],this._maskAssetLocations=[],this._maskAssetFlipHs=[],this._maskAssetFlipVs=[],null!=t&&(this._maskAssetNames=t._maskAssetNames,this._maskAssetLocations=t._maskAssetLocations,this._maskAssetFlipHs=t._maskAssetFlipHs,this._maskAssetFlipVs=t._maskAssetFlipVs),this._color=e,this._alignBottom=s}addMask(t,e,s,i){this._maskAssetNames.push(t),this._maskAssetLocations.push(e),this._maskAssetFlipHs.push(s),this._maskAssetFlipVs.push(i)}_Str_22862(t){this._assetNames.push(t)}set z(t){this._z=t}get z(){return this._z}set cornerPoints(t){this._points=t}get cornerPoints(){return this._points}get color(){return this._color}get _Str_21807(){return this._maskAssetNames}get _Str_20731(){return this._maskAssetLocations}get _Str_21810(){return this._maskAssetFlipHs}get _Str_19044(){return this._maskAssetFlipVs}_Str_14945(){return this._alignBottom}get _Str_17636(){return this._assetNames}}class Cu{constructor(t,e,s){this._type=t,this._leftSideLoc=e,this._rightSideLoc=s}get type(){return this._type}get _Str_5120(){return this._leftSideLoc}get _Str_4659(){return this._rightSideLoc}}class Mu{constructor(t,e,s,i){this._leftSideLoc=t,this._rightSideLoc=e,this._leftSideLength=s,this._rightSideLength=i}get _Str_5120(){return this._leftSideLoc}get _Str_4659(){return this._rightSideLoc}get _Str_9124(){return this._leftSideLength}get _Str_12156(){return this._rightSideLength}}class Du{constructor(t,e){this._bitmap=t,this._timeStamp=e}dispose(){this._bitmap=null}get bitmap(){return this._bitmap}get timeStamp(){return this._timeStamp}}let Nu=(()=>{class t{constructor(){this._Str_16737=1,this._Str_16979=16777216,this._Str_25697=69069,this._Str_23320=5}static _Str_17384(e=1){t._Str_3699||(t._Str_3699=new t),t._Str_3699._Str_15634=e}static _Str_26085(e=16777216){t._Str_3699||(t._Str_3699=new t),t._Str_3699._Str_25321=e}static _Str_1612(e,s,i){return t._Str_3699||(t._Str_3699=new t),t._Str_3699._Str_24535(e,s,i)}static _Str_23572(e,s){return t._Str_3699||(t._Str_3699=new t),t._Str_3699._Str_24231(e,s)}set _Str_15634(t){this._Str_16737=t}set _Str_25321(t){t<1&&(t=1),this._Str_16979=t}dispose(){}_Str_24535(t,e,s){const i=[];let r=0;for(;r<t;)i.push(this._Str_19361(e,s-e)),r++;return i}_Str_24231(t,e){if(t>e||e>1e3)return null;const s=[];let i=0;for(;i<=e;)s.push(i),i++;const r=[];let n=0;for(;n<t;){const t=this._Str_19361(0,s.length-1);r.push(s[t]),s.splice(t,1),n++}return r}_Str_24980(){let t=this._Str_25697*this._Str_16737+this._Str_23320;return t<0&&(t=-t),t%=this._Str_16979,this._Str_16737=t,t}_Str_19361(t,e){let s=this._Str_24980();return e<1?t:(s=t+s/this._Str_16979*e,s)}}return t._Str_21045=1,t._Str_20078=16777216,t._Str_3699=null,t})(),wu=(()=>{class t{constructor(e,s,i,r,n,a,o,c,_=0,h=0,l=0,u=0){if(this._Str_4795=null,this._Str_1720=0,this._height=0,this._Str_5886=[],this._Str_4047=[],this._Str_5088=[],this._Str_8341=[],this._Str_14495=[],this._Str_16308=c,this._Str_1049=null,this._Str_2730=null,this._Str_4891=!1,this._Str_5545=null,this._Str_5221=new ot,this._Str_5221.assign(e),this._location=new ot,this._location.assign(s),this._Str_2920=new ot,this._Str_2920.assign(i),this._Str_2943=new ot,this._Str_2943.assign(r),this._normal=ot.crossProduct(this._Str_2920,this._Str_2943),this._normal.length>0&&this._normal.multiply(1/this._normal.length),null!=o)for(const t of o){if(!t)continue;const e=new ot;e.assign(t),this._Str_5886.push(e)}this._disposed=!1,this._Str_3816=!1,this._Str_576=null,this._Str_13946=!0,this._Str_3406=-1,this._offset=new A.j,this._relativeDepth=0,this._type=n,this._color=0,this._rasterizer=null,this._Str_7367=!0,this._Str_2708=new Map,this._Str_2820=new ot,this._Str_2745=new ot,this._Str_2639=new ot,this._Str_2766=new ot,this._Str_1720=0,this._height=0,this._Str_20541=_,this._Str_19707=h,this._Str_21079=l,this._Str_22024=u,this._Str_4542=a,this._uniqueId=++t._uniqueIdCounter}static blend(t,e){return 0}set _Str_14801(t){t!==this._Str_7367&&(this._Str_7367||this._Str_11000(),this._Str_7367=t)}get _Str_14801(){return this._Str_7367}get bitmapData(){if(!this.visible||!this._Str_1049)return null;let t=id.getTextureCache(this._Str_1049);return t||(t=bt.generateTexture(this._Str_1049,new A.k(0,0,this._Str_1720,this._height)),id.addTextureCache(this._Str_1049,t)),t}get visible(){return this._Str_3816&&this._Str_7367}get offset(){return this._offset}get relativeDepth(){return this._relativeDepth}get color(){return this._color}set color(t){this._color=t}get type(){return this._type}get _Str_5424(){return this._Str_2920}get _Str_4968(){return this._Str_2943}get location(){return this._location}get normal(){return this._normal}get _Str_18448(){return this._Str_13946}set _Str_18448(t){this._Str_13946=t}set rasterizer(t){this._rasterizer=t}set _Str_16279(t){this._Str_4795=t}set id(t){t!==this._Str_576&&(this._Str_11000(),this._Str_576=t)}get uniqueId(){return this._uniqueId}dispose(){if(this._Str_1049&&(this._Str_1049.destroy(),this._Str_1049=null),this._Str_2708){for(const t of this._Str_2708.values())t&&(t.bitmap&&t.bitmap.destroy(),t.dispose());this._Str_2708=null}this._Str_5545=null,this._location=null,this._Str_5221=null,this._Str_2920=null,this._Str_2943=null,this._normal=null,this._rasterizer=null,this._Str_2820=null,this._Str_2745=null,this._Str_2639=null,this._Str_2766=null,this._Str_4047=null,this._Str_5088=null,this._Str_2730&&(this._Str_2730.destroy(),this._Str_2730=null),this._disposed=!0}_Str_24896(t){return this.visible&&this._Str_1049&&t?this._Str_1049.width!==t.width||this._Str_1049.height!==t.height?null:t:null}_Str_17642(t,e){const s=this._Str_2708.get(t);return s&&(this._Str_2708.delete(t),s.dispose()),this._Str_5545=e,this._Str_2708.set(t,e),!0}_Str_11000(t=null){if(this._Str_2708&&this._Str_2708.size){for(const t of this._Str_2708.values())t&&t.dispose();this._Str_2708.clear()}this._Str_5545=null}getTextureIdentifier(t){return this._rasterizer?this._rasterizer.getTextureIdentifier(t,this.normal):t.toString()}_Str_10518(t,e){if(!t)return!1;let s=this._Str_5545;return s||(s=this._Str_2708.get(this.getTextureIdentifier(t.scale))),this._Str_19336(),!(!this._Str_7367||!(!s||s.timeStamp>=0&&e>s.timeStamp||this._Str_4891))}_Str_10114(t,e){if(!t)return null;let s=null;if(this._Str_10518(t,e)){const i=this.getTextureIdentifier(t.scale),r=this._Str_2920.length*t.scale,n=this._Str_2943.length*t.scale,a=t.getCoordinatePosition(this._normal);s=this._Str_5545?this._Str_5545:this._Str_2708.get(i);let o=null;if(s&&(o=s.bitmap),this._rasterizer)s=this._rasterizer.render(o,this._Str_576,r,n,t.scale,a,this._Str_13946,this._Str_20541,this._Str_19707,this._Str_21079,this._Str_22024,e),s&&o&&s.bitmap!==o&&o.destroy();else{const t=new A.f;t.beginFill(16777215),t.drawRect(0,0,r,n),t.endFill(),s=new Du(t,-1)}s&&(this._Str_17859(s.bitmap,t),this._Str_17642(i,s))}else s=this._Str_5545?this._Str_5545:this._Str_2708.get(this.getTextureIdentifier(t.scale));return s?(this._Str_5545=s,s.bitmap):null}_Str_23649(t){if(!this._Str_4542)return null;const e=new yu;for(;0<this._Str_4047.length;){const s=this._Str_4047[0];if(s){const i=this._Str_4795._Str_8361(s.type);if(i){const r=i._Str_2125(t.scale);if(r){const n=t.getCoordinatePosition(this._normal),a=i._Str_21021(t.scale,n);if(a){const t=new A.j(this._Str_2730.width*(1-s._Str_5120/this._Str_2920.length)+a.offsetX,this._Str_2730.height*(1-s._Str_4659/this._Str_2943.length)+a.offsetY);e.addMask(r,t,a.flipH,a.flipV)}}}}}return e}_Str_24802(t){const e=t.getScreenPoint(new ot(0,0,0)),s=t.getScreenPoint(new ot(0,1,0));return Math.round(this._Str_2920.length*Math.abs(e.x-s.x))}_Str_22136(t){const e=[];if(this._Str_3816){const s=this._Str_23649(t),i=this._rasterizer._Str_8988(this._Str_576);let r=0;for(;r<i.length;){const n=i[r];if(n)if(this._Str_13946&&n._Str_8547()){const i=t.getCoordinatePosition(this._normal),r=n._Str_8547()._Str_21968(i),a=new yu(s,this._color,r._Str_14945());Nu._Str_17384(this._Str_16308);for(const e of r._Str_23721(this._Str_24802(t))){const t=[];for(const s of e._Str_22299()){const e=s._Str_2125(i);e&&t.push(e)}t.length>0&&(e._Str_24523()||t.push(""),a._Str_22862(t))}a._Str_17636.length>0&&e.push(a)}else{const t=new yu(s,this._color);e.push(t)}r++}e.length||e.push(new yu(s,this._color))}return e}update(e,s){if(!e||this._disposed)return!1;let i=!1;if(this._Str_3406!=e.updateId&&(i=!0),!(i&&this._Str_7367||this.visible))return!1;if(i){this._Str_5545=null;let s=0;if(s=ot.cosAngle(e.directionAxis,this.normal),s>-.001)return!!this._Str_3816&&(this._Str_3816=!1,!0);let i=0;for(;i<this._Str_5886.length;){if(s=ot.cosAngle(e.directionAxis,this._Str_5886[i]),s>-.001)return!!this._Str_3816&&(this._Str_3816=!1,!0);i++}this._Str_18702(e);const r=e.getScreenPosition(this._Str_5221).z;let n=Math.max(this._Str_2820.z,this._Str_2745.z,this._Str_2639.z,this._Str_2766.z)-r;this._type===t.TYPE_FLOOR&&(n-=8*(this._location.z+Math.min(0,this._Str_2920.z,this._Str_2943.z))),this._type===t.TYPE_LANDSCAPE&&(n+=.02),this._relativeDepth=n,this._Str_3816=!0,this._Str_3406=e.updateId}if(i||this._Str_10518(e,s)){if(!this._Str_1049||this._Str_1720!==this._Str_1049.width||this._height!==this._Str_1049.height){if(this._Str_1049){if(this._Str_1049.destroy(),this._Str_1049=null,this._Str_1720<1||this._height<1)return!0}else if(this._Str_1720<1||this._height<1)return!1;const t=new A.f;if(t.beginFill(16777215,0),t.drawRect(0,0,this._Str_1720,this._height),t.endFill(),this._Str_1049=t,!this._Str_1049)return!1}Nu._Str_17384(this._Str_16308);const t=this._Str_10114(e,s);return t?(this._Str_17000(e,t),null!==t||i):(this.dispose(),!1)}return!1}_Str_18702(t){this._Str_2820.assign(t.getScreenPosition(this._location)),this._Str_2745.assign(t.getScreenPosition(ot.sum(this._location,this._Str_2943))),this._Str_2639.assign(t.getScreenPosition(ot.sum(ot.sum(this._location,this._Str_2920),this._Str_2943))),this._Str_2766.assign(t.getScreenPosition(ot.sum(this._location,this._Str_2920))),this._offset=t.getScreenPoint(this._Str_5221),this._Str_2820.x=Math.round(this._Str_2820.x),this._Str_2820.y=Math.round(this._Str_2820.y),this._Str_2745.x=Math.round(this._Str_2745.x),this._Str_2745.y=Math.round(this._Str_2745.y),this._Str_2639.x=Math.round(this._Str_2639.x),this._Str_2639.y=Math.round(this._Str_2639.y),this._Str_2766.x=Math.round(this._Str_2766.x),this._Str_2766.y=Math.round(this._Str_2766.y),this._offset.x=Math.round(this._offset.x),this._offset.y=Math.round(this._offset.y);const e=Math.min(this._Str_2820.x,this._Str_2745.x,this._Str_2639.x,this._Str_2766.x);let s=Math.max(this._Str_2820.x,this._Str_2745.x,this._Str_2639.x,this._Str_2766.x);const i=Math.min(this._Str_2820.y,this._Str_2745.y,this._Str_2639.y,this._Str_2766.y);let r=Math.max(this._Str_2820.y,this._Str_2745.y,this._Str_2639.y,this._Str_2766.y);s-=e,this._offset.x=this._offset.x-e,this._Str_2820.x=this._Str_2820.x-e,this._Str_2745.x=this._Str_2745.x-e,this._Str_2639.x=this._Str_2639.x-e,this._Str_2766.x=this._Str_2766.x-e,r-=i,this._offset.y=this._offset.y-i,this._Str_2820.y=this._Str_2820.y-i,this._Str_2745.y=this._Str_2745.y-i,this._Str_2639.y=this._Str_2639.y-i,this._Str_2766.y=this._Str_2766.y-i,this._Str_1720=s,this._height=r}_Str_17000(e,s){if(null==this._Str_2820||null==this._Str_2745||null==this._Str_2639||null==this._Str_2766||null==s||null==this._Str_1049)return;let i=this._Str_2766.x-this._Str_2639.x,r=this._Str_2766.y-this._Str_2639.y,n=this._Str_2745.x-this._Str_2639.x,a=this._Str_2745.y-this._Str_2639.y;this._type!=t.TYPE_WALL&&this._type!=t.TYPE_LANDSCAPE||(Math.abs(n-s.width)<=1&&(n=s.width),Math.abs(a-s.width)<=1&&(a=s.width),Math.abs(i-s.height)<=1&&(i=s.height),Math.abs(r-s.height)<=1&&(r=s.height));const o=n/s.width,c=a/s.width,_=i/s.height,h=r/s.height,l=new A.i;l.a=o,l.b=c,l.c=_,l.d=h,l.translate(this._Str_2639.x,this._Str_2639.y),this.draw(s,l)}draw(t,e){const s=t.clone();s.transform.setFromMatrix(e),this._Str_1049=s}_Str_25213(){!this._disposed&&this._Str_4542&&this._Str_4047.length&&(this._Str_4891=!0,this._Str_4047=[])}_Str_24569(t,e,s){if(!this._Str_4542)return!1;let i=0;for(;i<this._Str_4047.length;){const r=this._Str_4047[i];if(r&&r.type===t&&r._Str_5120===e&&r._Str_4659===s)return!1;i++}const r=new Cu(t,e,s);return this._Str_4047.push(r),this._Str_4891=!0,!0}_Str_25934(){this._Str_4542&&this._Str_5088.length&&(this._Str_4891=!0,this._Str_5088=[])}_Str_24758(t,e,s,i){if(this._Str_4542){for(const n of this._Str_5088)if(n&&n._Str_5120===t&&n._Str_4659===e&&n._Str_9124===s&&n._Str_12156===i)return!1;const r=new Mu(t,e,s,i);return this._Str_5088.push(r),this._Str_4891=!0,!0}return!1}_Str_19336(){if(!this._Str_4891)return;let t,e=!0;if(this._Str_4047.length===this._Str_8341.length){for(const s of this._Str_4047)if(s){t=!1;for(const e of this._Str_8341)if(e&&e.type===s.type&&e._Str_5120===s._Str_5120&&e._Str_4659===s._Str_4659){t=!0;break}if(!t){e=!1;break}}}else e=!1;this._Str_5088.length>this._Str_14495.length&&(e=!1),e&&(this._Str_4891=!1)}_Str_17859(t,e){if(!t||!e)return;if(!this._Str_4542||!this._Str_4047.length&&!this._Str_5088.length&&!this._Str_4891||!this._Str_4795)return;const s=t.width,i=t.height;if(this._Str_19336(),!this._Str_2730||this._Str_2730.width!==s||this._Str_2730.height!==i){this._Str_2730&&(this._Str_2730.destroy(),this._Str_2730=null);const t=new A.f;t.beginFill(16777215,0).drawRect(0,0,s,i).endFill(),this._Str_2730=t,this._Str_4891=!0}if(this._Str_4891){this._Str_8341=[],this._Str_14495=[],this._Str_2730&&this._Str_2730.beginFill(16777215,0).drawRect(0,0,s,i).endFill(),this._Str_11000(t);const r=e.getCoordinatePosition(this._normal);let n=null,a=0,o=0,c=0;for(;c<this._Str_4047.length;){const t=this._Str_4047[c];t&&(n=t.type,a=this._Str_2730.width-this._Str_2730.width*t._Str_5120/this._Str_2920.length,o=this._Str_2730.height-this._Str_2730.height*t._Str_4659/this._Str_2943.length,this._Str_4795._Str_17859(this._Str_2730,n,e.scale,r,a,o),this._Str_8341.push(new Cu(n,t._Str_5120,t._Str_4659))),c++}for(c=0;c<this._Str_5088.length;){const t=this._Str_5088[c];if(t){a=this._Str_2730.width-this._Str_2730.width*t._Str_5120/this._Str_2920.length,o=this._Str_2730.height-this._Str_2730.height*t._Str_4659/this._Str_2943.length;const e=this._Str_2730.width*t._Str_9124/this._Str_2920.length,s=this._Str_2730.height*t._Str_12156/this._Str_2943.length;this._Str_2730.beginFill(16711680).drawRect(a-e,o-s,e,s).endFill(),this._Str_14495.push(new Mu(t._Str_9124,t._Str_4659,t._Str_9124,t._Str_12156))}c++}this._Str_4891=!1}this._Str_24790(t,this._Str_2730)}_Str_24790(t,e){if(!t||!e)return;const s=um.instance.renderer.extract.canvas(e),i=um.instance.renderer.extract.canvas(t),r=i.getContext("2d");r.drawImage(s,0,0);const n=r.getImageData(0,0,i.width,i.height),a=n.data;for(let c=0;c<a.length;c+=4){const t=a[c+1],e=a[c+2];a[c]||t||e||(a[c+3]=0)}r.putImageData(n,0,0);const o=A.p.from(i);o&&t.clear().beginTextureFill({texture:o}).drawRect(0,0,o.width,o.height).endFill()}}return t.ZERO_POINT=new A.j(0,0),t.TYPE_UNDEFINED=0,t.TYPE_WALL=1,t.TYPE_FLOOR=2,t.TYPE_LANDSCAPE=3,t._uniqueIdCounter=1,t})(),Uu=(()=>{class t{constructor(t,e=-1,s=1,i=-1,r=1){this._normalMinX=e,this._normalMaxX=s,this._normalMinY=i,this._normalMaxY=r,this._asset=t}get asset(){return this._asset}get normalMinX(){return this._normalMinX}get normalMaxX(){return this._normalMaxX}get normalMinY(){return this._normalMinY}get normalMaxY(){return this._normalMaxY}dispose(){this._asset=null}}return t._Str_3268=-1,t._Str_3271=1,t})(),Lu=(()=>{class t{constructor(){this._bitmaps=[]}dispose(){for(const t of this._bitmaps)t&&t.dispose();this._bitmaps=null}_Str_16790(t,e=-1,s=1,i=-1,r=1){this._bitmaps.push(new Uu(t,e,s,i,r))}getAsset(t){if(!t)return null;for(const e of this._bitmaps)if(e&&t.x>=e.normalMinX&&t.x<=e.normalMaxX&&t.y>=e.normalMinY&&t.y<=e.normalMaxY)return e.asset;return null}}return t._Str_3268=-1,t._Str_3271=1,t})();class Pu{constructor(){this._sizes=[],this._maskVisualizations=new Map,this._assetNames=new Map,this._lastMaskVisualization=null,this._lastSize=-1}dispose(){if(this._maskVisualizations){for(const t of this._maskVisualizations.values())t&&t.dispose();this._maskVisualizations=null}this._lastMaskVisualization=null,this._sizes=null}_Str_24540(t){if(this._maskVisualizations.get(t))return null;const e=new Lu;return this._maskVisualizations.set(t,e),this._sizes.push(t),this._sizes.sort(),e}_Str_8560(t){let e=0;for(;1<this._sizes.length;){if(this._sizes[1]>t){this._sizes[1]-t<t-this._sizes[0]&&(e=1);break}e=1}return e}_Str_24650(t){if(t===this._lastSize)return this._lastMaskVisualization;const e=this._Str_8560(t);return this._lastMaskVisualization=e<this._sizes.length?this._maskVisualizations.get(this._sizes[e]):null,this._lastSize=t,this._lastMaskVisualization}_Str_21021(t,e){const s=this._Str_24650(t);return s?s.getAsset(e):null}_Str_2125(t){return this._assetNames&&this._assetNames.get(t)||null}_Str_24425(t,e){this._assetNames&&this._assetNames.set(t,e)}}class xu{constructor(){this._assetCollection=null,this._masks=new Map,this._data=null}get data(){return this._data}dispose(){if(this._assetCollection=null,this._data=null,this._masks&&this._masks.size){for(const t of this._masks.values())t&&t.dispose();this._masks.clear()}}initialize(t){this._data=t}_Str_6703(t){this.data&&(this._assetCollection=t,this._Str_22834(this.data,t))}_Str_22834(t,e){if(t&&e&&t.masks&&t.masks.length){let s=0;for(;s<t.masks.length;){const i=t.masks[s];if(i){const t=i.id;if(this._masks.get(t))continue;const s=new Pu;if(i.visualizations&&i.visualizations.length){let t=0;for(;t<i.visualizations.length;){const r=i.visualizations[t];if(r){const t=r.size,i=s._Str_24540(t);if(i){const n=this._Str_25815(r.bitmaps,i,e);s._Str_24425(t,n)}}t++}}this._masks.set(t,s)}s++}}}_Str_25815(t,e,s){if(!t||!t.length)return null;let i=null;for(const r of t){if(!r)continue;const t=r.assetName,n=s.getAsset(t);if(!n)continue;let a=Lu._Str_3268,o=Lu._Str_3271,c=Lu._Str_3268,_=Lu._Str_3271;void 0!==r.normalMinX&&(a=r.normalMinX),void 0!==r.normalMaxX&&(o=r.normalMaxX),void 0!==r.normalMinY&&(c=r.normalMinY),void 0!==r.normalMaxY&&(_=r.normalMaxY),n.flipH||(i=t),e._Str_16790(n,a,o,c,_)}return i}_Str_17859(t,e,s,i,r,n){const a=this._masks.get(e);if(!a)return!0;const o=a._Str_21021(s,i);if(!o)return!0;const c=o.texture;if(!c)return!0;const _=new A.j(r+o.offsetX,n+o.offsetY),h=new A.i;let l=1,u=1,d=0,g=0;return o.flipH&&(l=-1,d=-c.width),o.flipV&&(u=-1,g=-c.height),h.scale(l,u),h.translate(_.x+d,_.y+g),t.beginTextureFill({texture:c,matrix:h}).drawRect(h.tx,h.ty,c.width,c.height).endFill(),!0}_Str_8361(t){return this._masks&&this._masks.size&&this._masks.get(t)||null}}class Fu{static _Str_16640(t){if(!t)return null;const e=new A.i;e.scale(-1,1),e.translate(t.width,0);const s=new A.f;return s.beginTextureFill({texture:t,matrix:e}).drawRect(0,0,t.width,t.height).endFill(),bt.generateTexture(s)}static _Str_20706(t){if(!t)return null;const e=new A.i;e.scale(1,-1),e.translate(0,t.height);const s=new A.f;return s.beginTextureFill({texture:t,matrix:e}).drawRect(0,0,t.width,t.height).endFill(),bt.generateTexture(s)}static _Str_20356(t){if(!t)return null;const e=new A.i;e.scale(-1,-1),e.translate(t.width,t.height);const s=new A.f;return s.beginTextureFill({texture:t,matrix:e}).drawRect(0,0,t.width,t.height).endFill(),bt.generateTexture(s)}}class Gu{constructor(t,e,s,i,r){this._x=t,this._y=e,this._speedX=s,this._speedY=i,this._bitmapData=r,isNaN(this._x)&&(this._x=0),isNaN(this._y)&&(this._y=0),isNaN(this._speedX)&&(this._speedX=0),isNaN(this._speedY)&&(this._speedY=0)}get bitmapData(){return this._bitmapData}dispose(){this._bitmapData=null}_Str_6729(t,e,s,i,r){let n=this._x,a=this._y;return s>0&&(n+=this._speedX/s*r/1e3),i>0&&(a+=this._speedY/i*r/1e3),new A.j(n%1*t,a%1*e)}}class Vu{constructor(t,e){if(this._color=0,this._bitmapData=null,this._isDisposed=!1,this._color=0,this._bitmapData=null,this._isDisposed=!1,this._items=[],t&&e)for(const s of t){if(!s)continue;const t=s.asset;if(t){const i=e.getAsset(t);i&&this._items.push(new Gu(s.x,s.y,s.speedX,s.speedY,i))}}}get disposed(){return this._isDisposed}dispose(){if(this._isDisposed=!0,this._bitmapData&&(this._bitmapData.destroy(),this._bitmapData=null),this._items){for(const t of this._items)t&&t.dispose();this._items=[]}}_Str_3355(){this._bitmapData&&(this._bitmapData.destroy(),this._bitmapData=null)}render(t,e,s,i,r,n,a,o,c,_,h){if(null!=t&&t.width==e&&t.height==s||(null==this._bitmapData||this._bitmapData.width!=e||this._bitmapData.height!=s?(null!=this._bitmapData&&this._bitmapData.destroy(),this._bitmapData=(new A.f).drawRect(0,0,e,s)):this._bitmapData.beginFill(16777215).drawRect(0,0,this._bitmapData.width,this._bitmapData.height).endFill(),t=this._bitmapData),a>0&&o>0){let e=0;for(;e<this._items.length;){const s=this._items[e];if(null!=s){const e=s._Str_6729(a,o,c,_,h);if(e.x=e.x-r,e.y=e.y-n,s.bitmapData)if(e.x>0&&e.x+s.bitmapData.width<t.width)t.beginFill(65280).beginTextureFill({texture:s.bitmapData.texture,matrix:new A.i(1,0,0,1,e.x,e.y)}).drawRect(e.x,e.y,s.bitmapData.width,s.bitmapData.height).endFill();else if(e.x>0){const i=t.width-e.x;t.beginFill(65280).beginTextureFill({texture:s.bitmapData.texture,matrix:new A.i(1,0,0,1,e.x,e.y)}).drawRect(e.x,e.y,i,s.bitmapData.height).endFill()}else{const i=s.bitmapData.width+e.x;t.beginFill(65280).beginTextureFill({texture:s.bitmapData.texture,matrix:new A.i(1,0,0,1,e.x,e.y)}).drawRect(0,e.y,i,s.bitmapData.height).endFill()}}e++}}return t}}let Yu=(()=>{class t{constructor(t,e,s,i=0){this._material=t,this._offset=i,this._align=s,this._color=e,this._bitmapData=null,this._isDisposed=!1}get offset(){return this._offset}get align(){return this._align}get disposed(){return this._isDisposed}dispose(){this._isDisposed=!0,this._material=null,this._Str_3355()}_Str_3355(){this._bitmapData&&(this._bitmapData.destroy(),this._bitmapData=null)}render(e,s,i,r,n,a,o){e&&e.width===s&&e.height===i||(e=null);let c=null;if(this._material)c=this._material.render(null,s,i,r,n,a,o+this.offset,this.align===t.ALIGN_TOP),c&&c!==e&&(this._bitmapData&&this._bitmapData.destroy(),this._bitmapData=c.clone(),c=this._bitmapData);else if(e)e.beginFill(16777215).drawRect(0,0,s,i).endFill(),c=e;else{if(this._bitmapData&&this._bitmapData.width===s&&this._bitmapData.height===i)return this._bitmapData;this._bitmapData&&this._bitmapData.destroy();const t=(new A.f).beginFill(16777215).drawRect(0,0,s,i).endFill();this._bitmapData=t,c=this._bitmapData}if(c&&(c.tint=this._color,e&&c!==e)){let t=id.getTextureCache(c);t||(t=bt.generateTexture(c,new A.k(0,0,s,i)),id.addTextureCache(c,t)),e.beginTextureFill({texture:t}).drawRect(0,0,s,i).endFill(),c=e}return c}_Str_8547(){return this._material}_Str_751(){return this._color}}return t._Str_1934=0,t.ALIGN_TOP=1,t._Str_3606=2,t._Str_6914=t.ALIGN_TOP,t})();class ku{constructor(t,e,s){this._layers=[],this._geometry=s,this._cachedBitmapData=null,this._cachedBitmapNormal=new ot,this._isCached=!1,this._hasAnimationLayers=!1,e<0&&(e=0);let i=0;for(;i<e;)this._layers.push(null),i++}get geometry(){return this._geometry}get _Str_20530(){return this._hasAnimationLayers}dispose(){if(this._layers&&this._layers.length){for(const t of this._layers)t&&t.dispose();this._layers=null}this._geometry=null,this._cachedBitmapData&&(this._cachedBitmapData.destroy(),this._cachedBitmapData=null),this._cachedBitmapNormal&&(this._cachedBitmapNormal=null)}_Str_3355(){if(this._isCached){if(this._cachedBitmapData&&(this._cachedBitmapData.destroy(),this._cachedBitmapData=null),this._cachedBitmapNormal&&this._cachedBitmapNormal.assign(new ot),this._layers&&this._layers.length)for(const t of this._layers)t&&t._Str_3355();this._isCached=!1}}_Str_21464(t,e,s,i,r=0){if(t<0||t>this._layers.length)return!1;let n=this._layers[t];return n&&n.dispose(),n=new Yu(e,s,i,r),this._layers[t]=n,!0}_Str_23489(t,e,s){if(t<0||t>this._layers.length)return!1;let i=this._layers[t];return i&&i.dispose(),i=new Vu(e,s),this._layers[t]=i,this._hasAnimationLayers=!0,!0}_Str_8988(){return this._layers}render(t,e,s,i,r,n=0,a=0,o=0,c=0,_=0,h=0,l=0){if(e<1&&(e=1),s<1&&(s=1),t&&t.width===e&&t.height===s||(t=null),this._cachedBitmapData)if(this._cachedBitmapData.width===e&&this._cachedBitmapData.height===s&&ot.isEqual(this._cachedBitmapNormal,i)){if(!this._Str_20530){if(t){const i=bt.generateTexture(this._cachedBitmapData,new A.k(0,0,e,s));if(i)return t.beginTextureFill({texture:i}).drawRect(0,0,i.width,i.height).endFill(),t}return this._cachedBitmapData}}else this._cachedBitmapData.destroy(),this._cachedBitmapData=null;if(this._isCached=!0,this._cachedBitmapData)this._cachedBitmapData.beginFill(16777215).drawRect(0,0,e,s).endFill();else{const t=(new A.f).beginFill(16777215).drawRect(0,0,e,s).endFill();this._cachedBitmapData=t}if(t||(t=this._cachedBitmapData),this._cachedBitmapNormal.assign(i),this._layers&&this._layers.length)for(const u of this._layers)u&&(u instanceof Yu?u.render(t,e,s,i,r,n,a):u instanceof Vu&&u.render(t,e,s,i,n,a,o,c,_,h,l));if(t&&t!==this._cachedBitmapData){const e=bt.generateTexture(t,new A.k(0,0,t.width,t.height));return this._cachedBitmapData.beginTextureFill({texture:e}).drawRect(0,0,t.width,t.height).endFill(),t}return this._cachedBitmapData}}class ju{constructor(){this._planeVisualizations=new Map,this._sizes=[],this._lastPlaneVisualization=null,this._lastSize=-1}isStatic(t){return!0}dispose(){for(const t of this._planeVisualizations.values())t&&t.dispose();this._planeVisualizations=null,this._lastPlaneVisualization=null,this._sizes=null,this._lastSize=-1}_Str_3355(){for(const t of this._planeVisualizations.values())t&&t._Str_3355()}_Str_20305(t,e,s){if(this._planeVisualizations.get(t.toString()))return null;const i=new ku(t,e,s);return this._planeVisualizations.set(t.toString(),i),this._sizes.push(t),this._sizes.sort(),i}_Str_8560(t){let e=0,s=1;for(;s<this._sizes.length;){if(this._sizes[s]>t){this._sizes[s]-t<t-this._sizes[s-1]&&(e=s);break}e=s,s++}return e}_Str_6009(t){if(t===this._lastSize)return this._lastPlaneVisualization;const e=this._Str_8560(t);return this._lastPlaneVisualization=e<this._sizes.length?this._planeVisualizations.get(this._sizes[e].toString()):null,this._lastSize=t,this._lastPlaneVisualization}_Str_8988(){return this._Str_6009(this._lastSize)._Str_8988()}}let Bu=(()=>{class t extends ju{render(t,e,s,i,r,n,a,o){const c=this._Str_6009(i);if(!c||!c.geometry)return null;const _=c.geometry.getScreenPoint(new ot(0,0,0)),h=c.geometry.getScreenPoint(new ot(0,s/c.geometry.scale,0)),l=c.geometry.getScreenPoint(new ot(e/c.geometry.scale,0,0));let u=0,d=0;if(_&&h&&l){e=Math.round(Math.abs(_.x-l.x)),s=Math.round(Math.abs(_.x-h.x));const t=_.x-c.geometry.getScreenPoint(new ot(1,0,0)).x;u=a*Math.trunc(Math.abs(t)),d=o*Math.trunc(Math.abs(t))}return c.render(t,e,s,r,n,u,d)}}return t._Str_2531=16777215,t._Str_5433=45,t._Str_5509=30,t})(),Hu=(()=>{class t{constructor(t,e,s=1){if(this._cells=[],this._repeatMode=s,this._width=t<1?1:t,this._cachedBitmapData=null,this._cachedBitmapNormal=null,this._cachedBitmapDataOffsetX=0,this._cachedBitmapDataOffsetY=0,this._isCached=!1,this._isStatic=!0,e&&e.length){let t=0;for(;t<e.length;){const s=e[t];s&&(this._cells.push(s),s.isStatic||(this._isStatic=!1)),t++}}}get isStatic(){return this._isStatic}_Str_24523(){return!(this._repeatMode===t._Str_9685)}get width(){return this._width}dispose(){if(this._cells&&this._cells.length){for(const t of this._cells)t&&t.dispose();this._cells=null}this._cachedBitmapData&&(this._cachedBitmapData.destroy(),this._cachedBitmapData=null),this._cachedBitmapNormal&&(this._cachedBitmapNormal=null)}_Str_3355(){if(this._isCached){if(this._cachedBitmapData&&(this._cachedBitmapData.destroy(),this._cachedBitmapData=null),this._cachedBitmapNormal&&(this._cachedBitmapNormal.x=0,this._cachedBitmapNormal.y=0,this._cachedBitmapNormal.z=0),this._cells&&this._cells.length)for(const t of this._cells)t&&t._Str_3355();this._isCached=!1}}render(e,s,i,r){let n=0;if(this._repeatMode==t._Str_9685&&(n=this._Str_19857(this._cells,s),e=n),this._cachedBitmapNormal||(this._cachedBitmapNormal=new ot),this.isStatic){if(this._cachedBitmapData){if(this._cachedBitmapData.height===e&&ot.isEqual(this._cachedBitmapNormal,s)&&this._cachedBitmapDataOffsetX===i&&this._cachedBitmapDataOffsetY===r)return this._cachedBitmapData;this._cachedBitmapData.destroy(),this._cachedBitmapData=null}}else this._cachedBitmapData&&(this._cachedBitmapData.height===e?this._cachedBitmapData.beginFill(16777215).drawRect(0,0,this._cachedBitmapData.width,e).endFill():(this._cachedBitmapData.destroy(),this._cachedBitmapData=null));if(this._isCached=!0,this._cachedBitmapData||(this._cachedBitmapData=(new A.f).beginFill(16777215).drawRect(0,0,this._width,e).endFill()),this._cachedBitmapNormal.assign(s),this._cachedBitmapDataOffsetX=i,this._cachedBitmapDataOffsetY=r,!this._cells.length)return this._cachedBitmapData;switch(this._repeatMode){case t._Str_9685:this._Str_25839(s);break;case t._Str_6087:console.log("tru2");break;case t._Str_6114:console.log("tru3");break;case t._Str_6187:console.log("tru4");break;case t._Str_6063:console.log("tru5");break;default:this._Str_18711(s,i,r)}return this._cachedBitmapData}_Str_19857(t,e){if(!t||!t.length)return 0;let s=0,i=0;for(;i<t.length;){const r=t[i];r&&(s+=r._Str_9599(e)),i++}return s}_Str_4757(t,e,s,i,r=0,n=0){if(!t||!t.length||!this._cachedBitmapData)return e;let a=0;for(;a<t.length;){let o=null;if(o=s?t[a]:t[t.length-1-a],o){const t=o.render(i,r,n);if(t&&(s||(e-=t.height),t.y=e,this._cachedBitmapData.addChild(t),s&&(e+=t.height),s&&e>=this._cachedBitmapData.height||!s&&e<=0))return e}a++}return e}_Str_25839(t){this._cells.length&&this._cachedBitmapData&&this._Str_4757(this._cells,0,!0,t)}_Str_18711(t,e,s){if(!this._cells.length||!this._cachedBitmapData)return;let i=0;for(;i<this._cachedBitmapData.height;)if(i=this._Str_4757(this._cells,i,!0,t,e,s),!i)return}_Str_22299(){return this._cells}}return t._Str_9685=0,t._Str_7916=1,t._Str_6087=2,t._Str_6114=3,t._Str_6187=4,t._Str_6063=5,t})(),Wu=(()=>{class t{constructor(e,s=1,i=1,r=-1,n=1,a=-1,o=1){this._repeatMode=1,this._align=1,this._cachedBitmapNormal=null,this._cachedBitmapHeight=0,this._isCached=!1,this._isStatic=!0,this._normalMinX=-1,this._normalMaxX=1,this._normalMinY=-1,this._normalMaxY=1,this._columns=[],e<1&&(e=1);let c=0;for(;c<e;)this._columns.push(null),c++;this._repeatMode=s,this._align=i,this._normalMinX=r,this._normalMaxX=n,this._normalMinY=a,this._normalMaxY=o,this._repeatMode==t._Str_9127&&(this._isStatic=!1)}static _Str_12526(t){return Nu._Str_1612(1,0,17631*t)[0]%t}get normalMinX(){return this._normalMinX}get normalMaxX(){return this._normalMaxX}get normalMinY(){return this._normalMinY}get normalMaxY(){return this._normalMaxY}_Str_14945(){return this._align===t._Str_3606}get isStatic(){return this._isStatic}dispose(){this._cachedBitmapData&&(this._cachedBitmapData.destroy(),this._cachedBitmapData=null),this._cachedBitmapNormal&&(this._cachedBitmapNormal=null)}_Str_3355(){if(this._isCached){if(this._cachedBitmapData&&(this._cachedBitmapData.destroy(),this._cachedBitmapData=null),this._cachedBitmapNormal&&(this._cachedBitmapNormal.x=0,this._cachedBitmapNormal.y=0,this._cachedBitmapNormal.z=0),this._columns&&this._columns.length)for(const t of this._columns)t&&t._Str_3355();this._isCached=!1}}_Str_22372(t,e,s,i=1){if(t<0||t>=this._columns.length)return!1;const r=new Hu(e,s,i),n=this._columns[t];return n&&n.dispose(),this._columns[t]=r,r&&!r.isStatic&&(this._isStatic=!1),!0}render(e,s,i,r,n,a,o,c){if(s<1&&(s=1),i<1&&(i=1),e&&e.width===s&&e.height===i||(e=null),this._cachedBitmapNormal||(this._cachedBitmapNormal=new ot),this.isStatic){if(this._cachedBitmapData){if(this._cachedBitmapData.width===s&&this._cachedBitmapData.height==i&&ot.isEqual(this._cachedBitmapNormal,r))return e?(this._Str_17578(e,this._cachedBitmapHeight,o,c),e):this._cachedBitmapData;this._cachedBitmapData.destroy(),this._cachedBitmapData=null}}else this._cachedBitmapData&&(this._cachedBitmapData.width===s&&this._cachedBitmapData.height===i?this._cachedBitmapData.beginFill(16777215).drawRect(0,0,s,i).endFill():(this._cachedBitmapData.destroy(),this._cachedBitmapData=null));if(this._isCached=!0,this._cachedBitmapNormal.assign(r),!n){if(this._cachedBitmapHeight=i,this._cachedBitmapData)this._cachedBitmapData.beginFill(16777215).drawRect(0,0,s,i).endFill();else{const t=(new A.f).beginFill(16777215).drawRect(0,0,s,i).endFill();this._cachedBitmapData=t}return e?(this._Str_17578(e,i,o,c),e):this._cachedBitmapData}if(!this._cachedBitmapData){this._cachedBitmapHeight=i;const t=(new A.f).beginFill(16777215).drawRect(0,0,s,i).endFill();this._cachedBitmapData=t}const _=[];let h=0;for(;h<this._columns.length;){const t=this._columns[h];if(t){const e=t.render(i,r,a,o);e&&_.push(e)}h++}if(!_.length)return e||this._cachedBitmapData;let l=0;switch(this._repeatMode){case t._Str_6087:case t._Str_6114:case t._Str_6187:case t._Str_6063:case t._Str_9127:break;default:l=this._Str_18711(this._cachedBitmapData,_)}return this._cachedBitmapHeight=l,e?(this._Str_17578(e,l,o,c),e):this._cachedBitmapData}_Str_17578(e,s,i,r){if(!e||!this._cachedBitmapData||e===this._cachedBitmapData)return;let n;r||(i=e.height-s-i),n=new A.k(0,this._align==t.ALIGN_TOP?0:this._cachedBitmapData.height-this._cachedBitmapHeight,this._cachedBitmapData.width,this._cachedBitmapHeight);const a=bt.generateTexture(this._cachedBitmapData,n);a&&e.beginTextureFill({texture:a}).drawRect(0,i,n.width,n.height).endFill()}_Str_25859(t){if(!t||!t.length)return 0;let e=0;for(const s of t)s&&(e+=s.width);return e}_Str_4606(e,s,i,r){if(!e||!s||!s.length)return new A.j(i,0);let n=0,a=null,o=0;for(;o<s.length;){if(a=r?s[o]:s[s.length-1-o],null!=a){r||(i-=a.width);let s=0;this._align==t._Str_3606&&(s=e.height-a.height);let o=id.getTextureCache(a);if(o||(o=bt.generateTexture(a,new A.k(0,0,a.width,a.height)),id.addTextureCache(a,o)),e.beginTextureFill({texture:o}),e.drawRect(i,s,o.width,o.height),e.endFill(),a.height>n&&(n=a.height),r&&(i+=a.width),r&&i>=e.width||!r&&i<=0)return new A.j(i,n)}o++}return new A.j(i,n)}_Str_18711(t,e){if(!t||!e||!e.length)return 0;this._Str_25859(e);let s=0,i=0;for(;s<t.width;){const r=this._Str_4606(t,e,s,!0);if(s=r.x,r.y>i&&(i=r.y),!r.x)return i}return i}_Str_23721(e){if(this._repeatMode===t._Str_9127){const s=[];let i=0;for(;i<e;){const e=this._columns[t._Str_12526(this._columns.length)];if(e){if(s.push(e),!(e.width>1))break;i+=e.width}}return s}return this._columns}}return t._Str_7916=1,t._Str_6087=2,t._Str_6114=3,t._Str_6187=4,t._Str_6063=5,t._Str_9127=6,t._Str_18632=t._Str_7916,t._Str_3268=-1,t._Str_3271=1,t.ALIGN_TOP=1,t._Str_3606=2,t._Str_6914=t.ALIGN_TOP,t})(),Zu=(()=>{class t{constructor(){this._planeMaterialItems=[],this._isCached=!1}dispose(){if(this._planeMaterialItems&&this._planeMaterialItems.length){for(const t of this._planeMaterialItems)t&&t.dispose();this._planeMaterialItems=null}this._isCached=!1}_Str_3355(){if(this._isCached){if(this._planeMaterialItems&&this._planeMaterialItems.length)for(const t of this._planeMaterialItems)t&&t._Str_3355();this._isCached=!1}}_Str_24503(t,e,s,i=-1,r=1,n=-1,a=1){const o=new Wu(t,e,s,i,r,n,a);return this._planeMaterialItems.push(o),o}_Str_21968(t){if(!t)return null;if(this._planeMaterialItems&&this._planeMaterialItems.length)for(const e of this._planeMaterialItems)if(e&&t.x>=e.normalMinX&&t.x<=e.normalMaxX&&t.y>=e.normalMinY&&t.y<=e.normalMaxY)return e;return null}render(t,e,s,i,r,n,a,o){e<1&&(e=1),s<1&&(s=1);const c=this._Str_21968(i);return c?(this._isCached=!0,c.render(t,e,s,i,r,n,a,o)):null}}return t._Str_3268=-1,t._Str_3271=1,t})();class zu{constructor(t,e=null,s=null,i=0){if(this._extraItemCount=0,this._cachedBitmapData=null,this._texture=t,this._extraItemOffsets=[],this._extraItemAssets=[],this._extraItemCount=0,e&&e.length&&i>0){let t=0;for(;t<e.length;){const s=e[t];s&&this._extraItemAssets.push(s),t++}if(this._extraItemAssets.length){if(s){let t=0;for(;t<s.length;){const e=s[t];e&&this._extraItemOffsets.push(new A.j(e.x,e.y)),t++}}this._extraItemCount=i}}}get isStatic(){return 0==this._extraItemCount}dispose(){this._texture&&(this._texture.dispose(),this._texture=null),this._cachedBitmapData&&(this._cachedBitmapData.destroy(),this._cachedBitmapData=null),this._extraItemAssets=null,this._extraItemOffsets=null,this._extraItemCount=0}_Str_3355(){this._cachedBitmapData&&(this._cachedBitmapData.destroy(),this._cachedBitmapData=null)}_Str_9599(t){if(this._texture){const e=this._texture._Str_4913(t);if(e)return e.height}return 0}render(t,e,s){if(!this._texture)return null;const i=this._texture._Str_4913(t);if(!i)return null;let r=null;if(0!==e||0!==s){for(;e<0;)e+=i.width;for(;s<0;)s+=i.height;const t=new A.q(i,i.width,i.height);t.tilePosition.x=e%i.width,t.tilePosition.y=s%i.height,t.uvRespectAnchor=!0,e&&(t.anchor.x=1,t.scale.x=-1),s&&(t.anchor.y=1,t.scale.y=-1),r=t}else r=new A.n(i);return r||null}_Str_2125(t){return null==this._texture?null:this._texture._Str_2125(t)}}let Xu=(()=>{class t{constructor(t,e=-1,s=1,i=-1,r=1,n=null){this._normalMinX=e,this._normalMaxX=s,this._normalMinY=i,this._normalMaxY=r,this._assetName=n,this._bitmap=t}get bitmap(){return this._bitmap}get normalMinX(){return this._normalMinX}get normalMaxX(){return this._normalMaxX}get normalMinY(){return this._normalMinY}get normalMaxY(){return this._normalMaxY}get assetName(){return this._assetName}dispose(){this._bitmap=null}}return t._Str_3268=-1,t._Str_3271=1,t})(),Ku=(()=>{class t{constructor(){this._bitmaps=[]}dispose(){if(this._bitmaps){for(const t of this._bitmaps)t&&t.dispose();this._bitmaps=null}}_Str_16790(t,e=-1,s=1,i=-1,r=1,n=null){this._bitmaps.push(new Xu(t,e,s,i,r,n))}_Str_4913(t){const e=this._Str_21702(t);return e?e.bitmap:null}_Str_21702(t){if(!t)return null;for(const e of this._bitmaps)if(e&&t.x>=e.normalMinX&&t.x<=e.normalMaxX&&t.y>=e.normalMinY&&t.y<=e.normalMaxY)return e;return null}_Str_2125(t){const e=this._Str_21702(t);return e?e.assetName:null}}return t._Str_3268=-1,t._Str_3271=1,t})(),qu=(()=>{class t{constructor(){this._assetCollection=null,this._textures=new Map,this._materials=new Map,this._planes=new Map,this._geometries=new Map,this._data=null}get data(){return this._data}get _Str_2697(){return this._assetCollection}initializeDimensions(t,e){return!0}dispose(){if(this._planes){for(const t of this._planes.values())t&&t.dispose();this._planes=null}if(this._materials&&(this._Str_21781(),this._materials=null),this._textures&&(this._Str_21447(),this._textures=null),this._geometries){for(const t of this._geometries.values())t&&t.dispose();this._geometries=null}this._data=null,this._assetCollection=null}_Str_3355(){for(const t of this._planes.values())t&&t._Str_3355();for(const t of this._materials.values())t&&t._Str_3355()}initialize(t){this._data=t}_Str_24005(){this._Str_21447(),this._Str_21781(),this._Str_22054()}_Str_21781(){for(const t of this._materials.values())t&&t.dispose();this._materials.clear()}_Str_21447(){for(const t of this._textures.values())t&&t.dispose();this._textures.clear()}_Str_10114(t){return this._textures.get(t)}_Str_8547(t){return this._materials.get(t)}_Str_3491(t){return this._planes.get(t)}_Str_3453(t,e){return!!e&&!this._planes.get(t)&&(this._planes.set(t,e),!0)}_Str_6703(t){this._data&&(this._assetCollection=t,this._Str_22054())}_Str_22054(){this._data&&(this._Str_25281(),this.initializePlanes())}_Str_25281(){this._data.textures&&this._data.textures.length&&this._Str_24250(this._data.textures,this._Str_2697),this._data.materials&&this._data.materials.length&&this._Str_22388(this._data.materials)}initializePlanes(){}_Str_24250(t,e){if(t&&e&&t.length)for(const s of t){if(!s)continue;const t=s.id;if(!this._textures.get(t)){const i=new Ku;if(s.bitmaps&&s.bitmaps.length)for(const t of s.bitmaps){if(!t)continue;const s=t.assetName;let r=Ku._Str_3268,n=Ku._Str_3271,a=Ku._Str_3268,o=Ku._Str_3271;void 0!==t.normalMinX&&(r=t.normalMinX),void 0!==t.normalMaxX&&(n=t.normalMaxX),void 0!==t.normalMinY&&(a=t.normalMinY),void 0!==t.normalMaxY&&(o=t.normalMaxY);const c=e.getAsset(s);if(c){const t=c.texture;if(t){let e=t;c.flipH&&(e=Fu._Str_16640(t)),i._Str_16790(e,r,n,a,o,s)}}}this._textures.set(t,i)}}}_Str_22388(t){if(t&&t.length)for(const e of t){if(!e)continue;const t=e.id,s=new Zu;if(e.matrices&&e.matrices.length)for(const i of e.matrices){if(!i)continue;let t=i.repeatMode,e=i.align;const r=Wu._Str_3268,n=Wu._Str_3271,a=Wu._Str_3268,o=Wu._Str_3271;switch(t){case"borders":t=Wu._Str_6087;break;case"center":t=Wu._Str_6114;break;case"first":t=Wu._Str_6187;break;case"last":t=Wu._Str_6063;break;case"random":t=Wu._Str_9127;break;default:t=Wu._Str_18632}switch(e){case"top":e=Wu.ALIGN_TOP;break;case"bottom":e=Wu._Str_3606;break;default:e=Wu._Str_6914}if(i.columns&&i.columns.length){const c=s._Str_24503(i.columns.length,t,e,r,n,a,o);let _=0;for(;_<i.columns.length;){const t=i.columns[_];t&&this._Str_24431(t,c,_),_++}}}this._materials.set(t,s)}}_Str_24431(t,e,s){if(!t||!e)return;let i=Hu._Str_7916;const r=t.width,n=this._Str_25217(t);switch(t.repeatMode){case"borders":i=Hu._Str_6087;break;case"center":i=Hu._Str_6114;break;case"first":i=Hu._Str_6187;break;case"last":i=Hu._Str_6063;break;case"none":i=Hu._Str_9685;break;default:i=Hu._Str_7916}e._Str_22372(s,r,n,i)}_Str_25217(t){if(!t||!t.cells||!t.cells.length)return null;const e=[];let s=0;for(;s<t.cells.length;){const i=t.cells[s];if(i){const t=i.textureId;let s=null,r=null,n=null,a=0;if(i.extras&&i.extras.length){const t=i.extras[0],e=t.types,n=t.offsets;if(e&&n&&e.length&&n.length){const i=n[0];s=this._Str_25465(e[0]),r=this._Str_24448(i),a=r.length,t.limitMax&&(a=t.limitMax)}}if(s&&s.length){n=[];for(const t of s){if(!t)continue;const e=this._assetCollection.getAsset(t);e&&n.push(e)}}const o=this._Str_10114(t),c=new zu(o,n,r,a);e.push(c)}s++}return e&&e.length?e:null}_Str_25465(t){const e=[];if(t&&t.types&&t.types.length){let s=0;for(;s<t.types.length;){const i=t.types[s].assetName;i&&e.push(i),s++}}return e}_Str_24448(t){const e=[];if(t&&t.offsets&&t.offsets.length){let s=0;for(;s<t.offsets.length;){const i=t.offsets[s];e.push(new A.j(i.x,i.y)),s++}}return e}_Str_17204(t,e,s){(e=Math.abs(e))>90&&(e=90),(s=Math.abs(s))>90&&(s=90);const i=`${t}_${Math.round(e)}_${Math.round(s)}`;let r=this._geometries.get(i);return r||(r=new lh(t,new ot(e,s),new ot(-10,0,0)),this._geometries.set(i,r),r)}_Str_9137(t,e){if(t&&e&&e&&e.length)for(const s of e){if(!s)continue;const e=s.size;let i=Bu._Str_5433,r=Bu._Str_5509;s.horizontalAngle&&(i=s.horizontalAngle),s.verticalAngle&&(r=s.verticalAngle);const n=s.layers,a=t._Str_20305(e,n&&n.length||0,this._Str_17204(e,i,r));if(a&&n&&n.length){let t=0;for(;t<n.length;){const e=n[t];if(e){let s=null,i=Yu._Str_6914,r=Bu._Str_2531,n=Yu._Str_1934;e.materialId&&(s=this._Str_8547(e.materialId)),e.color&&(r=e.color),e.offset&&(n=e.offset),e.align&&("bottom"===e.align?i=Yu._Str_3606:"top"==e.align&&(i=Yu.ALIGN_TOP)),a._Str_21464(t,s,r,i,n)}t++}}}}render(t,e,s,i,r,n,a,o=0,c=0,_=0,h=0,l=0){return null}getTextureIdentifier(t,e){return t.toString()}_Str_8988(e){let s=this._Str_3491(e);return s||(s=this._Str_3491(t.DEFAULT)),s._Str_8988()}}return t.DEFAULT="default",t})(),Ju=(()=>{class t extends ju{constructor(){super(...arguments),this._width=0,this._height=0}isStatic(t){const e=this._Str_6009(t);return e?!e._Str_20530:super.isStatic(t)}initializeDimensions(t,e){t<0&&(t=0),e<0&&(e=0),t===this._width&&e===this._height||(this._width=t,this._height=e)}render(t,e,s,i,r,n,a,o,c,_,h){const l=this._Str_6009(i);if(!l||!l.geometry)return null;const u=l.geometry.getScreenPoint(new ot(0,0,0)),d=l.geometry.getScreenPoint(new ot(0,0,1)),g=l.geometry.getScreenPoint(new ot(0,1,0));if(u&&d&&g){e=Math.round(Math.abs((u.x-g.x)*e/l.geometry.scale)),s=Math.round(Math.abs((u.y-d.y)*s/l.geometry.scale));const i=a*Math.abs(u.x-g.x),m=o*Math.abs(u.y-d.y),p=c*Math.abs(u.x-g.x),E=_*Math.abs(u.y-d.y);return l.render(t,e,s,r,n,i,m,p,E,c,_,h)}return null}}return t._Str_2531=16777215,t._Str_5433=45,t._Str_5509=30,t})(),Qu=(()=>{class t extends qu{constructor(){super(...arguments),this._landscapeWidth=0,this._landscapeHeight=0}initializeDimensions(t,e){return t<0&&(t=0),e<0&&(e=0),this._landscapeWidth=t,this._landscapeHeight=e,!0}initializePlanes(){if(!this.data)return;const t=this.data.landscapes;t&&t.length&&this._Str_25478(t)}_Str_25478(t){if(!t)return;const e=Math.trunc(654321*Math.random());for(const s in t){const i=t[s];if(!i)continue;const r=i.id,n=i.animatedVisualizations,a=new Ju;for(const t of n){if(!t)continue;const s=t.size;let i=Ju._Str_5433,r=Ju._Str_5509;t.horizontalAngle&&(i=t.horizontalAngle),t.verticalAngle&&(r=t.verticalAngle);const n=t.layers,o=t.animationLayers,c=n&&n.length||0,_=o&&o.length||0,h=a._Str_20305(s,c+_||0,this._Str_17204(s,i,r));if(h){Nu._Str_17384(e);let t=0;if(c)for(;t<n.length;){const e=n[t];if(e){let s=null,i=Yu._Str_6914,r=Ju._Str_2531,n=Yu._Str_1934;e.materialId&&(s=this._Str_8547(e.materialId)),e.color&&(r=e.color),e.offset&&(n=e.offset),e.align&&("bottom"===e.align?i=Yu._Str_3606:"top"===e.align&&(i=Yu.ALIGN_TOP)),h._Str_21464(t,s,r,i,n)}t++}if(t=0,_){const e=[];for(;t<o.length;){const s=o[t];if(s){const t=s.animationItems;if(t&&t.length)for(const s of t)if(s){const t=s.assetId,i=this._Str_21504(s.x||"",s.randomX||""),r=this._Str_21504(s.y||"",s.randomY||""),n=s.speedX?s.speedX/um.instance.getConfiguration("animation.fps"):0,a=s.speedY?s.speedY/um.instance.getConfiguration("animation.fps"):0;e.push({asset:t,x:i,y:r,speedX:n,speedY:a})}}t++}h._Str_23489(t,e,this._Str_2697)}}}this._Str_3453(r,a)||a.dispose()}}_Str_21504(t,e){let s=0;if(t.length>0&&"%"===t.charAt(t.length-1)&&(t=t.substr(0,t.length-1),s=parseFloat(t)/100),e.length>0){const t=1e4,i=Nu._Str_1612(1,0,t)[0]/t;"%"===e.charAt(e.length-1)&&(e=e.substr(0,e.length-1),s+=i*parseFloat(e)/100)}return s}render(e,s,i,r,n,a,o,c=0,_=0,h=0,l=0,u=0){let d=this._Str_3491(s);if(d||(d=this._Str_3491(t.DEFAULT)),!d)return null;e&&e.clear();let g=d.render(e,i,r,n,a,o,c,_,h,l,u);if(g&&g!==e&&(g=g.clone(),!g))return null;let m=null;return m=!d.isStatic(n)&&t._Str_3536>0?new Du(g,Math.round(u/t._Str_3536)*t._Str_3536+t._Str_3536):new Du(g,-1),m}getTextureIdentifier(t,e){return e?e.x<0?t+"_0":t+"_1":super.getTextureIdentifier(t,e)}}return t._Str_3536=500,t})();class $u extends qu{initializePlanes(){if(!this.data)return;const t=this.data.floors;t&&t.length&&this._Str_24495(t)}_Str_24495(t){if(t)for(const e in t){const s=t[e];if(!s)continue;const i=s.id,r=s.visualizations,n=new Bu;this._Str_9137(n,r),this._Str_3453(i,n)||n.dispose()}}render(t,e,s,i,r,n,a,o=0,c=0,_=0,h=0,l=0){let u=this._Str_3491(e);if(u||(u=this._Str_3491(qu.DEFAULT)),!u)return null;t&&t.beginFill(16777215).drawRect(0,0,t.width,t.height).endFill();let d=u.render(t,s,i,r,n,a,o,c);return d&&d!==t&&(d=d.clone(),!d)?null:new Du(d,-1)}}let td=(()=>{class t extends ju{render(t,e,s,i,r,n){const a=this._Str_6009(i);if(!a||!a.geometry)return null;const o=a.geometry.getScreenPoint(new ot(0,0,0)),c=a.geometry.getScreenPoint(new ot(0,0,s/a.geometry.scale)),_=a.geometry.getScreenPoint(new ot(0,e/a.geometry.scale,0));return o&&c&&_&&(e=Math.round(Math.abs(o.x-_.x)),s=Math.round(Math.abs(o.y-c.y))),a.render(t,e,s,r,n)}}return t._Str_2531=16777215,t._Str_5433=45,t._Str_5509=30,t})();class ed extends qu{initializePlanes(){if(!this.data)return;const t=this.data.walls;t&&t.length&&this._Str_24495(t)}_Str_24495(t){if(t)for(const e in t){const s=t[e];if(!s)continue;const i=s.id,r=s.visualizations,n=new td;this._Str_9137(n,r),this._Str_3453(i,n)||n.dispose()}}render(t,e,s,i,r,n,a,o=0,c=0,_=0,h=0,l=0){let u=this._Str_3491(e);if(u||(u=this._Str_3491(qu.DEFAULT)),!u)return null;if(t){const e=t.getBounds();t.clear(),t.drawRect(e.x,e.y,e.width,e.height)}let d=u.render(t,s,i,r,n,a);return d&&d!==t&&(d=d.clone(),!d)?null:new Du(d,-1)}getTextureIdentifier(t,e){return e?`${t}_${e.x}_${e.y}_${e.z}`:super.getTextureIdentifier(t,e)}}class sd extends M{constructor(){super(),this._wallRasterizer=new ed,this._floorRasterizer=new $u,this._landscapeRasterizer=new Qu,this._maskManager=new xu,this._initialized=!1}initialize(t){const e=t.wallData;e&&this._wallRasterizer.initialize(e);const s=t.floorData;s&&this._floorRasterizer.initialize(s);const i=t.landscapeData;i&&this._landscapeRasterizer.initialize(i);const r=t.maskData;return r&&this._maskManager.initialize(r),!0}onDispose(){this._wallRasterizer&&(this._wallRasterizer.dispose(),this._wallRasterizer=null),this._floorRasterizer&&(this._floorRasterizer.dispose(),this._floorRasterizer=null),this._landscapeRasterizer&&(this._landscapeRasterizer.dispose(),this._landscapeRasterizer=null),this._maskManager&&(this._maskManager.dispose(),this._maskManager=null),super.onDispose()}setGraphicAssetCollection(t){this._initialized||(this._wallRasterizer._Str_6703(t),this._floorRasterizer._Str_6703(t),this._landscapeRasterizer._Str_6703(t),this._maskManager._Str_6703(t),this._initialized=!0)}_Str_3355(){this._wallRasterizer&&this._wallRasterizer._Str_3355(),this._floorRasterizer&&this._floorRasterizer._Str_3355(),this._landscapeRasterizer&&this._landscapeRasterizer._Str_3355()}get wallRasterizer(){return this._wallRasterizer}get floorRasterizer(){return this._floorRasterizer}get landscapeRasterizer(){return this._landscapeRasterizer}get maskManager(){return this._maskManager}}let id=(()=>{class t extends El{constructor(){super(),this._data=null,this._roomPlaneParser=new Ia,this._roomPlaneBitmapMaskParser=new Au,this._geometryUpdateId=-1,this._directionX=0,this._directionY=0,this._directionZ=0,this._floorThickness=1,this._wallThickness=1,this._holeUpdateTime=NaN,this._Str_2540=[],this._Str_4864=[],this._Str_6648=[],this._roomScale=0,this._lastUpdateTime=-1e3,this._updateIntervalTime=250,this._wallType=null,this._floorType=null,this._landscapeType=null,this._colorBackgroundOnly=!0,this._color=16777215,this._redColor=255,this._greenColor=255,this._blueColor=255,this._typeVisibility=[],this._Str_5928=0,this._maskData=null,this._isPlaneSet=!1,this._typeVisibility[wu.TYPE_UNDEFINED]=!1,this._typeVisibility[wu.TYPE_FLOOR]=!0,this._typeVisibility[wu.TYPE_WALL]=!0,this._typeVisibility[wu.TYPE_LANDSCAPE]=!0}static getTextureCache(e){const s=t.RENDER_TEXTURE_CACHE.get(t.LAST_VISUALIZATION);return s?s.getValue(e):null}static addTextureCache(e,s){if(!t.LAST_VISUALIZATION)return;let i=t.RENDER_TEXTURE_CACHE.get(t.LAST_VISUALIZATION);i||(i=new X,t.RENDER_TEXTURE_CACHE.set(t.LAST_VISUALIZATION,i)),i.add(e,s)}initialize(t){return t instanceof sd&&(this._data=t,super.initialize(t),this._data.setGraphicAssetCollection(this.asset),!0)}dispose(){super.dispose(),this.clearPlanes(),this._Str_2540=null,this._Str_4864=null,this._Str_6648=null,this._roomPlaneParser&&(this._roomPlaneParser.dispose(),this._roomPlaneParser=null),this._roomPlaneBitmapMaskParser&&(this._roomPlaneBitmapMaskParser.dispose(),this._roomPlaneBitmapMaskParser=null),this._data&&(this._data._Str_3355(),this._data=null);const e=t.RENDER_TEXTURE_CACHE.get(this);if(e){for(const t of e.getValues())t.destroy(!0);e.dispose(),t.RENDER_TEXTURE_CACHE.delete(this)}}reset(){super.reset(),this._floorType=null,this._wallType=null,this._landscapeType=null,this._maskData=null,this._geometryUpdateId=-1,this._roomScale=0}update(e,s,i,r){if(!this.object||!e)return;t.LAST_VISUALIZATION=this,t.RENDER_TEXTURE_CACHE.get(t.LAST_VISUALIZATION);const n=this.updateGeometry(e),a=this.object.model;let o=!1;if(this.updateThickness(a)&&(o=!0),this.updateHole(a)&&(o=!0),this._Str_25732(),o=this.updateMasks(a),!(s<this._lastUpdateTime+this._updateIntervalTime)||n||o){if(this.updatePlanes(a)&&(o=!0),this._Str_16913(e,n,s)&&(o=!0),o){let t=0;for(;t<this._Str_4864.length;){const e=this.getSprite(this._Str_6648[t]),s=this._Str_4864[t];if(e&&s&&s.type!==wu.TYPE_LANDSCAPE)if(this._colorBackgroundOnly){let t=s.color;t=(t>>24<<24)+((t>>16&255)*this._blueColor/255<<16)+((t>>8&255)*this._greenColor/255<<8)+(255&t)*this._redColor/255,e.color=t}else e.color=s.color;t++}this.updateSpriteCounter++}this.updateModelCounter=a.updateCounter,this._lastUpdateTime=s}}updateGeometry(t){if(!t)return!1;if(this._geometryUpdateId===t.updateId)return!1;this._geometryUpdateId=t.updateId,this._boundingRectangle=null;const e=t.direction;return!(!e||e.x===this._directionX&&e.y===this._directionY&&e.z===this._directionZ&&t.scale===this._roomScale||(this._directionX=e.x,this._directionY=e.y,this._directionZ=e.z,this._roomScale=t.scale,0))}updateThickness(t){if(this.updateModelCounter===t.updateCounter)return!1;const e=t.getValue(st.ROOM_FLOOR_THICKNESS),s=t.getValue(st.ROOM_WALL_THICKNESS);return!(isNaN(e)||isNaN(s)||e===this._floorThickness&&s===this._wallThickness||(this._floorThickness=e,this._wallThickness=s,this.clearPlanes(),0))}updateHole(t){if(this.updateModelCounter===t.updateCounter)return!1;const e=t.getValue(st.ROOM_FLOOR_HOLE_UPDATE_TIME);return!isNaN(e)&&e!==this._holeUpdateTime&&(this._holeUpdateTime=e,this.clearPlanes(),!0)}updateMasks(t){if(this.updateModelCounter===t.updateCounter)return!1;let e=!1;const s=t.getValue(st.ROOM_PLANE_MASK_XML);s!==this._maskData&&(this._Str_15935(s),this._maskData=s,e=!0);const i=t.getValue(st.ROOM_BACKGROUND_COLOR);i!==this._color&&(this._color=i,this._redColor=255&this._color,this._greenColor=this._color>>8&255,this._blueColor=this._color>>16&255,e=!0);const r=t.getValue(st.ROOM_COLORIZE_BG_ONLY)||!1;return r!==this._colorBackgroundOnly&&(this._colorBackgroundOnly=r,e=!0),e}updatePlanes(t){if(this.updateModelCounter===t.updateCounter)return!1;const e=t.getValue(st.ROOM_FLOOR_TYPE),s=t.getValue(st.ROOM_WALL_TYPE),i=t.getValue(st.ROOM_LANDSCAPE_TYPE);this.updatePlaneTypes(e,s,i);const r=1===t.getValue(st.ROOM_FLOOR_VISIBILITY),n=1===t.getValue(st.ROOM_WALL_VISIBILITY),a=1===t.getValue(st.ROOM_LANDSCAPE_VISIBILITY);return this.updatePlaneVisibility(r,n,a),!0}clearPlanes(){if(this._Str_2540){for(;this._Str_2540.length;){const t=this._Str_2540[0];t&&t.dispose(),this._Str_2540.pop()}this._Str_2540=[],this._Str_2540=[]}this._isPlaneSet=!1,this._Str_5928=this._Str_5928+1,this.reset()}_Str_25732(){if(!this.object||this._isPlaneSet)return!1;isNaN(this._floorThickness)||(this._roomPlaneParser.floorThicknessMultiplier=this._floorThickness),isNaN(this._wallThickness)||(this._roomPlaneParser.wallThicknessMultiplier=this._wallThickness);const e=this.object.model.getValue(st.ROOM_MAP_DATA);if(!this._roomPlaneParser.initializeFromMapData(e))return;const s=this._Str_23949(),i=this._Str_23063();let r=0,n=this.object.model.getValue(st.ROOM_RANDOM_SEED),a=0;for(;a<this._roomPlaneParser.planeCount;){const e=this._roomPlaneParser.getPlaneLocation(a),o=this._roomPlaneParser.getPlaneLeftSide(a),c=this._roomPlaneParser.getPlaneRightSide(a),_=this._roomPlaneParser.getPlaneSecondaryNormals(a),h=this._roomPlaneParser.getPlaneType(a);let l=null;if(!(e&&o&&c))return;{const u=ot.crossProduct(o,c);if(n=7613*n+517,l=null,h===ba.PLANE_FLOOR){const s=e.x+o.x+.5,i=e.y+c.y+.5,r=Math.trunc(s)-s,a=Math.trunc(i)-i;l=new wu(this.object.getLocation(),e,o,c,wu.TYPE_FLOOR,!0,_,n,-r,-a),l.color=0!==u.z?t._Str_18544:0!==u.x?t._Str_16664:t._Str_18640,this._data&&(l.rasterizer=this._data.floorRasterizer)}else h===ba.PLANE_WALL?(l=new wu(this.object.getLocation(),e,o,c,wu.TYPE_WALL,!0,_,n),(o.length<1||c.length<1)&&(l._Str_18448=!1),l.color=0===u.x&&0===u.y?t._Str_14868:u.y>0?t._Str_14503:0===u.y?t._Str_15851:t._Str_13715,this._data&&(l.rasterizer=this._data.wallRasterizer)):h===ba.PLANE_LANDSCAPE?(l=new wu(this.object.getLocation(),e,o,c,wu.TYPE_LANDSCAPE,!0,_,n,r,0,s,i),l.color=u.y>0?t._Str_17403:0==u.y?t._Str_16113:t._Str_18370,this._data&&(l.rasterizer=this._data.landscapeRasterizer),r+=o.length):h==ba.PLANE_BILLBOARD&&(l=new wu(this.object.getLocation(),e,o,c,wu.TYPE_WALL,!0,_,n),(o.length<1||c.length<1)&&(l._Str_18448=!1),l.color=0==u.x&&0==u.y?t._Str_14868:u.y>0?t._Str_14503:0==u.y?t._Str_15851:t._Str_13715);if(l){l._Str_16279=this._data.maskManager;let t=0;for(;t<this._roomPlaneParser.getPlaneMaskCount(a);){const e=this._roomPlaneParser.getPlaneMaskLeftSideLoc(a,t),s=this._roomPlaneParser.getPlaneMaskRightSideLoc(a,t),i=this._roomPlaneParser.getPlaneMaskLeftSideLength(a,t),r=this._roomPlaneParser.getPlaneMaskRightSideLength(a,t);l._Str_24758(e,s,i,r),t++}this._Str_2540.push(l)}}a++}return this._isPlaneSet=!0,this._Str_18024(),!0}_Str_18024(){this.setSpriteCount(this._Str_2540.length);let t=0;for(;t<this._Str_2540.length;){const e=this._Str_2540[t],s=this.getSprite(t);e&&s&&e._Str_5424&&e._Str_4968&&(s.alphaTolerance=e.type===wu.TYPE_WALL&&(e._Str_5424.length<1||e._Str_4968.length<1)?ml._Str_9268:ml._Str_9735,s.tag=e.type===wu.TYPE_WALL?"plane.wall@"+(t+1):e.type===wu.TYPE_FLOOR?"plane.floor@"+(t+1):"plane@"+(t+1),s.spriteType=_h._Str_8616),t++}}_Str_23949(){let t=0,e=0;for(;e<this._roomPlaneParser.planeCount;)this._roomPlaneParser.getPlaneType(e)===ba.PLANE_LANDSCAPE&&(t+=this._roomPlaneParser.getPlaneLeftSide(e).length),e++;return t}_Str_23063(){let t=0,e=0;for(;e<this._roomPlaneParser.planeCount;){if(this._roomPlaneParser.getPlaneType(e)===ba.PLANE_LANDSCAPE){const s=this._roomPlaneParser.getPlaneRightSide(e);s.length>t&&(t=s.length)}e++}return t>5&&(t=5),t}updatePlaneTypes(t,e,s){if(t!==this._floorType?this._floorType=t:t=null,e!==this._wallType?this._wallType=e:e=null,s!==this._landscapeType?this._landscapeType=s:s=null,!t&&!e&&!s)return!1;let i=0;for(;i<this._Str_2540.length;){const r=this._Str_2540[i];r&&(r.type===wu.TYPE_FLOOR&&t?r.id=t:r.type===wu.TYPE_WALL&&e?r.id=e:r.type===wu.TYPE_LANDSCAPE&&s&&(r.id=s)),i++}return!0}updatePlaneVisibility(t,e,s){t===this._typeVisibility[wu.TYPE_FLOOR]&&e===this._typeVisibility[wu.TYPE_WALL]&&s===this._typeVisibility[wu.TYPE_LANDSCAPE]||(this._typeVisibility[wu.TYPE_FLOOR]=t,this._typeVisibility[wu.TYPE_WALL]=e,this._typeVisibility[wu.TYPE_LANDSCAPE]=s,this._Str_4864=[],this._Str_6648=[])}_Str_16913(e,s,i){if(!e||!this.object)return;this._Str_5928++,s&&(this._Str_4864=[],this._Str_6648=[]);const r=this._Str_4864.length>0;let n=this._Str_4864;this._Str_4864.length||(n=this._Str_2540);let a=0,o=!1,c=0;for(;c<n.length;){let s=c;r&&(s=this._Str_6648[c]);const _=this.getSprite(s);if(_){const h=n[c];h?(_.id=h.uniqueId,h.update(e,i)&&(h.visible&&(a=h.relativeDepth+this._Str_24891+s/1e3,h.type!==wu.TYPE_FLOOR&&(a=h.relativeDepth+this._Str_25403+s/1e3,(h._Str_5424.length<1||h._Str_4968.length<1)&&(a+=.5*t._Str_8621)),this._Str_7421(_,h,"plane "+s+" "+e.scale,a)),o=!0),_.visible!=(h.visible&&this._typeVisibility[h.type])&&(_.visible=!_.visible,o=!0),_.visible&&(r||(this._Str_4864.push(h),this._Str_6648.push(c)))):(_.id=0,_.visible&&(_.visible=!1,o=!0))}c++}return o}_Str_15935(t){if(!t)return;this._roomPlaneBitmapMaskParser.initialize(t);const e=[],s=[];let i=!1,r=0;for(;r<this._Str_2540.length;){const t=this._Str_2540[r];t&&(t._Str_25213(),t.type===wu.TYPE_LANDSCAPE&&e.push(r)),r++}for(const n of this._roomPlaneBitmapMaskParser.masks.values()){const t=this._roomPlaneBitmapMaskParser._Str_21678(n),e=this._roomPlaneBitmapMaskParser._Str_19038(n),r=this._roomPlaneBitmapMaskParser._Str_21644(n);if(e){let n=0;for(;n<this._Str_2540.length;){const a=this._Str_2540[n];if((a.type===wu.TYPE_WALL||a.type===wu.TYPE_LANDSCAPE)&&a&&a.location&&a.normal){const o=ot.dif(e,a.location);if(Math.abs(ot.scalarProjection(o,a.normal))<.01&&a._Str_5424&&a._Str_4968){const e=ot.scalarProjection(o,a._Str_5424),c=ot.scalarProjection(o,a._Str_4968);a.type===wu.TYPE_WALL||a.type===wu.TYPE_LANDSCAPE&&r===Tu.HOLE?a._Str_24569(t,e,c):a.type===wu.TYPE_LANDSCAPE&&(a._Str_14801||(i=!0),a._Str_14801=!0,s.push(n))}}n++}}}for(r=0;r<e.length;){const t=e[r];s.indexOf(t)<0&&(this._Str_2540[t]._Str_14801=!1,i=!0),r++}i&&(this._Str_4864=[],this._Str_6648=[])}_Str_7421(t,e,s,i){const r=e.offset;t.offsetX=-r.x,t.offsetY=-r.y,t.relativeDepth=i,t.color=e.color,t.texture=this._Str_22446(e,s),t.name=s+"_"+this._Str_5928}_Str_22446(t,e){return t.bitmapData}getBoundingRectangle(){return this._boundingRectangle||(this._boundingRectangle=super.getBoundingRectangle()),new A.k(this._boundingRectangle.x,this._boundingRectangle.y,this._boundingRectangle.width,this._boundingRectangle.height)}get _Str_19113(){const t=[];for(const e of this._Str_4864)t.push(e);return t}get _Str_24891(){return t._Str_8621+.1}get _Str_25403(){return t._Str_8621+.5}}return t.LAST_VISUALIZATION=null,t.RENDER_TEXTURE_CACHE=new Map,t._Str_18544=16777215,t._Str_18640=14540253,t._Str_16664=12303291,t._Str_14503=16777215,t._Str_15851=13421772,t._Str_13715=10066329,t._Str_14868=10066329,t._Str_17403=16777215,t._Str_16113=13421772,t._Str_18370=10066329,t._Str_8621=1e3,t})();class rd extends Bl{constructor(){super(),this._tileHeight=0}getLayerYOffset(t,e,s){return 1===s?(this._tileHeight=this.object.model.getValue(st.TILE_CURSOR_HEIGHT),32*-this._tileHeight):super.getLayerYOffset(t,e,s)}}let nd=(()=>{class t{constructor(){this._visualizationDatas=new Map}getVisualization(t){const e=this.getVisualizationType(t);return e?new e:null}getVisualizationType(t){if(!t)return null;let e=null;switch(t){case it.ROOM:e=id;break;case it.TILE_CURSOR:e=rd;break;case it.USER:case it.BOT:case it.RENTABLE_BOT:e=Ol;break;case it.PET_ANIMATED:e=vu;break;case it.FURNITURE_STATIC:e=jl;break;case it.FURNITURE_ANIMATED:e=Bl;break;case it.FURNITURE_RESETTING_ANIMATED:e=uu;break;case it.FURNITURE_BADGE_DISPLAY:e=Hl;break;case it.FURNITURE_BG:e=du;break;case it.FURNITURE_BB:e=Zl;break;case it.FURNITURE_BOTTLE:e=zl;break;case it.FURNITURE_BUILDER_PLACEHOLDER:e=Xl;break;case it.FURNITURE_COUNTER_CLOCK:e=Kl;break;case it.FURNITURE_CUBOID:e=ql;break;case it.FURNITURE_EXTERNAL_IMAGE:e=$l;break;case it.FURNITURE_FIREWORKS:e=tu;break;case it.FURNITURE_GIFT_WRAPPED_FIREWORKS:e=eu;break;case it.FURNITURE_GIFT_WRAPPED:e=su;break;case it.FURNITURE_GUILD_CUSTOMIZED:e=iu;break;case it.FURNITURE_GUILD_ISOMETRIC_BADGE:e=ru;break;case it.FURNITURE_HABBOWHEEL:e=nu;break;case it.FURNITURE_MANNEQUIN:e=ou;break;case it.FURNITURE_PARTY_BEAMER:e=cu;break;case it.FURNITURE_PLANET_SYSTEM:e=_u;break;case it.FURNITURE_POSTER:e=hu;break;case it.FURNITURE_QUEUE_TILE:e=lu;break;case it.FURNITURE_SCORE_BOARD:e=gu;break;case it.FURNITURE_SOUNDBLOCK:e=mu;break;case it.FURNITURE_STICKIE:e=pu;break;case it.FURNITURE_VAL_RANDOMIZER:e=Eu;break;case it.FURNITURE_VOTE_COUNTER:e=fu;break;case it.FURNITURE_VOTE_MAJORITY:e=Su;break;case it.FURNITURE_WATER_AREA:e=bu}return e||(D.log("Unknown Visualization: "+t),null)}getVisualizationData(e,s,i){const r=this._visualizationDatas.get(e);if(r)return r;let n=null;switch(s){case it.FURNITURE_STATIC:case it.FURNITURE_GIFT_WRAPPED:case it.FURNITURE_BB:case it.FURNITURE_BG:case it.FURNITURE_STICKIE:case it.FURNITURE_BUILDER_PLACEHOLDER:n=new Yl;break;case it.FURNITURE_ANIMATED:case it.FURNITURE_RESETTING_ANIMATED:case it.FURNITURE_POSTER:case it.FURNITURE_HABBOWHEEL:case it.FURNITURE_VAL_RANDOMIZER:case it.FURNITURE_BOTTLE:case it.FURNITURE_PLANET_SYSTEM:case it.FURNITURE_QUEUE_TILE:case it.FURNITURE_PARTY_BEAMER:case it.FURNITURE_COUNTER_CLOCK:case it.FURNITURE_WATER_AREA:case it.FURNITURE_SCORE_BOARD:case it.FURNITURE_FIREWORKS:case it.FURNITURE_GIFT_WRAPPED_FIREWORKS:case it.FURNITURE_GUILD_CUSTOMIZED:case it.FURNITURE_GUILD_ISOMETRIC_BADGE:case it.FURNITURE_VOTE_COUNTER:case it.FURNITURE_VOTE_MAJORITY:case it.FURNITURE_SOUNDBLOCK:case it.FURNITURE_BADGE_DISPLAY:case it.FURNITURE_EXTERNAL_IMAGE:case it.FURNITURE_YOUTUBE:case it.TILE_CURSOR:n=new kl;break;case it.FURNITURE_MANNEQUIN:n=new au;break;case it.ROOM:n=new sd;break;case it.USER:case it.BOT:case it.RENTABLE_BOT:n=new Tl;break;case it.PET_ANIMATED:n=new Iu}return n?n.initialize(i)?((n instanceof Tl||n instanceof au)&&(n.avatarManager=um.instance.avatar),t.CACHING_ENABLED&&this._visualizationDatas.set(e,n),n):(n.dispose(),null):null}}return t.CACHING_ENABLED=!0,t})(),ad=(()=>{class t{}return t.DOG=0,t.CAT=1,t.CROCODILE=2,t.TERRIER=3,t.BEAR=4,t.PIG=5,t.LION=6,t.RHINO=7,t.SPIDER=8,t.TURTLE=9,t.CHICKEN=10,t.FROG=11,t.DRAGON=12,t.MONSTER=13,t.MONKEY=14,t.HORSE=15,t.MONSTERPLANT=16,t.BUNNY=17,t.BUNNYEVIL=18,t.BUNNYDEPRESSED=19,t.BUNNYLOVE=20,t.PIGEONGOOD=21,t.PIGEONEVIL=22,t.DEMONMONKEY=23,t.BABYBEAR=24,t.BABYTERRIER=25,t.GNOME=26,t.LEPRECHAUN=27,t.KITTENBABY=28,t.PUPPYBABY=29,t.PIGLETNBABY=30,t.HALOOMPA=31,t.FOOLS=32,t.PTEROSAUR=33,t.VELOCIRAPTOR=34,t})(),od=(()=>{class t{}return t.ROOM_MIN_X="room_min_x",t.ROOM_MAX_X="room_max_x",t.ROOM_MIN_Y="room_min_y",t.ROOM_MAX_Y="room_max_y",t.ROOM_IS_PUBLIC="room_is_public",t.ROOM_Z_SCALE="room_z_scale",t.AD_DISPLAY_DELAY="ad_display_delay",t.IS_PLAYING_GAME="is_playing_game",t.RESTRICTS_DRAGGING="restricts_dragging",t.RESTRICTS_SCALING="restricts_scaling",t.RESTRICTED_SCALE="room_scale",t})();class cd{constructor(t,e){this._width=t,this._height=e,this._heights=[],this._isNotStackable=[],this._isRoomTile=[];let s=t*e;for(;s>0;)this._heights.push(0),this._isNotStackable.push(!1),this._isRoomTile.push(!1),s--}dispose(){this._width=0,this._height=0,this._height=null,this._isNotStackable=null,this._isRoomTile=null}validPosition(t,e){return t>=0&&t<this._width&&e>=0&&e<this._height}getTileHeight(t,e){return this.validPosition(t,e)?this._heights[e*this._width+t]:0}setTileHeight(t,e,s){this.validPosition(t,e)&&(this._heights[e*this._width+t]=s)}setStackingBlocked(t,e,s){this.validPosition(t,e)&&(this._isNotStackable[e*this._width+t]=s)}setIsRoomTile(t,e,s){this.validPosition(t,e)&&(this._isRoomTile[e*this._width+t]=s)}validateLocation(t,e,s,i,r,n,a,o,c,_=-1){let h=0,l=0;if(!this.validPosition(t,e)||!this.validPosition(t+s-1,e+i-1))return!1;(r<0||r>=this._width)&&(r=0),(n<0||n>=this._height)&&(n=0),a=Math.min(a,this._width-r),o=Math.min(o,this._height-n),-1===_&&(_=this.getTileHeight(t,e));let u=e;for(;u<e+i;){for(h=t;h<t+s;){if(h<r||h>=r+a||u<n||u>=n+o)if(l=u*this._width+h,c){if(!this._isRoomTile[l])return!1}else if(this._isNotStackable[l]||!this._isRoomTile[l]||Math.abs(this._heights[l]-_)>.01)return!1;h++}u++}return!0}get width(){return this._width}get height(){return this._height}}let _d=(()=>{class t{constructor(){this._isDisposed=!1,this._scale=64,this._heightMap=[],this._width=0,this._height=0,this._floorHeight=0}get disposed(){return this._isDisposed}get scale(){return this._scale}set scale(t){this._scale=t}dispose(){this.reset(),this._isDisposed=!0}initialize(t,e,s){if(t<=this._width&&e<=this._height)return this._width=t,this._height=e,void(this._floorHeight=s);this.reset();let i=0;for(;i<e;){const e=[];this._heightMap.push(e);let s=0;for(;s<t;)e.push(0),s++;i++}this._width=t,this._height=e,this._floorHeight=s}reset(){this._heightMap=[]}setHeight(t,e,s){if(t<0||t>=this._width||e<0||e>=this._height)return!1;const i=this._heightMap[e];return!!i&&(i[t]=s,!0)}getHeight(t,e){if(t<0||t>=this._width||e<0||e>=this._height)return 0;const s=this._heightMap[e];return s?s[t]:0}getLocation(e,s,i,r,n){let a,o,c;if(0==e&&0==s)if(e=this._width,s=this._height,a=Math.round(this.scale/10),n==t.R){for(c=this._width-1;c>=0;){for(o=1;o<this._height;){if(this.getHeight(c,o)<=this._floorHeight){o-1<s&&(e=c,s=o-1);break}o++}c--}r+=this.scale/4-a/2,i+=this.scale/2}else{for(o=this._height-1;o>=0;){for(c=1;c<this._width;){if(this.getHeight(c,o)<=this._floorHeight){c-1<e&&(e=c-1,s=o);break}c++}o--}r+=this.scale/4-a/2,i-=a}let _=e,h=s,l=this.getHeight(e,s);return n==t.R?(_+=i/(this._scale/2)-.5,h+=.5,l-=(r-i/2)/(this._scale/2)):(h+=(this._scale/2-i)/(this._scale/2)-.5,_+=.5,l-=(r-(this._scale/2-i)/2)/(this._scale/2)),new ot(_,h,l)}_Str_24084(e,s,i){let r,n,a,o,c,_=0,h=0;n=Math.ceil(e),_=n-e;let l=0;for(r=0;r<this._width;){if(n>=0&&n<this._height){if(this.getHeight(r,n)<=this._floorHeight){a=r-1,o=n,h=r,i=t.L;break}if(this.getHeight(r,n+1)<=this._floorHeight){a=r,o=n,h=o-e,i=t.R;break}}n++,r++}const u=this.scale/2*_;let d=-h*this.scale/2;return d+=18*-s/32*this.scale/2,l=this.getHeight(a,o),c=l*this.scale/2+d,c+=i==t.R?_*this.scale/4:(1-_)*this.scale/4,this.getLocation(a,o,u,c,i)}_Str_22875(e,s){if(null==e)return null;let i=0,r=0,n=0,a=0,o="",c=0;if(90==s)i=Math.floor(e.x-.5),r=Math.floor(e.y+.5),c=this.getHeight(i,r),n=this._scale/2-this._scale/2*(e.y-r+.5),a=this._scale/2*(c-e.z)+(this._scale/2-n)/2,o=t.L;else{if(180!=s)return null;i=Math.floor(e.x+.5),r=Math.floor(e.y-.5),c=this.getHeight(i,r),n=this._scale/2*(e.x+.5-i),a=this._scale/2*(c-e.z)+n/2,o=t.R}return[i,r,n,a,o]}_Str_21860(t,e){const s=this._Str_22875(t,e);return null==s?null:":w="+Math.trunc(s[0])+","+Math.trunc(s[1])+" l="+Math.trunc(s[2])+","+Math.trunc(s[3])+" "+s[4]}getDirection(e){return e==t.R?180:90}_Str_24141(t,e){const s=this.getHeight(t,e),i=s+1;return s+(Math.trunc(this.getHeight(t-1,e-1))==i||Math.trunc(this.getHeight(t,e-1))==i||Math.trunc(this.getHeight(t+1,e-1))==i||Math.trunc(this.getHeight(t-1,e))==i||Math.trunc(this.getHeight(t+1,e))==i||Math.trunc(this.getHeight(t-1,e+1))==i||Math.trunc(this.getHeight(t,e+1))==i||Math.trunc(this.getHeight(t+1,e+1))==i?.5:0)}_Str_10375(t,e){return t>=0&&t<this._width&&e>=0&&e<this._height&&this._heightMap[e][t]>=0}}return t.DEFAULT_SCALE=32,t.L="l",t.R="r",t})();class hd extends M{constructor(t){super(),this._connection=null,this._roomCreator=t,this._planeParser=new Ia,this._latestEntryTileEvent=null,this._currentRoomId=0,this._ownUserId=0,this._initialConnection=!0}onDispose(){super.onDispose(),this._connection=null,this._roomCreator=null,this._latestEntryTileEvent=null,this._planeParser&&(this._planeParser.dispose(),this._planeParser=null)}setConnection(t){!this._connection&&t&&(this._connection=t,this._connection.addMessageEvent(new ko(this.onUserInfoEvent.bind(this))),this._connection.addMessageEvent(new Aa(this.onRoomModelNameEvent.bind(this))),this._connection.addMessageEvent(new Ca(this.onRoomPaintEvent.bind(this))),this._connection.addMessageEvent(new Ta(this.onRoomModelEvent.bind(this))),this._connection.addMessageEvent(new ga(this.onRoomHeightMapEvent.bind(this))),this._connection.addMessageEvent(new pa(this.onRoomHeightMapUpdateEvent.bind(this))),this._connection.addMessageEvent(new Da(this.onRoomThicknessEvent.bind(this))),this._connection.addMessageEvent(new ua(this.onRoomDoorEvent.bind(this))),this._connection.addMessageEvent(new Un(this.onRoomRollingEvent.bind(this))),this._connection.addMessageEvent(new Zn(this.onFurnitureAliasesEvent.bind(this))),this._connection.addMessageEvent(new Gn(this.onFurnitureFloorAddEvent.bind(this))),this._connection.addMessageEvent(new Yn(this.onFurnitureFloorEvent.bind(this))),this._connection.addMessageEvent(new jn(this.onFurnitureFloorRemoveEvent.bind(this))),this._connection.addMessageEvent(new Hn(this.onFurnitureFloorUpdateEvent.bind(this))),this._connection.addMessageEvent(new ra(this.onFurnitureWallAddEvent.bind(this))),this._connection.addMessageEvent(new aa(this.onFurnitureWallEvent.bind(this))),this._connection.addMessageEvent(new ca(this.onFurnitureWallRemoveEvent.bind(this))),this._connection.addMessageEvent(new ha(this.onFurnitureWallUpdateEvent.bind(this))),this._connection.addMessageEvent(new zn(this.onFurnitureDataEvent.bind(this))),this._connection.addMessageEvent(new Kn(this.onFurnitureItemDataEvent.bind(this))),this._connection.addMessageEvent(new ea(this.onFurnitureStateEvent.bind(this))),this._connection.addMessageEvent(new Ba(this.onRoomUnitDanceEvent.bind(this))),this._connection.addMessageEvent(new Wa(this.onRoomUnitEffectEvent.bind(this))),this._connection.addMessageEvent(new Ka(this.onRoomUnitEvent.bind(this))),this._connection.addMessageEvent(new Ja(this.onRoomUnitExpressionEvent.bind(this))),this._connection.addMessageEvent(new $a(this.onRoomUnitHandItemEvent.bind(this))),this._connection.addMessageEvent(new eo(this.onRoomUnitIdleEvent.bind(this))),this._connection.addMessageEvent(new io(this.onRoomUnitInfoEvent.bind(this))),this._connection.addMessageEvent(new no(this.onRoomUnitNumberEvent.bind(this))),this._connection.addMessageEvent(new oo(this.onRoomUnitRemoveEvent.bind(this))),this._connection.addMessageEvent(new lo(this.onRoomUnitStatusEvent.bind(this))),this._connection.addMessageEvent(new Fa(this.onRoomUnitChatEvent.bind(this))),this._connection.addMessageEvent(new Ga(this.onRoomUnitChatEvent.bind(this))),this._connection.addMessageEvent(new Va(this.onRoomUnitChatEvent.bind(this))),this._connection.addMessageEvent(new ka(this.onRoomUnitTypingEvent.bind(this))),this._connection.addMessageEvent(new Ua(this.onPetFigureUpdateEvent.bind(this))),this._connection.addMessageEvent(new Pa(this.onYouArePlayingGameEvent.bind(this))),this._connection.addMessageEvent(new $n(this.onFurnitureState2Event.bind(this))))}setRoomId(t){0!==this._currentRoomId&&this._roomCreator&&this._roomCreator.destroyRoom(this._currentRoomId),this._currentRoomId=t,this._latestEntryTileEvent=null}clearRoomId(){this._currentRoomId=0,this._latestEntryTileEvent=null}onUserInfoEvent(t){if(!(t instanceof ko&&t.connection))return;const e=t.getParser();e&&(this._ownUserId=e.userInfo.userId)}onRoomModelNameEvent(t){if(t instanceof Aa&&t.connection){if(this._currentRoomId!==t.getParser().roomId&&this.setRoomId(t.getParser().roomId),this._roomCreator&&this._roomCreator.setRoomInstanceModelName(t.getParser().roomId,t.getParser().name),this._initialConnection)return t.connection.send(new r_),void(this._initialConnection=!1);t.connection.send(new f_)}}onRoomPaintEvent(t){if(!(t instanceof Ca))return;const e=t.getParser();e&&this._roomCreator&&this._roomCreator.updateRoomInstancePlaneType(this._currentRoomId,e.floorType,e.wallType,e.landscapeType)}onRoomModelEvent(t){if(!(t instanceof Ta&&t.connection&&this._roomCreator))return;const e=t.getParser();if(!e)return;const s=this._roomCreator.getLegacyWallGeometry(this._currentRoomId);if(!s)return;this._planeParser.reset();const i=e.width,r=e.height;this._planeParser.initializeTileMap(i,r);let n=null;this._latestEntryTileEvent&&(n=this._latestEntryTileEvent.getParser());let a=-1,o=-1,c=0,_=0,h=0;for(;h<r;){let t=0;for(;t<i;){const s=e.getHeight(t,h);(h>0&&h<r-1||t>0&&t<i-1)&&s!=Ia.TILE_BLOCKED&&(null==n||t==n.x&&h==n.y)&&(e.getHeight(t,h-1)==Ia.TILE_BLOCKED&&e.getHeight(t-1,h)==Ia.TILE_BLOCKED&&e.getHeight(t,h+1)==Ia.TILE_BLOCKED&&(a=t+.5,o=h,c=s,_=90),e.getHeight(t,h-1)==Ia.TILE_BLOCKED&&e.getHeight(t-1,h)==Ia.TILE_BLOCKED&&e.getHeight(t+1,h)==Ia.TILE_BLOCKED&&(a=t,o=h+.5,c=s,_=180)),this._planeParser.setTileHeight(t,h,s),t++}h++}this._planeParser.setTileHeight(Math.floor(a),Math.floor(o),c),this._planeParser.initializeFromTileData(e.wallHeight),this._planeParser.setTileHeight(Math.floor(a),Math.floor(o),c+this._planeParser.wallHeight),64===e.scale?(this._planeParser.restrictsDragging=!0,this._planeParser.restrictsScaling=!0,this._planeParser.restrictedScale=.5):(this._planeParser.restrictsDragging=!1,this._planeParser.restrictsScaling=!1,this._planeParser.restrictedScale=1),s.scale=_d.DEFAULT_SCALE,s.initialize(i,r,this._planeParser.floorHeight);let l=e.height-1;for(;l>=0;){let t=e.width-1;for(;t>=0;)s.setHeight(t,l,this._planeParser.getTileHeight(t,l)),t--;l--}const u=this._planeParser.getMapData();u.doors.push({x:a,y:o,z:c,dir:_}),this._roomCreator.createRoomInstance(this._currentRoomId,u)}onRoomHeightMapEvent(t){if(!(t instanceof ga&&t.connection&&this._roomCreator))return;const e=t.getParser();if(!e)return;const s=e.width,i=e.height,r=new cd(s,i);let n=0;for(;n<i;){let t=0;for(;t<s;)r.setTileHeight(t,n,e.getTileHeight(t,n)),r.setStackingBlocked(t,n,e.getStackingBlocked(t,n)),r.setIsRoomTile(t,n,e.isRoomTile(t,n)),t++;n++}this._roomCreator.setFurnitureStackingHeightMap(this._currentRoomId,r)}onRoomHeightMapUpdateEvent(t){if(!(t instanceof pa&&t.connection&&this._roomCreator))return;const e=t.getParser();if(!e)return;const s=this._roomCreator.getFurnitureStackingHeightMap(this._currentRoomId);if(s){for(;e.next();)s.setTileHeight(e.x,e.y,e.tileHeight()),s.setStackingBlocked(e.x,e.y,e.isStackingBlocked()),s.setIsRoomTile(e.x,e.y,e.isRoomTile());this._roomCreator._Str_17722(this._currentRoomId,"RoomMessageHandler.onRoomHeightMapUpdateEvent()")}}onRoomThicknessEvent(t){if(!(t instanceof Da))return;const e=t.getParser();if(!e)return;const s=e.thicknessWall,i=e.thicknessFloor;this._roomCreator&&(this._roomCreator.updateRoomInstancePlaneVisibility(this._currentRoomId,!e.hideWalls,!0),this._roomCreator.updateRoomInstancePlaneThickness(this._currentRoomId,s,i))}onRoomDoorEvent(t){t instanceof ua&&(this._latestEntryTileEvent=t)}onRoomRollingEvent(t){if(!(t instanceof Un&&t.connection&&this._roomCreator))return;const e=t.getParser();this._roomCreator.updateRoomObjectFloor(this._currentRoomId,e.rollerId,null,null,1,null),this._roomCreator.updateRoomObjectFloor(this._currentRoomId,e.rollerId,null,null,2,null);const s=e.itemsRolling;if(s&&s.length)for(const r of s)r&&this._roomCreator.rollRoomObjectFloor(this._currentRoomId,r.id,r.location,r.targetLocation);const i=e.unitRolling;if(i){this._roomCreator.updateRoomObjectUserLocation(this._currentRoomId,i.id,i.location,i.targetLocation);const t=this._roomCreator.getRoomObjectUser(this._currentRoomId,i.id);if(t&&t.type!==et.MONSTER_PLANT){let t="std";switch(i.movementType){case Nn.MOVE:t="mv";break;case Nn.SLIDE:t="std"}this._roomCreator.updateRoomObjectUserPosture(this._currentRoomId,i.id,t)}}}onFurnitureAliasesEvent(t){t instanceof Zn&&t.connection&&this._roomCreator&&(t.getParser(),this._connection.send(new f_))}onFurnitureFloorAddEvent(t){if(!(t instanceof Gn&&t.connection&&this._roomCreator))return;const e=t.getParser().item;e&&this.addRoomObjectFurnitureFloor(this._currentRoomId,e)}onFurnitureFloorEvent(t){if(!(t instanceof Yn&&t.connection&&this._roomCreator))return;const e=t.getParser();if(!e)return;const s=e.items.length;let i=0;for(;i<s;){const t=e.items[i];t&&this.addRoomObjectFurnitureFloor(this._currentRoomId,t),i++}}onFurnitureFloorRemoveEvent(t){if(!(t instanceof jn&&t.connection&&this._roomCreator))return;const e=t.getParser();e&&(e.delay>0?setTimeout(()=>{this._roomCreator.removeRoomObjectFloor(this._currentRoomId,e.itemId,e.isExpired?-1:e.userId,!0)},e.delay):this._roomCreator.removeRoomObjectFloor(this._currentRoomId,e.itemId,e.isExpired?-1:e.userId,!0))}onFurnitureFloorUpdateEvent(t){if(!(t instanceof Hn&&t.connection&&this._roomCreator))return;const e=t.getParser().item;if(!e)return;const s=new ot(e.x,e.y,e.z),i=new ot(e.direction);this._roomCreator.updateRoomObjectFloor(this._currentRoomId,e.itemId,s,i,e.data.state,e.data),this._roomCreator.updateRoomObjectFloorHeight(this._currentRoomId,e.itemId,e.stackHeight),this._roomCreator.updateRoomObjectFloorExpiration(this._currentRoomId,e.itemId,e.expires)}onFurnitureWallAddEvent(t){if(!(t instanceof ra&&t.connection&&this._roomCreator))return;const e=t.getParser().item;e&&this.addRoomObjectFurnitureWall(this._currentRoomId,e)}onFurnitureWallEvent(t){if(!(t instanceof aa&&t.connection&&this._roomCreator))return;const e=t.getParser();if(!e)return;const s=e.items.length;let i=0;for(;i<s;){const t=e.items[i];t&&this.addRoomObjectFurnitureWall(this._currentRoomId,t),i++}}onFurnitureWallRemoveEvent(t){if(!(t instanceof ca&&t.connection&&this._roomCreator))return;const e=t.getParser();e&&this._roomCreator.removeRoomObjectWall(this._currentRoomId,e.itemId,e.userId)}onFurnitureWallUpdateEvent(t){if(!(t instanceof ha&&t.connection&&this._roomCreator))return;const e=this._roomCreator.getLegacyWallGeometry(this._currentRoomId);if(!e)return;const s=t.getParser().item;if(!s)return;const i=e.getLocation(s.width,s.height,s.localX,s.localY,s.direction),r=new ot(e.getDirection(s.direction));this._roomCreator.updateRoomObjectWall(this._currentRoomId,s.itemId,i,r,s.state,s.stuffData),this._roomCreator.updateRoomObjectWallExpiration(this._currentRoomId,s.itemId,s.secondsToExpiration)}onFurnitureDataEvent(t){if(!(t instanceof zn&&t.connection&&this._roomCreator))return;const e=t.getParser();this._roomCreator.updateRoomObjectFloor(this._currentRoomId,e.furnitureId,null,null,e.objectData.state,e.objectData)}onFurnitureItemDataEvent(t){if(!(t instanceof Kn&&t.connection&&this._roomCreator))return;const e=t.getParser();this._roomCreator.updateRoomObjectWallItemData(this._currentRoomId,e.furnitureId,e.data)}onFurnitureStateEvent(t){if(!(t instanceof ea&&t.connection&&this._roomCreator))return;const e=t.getParser();this._roomCreator.updateRoomObjectFloor(this._currentRoomId,e.itemId,null,null,e.state,new Ii)}onFurnitureState2Event(t){if(!(t instanceof $n&&t.connection&&this._roomCreator))return;const e=t.getParser();this._roomCreator.updateRoomObjectFloor(this._currentRoomId,e.itemId,null,null,e.value,new Ii)}onRoomUnitDanceEvent(t){t instanceof Ba&&t.connection&&this._roomCreator&&this._roomCreator.updateRoomObjectUserAction(this._currentRoomId,t.getParser().unitId,st.FIGURE_DANCE,t.getParser().danceId)}onRoomUnitEffectEvent(t){t instanceof Wa&&t.connection&&this._roomCreator&&this._roomCreator.updateRoomObjectUserEffect(this._currentRoomId,t.getParser().unitId,t.getParser().effectId,t.getParser().delay)}onRoomUnitEvent(t){if(!(t instanceof Ka&&t.connection&&this._roomCreator))return;const e=t.getParser().users;if(e&&e.length)for(const s of e){if(!s)continue;const t=new ot(s.x,s.y,s.z),e=new ot(s.dir);this._roomCreator.addRoomObjectUser(this._currentRoomId,s.roomIndex,t,e,s.dir,s.userType,s.figure),s.webID===this._ownUserId&&(this._roomCreator.setRoomSessionOwnUser(this._currentRoomId,s.roomIndex),this._roomCreator.updateRoomObjectUserOwn(this._currentRoomId,s.roomIndex)),this._roomCreator.updateRoomObjectUserFigure(this._currentRoomId,s.roomIndex,s.figure,s.sex,s.subType,s.isRiding),et.getTypeString(s.userType)===et.PET&&this._roomCreator.getPetTypeId(s.figure)===ad.MONSTERPLANT&&this._roomCreator.updateRoomObjectUserPosture(this._currentRoomId,s.roomIndex,s.petPosture)}}onRoomUnitExpressionEvent(t){t instanceof Ja&&t.connection&&this._roomCreator&&this._roomCreator.updateRoomObjectUserAction(this._currentRoomId,t.getParser().unitId,st.FIGURE_EXPRESSION,t.getParser().expression)}onRoomUnitHandItemEvent(t){t instanceof $a&&t.connection&&this._roomCreator&&this._roomCreator.updateRoomObjectUserAction(this._currentRoomId,t.getParser().unitId,st.FIGURE_CARRY_OBJECT,t.getParser().handId)}onRoomUnitIdleEvent(t){t instanceof eo&&t.connection&&this._roomCreator&&this._roomCreator.updateRoomObjectUserAction(this._currentRoomId,t.getParser().unitId,st.FIGURE_SLEEP,t.getParser().isIdle?1:0)}onRoomUnitInfoEvent(t){t instanceof io&&t.connection&&this._roomCreator&&this._roomCreator.updateRoomObjectUserFigure(this._currentRoomId,t.getParser().unitId,t.getParser().figure,t.getParser().gender)}onRoomUnitNumberEvent(t){if(!(t instanceof no&&t.connection&&this._roomCreator))return;const e=t.getParser();e&&this._roomCreator.updateRoomObjectUserAction(this._currentRoomId,e.unitId,st.FIGURE_NUMBER_VALUE,e.value)}onRoomUnitRemoveEvent(t){t instanceof oo&&t.connection&&this._roomCreator&&this._roomCreator.removeRoomObjectUser(this._currentRoomId,t.getParser().unitId)}onRoomUnitStatusEvent(t){if(!(t instanceof lo&&t.connection&&this._roomCreator))return;const e=t.getParser().statuses;if(!e||!e.length)return;const s=this._roomCreator.getRoomInstance(this._currentRoomId);if(!s)return;const i=s.model.getValue(od.ROOM_Z_SCALE)||1;for(const r of e){if(!r)continue;let t=r.height;t&&(t/=i);const e=new ot(r.x,r.y,r.z+t),s=new ot(r.direction);let n=null;r.didMove&&(n=new ot(r.targetX,r.targetY,r.targetZ)),this._roomCreator.updateRoomObjectUserLocation(this._currentRoomId,r.id,e,n,r.canStandUp,t,s,r.headDirection),this._roomCreator.updateRoomObjectUserFlatControl(this._currentRoomId,r.id,null);let a=!0,o=!1,c=st.STD,_="";if(r.actions&&r.actions.length)for(const i of r.actions)if(i)switch(i.action){case"flatctrl":this._roomCreator.updateRoomObjectUserFlatControl(this._currentRoomId,r.id,i.value);break;case"sign":1===r.actions.length&&(a=!1),this._roomCreator.updateRoomObjectUserAction(this._currentRoomId,r.id,st.FIGURE_SIGN,parseInt(i.value));break;case"gst":1===r.actions.length&&(a=!1),this._roomCreator.updateRoomObjectUserPetGesture(this._currentRoomId,r.id,i.value);break;case"wav":case"mv":o=!0,c=i.action,_=i.value;break;case"trd":break;default:o=!0,c=i.action,_=i.value}o?this._roomCreator.updateRoomObjectUserPosture(this._currentRoomId,r.id,c,_):a&&this._roomCreator.updateRoomObjectUserPosture(this._currentRoomId,r.id,st.STD,"")}}onRoomUnitChatEvent(t){if(!t.connection||!this._roomCreator)return;const e=t.getParser();e&&(this._roomCreator.updateRoomObjectUserGesture(this._currentRoomId,e.roomIndex,e.gesture),this._roomCreator.updateRoomObjectUserAction(this._currentRoomId,e.roomIndex,st.FIGURE_TALK,e.message.length/10))}onRoomUnitTypingEvent(t){t instanceof ka&&t.connection&&this._roomCreator&&this._roomCreator.updateRoomObjectUserAction(this._currentRoomId,t.getParser().unitId,st.FIGURE_IS_TYPING,t.getParser().isTyping?1:0)}onPetFigureUpdateEvent(t){if(!(t instanceof Ua&&t.connection&&this._roomCreator))return;const e=t.getParser();e&&this._roomCreator.updateRoomObjectUserFigure(this._currentRoomId,e.roomIndex,e.figureData.figuredata,"","",e.isRiding)}onYouArePlayingGameEvent(t){if(!t)return;const e=t.getParser();e&&this._roomCreator.setRoomEngineGameMode(this._currentRoomId,e.isPlaying)}addRoomObjectFurnitureFloor(t,e){if(!e||!this._roomCreator)return;const s=new ot(e.x,e.y,e.z),i=new ot(e.direction);e.spriteName?this._roomCreator.addFurnitureFloorByTypeName(t,e.itemId,e.spriteName,s,i,e.state,e.data,NaN,e.expires,e.usagePolicy,e.userId,e.username,!0,!0,e.stackHeight):this._roomCreator.addFurnitureFloor(t,e.itemId,e.spriteId,s,i,e.state,e.data,NaN,e.expires,e.usagePolicy,e.userId,e.username,!0,!0,e.stackHeight)}addRoomObjectFurnitureWall(t,e){if(!e||!this._roomCreator)return;const s=this._roomCreator.getLegacyWallGeometry(t);if(!s)return;let i=null;e._Str_22379||(i=s.getLocation(e.width,e.height,e.localX,e.localY,e.direction));const r=new ot(s.getDirection(e.direction));this._roomCreator.addFurnitureWall(t,e.itemId,e.spriteId,i,r,e.state,e.stuffData,e.secondsToExpiration,e.usagePolicy,e.userId,e.username)}get currentRoomId(){return this._currentRoomId}}let ld=(()=>{class t{}return t.CATALOG="catalog",t.INVENTORY="inventory",t})(),ud=(()=>{class t extends ih{constructor(e,s,i,r,n,a){super(t.ROOM_COLOR,e),this._state=s,this._presetId=i,this._effectId=r,this._color=n,this._brightness=a}get state(){return this._state}get _Str_14686(){return this._presetId}get _Str_6815(){return this._effectId}get color(){return this._color}get _Str_5123(){return this._brightness}}return t.ROOM_COLOR="REDSE_ROOM_COLOR",t})();class dd extends Nh{constructor(t,e,s,i,r,n,a,o,c,_,h,l,u){super(t,e,s,i),this._wallLocation="",this._x=0,this._y=0,this._z=0,this._direction=0,this._placedInRoom=!1,this._placedOnFloor=!1,this._placedOnWall=!1,this._instanceData=null,this._wallLocation=r,this._x=n,this._y=a,this._z=o,this._direction=c,this._placedInRoom=_,this._placedOnFloor=h,this._placedOnWall=l,this._instanceData=u}get _Str_7031(){return this._wallLocation}get x(){return this._x}get y(){return this._y}get z(){return this._z}get direction(){return this._direction}get _Str_4057(){return this._placedInRoom}get _Str_23888(){return this._placedOnFloor}get _Str_23432(){return this._placedOnWall}get _Str_4766(){return this._instanceData}}class gd extends Nh{constructor(t,e,s,i,r,n){super(t,e,s,i),this._droppedObjectId=r,this._droppedObjectCategory=n}get droppedObjectId(){return this._droppedObjectId}get droppedObjectCategory(){return this._droppedObjectCategory}}let md=(()=>{class t extends Nh{constructor(t,e,s,i,r=null){super(t,e,s,i),this._widget=r}get widget(){return this._widget}}return t.OPEN_WIDGET="RETWE_OPEN_WIDGET",t.CLOSE_WIDGET="RETWE_CLOSE_WIDGET",t.OPEN_FURNI_CONTEXT_MENU="RETWE_OPEN_FURNI_CONTEXT_MENU",t.CLOSE_FURNI_CONTEXT_MENU="RETWE_CLOSE_FURNI_CONTEXT_MENU",t.REQUEST_PLACEHOLDER="RETWE_REQUEST_PLACEHOLDER",t.REQUEST_CREDITFURNI="RETWE_REQUEST_CREDITFURNI",t.REQUEST_STICKIE="RETWE_REQUEST_STICKIE",t.REQUEST_PRESENT="RETWE_REQUEST_PRESENT",t.REQUEST_TROPHY="RETWE_REQUEST_TROPHY",t.REQUEST_TEASER="RETWE_REQUEST_TEASER",t.REQUEST_ECOTRONBOX="RETWE_REQUEST_ECOTRONBOX",t.REQUEST_DIMMER="RETWE_REQUEST_DIMMER",t.REMOVE_DIMMER="RETWE_REMOVE_DIMMER",t.REQUEST_CLOTHING_CHANGE="RETWE_REQUEST_CLOTHING_CHANGE",t.REQUEST_PLAYLIST_EDITOR="RETWE_REQUEST_PLAYLIST_EDITOR",t.REQUEST_MANNEQUIN="RETWE_REQUEST_MANNEQUIN",t.REQUEST_MONSTERPLANT_SEED_PLANT_CONFIRMATION_DIALOG="ROWRE_REQUEST_MONSTERPLANT_SEED_PLANT_CONFIRMATION_DIALOG",t.REQUEST_PURCHASABLE_CLOTHING_CONFIRMATION_DIALOG="ROWRE_REQUEST_PURCHASABLE_CLOTHING_CONFIRMATION_DIALOG",t.REQUEST_BACKGROUND_COLOR="RETWE_REQUEST_BACKGROUND_COLOR",t.REQUEST_MYSTERYBOX_OPEN_DIALOG="RETWE_REQUEST_MYSTERYBOX_OPEN_DIALOG",t.REQUEST_EFFECTBOX_OPEN_DIALOG="RETWE_REQUEST_EFFECTBOX_OPEN_DIALOG",t.REQUEST_MYSTERYTROPHY_OPEN_DIALOG="RETWE_REQUEST_MYSTERYTROPHY_OPEN_DIALOG",t.REQUEST_ACHIEVEMENT_RESOLUTION_ENGRAVING="RETWE_REQUEST_ACHIEVEMENT_RESOLUTION_ENGRAVING",t.REQUEST_ACHIEVEMENT_RESOLUTION_FAILED="RETWE_REQUEST_ACHIEVEMENT_RESOLUTION_FAILED",t.REQUEST_FRIEND_FURNITURE_CONFIRM="RETWE_REQUEST_FRIEND_FURNITURE_CONFIRM",t.REQUEST_FRIEND_FURNITURE_ENGRAVING="RETWE_REQUEST_FRIEND_FURNITURE_ENGRAVING",t.REQUEST_BADGE_DISPLAY_ENGRAVING="RETWE_REQUEST_BADGE_DISPLAY_ENGRAVING",t.REQUEST_HIGH_SCORE_DISPLAY="RETWE_REQUEST_HIGH_SCORE_DISPLAY",t.REQUEST_HIDE_HIGH_SCORE_DISPLAY="RETWE_REQUEST_HIDE_HIGH_SCORE_DISPLAY",t.REQUEST_INTERNAL_LINK="RETWE_REQUEST_INTERNAL_LINK",t.REQUEST_ROOM_LINK="RETWE_REQUEST_ROOM_LINK",t})(),pd=(()=>{class t extends rh{constructor(t,e,s,i=!0){super(t,e),this._badgeId=s,this._groupBadge=i}get badgeId(){return this._badgeId}get groupBadge(){return this._groupBadge}}return t.LOAD_BADGE="ROBAE_LOAD_BADGE",t})(),Ed=(()=>{class t extends rh{constructor(e,s,i,r,n,a){super(t.DIMMER_STATE,e),this._state=s,this._presetId=i,this._effectId=r,this._color=n,this._brightness=a}get state(){return this._state}get _Str_14686(){return this._presetId}get _Str_6815(){return this._effectId}get color(){return this._color}get _Str_5123(){return this._brightness}}return t.DIMMER_STATE="RODSUE_DIMMER_STATE",t})(),fd=(()=>{class t extends rh{constructor(t,e){super(t,e)}}return t.ADD_HOLE="ROFHO_ADD_HOLE",t.REMOVE_HOLE="ROFHO_REMOVE_HOLE",t})(),Sd=(()=>{class t extends ih{constructor(t,e,s,i,r,n){super(t,e),this._enable=s,this._hue=i,this._saturation=r,this._lightness=n}get enable(){return this._enable}get hue(){return this._hue}get saturation(){return this._saturation}get lightness(){return this._lightness}}return t.ROOM_BACKGROUND_COLOR="ROHSLCEE_ROOM_BACKGROUND_COLOR",t})(),bd=(()=>{class t extends rh{constructor(t,e,s,i,r,n){super(t,e),this._enable=s,this._hue=i,this._saturation=r,this._lightness=n}get enable(){return this._enable}get hue(){return this._hue}get saturation(){return this._saturation}get lightness(){return this._lightness}}return t.ROOM_BACKGROUND_COLOR="ROHSLCEE_ROOM_BACKGROUND_COLOR",t})(),Rd=(()=>{class t extends rh{constructor(t,e){super(t,e)}}return t.POSITION_CHANGED="ROME_POSITION_CHANGED",t.OBJECT_REMOVED="ROME_OBJECT_REMOVED",t})(),Id=(()=>{class t extends rh{constructor(t,e,s=0){super(t,e),this._state=s}get state(){return this._state}}return t.STATE_CHANGE="ROSCE_STATE_CHANGE",t.STATE_RANDOM="ROSCE_STATE_RANDOM",t})();class vd extends nh{constructor(t,e,s,i,r,n,a=!1,o=!1,c=!1,_=!1){super(t,e,s,a,o,c,_),this._tileX=i,this._tileY=r,this._tileZ=n}get tileX(){return this._tileX}get tileY(){return this._tileY}get tileZ(){return this._tileZ}get _Str_16836(){return Math.trunc(this._tileX+.499)}get _Str_17676(){return Math.trunc(this._tileY+.499)}get _Str_21459(){return Math.trunc(this._tileZ+.499)}}class Td extends nh{constructor(t,e,s,i,r,n,a,o,c,_=!1,h=!1,l=!1,u=!1){super(t,e,s,_,h,l,u),this._wallLocation=new ot,this._wallWd=new ot,this._wallHt=new ot,this._wallLocation.assign(i),this._wallWd.assign(r),this._wallHt.assign(n),this._x=a,this._y=o,this._direction=c}get wallLocation(){return this._wallLocation}get wallWidth(){return this._wallWd}get wallHeight(){return this._wallHt}get x(){return this._x}get y(){return this._y}get direction(){return this._direction}}let Od=(()=>{class t extends rh{constructor(t,e){super(t,e)}}return t.OPEN_WIDGET="ROWRE_OPEN_WIDGET",t.CLOSE_WIDGET="ROWRE_CLOSE_WIDGET",t.OPEN_FURNI_CONTEXT_MENU="ROWRE_OPEN_FURNI_CONTEXT_MENU",t.CLOSE_FURNI_CONTEXT_MENU="ROWRE_CLOSE_FURNI_CONTEXT_MENU",t.PLACEHOLDER="ROWRE_PLACEHOLDER",t.CREDITFURNI="ROWRE__CREDITFURNI",t.STICKIE="ROWRE__STICKIE",t.PRESENT="ROWRE_PRESENT",t.TROPHY="ROWRE_TROPHY",t.TEASER="ROWRE_TEASER",t.ECOTRONBOX="ROWRE_ECOTRONBOX",t.DIMMER="ROWRE_DIMMER",t.WIDGET_REMOVE_DIMMER="ROWRE_WIDGET_REMOVE_DIMMER",t.CLOTHING_CHANGE="ROWRE_CLOTHING_CHANGE",t.JUKEBOX_PLAYLIST_EDITOR="ROWRE_JUKEBOX_PLAYLIST_EDITOR",t.MANNEQUIN="ROWRE_MANNEQUIN",t.PET_PRODUCT_MENU="ROWRE_PET_PRODUCT_MENU",t.GUILD_FURNI_CONTEXT_MENU="ROWRE_GUILD_FURNI_CONTEXT_MENU",t.MONSTERPLANT_SEED_PLANT_CONFIRMATION_DIALOG="ROWRE_MONSTERPLANT_SEED_PLANT_CONFIRMATION_DIALOG",t.PURCHASABLE_CLOTHING_CONFIRMATION_DIALOG="ROWRE_PURCHASABLE_CLOTHING_CONFIRMATION_DIALOG",t.BACKGROUND_COLOR="ROWRE_BACKGROUND_COLOR",t.MYSTERYBOX_OPEN_DIALOG="ROWRE_MYSTERYBOX_OPEN_DIALOG",t.EFFECTBOX_OPEN_DIALOG="ROWRE_EFFECTBOX_OPEN_DIALOG",t.MYSTERYTROPHY_OPEN_DIALOG="ROWRE_MYSTERYTROPHY_OPEN_DIALOG",t.ACHIEVEMENT_RESOLUTION_OPEN="ROWRE_ACHIEVEMENT_RESOLUTION_OPEN",t.ACHIEVEMENT_RESOLUTION_ENGRAVING="ROWRE_ACHIEVEMENT_RESOLUTION_ENGRAVING",t.ACHIEVEMENT_RESOLUTION_FAILED="ROWRE_ACHIEVEMENT_RESOLUTION_FAILED",t.FRIEND_FURNITURE_CONFIRM="ROWRE_FRIEND_FURNITURE_CONFIRM",t.FRIEND_FURNITURE_ENGRAVING="ROWRE_FRIEND_FURNITURE_ENGRAVING",t.BADGE_DISPLAY_ENGRAVING="ROWRE_BADGE_DISPLAY_ENGRAVING",t.HIGH_SCORE_DISPLAY="ROWRE_HIGH_SCORE_DISPLAY",t.HIDE_HIGH_SCORE_DISPLAY="ROWRE_HIDE_HIGH_SCORE_DISPLAY",t.INERNAL_LINK="ROWRE_INTERNAL_LINK",t.ROOM_LINK="ROWRE_ROOM_LINK",t})();class Ad extends xh{constructor(t){super(),this._selected=t}get selected(){return this._selected}}class yd extends xh{constructor(t){super(),this._selected=t}get selected(){return this._selected}}class Cd extends ah{constructor(t,e,s,i,r=!1){super(t,null),this._height=e,this._visible=s,this._sourceEventId=i,this._toggleVisibility=r}get height(){return this._height}get visible(){return this._visible}get _Str_20637(){return this._sourceEventId}get toggleVisibility(){return this._toggleVisibility}}let Md=(()=>{class t extends ah{constructor(t){super(null,null),this._type=t}get type(){return this._type}}return t.ENABLED="ROVUM_ENABLED",t.DISABLED="ROVUM_DISABLED",t})(),Dd=(()=>{class t{}return t.OBJECT_UNDEFINED="OBJECT_UNDEFINED",t.OBJECT_MOVE="OBJECT_MOVE",t.OBJECT_PLACE="OBJECT_PLACE",t.OBJECT_ROTATE_POSITIVE="OBJECT_ROTATE_POSITIVE",t.OBJECT_ROTATE_NEGATIVE="OBJECT_ROTATE_NEGATIVE",t.OBJECT_MOVE_TO="OBJECT_MOVE_TO",t.OBJECT_PLACE_TO="OBJECT_PLACE_TO",t.OBJECT_PICKUP="OBJECT_PICKUP",t.OBJECT_PICKUP_BOT="OBJECT_PICKUP_BOT",t.OBJECT_PICKUP_PET="OBJECT_PICKUP_PET",t.OBJECT_EJECT="OBJECT_EJECT",t.OBJECT_SAVE_STUFF_DATA="OBJECT_SAVE_STUFF_DATA",t})();class Nd{constructor(t,e,s,i,r,n=0,a=null,o=null,c=-1,_=-1,h=null){this._id=0,this._category=0,this._operation="",this._loc=null,this._dir=null,this._typeId=0,this._instanceData=null,this._stuffData=null,this._state=-1,this._animFrame=-1,this._posture=null,this._id=t,this._category=e,this._operation=s,this._loc=new ot,this._loc.assign(i),this._dir=new ot,this._dir.assign(r),this._typeId=n,this._instanceData=a,this._stuffData=o,this._state=c,this._animFrame=_,this._posture=h}get id(){return this._id}get category(){return this._category}get operation(){return this._operation}get loc(){return this._loc}get dir(){return this._dir}get typeId(){return this._typeId}get _Str_4766(){return this._instanceData}get stuffData(){return this._stuffData}get state(){return this._state}get _Str_15896(){return this._animFrame}get posture(){return this._posture}dispose(){this._loc=null,this._dir=null}}class wd extends M{constructor(t){super(),this._roomEngine=t,this._eventIds=new Map,this._selectedAvatarId=-1,this._selectedObjectId=-1,this._selectedObjectCategory=-2,this._whereYouClickIsWhereYouGo=!0,this._objectPlacementSource=null,this.onRoomEngineObjectEvent=this.onRoomEngineObjectEvent.bind(this),this._roomEngine.events.addEventListener(Nh.ADDED,this.onRoomEngineObjectEvent)}dispose(){this._eventIds&&(this._eventIds=null),this._roomEngine.events.removeEventListener(Nh.ADDED,this.onRoomEngineObjectEvent),this._roomEngine=null}onRoomEngineObjectEvent(t){let e=this.getSelectedRoomObjectData(t.roomId);if(e&&e.operation===Dd.OBJECT_PLACE&&e.id===t.objectId){const s=this._roomEngine.getRoomObject(t.roomId,e.id,e.category);if(s&&s.model&&e.category===tt.FLOOR){const i=s.model.getValue(st.FURNITURE_ALLOWED_DIRECTIONS);if(i&&i.length){const r=new ot(i[0]);if(s.setDirection(r),this._Str_16022(t.roomId,e.id,e.category,e.loc,r,e.operation,e.typeId,e._Str_4766,e.stuffData,e.state,e._Str_15896,e.posture),e=this.getSelectedRoomObjectData(t.roomId),!e)return}}this.setFurnitureAlphaMultiplier(s,.5)}}_Str_20330(t,e,s){if(!t||!e)return;if(hh.isRunning())return;let i=this._roomEngine.getRoomObjectCategoryForType(e.type);if(i===tt.ROOM||this._roomEngine.isPlayingGame()&&i===tt.UNIT||(i=tt.MINIMUM),this._Str_18648(i,t.type)===t._Str_3463){if(t.type===oh.MOUSE_CLICK||t.type===oh.DOUBLE_CLICK||t.type===oh.MOUSE_DOWN||t.type===oh.MOUSE_UP||t.type===oh.MOUSE_MOVE)return}else t._Str_3463&&this._Str_11142(i,t.type,t._Str_3463);e.mouseHandler&&e.mouseHandler.mouseEvent(t,s)}processRoomObjectPlacement(t,e,s,i,r,n=null,a=null,o=-1,c=-1,_=null){this._objectPlacementSource=t;const h=new ot(-100,-100),l=new ot(0);return this.setSelectedRoomObjectData(e,s,i,h,l,Dd.OBJECT_PLACE,r,n,a,o,c,_),this._roomEngine&&(this._roomEngine._Str_16645(r,i,!1,n,a,o,c,_),this._roomEngine._Str_7972(!1)),!0}_Str_8675(t){return this._Str_13199(t),!0}_Str_18648(t,e){const s=this._eventIds.get(t);return s&&s.get(e)||null}_Str_11142(t,e,s){let i=this._eventIds.get(t);i||(i=new Map,this._eventIds.set(t,i)),i.delete(e),i.set(e,s)}handleRoomObjectEvent(t,e){if(t)if(t instanceof nh)this.handleRoomObjectMouseEvent(t,e);else switch(t.type){case Id.STATE_CHANGE:case Id.STATE_RANDOM:return void this.onRoomObjectStateChangedEvent(t,e);case Ed.DIMMER_STATE:return void this.onRoomObjectDimmerStateUpdateEvent(t,e);case Rd.POSITION_CHANGED:case Rd.OBJECT_REMOVED:return void this.onRoomObjectMoveEvent(t,e);case Od.OPEN_WIDGET:case Od.CLOSE_WIDGET:case Od.OPEN_FURNI_CONTEXT_MENU:case Od.CLOSE_FURNI_CONTEXT_MENU:case Od.PLACEHOLDER:case Od.CREDITFURNI:case Od.STICKIE:case Od.PRESENT:case Od.TROPHY:case Od.TEASER:case Od.ECOTRONBOX:case Od.DIMMER:case Od.WIDGET_REMOVE_DIMMER:case Od.CLOTHING_CHANGE:case Od.JUKEBOX_PLAYLIST_EDITOR:case Od.MANNEQUIN:case Od.PET_PRODUCT_MENU:case Od.GUILD_FURNI_CONTEXT_MENU:case Od.MONSTERPLANT_SEED_PLANT_CONFIRMATION_DIALOG:case Od.PURCHASABLE_CLOTHING_CONFIRMATION_DIALOG:case Od.BACKGROUND_COLOR:case Od.MYSTERYBOX_OPEN_DIALOG:case Od.EFFECTBOX_OPEN_DIALOG:case Od.MYSTERYTROPHY_OPEN_DIALOG:case Od.ACHIEVEMENT_RESOLUTION_OPEN:case Od.ACHIEVEMENT_RESOLUTION_ENGRAVING:case Od.ACHIEVEMENT_RESOLUTION_FAILED:case Od.FRIEND_FURNITURE_CONFIRM:case Od.FRIEND_FURNITURE_ENGRAVING:case Od.BADGE_DISPLAY_ENGRAVING:case Od.HIGH_SCORE_DISPLAY:case Od.HIDE_HIGH_SCORE_DISPLAY:case Od.INERNAL_LINK:case Od.ROOM_LINK:return void this.onRoomObjectWidgetRequestEvent(t,e);case wh.DICE_ACTIVATE:case wh.DICE_OFF:case wh.USE_HABBOWHEEL:case wh.STICKIE:case wh.ENTER_ONEWAYDOOR:return void this.onRoomObjectFurnitureActionEvent(t,e);case fd.ADD_HOLE:case fd.REMOVE_HOLE:return void this.onRoomObjectFloorHoleEvent(t,e);case pd.LOAD_BADGE:return void this.onRoomObjectBadgeAssetEvent(t,e);case wh.MOUSE_ARROW:case wh.MOUSE_BUTTON:return void this.handleMousePointer(t,e);case bd.ROOM_BACKGROUND_COLOR:return void this.onHSLColorEnableEvent(t,e);default:return void D.log("Unhandled Event: "+t.constructor.name,"Object ID: "+t.object.id)}}handleRoomObjectMouseEvent(t,e){if(t&&t.type)switch(t.type){case nh.CLICK:return void this.handleRoomObjectMouseClickEvent(t,e);case nh.MOUSE_MOVE:return void this.handleRoomObjectMouseMoveEvent(t,e);case nh.MOUSE_DOWN:return void this.handleRoomObjectMouseDownEvent(t,e);case nh.MOUSE_ENTER:return void this.handleRoomObjectMouseEnterEvent(t,e);case nh.MOUSE_LEAVE:return void this.handleRoomObjectMouseLeaveEvent(t,e)}}handleRoomObjectMouseClickEvent(t,e){if(!t)return;let s=Dd.OBJECT_UNDEFINED;const i=this.getSelectedRoomObjectData(e);i&&(s=i.operation);let r=!1,n=!1;this._whereYouClickIsWhereYouGo&&(s&&s!==Dd.OBJECT_UNDEFINED||(r=this._Str_23423(e,t)));const a=this._roomEngine.getRoomObjectCategoryForType(t.objectType);switch(s){case Dd.OBJECT_MOVE:a===tt.ROOM?i&&this.processRoomObjectOperation(e,i.id,i.category,Dd.OBJECT_MOVE_TO):a===tt.UNIT&&(i&&t.objectType===et.MONSTER_PLANT&&this.processRoomObjectOperation(e,i.id,i.category,Dd.OBJECT_MOVE_TO),t.eventId||this._Str_11142(tt.ROOM,oh.MOUSE_CLICK,t.eventId),this._Str_19253(e,t.objectId,a)),n=!0,-1!==t.objectId&&this._Str_17481(e,t.objectId,a);break;case Dd.OBJECT_PLACE:if(a===tt.ROOM)this._Str_19271(e,t instanceof vd,t instanceof Td);else if(a===tt.UNIT)switch(t.objectType){case et.MONSTER_PLANT:case et.RENTABLE_BOT:this._Str_19271(e,t instanceof vd,t instanceof Td);break;default:t.eventId&&this._Str_11142(tt.ROOM,oh.MOUSE_CLICK,t.eventId),this._Str_19253(e,t.objectId,a)}break;case Dd.OBJECT_UNDEFINED:a===tt.ROOM?!r&&t instanceof vd&&this.onRoomObjectTileMouseEvent(e,t):(this._Str_17481(e,t.objectId,a),a===tt.UNIT?(!t.ctrlKey||t.altKey||t.shiftKey||t.objectType!==et.RENTABLE_BOT?!t.ctrlKey||t.altKey||t.shiftKey||t.objectType!==et.MONSTER_PLANT?t.ctrlKey||t.altKey||!t.shiftKey||t.objectType!==et.MONSTER_PLANT||this.processRoomObjectOperation(e,t.objectId,a,Dd.OBJECT_ROTATE_POSITIVE):this.processRoomObjectOperation(e,t.objectId,a,Dd.OBJECT_PICKUP_PET):this.processRoomObjectOperation(e,t.objectId,a,Dd.OBJECT_PICKUP_BOT),r=!0):a!==tt.FLOOR&&a!==tt.WALL||(t.altKey||t.ctrlKey||t.shiftKey)&&(t.ctrlKey||t.altKey||!t.shiftKey?!t.ctrlKey||t.altKey||t.shiftKey||this.processRoomObjectOperation(e,t.objectId,a,Dd.OBJECT_PICKUP):a===tt.FLOOR&&this._roomEngine.events&&this._roomEngine.events.dispatchEvent(new Nh(Nh.REQUEST_ROTATE,e,t.objectId,a)),r=!0),t.eventId&&r&&this._Str_11142(tt.ROOM,oh.MOUSE_CLICK,t.eventId))}if(a===tt.ROOM){const s=this._Str_18648(tt.MINIMUM,oh.MOUSE_CLICK),i=this._Str_18648(tt.UNIT,oh.MOUSE_CLICK);s===t.eventId||i===t.eventId||n||(this._Str_16209(e),this._roomEngine.events&&this._roomEngine.events.dispatchEvent(new Nh(Nh.DESELECTED,e,-1,tt.MINIMUM)),this._Str_12227(e,0,!1))}}handleRoomObjectMouseMoveEvent(t,e){if(!t)return;let s=Dd.OBJECT_UNDEFINED;const i=this.getSelectedRoomObjectData(e);i&&(s=i.operation);const r=this._roomEngine.getRoomObjectCategoryForType(t.objectType);if(this._roomEngine){const s=this._roomEngine.getRoomObjectCursor(e);if(s&&s.logic){let i=null;t instanceof vd?i=this._Str_23824(t,e):t.object&&-1!==t.object.id?this._whereYouClickIsWhereYouGo&&(i=this._Str_25124(r,e,t)):i=new Cd(null,0,!1,t.eventId),s.processUpdateMessage(i)}}switch(s){case Dd.OBJECT_MOVE:return void(r===tt.ROOM&&this._Str_24048(t,e));case Dd.OBJECT_PLACE:return void(r===tt.ROOM&&this._Str_22548(t,e))}}handleRoomObjectMouseDownEvent(t,e){if(!t)return;let s=Dd.OBJECT_UNDEFINED;const i=this.getSelectedRoomObjectData(e);i&&(s=i.operation);const r=this._roomEngine.getRoomObjectCategoryForType(t.objectType);switch(s){case Dd.OBJECT_UNDEFINED:return void(r!==tt.FLOOR&&r!==tt.WALL&&t.objectType!==et.MONSTER_PLANT||(t.altKey&&!t.ctrlKey&&!t.shiftKey||this._Str_25211(t))&&this._roomEngine.events&&this._roomEngine.events.dispatchEvent(new Nh(Nh.REQUEST_MOVE,e,t.objectId,r)))}}handleRoomObjectMouseEnterEvent(t,e){const s=t.objectId,i=this._roomEngine.getRoomObjectCategoryForType(t.objectType);this._roomEngine.events&&this._roomEngine.events.dispatchEvent(new Nh(Nh.MOUSE_ENTER,e,s,i))}handleRoomObjectMouseLeaveEvent(t,e){const s=t.objectId,i=this._roomEngine.getRoomObjectCategoryForType(t.objectType);if(i!==tt.ROOM&&i===tt.UNIT){const t=this._roomEngine.getRoomObjectCursor(e);t&&t.processUpdateMessage(new nl(0,null))}this._roomEngine.events&&this._roomEngine.events.dispatchEvent(new Nh(Nh.MOUSE_LEAVE,e,s,i))}onRoomObjectStateChangedEvent(t,e){if(t)switch(t.type){case Id.STATE_CHANGE:return void this.updateRoomObjectState(e,t.object.id,t.object.type,t.state,!1);case Id.STATE_RANDOM:return void this.updateRoomObjectState(e,t.object.id,t.object.type,t.state,!0)}}onRoomObjectDimmerStateUpdateEvent(t,e){if(t)switch(t.type){case Ed.DIMMER_STATE:return void this._roomEngine.events.dispatchEvent(new ud(e,t.state,t._Str_14686,t._Str_6815,t.color,t._Str_5123))}}onRoomObjectMoveEvent(t,e){if(t&&this._roomEngine)switch(t.type){case Rd.POSITION_CHANGED:{const s=t.objectId,i=this._roomEngine.getRoomObjectCategoryForType(t.objectType),r=this._roomEngine.getRoomObject(e,s,i),n=this._roomEngine.getRoomObjectSelectionArrow(e);if(r&&n&&n.logic){const t=r.getLocation();n.logic.processUpdateMessage(new ah(t,null))}return}case Rd.OBJECT_REMOVED:return void this._Str_12227(e,0,!1)}}onRoomObjectWidgetRequestEvent(t,e){if(!t||!this._roomEngine)return;const s=t.objectId,i=this._roomEngine.getRoomObjectCategoryForType(t.objectType),r=this._roomEngine.events;if(r)switch(t.type){case Od.OPEN_WIDGET:return void r.dispatchEvent(new md(md.OPEN_WIDGET,e,s,i,t.object.logic.widget));case Od.CLOSE_WIDGET:return void r.dispatchEvent(new md(md.CLOSE_WIDGET,e,s,i,t.object.logic.widget));case Od.TROPHY:return void r.dispatchEvent(new md(md.REQUEST_TROPHY,e,s,i));case Od.INERNAL_LINK:return void r.dispatchEvent(new md(md.REQUEST_INTERNAL_LINK,e,s,i));case Od.ROOM_LINK:return void r.dispatchEvent(new md(md.REQUEST_ROOM_LINK,e,s,i));case Od.HIGH_SCORE_DISPLAY:return void r.dispatchEvent(new md(md.REQUEST_HIGH_SCORE_DISPLAY,e,s,i));case Od.HIDE_HIGH_SCORE_DISPLAY:return void r.dispatchEvent(new md(md.REQUEST_HIDE_HIGH_SCORE_DISPLAY,e,s,i));case Od.STICKIE:return void r.dispatchEvent(new md(md.REQUEST_STICKIE,e,s,i))}}onRoomObjectFurnitureActionEvent(t,e){t&&this.useObject(e,t.object.id,t.object.type,t.type)}onRoomObjectFloorHoleEvent(t,e){if(t)switch(t.type){case fd.ADD_HOLE:return void this._roomEngine.addRoomInstanceFloorHole(e,t.objectId);case fd.REMOVE_HOLE:return void this._roomEngine.removeRoomInstanceFloorHole(e,t.objectId)}}onRoomObjectBadgeAssetEvent(t,e){if(t&&this._roomEngine)switch(t.type){case pd.LOAD_BADGE:{const s=t.objectId,i=this._roomEngine.getRoomObjectCategoryForType(t.objectType);return void this._roomEngine.loadRoomObjectBadgeImage(e,s,i,t.badgeId,t.groupBadge)}}}handleMousePointer(t,e){t&&this._roomEngine.updateMousePointer(t.type,t.objectId,t.objectType)}onHSLColorEnableEvent(t,e){if(t&&this._roomEngine)switch(t.type){case bd.ROOM_BACKGROUND_COLOR:return void this._roomEngine.events.dispatchEvent(new Sd(Sd.ROOM_BACKGROUND_COLOR,e,t.enable,t.hue,t.saturation,t.lightness))}}onRoomObjectTileMouseEvent(t,e){if(!this._roomEngine||this._roomEngine.isDecorating||!this._roomEngine.roomSessionManager)return;const s=this._roomEngine.roomSessionManager.getSession(t);s&&!s.isSpectator&&this.sendWalkUpdate(e._Str_16836,e._Str_17676)}_Str_24048(t,e){if(!t||!this._roomEngine)return;if(!this._roomEngine.events)return;const s=this.getSelectedRoomObjectData(e);if(!s)return;const i=this._roomEngine.getRoomObject(e,s.id,s.category);if(!i)return;let r=!0;if(s.category===tt.FLOOR||s.category===tt.UNIT){const n=this._roomEngine.getFurnitureStackingHeightMap(e);t instanceof vd&&this._Str_18155(i,s,Math.floor(t.tileX+.5),Math.floor(t.tileY+.5),n)||(this._Str_18155(i,s,s.loc.x,s.loc.y,n),r=!1)}else s.category===tt.WALL&&(r=!1,t instanceof Td&&this._Str_22090(i,s,t.wallLocation,t.wallWidth,t.wallHeight,t.x,t.y,t.direction)&&(r=!0),r||(i.setLocation(s.loc),i.setDirection(s.dir)),this._roomEngine.updateRoomObjectMask(e,s.id,r));r?(this.setFurnitureAlphaMultiplier(i,.5),this._roomEngine._Str_7972(!1)):(this.setFurnitureAlphaMultiplier(i,0),this._roomEngine._Str_7972(!0))}_Str_22548(t,e){if(!t||!this._roomEngine)return;if(!this._roomEngine.events)return;const s=this.getSelectedRoomObjectData(e);if(!s)return;const i=this._roomEngine.getRoomObject(e,s.id,s.category);if(i){let r=!0;const n=this._roomEngine.getFurnitureStackingHeightMap(e);s.category===tt.FLOOR?t instanceof vd&&this._Str_18155(i,s,t._Str_16836,t._Str_17676,n)||(this._roomEngine.removeRoomObjectFloor(e,s.id),r=!1):s.category===tt.WALL?(r=!1,t instanceof Td&&this._Str_22090(i,s,t.wallLocation,t.wallWidth,t.wallHeight,t.x,t.y,t.direction)&&(r=!0),r||this._roomEngine.removeRoomObjectWall(e,s.id),this._roomEngine.updateRoomObjectMask(e,s.id,r)):s.category===tt.UNIT&&t instanceof vd&&!this._Str_25586(i,Math.floor(t.tileX+.5),Math.floor(t.tileY+.5),this._roomEngine.getLegacyWallGeometry(e))&&(this._roomEngine.removeRoomObjectUser(e,s.id),r=!1),this._roomEngine._Str_7972(!r)}else{if(s.category===tt.FLOOR&&t instanceof vd)this._roomEngine.addFurnitureFloor(e,s.id,s.typeId,s.loc,s.dir,0,s.stuffData,parseInt(s._Str_4766),-1,0,0,"",!1);else if(s.category===tt.WALL&&t instanceof Td)this._roomEngine.addFurnitureWall(e,s.id,s.typeId,s.loc,s.dir,0,s._Str_4766,0);else if(s.category===tt.UNIT&&t instanceof vd){this._roomEngine.addRoomObjectUser(e,s.id,new ot,new ot(180),180,s.typeId,s._Str_4766);const t=this._roomEngine.getRoomObject(e,s.id,s.category);t&&s.posture&&t.model.setValue(st.FIGURE_POSTURE,s.posture)}this._roomEngine._Str_7972(!0)}}_Str_18155(t,e,s,i,r){if(!t||!e)return!1;const n=new ot;n.assign(t.getDirection()),t.setDirection(e.dir);const a=new ot(s,i,0),o=new ot;o.assign(t.getDirection());let c=this._Str_21004(t,a,e.loc,e.dir,r);return c||(o.x=this._Str_17555(t,!0),t.setDirection(o),c=this._Str_21004(t,a,e.loc,e.dir,r)),c?(t.setLocation(c),o&&t.setDirection(o),!0):(t.setDirection(n),!1)}_Str_22090(t,e,s,i,r,n,a,o){if(!t||!e)return!1;const c=new ot(o),_=this._Str_25568(t,s,i,r,n,a,e);return!!_&&(t.setLocation(_),t.setDirection(c),!0)}_Str_21004(t,e,s,i,r){if(!t||!t.model||!e)return null;let n=null;const a=t.getDirection();if(!a)return null;if(!s||!i)return null;if(e.x===s.x&&e.y===s.y&&a.x===i.x)return n=new ot,n.assign(s),n;let o=t.model.getValue(st.FURNITURE_SIZE_X),c=t.model.getValue(st.FURNITURE_SIZE_Y);o<1&&(o=1),c<1&&(c=1);const _=s.x,h=s.y;let l=o,u=c,d=0,g=Math.trunc(Math.trunc(a.x+45)%360/90);if(1!==g&&3!==g||(d=o,o=c,c=d),g=Math.trunc(Math.trunc(i.x+45)%360/90),1!==g&&3!==g||(d=l,l=u,u=d),r&&e){const s=1===t.model.getValue(st.FURNITURE_ALWAYS_STACKABLE);return r.validateLocation(e.x,e.y,o,c,_,h,l,u,s)?new ot(e.x,e.y,r.getTileHeight(e.x,e.y)):null}return null}_Str_25568(t,e,s,i,r,n,a){if(null==t||null==t.model||null==e||null==s||null==i||null==a)return null;const o=t.model.getValue(st.FURNITURE_SIZE_X),c=t.model.getValue(st.FURNITURE_SIZE_Z),_=t.model.getValue(st.FURNITURE_CENTER_Z);if((r<o/2||r>s.length-o/2||n<_||n>i.length-(c-_))&&(r<o/2&&r<=s.length-o/2?r=o/2:r>=o/2&&r>s.length-o/2&&(r=s.length-o/2),n<_&&n<=i.length-(c-_)?n=_:n>=_&&n>i.length-(c-_)&&(n=i.length-(c-_))),r<o/2||r>s.length-o/2||n<_||n>i.length-(c-_))return null;let h=ot.sum(ot.product(s,r/s.length),ot.product(i,n/i.length));return h=ot.sum(e,h),h}updateRoomObjectState(t,e,s,i,r){const n=this._roomEngine.getRoomObjectCategoryForType(s);this.sendStateUpdate(t,e,n,i,r)}useObject(t,e,s,i){if(this._roomEngine&&this._roomEngine.connection)switch(i){case wh.DICE_ACTIVATE:return void this._roomEngine.connection.send(new h_(e));case wh.DICE_OFF:return void this._roomEngine.connection.send(new l_(e));case wh.USE_HABBOWHEEL:return void this._roomEngine.connection.send(new __(e));case wh.STICKIE:return void this._roomEngine.connection.send(new Jc(e));case wh.ENTER_ONEWAYDOOR:return void this._roomEngine.connection.send(new d_(e))}}sendStateUpdate(t,e,s,i,r){return!this._roomEngine||!this._roomEngine.connection||(s===tt.FLOOR?this._roomEngine.connection.send(r?new g_(e,i):new u_(e,i)):s===tt.WALL&&this._roomEngine.connection.send(new p_(e,i)),!0)}sendWalkUpdate(t,e){this._roomEngine&&this._roomEngine.connection&&this._roomEngine.connection.send(new w_(t,e))}_Str_25124(t,e,s){if(t!==tt.FLOOR)return null;const i=this._roomEngine.getRoomObject(e,s.objectId,tt.FLOOR);if(!i)return null;const r=this._Str_21925(i,s);if(!r)return null;if(!this._roomEngine.getFurnitureStackingHeightMap(e))return null;const n=r.z;return new Cd(new ot(r.x,r.y,i.getLocation().z),n,!0,s.eventId)}_Str_23423(t,e){const s=this._roomEngine.getRoomObject(t,e.objectId,tt.FLOOR),i=this._Str_21925(s,e);return!!i&&(this.sendWalkUpdate(i.x,i.y),!0)}_Str_21925(t,e){if(!t||!e)return null;const s=this._roomEngine.sessionDataManager.getFloorItemDataByName(t.type);if(!s)return null;if(!s.canStandOn&&!s.canSitOn&&!s.canLayOn)return null;const i=t.model;if(!i)return null;const r=t.getLocation(),n=t.getDirection();let a=i.getValue(st.FURNITURE_SIZE_X),o=i.getValue(st.FURNITURE_SIZE_Y);const c=i.getValue(st.FURNITURE_SIZE_Z);90!==n.x&&270!==n.x||([a,o]=[o,a]),a<1&&(a=1),o<1&&(o=1);const _=this._roomEngine.getActiveRoomInstanceRenderingCanvas();if(!_)return null;const h=_.geometry.scale,l=(h/2+e.spriteOffsetX+e.localX)/(h/4),u=(e.spriteOffsetY+e.localY+(c-(s.canSitOn?.5:0))*h/2)/(h/4),d=(l-2*u)/4,g=Math.floor(r.x+(l+2*u)/4),m=Math.floor(r.y-d+1);let p=!1;return(g<r.x||g>=r.x+a||m<r.y||m>=r.y+o)&&(p=!0),p?null:new ot(g,m,s.canSitOn?c-.5:c)}_Str_23824(t,e){if(this._whereYouClickIsWhereYouGo)return new Cd(new ot(t._Str_16836,t._Str_17676,t._Str_21459),0,!0,t.eventId);const s=this._roomEngine.getRoomObjectCursor(e);if(s&&s.visualization){const s=t._Str_16836,i=t._Str_17676,r=t._Str_21459;if(this._roomEngine.getRoomInstance(e)){const n=this._roomEngine.getRoomTileObjectMap(e);if(n){const a=n._Str_19056(s,i),o=this._roomEngine.getFurnitureStackingHeightMap(e);if(o){if(a&&a.model&&a.model.getValue(st.FURNITURE_IS_VARIABLE_HEIGHT)>0){const n=o.getTileHeight(s,i),a=this._roomEngine.getLegacyWallGeometry(e).getHeight(s,i);return new Cd(new ot(s,i,r),n-a,!0,t.eventId)}return new Cd(new ot(s,i,r),0,!0,t.eventId)}}}}return null}_Str_19271(t,e,s){const i=this.getSelectedRoomObjectData(t);if(!i)return;let r=null,n=i.id;const a=i.category;let o=0,c=0,_=0,h=0,l="";if(this._roomEngine&&this._roomEngine.connection&&(r=this._roomEngine.getRoomObject(t,n,a),r)){const e=r.getLocation();if(h=r.getDirection().x,a===tt.FLOOR||a===tt.UNIT)o=e.x,c=e.y,_=e.z;else if(a===tt.WALL){o=e.x,c=e.y,_=e.z;const s=this._roomEngine.getLegacyWallGeometry(t);s&&(l=s._Str_21860(e,h))}h=(h/45%8+8)%8,n<0&&a===tt.UNIT&&(n*=-1),this._objectPlacementSource!==ld.CATALOG&&(a===tt.UNIT?i.typeId===Za.PET||i.typeId===Za.RENTABLE_BOT&&this._roomEngine.connection.send(new $c(n,Math.floor(o),Math.floor(c))):void 0!==r.model.getValue(st.FURNITURE_IS_STICKIE)?this._roomEngine.connection.send(new c_(n,l)):this._roomEngine.connection.send(new a_(n,a,l,o,c,h)))}this._roomEngine.setPlacedRoomObjectData(t,new Nd(i.id,i.category,null,i.dir,null)),this._Str_13199(t),this._roomEngine&&this._roomEngine.events&&this._roomEngine.events.dispatchEvent(new dd(Nh.PLACED,t,n,a,l,o,c,_,h,r&&r.id===i.id,e,s,i._Str_4766))}processRoomObjectWallOperation(t,e,s,i,r){return!!this._roomEngine&&!!this._roomEngine.getRoomObject(t,e,s)}processRoomObjectFloorOperation(t,e,s,i){return!!this._roomEngine}processRoomObjectOperation(t,e,s,i){if(!this._roomEngine)return!1;const r=this._roomEngine.getRoomObject(t,e,s);if(!r)return!1;let n=!0;switch(i){case Dd.OBJECT_ROTATE_POSITIVE:case Dd.OBJECT_ROTATE_NEGATIVE:if(this._roomEngine.connection){let s=0;s=this._Str_17555(r,i!=Dd.OBJECT_ROTATE_NEGATIVE);const n=r.getLocation().x,a=r.getLocation().y;if(this.isValidLocation(r,new ot(s),this._roomEngine.getFurnitureStackingHeightMap(t)))if(s=Math.trunc(s/45),r.type===et.MONSTER_PLANT){const s=this._roomEngine.roomSessionManager.getSession(t);s&&s.userDataManager.getUserDataByIndex(e)}else this._roomEngine.connection.send(new i_(e,n,a,s))}break;case Dd.OBJECT_EJECT:case Dd.OBJECT_PICKUP:this._roomEngine.connection&&this._roomEngine.connection.send(new n_(s,e));break;case Dd.OBJECT_PICKUP_PET:if(this._roomEngine.connection){const s=this._roomEngine.roomSessionManager.getSession(t);if(s){const t=s.userDataManager.getUserDataByIndex(e);s.pickupPet(t.webID)}}break;case Dd.OBJECT_PICKUP_BOT:if(this._roomEngine.connection){const s=this._roomEngine.roomSessionManager.getSession(t);if(s){const t=s.userDataManager.getUserDataByIndex(e);s.pickupBot(t.webID)}}break;case Dd.OBJECT_MOVE:n=!1,this.setFurnitureAlphaMultiplier(r,.5),this.setSelectedRoomObjectData(t,r.id,s,r.getLocation(),r.getDirection(),i),this._roomEngine._Str_16645(r.id,s,!0),this._roomEngine._Str_7972(!1);break;case Dd.OBJECT_MOVE_TO:{const i=this.getSelectedRoomObjectData(t);if(this._Str_16022(t,i.id,i.category,i.loc,i.dir,Dd.OBJECT_MOVE_TO,i.typeId,i._Str_4766,i.stuffData,i.state,i._Str_15896,i.posture),this.setFurnitureAlphaMultiplier(r,1),this._roomEngine._Str_17948(),this._roomEngine.connection)if(s===tt.FLOOR){const t=r.getDirection().x%360,s=r.getLocation();this._roomEngine.connection.send(new i_(e,s.x,s.y,t/45))}else if(s===tt.WALL){const s=r.getDirection().x%360,i=this._roomEngine.getLegacyWallGeometry(t);if(i){const t=i._Str_21860(r.getLocation(),s);t&&this._roomEngine.connection.send(new E_(e,t))}}break}}return n&&this._Str_13199(t),!0}_Str_17555(t,e){if(!t||!t.model)return 0;let s=0,i=0,r=[];r=t.model.getValue(t.type===et.MONSTER_PLANT?st.PET_ALLOWED_DIRECTIONS:st.FURNITURE_ALLOWED_DIRECTIONS);let n=t.getDirection().x;if(r&&r.length){if(s=r.indexOf(n),s<0){for(s=0,i=0;i<r.length&&!(n<=r[i]);)s++,i++;s%=r.length}s=e?(s+1)%r.length:(s-1+r.length)%r.length,n=r[s]}return n}isValidLocation(t,e,s){if(!t||!t.model||!e)return!1;const i=t.getDirection(),r=t.getLocation();if(!i||!r)return!1;if(i.x%180==e.x%180)return!0;let n=t.model.getValue(st.FURNITURE_SIZE_X),a=t.model.getValue(st.FURNITURE_SIZE_Y);n<1&&(n=1),a<1&&(a=1);let o=n,c=a,_=Math.trunc(Math.trunc(e.x+45)%360/90);if(1!==_&&3!==_||([n,a]=[a,n]),_=Math.trunc(Math.trunc(i.x+45)%360/90),1!==_&&3!==_||([o,c]=[c,o]),s&&r){const e=1===t.model.getValue(st.FURNITURE_ALWAYS_STACKABLE);if(s.validateLocation(r.x,r.y,n,a,r.x,r.y,o,c,e,r.z))return!0}return!1}_Str_19253(t,e,s){const i=this.getSelectedRoomObjectData(t);i&&this._roomEngine.getRoomObject(t,e,s)&&this._roomEngine&&this._roomEngine.events&&this._roomEngine.events.dispatchEvent(new gd(Nh.PLACED_ON_USER,t,e,s,i.id,i.category))}_Str_17481(t,e,s){if(!this._roomEngine)return;const i=this._roomEngine.events;if(i)switch(s){case tt.UNIT:case tt.FLOOR:case tt.WALL:if(s===tt.UNIT)this._Str_16209(t),this._Str_12227(t,e,!0);else if(this._Str_12227(t,0,!1),e!==this._selectedObjectId){this._Str_16209(t);const i=this._roomEngine.getRoomObject(t,e,s);i&&i.logic&&(i.logic.processUpdateMessage(new yd(!0)),this._selectedObjectId=e,this._selectedObjectCategory=s)}return void i.dispatchEvent(new Nh(Nh.SELECTED,t,e,s))}}_Str_16209(t){if(-1===this._selectedObjectId)return;const e=this._roomEngine.getRoomObject(t,this._selectedObjectId,this._selectedObjectCategory);e&&e.logic&&(e.logic.processUpdateMessage(new yd(!1)),this._selectedObjectId=-1,this._selectedObjectCategory=tt.MINIMUM)}_Str_12227(t,e,s){if(!this._roomEngine)return;const i=tt.UNIT,r=this._roomEngine.getRoomObject(t,this._selectedAvatarId,i);r&&r.logic&&(r.logic.processUpdateMessage(new Ad(!1)),this._selectedAvatarId=-1);let n=!1;if(s){const s=this._roomEngine.getRoomObject(t,e,i);if(s&&s.logic){s.logic.processUpdateMessage(new Ad(!0)),n=!0,this._selectedAvatarId=e;const t=s.getLocation();t&&this._roomEngine.connection.send(new M_(~~t.x,~~t.y))}}const a=this._roomEngine.getRoomObjectSelectionArrow(t);a&&a.logic&&a.logic.processUpdateMessage(new Md(n?Md.ENABLED:Md.DISABLED))}_Str_13199(t){if(!this._roomEngine)return;this._roomEngine._Str_17948();const e=this.getSelectedRoomObjectData(t);if(e){if(e.operation===Dd.OBJECT_MOVE||e.operation===Dd.OBJECT_MOVE_TO){const s=this._roomEngine.getRoomObject(t,e.id,e.category);s&&e.operation!==Dd.OBJECT_MOVE_TO&&(s.setLocation(e.loc),s.setDirection(e.dir)),this.setFurnitureAlphaMultiplier(s,1),e.category===tt.WALL&&this._roomEngine.updateRoomObjectMask(t,e.id,!0),this._Str_16022(t,e.id,e.category,e.loc,e.dir,Dd.OBJECT_MOVE,e.typeId,e._Str_4766,e.stuffData,e.state,e._Str_15896,e.posture)}else if(e.operation===Dd.OBJECT_PLACE){const s=e.id;switch(e.category){case tt.FLOOR:this._roomEngine.removeRoomObjectFloor(t,s);break;case tt.WALL:this._roomEngine.removeRoomObjectWall(t,s);break;case tt.UNIT:this._roomEngine.removeRoomObjectUser(t,s)}}this._roomEngine.setSelectedRoomObjectData(t,null)}}getSelectedRoomObjectData(t){return this._roomEngine?this._roomEngine.getSelectedRoomObjectData(t):null}setFurnitureAlphaMultiplier(t,e){t&&t.model&&t.model.setValue(st.FURNITURE_ALPHA_MULTIPLIER,e)}_Str_25211(t){return this._roomEngine.isDecorating&&!(t.ctrlKey||t.shiftKey)}cancelRoomObjectPlacement(t){return this._Str_13199(t),!0}setSelectedRoomObjectData(t,e,s,i,r,n,a=0,o=null,c=null,_=-1,h=-1,l=null){if(this._Str_13199(t),!this._roomEngine)return;const u=new Nd(e,s,n,i,r,a,o,c,_,h,l);this._roomEngine.setSelectedRoomObjectData(t,u)}_Str_16022(t,e,s,i,r,n,a=0,o=null,c=null,_=-1,h=-1,l=null){if(!this._roomEngine)return null;const u=new Nd(e,s,n,i,r,a,o,c,_,h,l);this._roomEngine.setSelectedRoomObjectData(t,u)}_Str_25586(t,e,s,i){return!!i._Str_10375(e,s)&&(t.setLocation(new ot(e,s,i.getHeight(e,s))),!0)}modifyWallItemData(t,e,s,i){return!(!this._roomEngine||!this._roomEngine.connection||(this._roomEngine.connection.send(new Qc(e,s,i)),0))}deleteWallItem(t,e){return!(!this._roomEngine||!this._roomEngine.connection||(this._roomEngine.connection.send(new e_(e)),0))}get engine(){return this._roomEngine}get selectedAvatarId(){return this._selectedAvatarId}}class Ud extends M{constructor(){super(),this._object=null,this._events=null,this._time=0}initialize(t){}onDispose(){this._object=null}update(t){this._time=t}processUpdateMessage(t){t&&this._object&&(this._object.setLocation(t.location),this._object.setDirection(t.direction))}getEventTypes(){return[]}mergeTypes(t,e){const s=t.concat();for(const i of e)!i||s.indexOf(i)>=0||s.push(i);return s}mouseEvent(t,e){}useObject(){}setObject(t){if(this._object!==t){if(this._object&&this._object.setLogic(null),!t)return this.dispose(),void(this._object=null);this._object=t,this._object.setLogic(this)}}tearDown(){}get object(){return this._object}get eventDispatcher(){return this._events}set eventDispatcher(t){this._events=t}get widget(){return null}get contextMenu(){return null}get time(){return this._time}}let Ld=(()=>{class t extends Ud{constructor(){super(),this._liftAmount=0,this._location=new ot,this._locationDelta=new ot,this._lastUpdateTime=0,this._changeTime=0,this._updateInterval=500}dispose(){this._liftAmount=0,super.dispose()}update(e){super.update(e);const s=this.getLocationOffset(),i=this.object&&this.object.model;if(i&&(s?this._liftAmount!==s.z&&(this._liftAmount=s.z,i.setValue(st.FURNITURE_LIFT_AMOUNT,this._liftAmount)):0!==this._liftAmount&&(this._liftAmount=0,i.setValue(st.FURNITURE_LIFT_AMOUNT,this._liftAmount))),this._locationDelta.length>0||s){const e=t.TEMP_VECTOR;let i=this.time-this._changeTime;i===this._updateInterval>>1&&i++,i>this._updateInterval&&(i=this._updateInterval),this._locationDelta.length>0?(e.assign(this._locationDelta),e.multiply(i/this._updateInterval),e.add(this._location)):e.assign(this._location),s&&e.add(s),this.object.setLocation(e),i===this._updateInterval&&(this._locationDelta.x=0,this._locationDelta.y=0,this._locationDelta.z=0)}this._lastUpdateTime=this.time}setObject(t){super.setObject(t),t&&this._location.assign(t.getLocation())}processUpdateMessage(t){if(t)return super.processUpdateMessage(t),t.location&&this._location.assign(t.location),t instanceof sl?this.processMoveMessage(t):void 0}processMoveMessage(t){t&&this.object&&t.location&&(this._changeTime=this._lastUpdateTime,this._locationDelta.assign(t.targetLocation),this._locationDelta.subtract(this._location))}getLocationOffset(){return null}get lastUpdateTime(){return this._lastUpdateTime}}return t.TEMP_VECTOR=new ot,t})(),Pd=(()=>{class t extends Ld{constructor(){super(),this._selected=!1,this._reportedLocation=null,this._effectChangeTimeStamp=0,this._newEffect=0,this._blinkingStartTimestamp=um.instance.time+this.randomBlinkStartTimestamp(),this._blinkingEndTimestamp=0,this._talkingEndTimestamp=0,this._talkingPauseStartTimestamp=0,this._talkingPauseEndTimestamp=0,this._carryObjectStartTimestamp=0,this._carryObjectEndTimestamp=0,this._allowUseCarryObject=!1,this._animationEndTimestamp=0,this._signEndTimestamp=0,this._gestureEndTimestamp=0,this._numberValueEndTimestamp=0}getEventTypes(){const t=[nh.CLICK,Rd.POSITION_CHANGED,nh.MOUSE_ENTER,nh.MOUSE_LEAVE,wh.MOUSE_BUTTON,wh.MOUSE_ARROW];return this.mergeTypes(super.getEventTypes(),t)}dispose(){this._selected&&this.object&&this.eventDispatcher&&this.eventDispatcher.dispatchEvent(new Rd(Rd.OBJECT_REMOVED,this.object)),super.dispose(),this._reportedLocation=null}update(t){if(super.update(t),this._selected&&this.object&&this.eventDispatcher){const t=this.object.getLocation();this._reportedLocation&&this._reportedLocation.x===t.x&&this._reportedLocation.y===t.y&&this._reportedLocation.z===t.z||(this._reportedLocation||(this._reportedLocation=new ot),this._reportedLocation.assign(t),this.eventDispatcher.dispatchEvent(new Rd(Rd.POSITION_CHANGED,this.object)))}const e=this.object&&this.object.model;e&&this.updateModel(this.time,e)}updateModel(t,e){this._talkingEndTimestamp>0&&(t>this._talkingEndTimestamp?(e.setValue(st.FIGURE_TALK,0),this._talkingEndTimestamp=0,this._talkingPauseStartTimestamp=0,this._talkingPauseEndTimestamp=0):this._talkingPauseEndTimestamp||this._talkingPauseStartTimestamp?this._talkingPauseStartTimestamp>0&&t>this._talkingPauseStartTimestamp?(e.setValue(st.FIGURE_TALK,0),this._talkingPauseStartTimestamp=0):this._talkingPauseEndTimestamp>0&&t>this._talkingPauseEndTimestamp&&(e.setValue(st.FIGURE_TALK,1),this._talkingPauseEndTimestamp=0):(this._talkingPauseStartTimestamp=t+this.randomTalkingPauseStartTimestamp(),this._talkingPauseEndTimestamp=this._talkingPauseStartTimestamp+this.randomTalkingPauseEndTimestamp())),this._animationEndTimestamp>0&&t>this._animationEndTimestamp&&(e.setValue(st.FIGURE_EXPRESSION,0),this._animationEndTimestamp=0),this._gestureEndTimestamp>0&&t>this._gestureEndTimestamp&&(e.setValue(st.FIGURE_GESTURE,0),this._gestureEndTimestamp=0),this._signEndTimestamp>0&&t>this._signEndTimestamp&&(e.setValue(st.FIGURE_SIGN,-1),this._signEndTimestamp=0),this._carryObjectEndTimestamp>0&&t>this._carryObjectEndTimestamp&&(e.setValue(st.FIGURE_CARRY_OBJECT,0),e.setValue(st.FIGURE_USE_OBJECT,0),this._carryObjectStartTimestamp=0,this._carryObjectEndTimestamp=0,this._allowUseCarryObject=!1),this._allowUseCarryObject&&t-this._carryObjectStartTimestamp>5e3&&e.setValue(st.FIGURE_USE_OBJECT,(t-this._carryObjectStartTimestamp)%1e4<1e3?1:0),this._blinkingStartTimestamp>-1&&t>this._blinkingStartTimestamp&&(e.setValue(st.FIGURE_BLINK,1),this._blinkingStartTimestamp=t+this.randomBlinkStartTimestamp(),this._blinkingEndTimestamp=t+this.randomBlinkEndTimestamp()),this._blinkingEndTimestamp>0&&t>this._blinkingEndTimestamp&&(e.setValue(st.FIGURE_BLINK,0),this._blinkingEndTimestamp=0),this._effectChangeTimeStamp>0&&t>this._effectChangeTimeStamp&&(e.setValue(st.FIGURE_EFFECT,this._newEffect),this._effectChangeTimeStamp=0),this._numberValueEndTimestamp>0&&t>this._numberValueEndTimestamp&&(e.setValue(st.FIGURE_NUMBER_VALUE,0),this._numberValueEndTimestamp=0)}processUpdateMessage(e){if(!e||!this.object)return;super.processUpdateMessage(e);const s=this.object&&this.object.model;if(s){if(e instanceof Qh)return s.setValue(st.FIGURE_POSTURE,e.postureType),void s.setValue(st.FIGURE_POSTURE_PARAMETER,e.parameter);if(e instanceof Gh)return s.setValue(st.FIGURE_TALK,1),void(this._talkingEndTimestamp=this.time+1e3*e.numberOfWords);if(e instanceof el)s.setValue(st.FIGURE_IS_TYPING,e.isTyping?1:0);else{if(e instanceof il)return s.setValue(st.HEAD_DIRECTION,e.headDirection),s.setValue(st.FIGURE_CAN_STAND_UP,e.canStandUp),void s.setValue(st.FIGURE_VERTICAL_OFFSET,e.baseY);if(e instanceof Wh)return s.setValue(st.FIGURE_GESTURE,e.gesture),void(this._gestureEndTimestamp=this.time+3e3);if(e instanceof jh)return s.setValue(st.FIGURE_EXPRESSION,e.expressionType),this._animationEndTimestamp=Lt.getExpressionTimeout(s.getValue(st.FIGURE_EXPRESSION)),void(this._animationEndTimestamp>-1&&(this._animationEndTimestamp+=this.time));if(e instanceof Vh)s.setValue(st.FIGURE_DANCE,e.danceStyle);else{if(e instanceof tl)return s.setValue(st.FIGURE_SLEEP,e.isSleeping?1:0),void(this._blinkingStartTimestamp=e.isSleeping?-1:this.time+this.randomBlinkStartTimestamp());if(e instanceof qh)return s.setValue(st.FIGURE_NUMBER_VALUE,e.value),void(this._numberValueEndTimestamp=this.time+3e3);if(e instanceof Yh)this.updateAvatarEffect(e.effect,e.delayMilliseconds,s);else{if(e instanceof Fh)return s.setValue(st.FIGURE_CARRY_OBJECT,e.itemType),s.setValue(st.FIGURE_USE_OBJECT,0),void(0===e.itemType?(this._carryObjectStartTimestamp=0,this._carryObjectEndTimestamp=0,this._allowUseCarryObject=!1):(this._carryObjectStartTimestamp=this.time,e.itemType<t.MAX_HAND_ID?(this._carryObjectEndTimestamp=0,this._allowUseCarryObject=e.itemType<=t.MAX_HAND_USE_ID):(this._carryObjectEndTimestamp=this._carryObjectStartTimestamp+1500,this._allowUseCarryObject=!1)));if(e instanceof rl)s.setValue(st.FIGURE_USE_OBJECT,e.itemType);else{if(e instanceof $h)return s.setValue(st.FIGURE_SIGN,e.signType),void(this._signEndTimestamp=this.time+5e3);if(!(e instanceof Hh))return e instanceof Bh?(s.setValue(st.FIGURE,e.figure),void s.setValue(st.GENDER,e.gender)):e instanceof Ad?(this._selected=e.selected,void(this._reportedLocation=null)):void(e instanceof Xh&&s.setValue(st.OWN_USER,1));s.setValue(st.FIGURE_FLAT_CONTROL,e.level)}}}}}}updateAvatarEffect(e,s,i){if(e===t._Str_13364)this._effectChangeTimeStamp=um.instance.time+t._Str_8860,this._newEffect=t._Str_15351;else if(e===t._Str_13733)this._effectChangeTimeStamp=um.instance.time+t._Str_8860,this._newEffect=t._Str_13094;else if(i.getValue(st.FIGURE_EFFECT)===t._Str_15351)this._effectChangeTimeStamp=um.instance.time+t._Str_8860,this._newEffect=e,e=t._Str_13364;else if(i.getValue(st.FIGURE_EFFECT)===t._Str_13094)this._effectChangeTimeStamp=um.instance.time+t._Str_8860,this._newEffect=e,e=t._Str_13733;else{if(0!==s)return this._effectChangeTimeStamp=um.instance.time+s,void(this._newEffect=e);this._effectChangeTimeStamp=0}i.setValue(st.FIGURE_EFFECT,e)}mouseEvent(t,e){let s=null;switch(t.type){case oh.MOUSE_CLICK:s=nh.CLICK;break;case oh.ROLL_OVER:s=nh.MOUSE_ENTER,this.object.model&&this.object.model.setValue(st.FIGURE_HIGHLIGHT,1),this.eventDispatcher&&this.eventDispatcher.dispatchEvent(new wh(wh.MOUSE_BUTTON,this.object));break;case oh.ROLL_OUT:s=nh.MOUSE_LEAVE,this.object.model&&this.object.model.setValue(st.FIGURE_HIGHLIGHT,0),this.eventDispatcher&&this.eventDispatcher.dispatchEvent(new wh(wh.MOUSE_ARROW,this.object))}s&&this.eventDispatcher&&this.eventDispatcher.dispatchEvent(new nh(s,this.object,t._Str_3463,t.altKey,t.ctrlKey,t.shiftKey,t.buttonDown))}randomTalkingPauseStartTimestamp(){return 100+200*Math.random()}randomTalkingPauseEndTimestamp(){return 75+75*Math.random()}randomBlinkStartTimestamp(){return 4500+1e3*Math.random()}randomBlinkEndTimestamp(){return 50+200*Math.random()}}return t.MAX_HAND_ID=999999999,t.MAX_HAND_USE_ID=999,t._Str_13364=28,t._Str_8860=500,t._Str_15351=29,t._Str_13733=184,t._Str_13094=185,t})(),xd=(()=>{class t extends Ld{constructor(){super(),this._sizeX=0,this._sizeY=0,this._sizeZ=0,this._centerX=0,this._centerY=0,this._centerZ=0,this._directions=[],this._mouseOver=!1,this._locationOffset=new ot,this._bouncingStep=0,this._storedRotateMessage=null,this._directionInitialized=!1}getEventTypes(){const t=[Id.STATE_CHANGE,nh.CLICK,nh.MOUSE_DOWN];return this.widget&&t.push(Od.OPEN_WIDGET,Od.CLOSE_WIDGET),this.contextMenu&&t.push(Od.OPEN_FURNI_CONTEXT_MENU,Od.CLOSE_FURNI_CONTEXT_MENU),this.mergeTypes(super.getEventTypes(),t)}initialize(t){if(!t)return;const e=this.object&&this.object.model;if(!e)return;const s=t.dimensions;if(!s)return;this._sizeX=s.x,this._sizeY=s.y,this._sizeZ=s.z,this._centerX=this._sizeX/2,this._centerY=this._sizeY/2,this._centerZ=this._sizeZ/2;const i=t.directions;if(i&&i.length){for(const t of i)this._directions.push(t);this._directions.sort((t,e)=>t-e)}e.setValue(st.FURNITURE_SIZE_X,this._sizeX),e.setValue(st.FURNITURE_SIZE_Y,this._sizeY),e.setValue(st.FURNITURE_SIZE_Z,this._sizeZ),e.setValue(st.FURNITURE_CENTER_X,this._centerX),e.setValue(st.FURNITURE_CENTER_Y,this._centerY),e.setValue(st.FURNITURE_CENTER_Z,this._centerZ),e.setValue(st.FURNITURE_ALLOWED_DIRECTIONS,this._directions),e.setValue(st.FURNITURE_ALPHA_MULTIPLIER,1)}dispose(){super.dispose(),this._storedRotateMessage=null,this._directions=null}setObject(t){super.setObject(t),t&&t.getLocation().length&&(this._directionInitialized=!0)}getAdClickUrl(t){return t.getValue(st.FURNITURE_AD_URL)}update(e){super.update(e),this._bouncingStep>0&&(this._bouncingStep++,this._bouncingStep>t.BOUNCING_STEPS&&(this._bouncingStep=0))}processUpdateMessage(t){if(t instanceof nl)this.processDataUpdateMessage(t);else if(t instanceof ol)this.processObjectHeightUpdateMessage(t);else if(t instanceof cl)this.processItemDataUpdateMessage(t);else{if(this._mouseOver=!1,t.location&&t.direction){if(!(t instanceof sl)){const e=this.object.getDirection(),s=this.object.getLocation();e.x!==t.direction.x&&this._directionInitialized&&s.x===t.location.x&&s.y===t.location.y&&s.z===t.location.z&&(this._bouncingStep=1,this._storedRotateMessage=new ah(t.location,t.direction),t=null)}this._directionInitialized=!0}t instanceof yd&&this.contextMenu&&this.eventDispatcher&&this.object&&this.eventDispatcher.dispatchEvent(new Od(t.selected?Od.OPEN_FURNI_CONTEXT_MENU:Od.CLOSE_FURNI_CONTEXT_MENU,this.object)),super.processUpdateMessage(t)}}processDataUpdateMessage(t){t&&(this.object.setState(t.state,0),t.data&&t.data.writeRoomObjectModel(this.object.model),this.object.model.setValue(st.FURNITURE_EXTRAS,t.extra),this.object.model.setValue(st.FURNITURE_STATE_UPDATE_TIME,this.lastUpdateTime))}processObjectHeightUpdateMessage(t){t&&this.object.model.setValue(st.FURNITURE_SIZE_Z,t.height)}processItemDataUpdateMessage(t){t&&this.object.model.setValue(st.FURNITURE_ITEMDATA,t.data)}mouseEvent(t,e){switch(this.getAdClickUrl(this.object.model),t.type){case oh.MOUSE_MOVE:if(this.eventDispatcher){const e=new nh(nh.MOUSE_MOVE,this.object,t._Str_3463,t.altKey,t.ctrlKey,t.shiftKey,t.buttonDown);e.localX=t.localX,e.localY=t.localY,e.spriteOffsetX=t.spriteOffsetX,e.spriteOffsetY=t.spriteOffsetY,this.eventDispatcher.dispatchEvent(e)}return;case oh.ROLL_OVER:if(!this._mouseOver){if(this.eventDispatcher){const e=new nh(nh.MOUSE_ENTER,this.object,t._Str_3463,t.altKey,t.ctrlKey,t.shiftKey,t.buttonDown);e.localX=t.localX,e.localY=t.localY,e.spriteOffsetX=t.spriteOffsetX,e.spriteOffsetY=t.spriteOffsetY,this.eventDispatcher.dispatchEvent(e)}this._mouseOver=!0}return;case oh.ROLL_OUT:if(this._mouseOver){if(this.eventDispatcher){const e=new nh(nh.MOUSE_LEAVE,this.object,t._Str_3463,t.altKey,t.ctrlKey,t.shiftKey,t.buttonDown);e.localX=t.localX,e.localY=t.localY,e.spriteOffsetX=t.spriteOffsetX,e.spriteOffsetY=t.spriteOffsetY,this.eventDispatcher.dispatchEvent(e)}this._mouseOver=!1}return;case oh.DOUBLE_CLICK:return void this.useObject();case oh.MOUSE_CLICK:if(this.eventDispatcher){const e=new nh(nh.CLICK,this.object,t._Str_3463,t.altKey,t.ctrlKey,t.shiftKey,t.buttonDown);e.localX=t.localX,e.localY=t.localY,e.spriteOffsetX=t.spriteOffsetX,e.spriteOffsetY=t.spriteOffsetY,this.eventDispatcher.dispatchEvent(e)}return void(this.eventDispatcher&&this.object&&this.contextMenu&&this.eventDispatcher.dispatchEvent(new Od(Od.OPEN_FURNI_CONTEXT_MENU,this.object)));case oh.MOUSE_DOWN:if(this.eventDispatcher){const e=new nh(nh.MOUSE_DOWN,this.object,t._Str_3463,t.altKey,t.ctrlKey,t.shiftKey,t.buttonDown);this.eventDispatcher.dispatchEvent(e)}return}}getLocationOffset(){return this._bouncingStep<=0?null:(this._locationOffset.x=0,this._locationOffset.y=0,this._bouncingStep<=t.BOUNCING_STEPS/2?this._locationOffset.z=t.BOUNCING_Z*this._bouncingStep:this._bouncingStep<=t.BOUNCING_STEPS&&(this._storedRotateMessage&&(super.processUpdateMessage(this._storedRotateMessage),this._storedRotateMessage=null),this._locationOffset.z=t.BOUNCING_Z*(t.BOUNCING_STEPS-this._bouncingStep)),this._locationOffset)}useObject(){this.object&&(this.getAdClickUrl(this.object.model),this.eventDispatcher&&(this.widget&&this.eventDispatcher.dispatchEvent(new Od(Od.OPEN_WIDGET,this.object)),this.eventDispatcher.dispatchEvent(new Id(Id.STATE_CHANGE,this.object))))}tearDown(){this.widget&&1===this.object.model.getValue(st.FURNITURE_REAL_ROOM_OBJECT)&&this.eventDispatcher.dispatchEvent(new Od(Od.CLOSE_WIDGET,this.object)),super.tearDown()}}return t.BOUNCING_STEPS=8,t.BOUNCING_Z=.0625,t})();class Fd extends xd{getEventTypes(){const t=[pd.LOAD_BADGE];return this.mergeTypes(super.getEventTypes(),t)}processUpdateMessage(t){if(super.processUpdateMessage(t),this.object)if(t instanceof nl){const e=t.data;e instanceof Oi&&this.updateBadge(e.getValue(1))}else t instanceof al&&"loading_icon"!==t.assetName&&(this.object.model.setValue(st.FURNITURE_BADGE_ASSET_NAME,t.assetName),this.object.model.setValue(st.FURNITURE_BADGE_IMAGE_STATUS,1),this.update(um.instance.time))}mouseEvent(t,e){if(t&&e&&this.object)switch(t.type){case oh.DOUBLE_CLICK:return void this.useObject();default:return void super.mouseEvent(t,e)}}useObject(){this.object&&this.eventDispatcher&&this.eventDispatcher.dispatchEvent(new Od(Od.BADGE_DISPLAY_ENGRAVING,this.object))}updateBadge(t){""!==t&&this.eventDispatcher&&this.eventDispatcher.dispatchEvent(new pd(pd.LOAD_BADGE,this.object,t,!1))}}class Gd extends xd{constructor(){super(),this.onRoomToObjectOwnAvatarMoveEvent=this.onRoomToObjectOwnAvatarMoveEvent.bind(this)}initialize(t){super.initialize(t),this.eventDispatcher&&this.eventDispatcher.addEventListener(Lh.ROAME_MOVE_TO,this.onRoomToObjectOwnAvatarMoveEvent)}tearDown(){this.eventDispatcher&&this.eventDispatcher.removeEventListener(Lh.ROAME_MOVE_TO,this.onRoomToObjectOwnAvatarMoveEvent),super.tearDown()}onRoomToObjectOwnAvatarMoveEvent(t){if(!t||!this.object)return;const e=this.object.getLocation(),s=t.targetLocation;if(!s)return;let i=this.object.model.getValue(st.FURNITURE_SIZE_X),r=this.object.model.getValue(st.FURNITURE_SIZE_Y);const n=(Math.floor(this.object.getDirection().x)+45)%360/90;1!==n&&3!==n||([i,r]=[r,i]),this.object.setState(s.x>=e.x&&s.x<e.x+i&&s.y>=e.y&&s.y<e.y+r?1:0,0)}}class Vd extends xd{getEventTypes(){const t=[Id.STATE_CHANGE];return this.mergeTypes(super.getEventTypes(),t)}mouseEvent(t,e){if(!t||!e||!this.object)return;let s=null;switch(t.type){case oh.DOUBLE_CLICK:switch(t.spriteTag){case"start_stop":s=new Id(Id.STATE_CHANGE,this.object,1);break;case"reset":s=new Id(Id.STATE_CHANGE,this.object,2)}if(this.eventDispatcher&&s)return void this.eventDispatcher.dispatchEvent(s)}super.mouseEvent(t,e)}useObject(){this.object&&this.eventDispatcher&&this.eventDispatcher.dispatchEvent(new Id(Id.STATE_CHANGE,this.object,1))}}class Yd extends xd{getEventTypes(){const t=[Od.CREDITFURNI];return this.mergeTypes(super.getEventTypes(),t)}initialize(t){super.initialize(t);let e=0;t.credits&&""!==t.credits&&t.credits.length>0&&(e=parseInt(t.credits)),this.object.model.setValue(st.FURNITURE_CREDIT_VALUE,e)}mouseEvent(t,e){if(t&&e&&this.object)switch(t.type){case oh.DOUBLE_CLICK:return void this.useObject();default:super.mouseEvent(t,e)}}useObject(){this.object&&this.eventDispatcher&&this.eventDispatcher.dispatchEvent(new Od(Od.CREDITFURNI,this.object))}}let kd=(()=>{class t{}return t.CHAT_WIDGET="RWE_CHAT_WIDGET",t.INFOSTAND="RWE_INFOSTAND",t.ME_MENU="RWE_ME_MENU",t.CHAT_INPUT_WIDGET="RWE_CHAT_INPUT_WIDGET",t.FURNI_PLACEHOLDER="RWE_FURNI_PLACEHOLDER",t.FURNI_CREDIT_WIDGET="RWE_FURNI_CREDIT_WIDGET",t.FURNI_STICKIE_WIDGET="RWE_FURNI_STICKIE_WIDGET",t.FURNI_TROPHY_WIDGET="RWE_FURNI_TROPHY_WIDGET",t.FURNI_PRESENT_WIDGET="RWE_FURNI_PRESENT_WIDGET",t.FURNI_ECOTRONBOX_WIDGET="RWE_FURNI_ECOTRONBOX_WIDGET",t.FURNI_PET_PACKAGE_WIDGET="RWE_FURNI_PET_PACKAGE_WIDGET",t.PLAYLIST_EDITOR_WIDGET="RWE_PLAYLIST_EDITOR_WIDGET",t.DOORBELL="RWE_DOORBELL",t.LOADINGBAR="RWE_LOADINGBAR",t.ROOM_QUEUE="RWE_ROOM_QUEUE",t.ROOM_POLL="RWE_ROOM_POLL",t.ROOM_VOTE="RWE_ROOM_VOTE",t.USER_CHOOSER="RWE_USER_CHOOSER",t.FURNI_CHOOSER="RWE_FURNI_CHOOSER",t.ROOM_DIMMER="RWE_ROOM_DIMMER",t.FRIEND_REQUEST="RWE_FRIEND_REQUEST",t.CLOTHING_CHANGE="RWE_CLOTHING_CHANGE",t.CONVERSION_TRACKING="RWE_CONVERSION_TRACKING",t.USER_NOTIFICATION="RWE_USER_NOTIFICATION",t.FRIENDS_BAR="RWE_FRIENDS_BAR",t.PURSE_WIDGET="RWE_PURSE_WIDGET",t.AVATAR_INFO="RWE_AVATAR_INFO",t.WELCOME_GIFT="RWE_WELCOME_GIFT",t.SPAMWALL_POSTIT_WIDGET="RWE_SPAMWALL_POSTIT_WIDGET",t.EFFECTS="RWE_EFFECTS",t.MANNEQUIN="RWE_MANNEQUIN",t.FURNITURE_CONTEXT_MENU="RWE_FURNITURE_CONTEXT_MENU",t.LOCATION_WIDGET="RWE_LOCATION_WIDGET",t.CAMERA="RWE_CAMERA",t.ROOM_THUMBNAIL_CAMERA="RWE_ROOM_THUMBNAIL_CAMERA",t.ROOM_BACKGROUND_COLOR="RWE_ROOM_BACKGROUND_COLOR",t.CUSTOM_USER_NOTIFICATION="RWE_CUSTOM_USER_NOTIFICATION",t.FURNI_ACHIEVEMENT_RESOLUTION_ENGRAVING="RWE_FURNI_ACHIEVEMENT_RESOLUTION_ENGRAVING",t.FRIEND_FURNI_CONFIRM="RWE_FRIEND_FURNI_CONFIRM",t.FRIEND_FURNI_ENGRAVING="RWE_FRIEND_FURNI_ENGRAVING",t.HIGH_SCORE_DISPLAY="RWE_HIGH_SCORE_DISPLAY",t.INTERNAL_LINK="RWE_INTERNAL_LINK",t.CUSTOM_STACK_HEIGHT="RWE_CUSTOM_STACK_HEIGHT",t.YOUTUBE="RWE_YOUTUBE",t.RENTABLESPACE="RWE_RENTABLESPACE",t.VIMEO="RWE_VIMEO",t.ROOM_TOOLS="RWE_ROOM_TOOLS",t.EXTERNAL_IMAGE="RWE_EXTERNAL_IMAGE",t.WORD_QUIZZ="RWE_WORD_QUIZZ",t.UI_HELP_BUBBLE="RWE_UI_HELP_BUBBLE",t.ROOM_LINK="RWE_ROOM_LINK",t.CRAFTING="RWE_CRAFTING",t.ROOMGAME_CHECKERS="RWE_GAME_CHECKERS",t})();class jd extends xd{getEventTypes(){const t=[wh.MOUSE_BUTTON,wh.MOUSE_ARROW];return this.mergeTypes(super.getEventTypes(),t)}mouseEvent(t,e){if(t&&e&&this.object){switch(t.type){case oh.ROLL_OVER:this.eventDispatcher&&this.eventDispatcher.dispatchEvent(new wh(wh.MOUSE_BUTTON,this.object));break;case oh.ROLL_OUT:this.eventDispatcher&&this.eventDispatcher.dispatchEvent(new wh(wh.MOUSE_ARROW,this.object))}super.mouseEvent(t,e)}}}class Bd extends jd{initialize(t){super.initialize(t),this.object&&this.object.model&&this.object.model.setValue(st.FURNITURE_ALWAYS_STACKABLE,1)}get widget(){return kd.CUSTOM_STACK_HEIGHT}}class Hd extends xd{constructor(){super(),this._noTags=!1,this._noTagsLastStateActivate=!1}getEventTypes(){const t=[wh.DICE_ACTIVATE,wh.DICE_OFF];return this.mergeTypes(super.getEventTypes(),t)}mouseEvent(t,e){if(!t||!e||!this.object)return;let s=null;switch(t.type){case oh.DOUBLE_CLICK:return this._noTags?this._noTagsLastStateActivate&&0!==this.object.getState(0)&&100!==this.object.getState(0)?(s=new wh(wh.DICE_OFF,this.object),this._noTagsLastStateActivate=!1):(s=new wh(wh.DICE_ACTIVATE,this.object),this._noTagsLastStateActivate=!0):"activate"===t.spriteTag||0===this.object.getState(0)||100===this.object.getState(0)?s=new wh(wh.DICE_ACTIVATE,this.object):"deactivate"===t.spriteTag&&(s=new wh(wh.DICE_OFF,this.object)),void(s&&this.eventDispatcher&&this.eventDispatcher.dispatchEvent(s))}super.mouseEvent(t,e)}}class Wd extends xd{constructor(){super(),this._showStateOnceRendered=!1,this._updateCount=0}getEventTypes(){const t=[Od.INERNAL_LINK];return this.mergeTypes(super.getEventTypes(),t)}initialize(t){super.initialize(t),t.action&&1===t.action.startState&&(this._showStateOnceRendered=!0)}update(t){super.update(t),this._showStateOnceRendered&&(this._updateCount++,this._showStateOnceRendered&&this._updateCount>20&&(this.setAutomaticStateIndex(1),this._showStateOnceRendered=!1))}setAutomaticStateIndex(t){this.object&&this.object.model&&this.object.model.setValue(st.FURNITURE_AUTOMATIC_STATE_INDEX,t)}mouseEvent(t,e){t&&e&&(t.type===oh.DOUBLE_CLICK&&this.setAutomaticStateIndex(0),super.mouseEvent(t,e))}useObject(){this.eventDispatcher&&this.object&&this.eventDispatcher.dispatchEvent(new Od(Od.INERNAL_LINK,this.object))}}class Zd extends xd{getEventTypes(){const t=[Od.ROOM_LINK];return this.mergeTypes(super.getEventTypes(),t)}initialize(t){super.initialize(t),t.action&&t.action.link&&""!==t.action.link&&t.action.link.length>0&&this.object&&this.object.model&&this.object.model.setValue(st.FURNITURE_INTERNAL_LINK,t.action.link)}dispose(){super.dispose(),this._timer&&(clearTimeout(this._timer),this._timer=null)}setAutomaticStateIndex(t){this.object&&this.object.model&&this.object.model.setValue(st.FURNITURE_AUTOMATIC_STATE_INDEX,t)}useObject(){this.setAutomaticStateIndex(1),this._timer&&(clearTimeout(this._timer),this._timer=null),this._timer=setTimeout(()=>{this.setAutomaticStateIndex(0),this._timer=null},2500),this.eventDispatcher&&this.object&&this.eventDispatcher.dispatchEvent(new Od(Od.ROOM_LINK,this.object))}}class zd extends jd{initialize(t){if(super.initialize(t),t&&this.object&&this.object.model){let e="";t.maskType&&""!==t.maskType&&t.maskType.length>0&&(e=t.maskType),this.object.model.setValue(st.FURNITURE_USES_PLANE_MASK,0),this.object.model.setValue(st.FURNITURE_PLANE_MASK_TYPE,e)}}mouseEvent(t,e){if(t&&e&&this.object){switch(t.type){case oh.DOUBLE_CLICK:this.useObject()}super.mouseEvent(t,e)}}get widget(){return kd.EXTERNAL_IMAGE}}class Xd extends xd{}let Kd=(()=>{class t extends jd{constructor(){super(),this._currentState=-1,this._currentLocation=null}getEventTypes(){const t=[fd.ADD_HOLE,fd.REMOVE_HOLE];return this.mergeTypes(super.getEventTypes(),t)}dispose(){this._currentState===t._Str_9306&&this.eventDispatcher.dispatchEvent(new fd(fd.REMOVE_HOLE,this.object)),super.dispose()}update(t){super.update(t),this._Str_25016()}processUpdateMessage(e){if(super.processUpdateMessage(e),!this.object)return;e instanceof nl&&this._Str_21445(this.object.getState(0));const s=this.object.getLocation();this._currentLocation?s.x===this._currentLocation.x&&s.y===this._currentLocation.y||this._currentState===t._Str_9306&&this.eventDispatcher&&this.eventDispatcher.dispatchEvent(new fd(fd.ADD_HOLE,this.object)):this._currentLocation=new ot,this._currentLocation.assign(s)}_Str_21445(e){e!==this._currentState&&(this.eventDispatcher&&(e===t._Str_9306?this.eventDispatcher.dispatchEvent(new fd(fd.ADD_HOLE,this.object)):this._currentState===t._Str_9306&&this.eventDispatcher.dispatchEvent(new fd(fd.REMOVE_HOLE,this.object))),this._currentState=e)}_Str_25016(){if(!this.object)return;const t=this.object.model;if(!t)return;const e=t.getValue(st.FURNITURE_AUTOMATIC_STATE_INDEX);isNaN(e)||this._Str_21445(e%2)}}return t._Str_9306=0,t})(),qd=(()=>{class t extends jd{processUpdateMessage(e){if(super.processUpdateMessage(e),e instanceof nl){const s=e.data;s instanceof Oi&&(this.updateGroupId(s.getValue(t.GROUPID_KEY)),this.updateBadge(s.getValue(t.BADGE_KEY)),this.updateColors(s.getValue(t.COLOR1_KEY),s.getValue(t.COLOR2_KEY)))}}updateGroupId(t){this.object.model.setValue(st.FURNITURE_GUILD_CUSTOMIZED_GUILD_ID,parseInt(t))}updateBadge(t){this.object.model.setValue(st.FURNITURE_GUILD_CUSTOMIZED_BADGE,t)}updateColors(t,e){this.object.model.setValue(st.FURNITURE_GUILD_CUSTOMIZED_COLOR_1,parseInt(t,16)),this.object.model.setValue(st.FURNITURE_GUILD_CUSTOMIZED_COLOR_2,parseInt(e,16))}}return t.GROUPID_KEY=1,t.BADGE_KEY=2,t.COLOR1_KEY=3,t.COLOR2_KEY=4,t})(),Jd=(()=>{class t extends xd{constructor(){super(...arguments),this._state=-1}getEventTypes(){return[Od.HIGH_SCORE_DISPLAY,Od.HIDE_HIGH_SCORE_DISPLAY]}tearDown(){1===this.object.model.getValue(st.FURNITURE_REAL_ROOM_OBJECT)&&this.eventDispatcher.dispatchEvent(new Od(Od.HIDE_HIGH_SCORE_DISPLAY,this.object)),super.tearDown()}processUpdateMessage(e){super.processUpdateMessage(e),1===this.object.model.getValue(st.FURNITURE_REAL_ROOM_OBJECT)&&e instanceof nl&&(this.eventDispatcher.dispatchEvent(new Od(e.state===t.SHOW_WIDGET_IN_STATE?Od.HIGH_SCORE_DISPLAY:Od.HIDE_HIGH_SCORE_DISPLAY,this.object)),this._state=e.state)}mouseEvent(t,e){if(t&&e&&this.object)switch(t.type){case oh.DOUBLE_CLICK:return void this.useObject();default:super.mouseEvent(t,e)}}}return t.SHOW_WIDGET_IN_STATE=1,t})();class Qd extends xd{getEventTypes(){const t=[Id.STATE_CHANGE];return this.mergeTypes(super.getEventTypes(),t)}mouseEvent(t,e){if(!t||!e||!this.object)return;let s=null;switch(t.type){case oh.DOUBLE_CLICK:switch(t.spriteTag){case"off":s=new Id(Id.STATE_CHANGE,this.object,3)}break;case oh.MOUSE_CLICK:switch(t.spriteTag){case"inc":s=new Id(Id.STATE_CHANGE,this.object,2);break;case"dec":s=new Id(Id.STATE_CHANGE,this.object,1)}}this.eventDispatcher&&s?this.eventDispatcher.dispatchEvent(s):super.mouseEvent(t,e)}useObject(){this.object&&this.eventDispatcher&&this.eventDispatcher.dispatchEvent(new Id(Id.STATE_CHANGE,this.object,3))}}class $d extends jd{constructor(){super(),this._nextState=0,this._nextStateTimestamp=0}update(t){if(this._nextStateTimestamp>0&&t>=this._nextStateTimestamp){this._nextStateTimestamp=0;const t=new Ii;t.setString(this._nextState.toString()),super.processUpdateMessage(new nl(this._nextState,t))}super.update(t)}processUpdateMessage(t){if(t instanceof nl)return this.processUpdate(t);super.processUpdateMessage(t)}processUpdate(t){if(!t)return;const e=t.state/1e3,s=t.state%1e3;if(s)this._nextState=e,this._nextStateTimestamp=this.time+s;else{this._nextStateTimestamp=0;const t=new Ii;t.setString(e.toString()),super.processUpdateMessage(new nl(e,t))}}}let tg=(()=>{class t extends xd{getEventTypes(){const t=[Od.MANNEQUIN];return this.mergeTypes(super.getEventTypes(),t)}processUpdateMessage(t){super.processUpdateMessage(t),t instanceof nl&&(t.data.writeRoomObjectModel(this.object.model),this.processObjectData())}processObjectData(){if(!this.object||!this.object.model)return;const e=new vi;e.initializeFromRoomObjectModel(this.object.model),this.object.model.setValue(st.FURNITURE_MANNEQUIN_GENDER,e.getValue(t.GENDER)),this.object.model.setValue(st.FURNITURE_MANNEQUIN_FIGURE,e.getValue(t.FIGURE)),this.object.model.setValue(st.FURNITURE_MANNEQUIN_NAME,e.getValue(t.OUTFIT_NAME))}mouseEvent(t,e){if(t&&e&&this.object){switch(t.type){case oh.DOUBLE_CLICK:return void this.useObject()}super.mouseEvent(t,e)}}useObject(){this.eventDispatcher&&this.object&&this.eventDispatcher.dispatchEvent(new Od(Od.MANNEQUIN,this.object))}}return t.GENDER="GENDER",t.FIGURE="FIGURE",t.OUTFIT_NAME="OUTFIT_NAME",t})();class eg extends jd{initialize(t){super.initialize(t),this.object&&this.object.model&&this.object.model.setValue(st.FURNITURE_IS_VARIABLE_HEIGHT,1)}}class sg extends xd{getEventTypes(){const t=[wh.ENTER_ONEWAYDOOR];return this.mergeTypes(super.getEventTypes(),t)}mouseEvent(t,e){if(t&&e&&this.object){switch(t.type){case oh.DOUBLE_CLICK:return void this.useObject()}super.mouseEvent(t,e)}}useObject(){this.object&&this.eventDispatcher&&this.eventDispatcher.dispatchEvent(new wh(wh.ENTER_ONEWAYDOOR,this.object))}}class ig extends xd{}class rg extends xd{}class ng extends jd{}class ag extends jd{}class og extends jd{constructor(){super(),this._roomColorUpdated=!1}getEventTypes(){const t=[Od.BACKGROUND_COLOR,bd.ROOM_BACKGROUND_COLOR];return this.mergeTypes(super.getEventTypes(),t)}dispose(){this._roomColorUpdated&&(this.eventDispatcher&&this.object&&1===this.object.model.getValue(st.FURNITURE_REAL_ROOM_OBJECT)&&this.eventDispatcher.dispatchEvent(new bd(bd.ROOM_BACKGROUND_COLOR,this.object,!1,0,0,0)),this._roomColorUpdated=!1),super.dispose()}processUpdateMessage(t){super.processUpdateMessage(t),t instanceof nl&&(t.data.writeRoomObjectModel(this.object.model),1===this.object.model.getValue(st.FURNITURE_REAL_ROOM_OBJECT)&&this.processColorUpdate())}processColorUpdate(){if(!this.object||!this.object.model)return;const t=new Ti;t.initializeFromRoomObjectModel(this.object.model);const e=t.getValue(0),s=t.getValue(1),i=t.getValue(2),r=t.getValue(3);e>-1&&s>-1&&i>-1&&r>-1&&(this.object.model.setValue(st.FURNITURE_ROOM_BACKGROUND_COLOR_HUE,s),this.object.model.setValue(st.FURNITURE_ROOM_BACKGROUND_COLOR_SATURATION,i),this.object.model.setValue(st.FURNITURE_ROOM_BACKGROUND_COLOR_LIGHTNESS,r),this.object.setState(e,0),this.eventDispatcher&&this.eventDispatcher.dispatchEvent(new bd(bd.ROOM_BACKGROUND_COLOR,this.object,1===e,s,i,r)),this._roomColorUpdated=!0)}mouseEvent(t,e){if(t&&e&&this.object)switch(t.type){case oh.DOUBLE_CLICK:return void(this.eventDispatcher&&this.eventDispatcher.dispatchEvent(new Od(Od.STICKIE,this.object)));default:super.mouseEvent(t,e)}}}let cg=(()=>{class t{}return t.INFOSTAND_EXTRA_PARAM="RWEIEP_INFOSTAND_EXTRA_PARAM",t.JUKEBOX="RWEIEP_JUKEBOX",t.USABLE_PRODUCT="RWEIEP_USABLE_PRODUCT",t.SONGDISK="RWEIEP_SONGDISK",t.CRACKABLE_FURNI="RWEIEP_CRACKABLE_FURNI",t.BRANDING_OPTIONS="RWEIEP_BRANDING_OPTIONS",t.USABLE="RWEIEP_USABLE",t})(),_g=(()=>{class t extends ah{constructor(t){super(null,null),this._type=t}get type(){return this._type}}return t.IMAGE_LOADED="ROAUM_IMAGE_LOADED",t.IMAGE_LOADING_FAILED="ROAUM_IMAGE_FAILED",t})(),hg=(()=>{class t extends xd{constructor(){super(),this._hasClickUrl=!1}processUpdateMessage(t){super.processUpdateMessage(t),t instanceof nl&&this.processAdDataUpdateMessage(t),t instanceof _g&&this.processAdUpdate(t)}processAdDataUpdateMessage(e){if(!e)return;const s=new vi;s.initializeFromRoomObjectModel(this.object.model);const i=parseInt(s.getValue(t.STATE));isNaN(i)||this.object.getState(0)===i||this.object.setState(i,0);const r=s.getValue(t.IMAGEURL_KEY),n=this.object.model.getValue(st.FURNITURE_BRANDING_IMAGE_URL);n&&n===r||(this.object.model.setValue(st.FURNITURE_BRANDING_IMAGE_URL,r),this.object.model.setValue(st.FURNITURE_BRANDING_IMAGE_STATUS,0),this.downloadBackground());const a=s.getValue(t.CLICKURL_KEY);if(a){const t=this.object.model.getValue(st.FURNITURE_BRANDING_URL);t&&t===a||this.object.model&&this.object.model.setValue(st.FURNITURE_BRANDING_URL,a)}const o=parseInt(s.getValue(t.OFFSETX_KEY)),c=parseInt(s.getValue(t.OFFSETY_KEY)),_=parseInt(s.getValue(t.OFFSETZ_KEY));isNaN(o)||this.object.model.setValue(st.FURNITURE_BRANDING_OFFSET_X,o),isNaN(c)||this.object.model.setValue(st.FURNITURE_BRANDING_OFFSET_Y,c),isNaN(_)||this.object.model.setValue(st.FURNITURE_BRANDING_OFFSET_Z,_);let h=t.IMAGEURL_KEY+"="+(null!==r?r:"")+"\t";this._hasClickUrl&&(h=h+(t.CLICKURL_KEY+"=")+(null!==a?a:"")+"\t"),h=h+(t.OFFSETX_KEY+"=")+o+"\t",h=h+(t.OFFSETY_KEY+"=")+c+"\t",h=h+(t.OFFSETZ_KEY+"=")+_+"\t",this.object.model.setValue(cg.INFOSTAND_EXTRA_PARAM,cg.BRANDING_OPTIONS+h)}processAdUpdate(t){if(t&&this.object)switch(t.type){case _g.IMAGE_LOADED:this.object.model.setValue(st.FURNITURE_BRANDING_IMAGE_STATUS,1);break;case _g.IMAGE_LOADING_FAILED:this.object.model.setValue(st.FURNITURE_BRANDING_IMAGE_STATUS,-1)}}downloadBackground(){const t=this.object&&this.object.model;if(!t)return;const e=t.getValue(st.FURNITURE_BRANDING_IMAGE_URL),s=t.getValue(st.FURNITURE_BRANDING_IMAGE_STATUS);if(!e||""===e||1===s)return;const i=um.instance.core&&um.instance.core.asset;i&&(i.getTexture(e)?this.processUpdateMessage(new _g(_g.IMAGE_LOADED)):i.downloadAsset(e,t=>{this.processUpdateMessage(new _g(t?_g.IMAGE_LOADED:_g.IMAGE_LOADING_FAILED))}))}}return t.STATE="state",t.IMAGEURL_KEY="imageUrl",t.CLICKURL_KEY="clickUrl",t.OFFSETX_KEY="offsetX",t.OFFSETY_KEY="offsetY",t.OFFSETZ_KEY="offsetZ",t})();class lg extends hg{getAdClickUrl(t){return null}}class ug extends hg{constructor(){super(),this._hasClickUrl=!0}getAdClickUrl(t){return t.getValue(st.FURNITURE_BRANDING_URL)}}class dg extends xd{constructor(){super(),this._roomColorUpdated=!1}getEventTypes(){const t=[Od.DIMMER,Od.WIDGET_REMOVE_DIMMER,Ed.DIMMER_STATE];return this.mergeTypes(super.getEventTypes(),t)}dispose(){this._roomColorUpdated&&this.eventDispatcher&&this.object&&(1===this.object.model.getValue(st.FURNITURE_REAL_ROOM_OBJECT)&&(this.eventDispatcher.dispatchEvent(new Ed(this.object,0,1,1,16777215,255)),this.eventDispatcher.dispatchEvent(new Od(Od.WIDGET_REMOVE_DIMMER,this.object))),this._roomColorUpdated=!1),super.dispose()}processUpdateMessage(t){if(t instanceof nl){if(t.data){const e=t.data.getLegacyString();1===this.object.model.getValue(st.FURNITURE_REAL_ROOM_OBJECT)&&this.processDimmerData(e),super.processUpdateMessage(new nl(this.getStateFromDimmerData(e),t.data))}}else super.processUpdateMessage(t)}getStateFromDimmerData(t){if(!t)return 0;const e=t.split(",");return e.length>=5?parseInt(e[0])-1:0}processDimmerData(t){if(!t)return;const e=t.split(",");if(e.length>=5){const s=this.getStateFromDimmerData(t),i=parseInt(e[1]),r=parseInt(e[2]);let n=parseInt(e[3].substr(1),16),a=parseInt(e[4]);s||(n=16777215,a=255),this.eventDispatcher&&this.object&&(this.eventDispatcher.dispatchEvent(new Ed(this.object,s,i,r,n,a)),this._roomColorUpdated=!0)}}useObject(){this.eventDispatcher.dispatchEvent(new Od(Od.DIMMER,this.object))}update(t){if(super.update(t),this.object&&this.object.model&&1===this.object.model.getValue(st.FURNITURE_REAL_ROOM_OBJECT)){const t=this.object.model.getValue(st.FURNITURE_DATA);t&&t.length>0&&(this.object.model.setValue(st.FURNITURE_DATA,""),this.processDimmerData(t))}}}let gg=(()=>{class t extends xd{constructor(){super(),this._score=0,this._scoreIncreaser=50,this._scoreTimer=0}processUpdateMessage(t){if(t instanceof nl)return this.updateScore(t.state);super.processUpdateMessage(t)}updateScore(e){this._score=e;const s=this.object.getState(0);if(this._score!==s){let e=this._score-s;e<0&&(e=-e),this._scoreIncreaser=e*t._Str_3536>t._Str_5967?t._Str_5967/e:t._Str_3536,this._scoreTimer=um.instance.time}}update(t){super.update(t);const e=this.object.getState(0);if(e!==this._score&&t>=this._scoreTimer+this._scoreIncreaser){const s=t-this._scoreTimer;let i=s/this._scoreIncreaser,r=1;this._score<e&&(r=-1),i>r*(this._score-e)&&(i=r*(this._score-e)),this.object.setState(e+r*i,0),this._scoreTimer=t-(s-i*this._scoreIncreaser)}}}return t._Str_3536=50,t._Str_5967=3e3,t})();class mg extends jd{}let pg=(()=>{class t extends xd{getEventTypes(){const t=[Od.STICKIE,wh.STICKIE];return this.mergeTypes(super.getEventTypes(),t)}initialize(t){super.initialize(t),this.updateColor(),this.object&&this.object.model.setValue(st.FURNITURE_IS_STICKIE,"")}processUpdateMessage(t){super.processUpdateMessage(t),t instanceof cl&&this.eventDispatcher&&this.eventDispatcher.dispatchEvent(new Od(Od.STICKIE,this.object)),this.updateColor()}updateColor(){if(!this.object)return;const e=this.object.model.getValue(st.FURNITURE_DATA);let s=t.STICKIE_COLORS.indexOf(e);s<0&&(s=3),this.object.model.setValue(st.FURNITURE_COLOR,s+1)}mouseEvent(t,e){if(t&&e&&this.object)switch(t.type){case oh.DOUBLE_CLICK:return void this.useObject();default:super.mouseEvent(t,e)}}useObject(){this.object&&this.eventDispatcher&&this.eventDispatcher.dispatchEvent(new wh(wh.STICKIE,this.object))}}return t.STICKIE_COLORS=["9CCEFF","FF9CFF","9CFF9C","FFFF33"],t})();class Eg extends xd{getEventTypes(){const t=[Od.TROPHY];return this.mergeTypes(super.getEventTypes(),t)}mouseEvent(t,e){if(t&&e&&this.object){switch(t.type){case oh.DOUBLE_CLICK:return void this.useObject()}super.mouseEvent(t,e)}}useObject(){this.eventDispatcher&&this.object&&this.eventDispatcher.dispatchEvent(new Od(Od.TROPHY,this.object))}}let fg=(()=>{class t extends jd{constructor(){super(),this._total=0,this._lastUpdate=0,this._interval=33}processUpdateMessage(t){if(super.processUpdateMessage(t),t instanceof nl){const e=t.data;if(!e)return;this._Str_24990(e.result)}}_Str_24990(e){if(this._total=e,!this._lastUpdate)return this.object.model.setValue(st.FURNITURE_VOTE_COUNTER_COUNT,e),void(this._lastUpdate=um.instance.time);if(this._total!==this._Str_8221){const e=Math.abs(this._total-this._Str_8221);this._interval=e*t._Str_3536>t._Str_5967?t._Str_5967/e:t._Str_3536,this._lastUpdate=um.instance.time}}update(t){if(super.update(t),this.object&&this._Str_8221!==this._total&&t>=this._lastUpdate+this._interval){const e=t-this._lastUpdate;let s=e/this._interval,i=1;this._total<this._Str_8221&&(i=-1),s>i*(this._total-this._Str_8221)&&(s=i*(this._total-this._Str_8221)),this.object.model.setValue(st.FURNITURE_VOTE_COUNTER_COUNT,this._Str_8221+i*s),this._lastUpdate=t-(e-s*this._interval)}}get _Str_8221(){return this.object.model.getValue(st.FURNITURE_VOTE_COUNTER_COUNT)}}return t._Str_3536=33,t._Str_5967=1e3,t})();class Sg extends jd{processUpdateMessage(t){if(super.processUpdateMessage(t),this.object&&t instanceof nl){const e=t.data;e instanceof Ai&&this.object.model.setValue(st.FURNITURE_VOTE_MAJORITY_RESULT,e.result)}}}class bg extends jd{initialize(t){super.initialize(t);let e="";t.maskType&&""!==t.maskType&&t.maskType.length>0&&(e=t.maskType),this.object.model.setValue(st.FURNITURE_USES_PLANE_MASK,0),this.object.model.setValue(st.FURNITURE_PLANE_MASK_TYPE,e)}}class Rg extends Ld{constructor(){super(),this._selected=!1,this._reportedLocation=null,this._postureIndex=0,this._gestureIndex=0,this._headDirectionDelta=0,this._directions=[],this._talkingEndTimestamp=0,this._gestureEndTimestamp=0,this._expressionEndTimestamp=0}getEventTypes(){const t=[nh.CLICK,Rd.POSITION_CHANGED];return this.mergeTypes(super.getEventTypes(),t)}initialize(t){if(!t)return;const e=this.object&&this.object.model;if(!e)return;const s=t.directions;if(s&&s.length){for(const t of s)this._directions.push(t);this._directions.sort((t,e)=>t-e)}e.setValue(st.PET_ALLOWED_DIRECTIONS,this._directions)}dispose(){this._selected&&this.object&&this.eventDispatcher&&this.eventDispatcher.dispatchEvent(new Rd(Rd.OBJECT_REMOVED,this.object)),this._directions=null,this._reportedLocation=null}update(t){if(super.update(t),this._selected&&this.object&&this.eventDispatcher){const t=this.object.getLocation();this._reportedLocation&&this._reportedLocation.x===t.x&&this._reportedLocation.y===t.y&&this._reportedLocation.z===t.z||(this._reportedLocation||(this._reportedLocation=new ot),this._reportedLocation.assign(t),this.eventDispatcher.dispatchEvent(new Rd(Rd.POSITION_CHANGED,this.object)))}this.object&&this.object.model&&this.updateModel(t,this.object.model)}updateModel(t,e){this._gestureEndTimestamp>0&&t>this._gestureEndTimestamp&&(e.setValue(st.FIGURE_GESTURE,null),this._gestureEndTimestamp=0),this._talkingEndTimestamp>0&&t>this._talkingEndTimestamp&&(e.setValue(st.FIGURE_TALK,0),this._talkingEndTimestamp=0),this._expressionEndTimestamp>0&&t>this._expressionEndTimestamp&&(e.setValue(st.FIGURE_EXPRESSION,0),this._expressionEndTimestamp=0)}processUpdateMessage(t){if(!t||!this.object)return;super.processUpdateMessage(t);const e=this.object&&this.object.model;if(e)if(t instanceof il)e.setValue(st.HEAD_DIRECTION,t.headDirection);else{if(t instanceof Bh){const s=new Th(t.figure);return e.setValue(st.FIGURE,t.figure),e.setValue(st.RACE,t.subType),e.setValue(st.PET_PALETTE_INDEX,s.paletteId),e.setValue(st.PET_COLOR,s.color),e.setValue(st.PET_TYPE,s.typeId),e.setValue(st.PET_CUSTOM_LAYER_IDS,s.customLayerIds),e.setValue(st.PET_CUSTOM_PARTS_IDS,s.customPartIds),e.setValue(st.PET_CUSTOM_PALETTE_IDS,s.customPaletteIds),void e.setValue(st.PET_IS_RIDING,t.isRiding?1:0)}if(t instanceof Qh)e.setValue(st.FIGURE_POSTURE,t.postureType);else{if(t instanceof Gh)return e.setValue(st.FIGURE_TALK,1),void(this._talkingEndTimestamp=this.time+1e3*t.numberOfWords);if(!(t instanceof tl))return t instanceof Kh?(e.setValue(st.FIGURE_GESTURE,t.gesture),void(this._gestureEndTimestamp=this.time+3e3)):t instanceof Ad?(this._selected=t.selected,void(this._reportedLocation=null)):void 0;e.setValue(st.FIGURE_SLEEP,t.isSleeping?1:0)}}}mouseEvent(t,e){let s=null;switch(t.type){case oh.MOUSE_CLICK:s=nh.CLICK;break;case oh.DOUBLE_CLICK:break;case oh.MOUSE_DOWN:this.object.model.getValue(st.PET_TYPE)==ad.MONSTERPLANT&&this.eventDispatcher&&this.eventDispatcher.dispatchEvent(new nh(nh.MOUSE_DOWN,this.object,t._Str_3463,t.altKey,t.ctrlKey,t.shiftKey,t.buttonDown))}s&&this.eventDispatcher&&this.eventDispatcher.dispatchEvent(new nh(s,this.object,t._Str_3463,t.altKey,t.ctrlKey,t.shiftKey,t.buttonDown))}}class Ig{static int2rgb(t){return"rgba("+[(16711680&(t>>>=0))>>>16,(65280&t)>>>8,255&t,1].join(",")+")"}static _Str_22130(t){const e=(t>>16&255)/255,s=(t>>8&255)/255,i=(255&t)/255,r=Math.max(e,s,i),n=Math.min(e,s,i),a=r-n;let o=0,c=0,_=0;return 0==a?o=0:r==e?o=s>i?60*(s-i)/a:60*(s-i)/a+360:r==s?o=60*(i-e)/a+120:r==i&&(o=60*(e-s)/a+240),c=.5*(r+n),_=0==a?0:c<=.5?a/c*.5:a/(1-c)*.5,(Math.round(o/360*255)<<16)+(Math.round(255*_)<<8)+Math.round(255*c)}static _Str_13949(t){let e,s,i,r,n;const a=(t>>16&255)/255,o=(t>>8&255)/255,c=(255&t)/255;let _=0,h=0,l=0;return o>0?(e=0,s=0,e=c<.5?c*(1+o):c+o-c*o,s=2*c-e,i=a+1/3,r=a,n=a-1/3,i<0?i+=1:i>1&&i--,r<0?r+=1:r>1&&r--,n<0?n+=1:n>1&&n--,_=6*i<1?s+6*(e-s)*i:2*i<1?e:3*i<2?s+6*(e-s)*(2/3-i):s,h=6*r<1?s+6*(e-s)*r:2*r<1?e:3*r<2?s+6*(e-s)*(2/3-r):s,l=6*n<1?s+6*(e-s)*n:2*n<1?e:3*n<2?s+6*(e-s)*(2/3-n):s):(_=c,h=c,l=c),(Math.round(255*_)<<16)+(Math.round(255*h)<<8)+Math.round(255*l)}static rgb2xyz(t){let e=(t>>16&255)/255,s=(t>>8&255)/255,i=(t>>0&255)/255;return e>.04045?e=Math.pow((e+.055)/1.055,2.4):e/=12.92,s>.04045?s=Math.pow((s+.055)/1.055,2.4):s/=12.92,i>.04045?i=Math.pow((i+.055)/1.055,2.4):i/=12.92,e*=100,s*=100,i*=100,new ot(.4124*e+.3576*s+.1805*i,.2126*e+.7152*s+.0722*i,.0193*e+.1192*s+.9505*i)}static _Str_22784(t){let e=t.x/95.047,s=t.y/100,i=t.z/108.883;return e=e>.008856?Math.pow(e,1/3):7.787*e+16/116,s=s>.008856?Math.pow(s,1/3):7.787*s+16/116,i=i>.008856?Math.pow(i,1/3):7.787*i+16/116,new ot(116*s-16,500*(e-s),200*(s-i))}static rgb2CieLab(t){return Ig._Str_22784(Ig.rgb2xyz(t))}}class vg extends Ud{constructor(){super(),this._planeParser=new Ia,this._planeBitmapMaskParser=new Au,this._color=16777215,this._Str_3576=255,this._Str_14932=16777215,this._Str_17003=255,this._Str_11287=16777215,this._Str_16460=255,this._Str_9785=0,this._Str_17191=1500,this._needsMapUpdate=!1}getEventTypes(){const t=[nh.MOUSE_MOVE,nh.CLICK];return this.mergeTypes(super.getEventTypes(),t)}dispose(){super.dispose(),this._planeParser&&(this._planeParser.dispose(),this._planeParser=null),this._planeBitmapMaskParser&&(this._planeBitmapMaskParser.dispose(),this._planeBitmapMaskParser=null)}initialize(t){t&&this.object&&t instanceof fa&&this._planeParser.initializeFromMapData(t)&&(this.object.model.setValue(st.ROOM_MAP_DATA,t),this.object.model.setValue(st.ROOM_BACKGROUND_COLOR,16777215),this.object.model.setValue(st.ROOM_FLOOR_VISIBILITY,1),this.object.model.setValue(st.ROOM_WALL_VISIBILITY,1),this.object.model.setValue(st.ROOM_LANDSCAPE_VISIBILITY,1))}update(t){if(super.update(t),this._Str_24703(t),this._needsMapUpdate){const e=this.object&&this.object.model;if(e){const s=this._planeParser.getMapData();e.setValue(st.ROOM_MAP_DATA,s),e.setValue(st.ROOM_FLOOR_HOLE_UPDATE_TIME,t),this._planeParser.initializeFromMapData(s)}this._needsMapUpdate=!1}}_Str_24703(t){if(!this.object||!this._Str_9785)return;let e=this._color,s=this._Str_3576;if(t-this._Str_9785>=this._Str_17191)e=this._Str_11287,s=this._Str_16460,this._Str_9785=0;else{let i=this._Str_14932>>16&255,r=this._Str_14932>>8&255,n=255&this._Str_14932;const a=(t-this._Str_9785)/this._Str_17191;i+=((this._Str_11287>>16&255)-i)*a,r+=((this._Str_11287>>8&255)-r)*a,n+=((255&this._Str_11287)-n)*a,e=(i<<16)+(r<<8)+n,s=this._Str_17003+(this._Str_16460-this._Str_17003)*a,this._color=e,this._Str_3576=s}let i=Ig._Str_22130(e);i=(16776960&i)+s,e=Ig._Str_13949(i),this.object.model&&this.object.model.setValue(st.ROOM_BACKGROUND_COLOR,e)}processUpdateMessage(t){if(!t||!this.object)return;const e=this.object.model;e&&(t instanceof gl?this.onObjectRoomUpdateMessage(t,e):t instanceof ll?this.onObjectRoomMaskUpdateMessage(t,e):t instanceof dl?this.onObjectRoomPlaneVisibilityUpdateMessage(t,e):t instanceof ul?this.onObjectRoomPlanePropertyUpdateMessage(t,e):t instanceof hl?this.onObjectRoomFloorHoleUpdateMessage(t,e):t instanceof _l&&this.onObjectRoomColorUpdateMessage(t,e))}onObjectRoomUpdateMessage(t,e){switch(t.type){case gl.ROOM_FLOOR_UPDATE:return void e.setValue(st.ROOM_FLOOR_TYPE,t.value);case gl.ROOM_WALL_UPDATE:return void e.setValue(st.ROOM_WALL_TYPE,t.value);case gl.ROOM_LANDSCAPE_UPDATE:return void e.setValue(st.ROOM_LANDSCAPE_TYPE,t.value)}}onObjectRoomMaskUpdateMessage(t,e){let s=null,i=!1;switch(t.type){case ll.ADD_MASK:s=Tu.WINDOW,t.maskCategory===ll.HOLE&&(s=Tu.HOLE),this._planeBitmapMaskParser.addMask(t.maskId,t.maskType,t.maskLocation,s),i=!0;break;case ll._Str_10260:i=this._planeBitmapMaskParser._Str_23574(t.maskId)}i&&e.setValue(st.ROOM_PLANE_MASK_XML,this._planeBitmapMaskParser._Str_5598())}onObjectRoomPlaneVisibilityUpdateMessage(t,e){let s=0;switch(t.visible&&(s=1),t.type){case dl.FLOOR_VISIBILITY:return void e.setValue(st.ROOM_FLOOR_VISIBILITY,s);case dl.WALL_VISIBILITY:return e.setValue(st.ROOM_WALL_VISIBILITY,s),void e.setValue(st.ROOM_LANDSCAPE_VISIBILITY,s)}}onObjectRoomPlanePropertyUpdateMessage(t,e){switch(t.type){case ul.FLOOR_THICKNESS:return void e.setValue(st.ROOM_FLOOR_THICKNESS,t.value);case ul.WALL_THICKNESS:return void e.setValue(st.ROOM_WALL_THICKNESS,t.value)}}onObjectRoomFloorHoleUpdateMessage(t,e){switch(t.type){case hl.ADD:return this._planeParser.addFloorHole(t.id,t.x,t.y,t.width,t.height),void(this._needsMapUpdate=!0);case hl.REMOVE:return this._planeParser.removeFloorHole(t.id),void(this._needsMapUpdate=!0)}}onObjectRoomColorUpdateMessage(t,e){t&&e&&(this._Str_14932=this._color,this._Str_17003=this._Str_3576,this._Str_11287=t.color,this._Str_16460=t.light,this._Str_9785=this.time,this._Str_17191=1500,e.setValue(st.ROOM_COLORIZE_BG_ONLY,t.backgroundOnly))}mouseEvent(t,e){if(!(t&&e&&this.object&&this.object.model))return;const s=t.spriteTag;let i=0;if(s&&s.indexOf("@")>=0&&(i=parseInt(s.substr(s.indexOf("@")+1))),i<1||i>this._planeParser.planeCount)return void(t.type===oh.ROLL_OUT&&this.object.model.setValue(st.ROOM_SELECTED_PLANE,0));i--;let r=null;const n=this._planeParser.getPlaneLocation(i),a=this._planeParser.getPlaneLeftSide(i),o=this._planeParser.getPlaneRightSide(i),c=this._planeParser.getPlaneNormalDirection(i),_=this._planeParser.getPlaneType(i);if(null==n||null==a||null==o||null==c)return;const h=a.length,l=o.length;if(0==h||0==l)return;const u=new A.j(t.screenX,t.screenY);if(r=e.getPlanePosition(u,n,a,o),!r)return void this.object.model.setValue(st.ROOM_SELECTED_PLANE,0);const d=ot.product(a,r.x/h);d.add(ot.product(o,r.y/l)),d.add(n);const g=d.x,m=d.y,p=d.z;if(!(r.x>=0&&r.x<h&&r.y>=0&&r.y<l))return void this.object.model.setValue(st.ROOM_SELECTED_PLANE,0);this.object.model.setValue(st.ROOM_SELECTED_X,g),this.object.model.setValue(st.ROOM_SELECTED_Y,m),this.object.model.setValue(st.ROOM_SELECTED_Z,p),this.object.model.setValue(st.ROOM_SELECTED_PLANE,i+1);let E=null;switch(t.type===oh.MOUSE_MOVE||t.type===oh.ROLL_OVER?E=nh.MOUSE_MOVE:t.type===oh.MOUSE_CLICK&&(E=nh.CLICK),t.type){case oh.MOUSE_MOVE:case oh.ROLL_OVER:case oh.MOUSE_CLICK:{let e=null;if(_===ba.PLANE_FLOOR)e=new vd(E,this.object,t._Str_3463,g,m,p,t.altKey,t.ctrlKey,t.shiftKey,t.buttonDown);else if(_===ba.PLANE_WALL||_===ba.PLANE_LANDSCAPE){let s=90;c&&(s=c.x+90,s>360&&(s-=360)),e=new Td(E,this.object,t._Str_3463,n,a,o,a.length*r.x/h,o.length*r.y/l,s,t.altKey,t.ctrlKey,t.shiftKey,t.buttonDown)}return void(this.eventDispatcher&&this.eventDispatcher.dispatchEvent(e))}}}}class Tg extends Ud{initialize(t){this.object&&(this.object.model.setValue(st.FURNITURE_ALPHA_MULTIPLIER,1),this.object.setState(1,0))}processUpdateMessage(t){if(super.processUpdateMessage(t),t instanceof Md&&this.object)switch(t.type){case Md.ENABLED:return void this.object.setState(0,0);case Md.DISABLED:return void this.object.setState(1,0)}}}let Og=(()=>{class t extends Ud{constructor(){super(),this._lastEventId=null,this._isHidden=!1}initialize(e){this.object&&(this.object.model.setValue(st.FURNITURE_ALPHA_MULTIPLIER,1),this.object.setState(t.CURSOR_HIDDEN_STATE,0))}processUpdateMessage(e){e instanceof Cd&&(this._lastEventId||this._lastEventId!==e._Str_20637)&&(e.toggleVisibility&&(this._isHidden=!this._isHidden),super.processUpdateMessage(e),this.object&&(this._isHidden?this.object.setState(t.CURSOR_HIDDEN_STATE,0):e.visible?(this.object.model.setValue(st.TILE_CURSOR_HEIGHT,e.height),this.object.setState(e.height>.8?t.CURSOR_HEIGHT_STATE:t.CURSOR_VISIBLE_STATE)):this.object.setState(t.CURSOR_HIDDEN_STATE,0)),this._lastEventId=e._Str_20637)}}return t.CURSOR_VISIBLE_STATE=0,t.CURSOR_HIDDEN_STATE=1,t.CURSOR_HEIGHT_STATE=6,t})(),Ag=(()=>{class t{}return t.FURNITURE_BASIC="furniture_basic",t.FURNITURE_MULTISTATE="furniture_multistate",t.FURNITURE_MULTIHEIGHT="furniture_multiheight",t.FURNITURE_RANDOMSTATE="furniture_randomstate",t.FURNITURE_PLACEHOLDER="furniture_placeholder",t.FURNITURE_CREDIT="furniture_credit",t.FURNITURE_STICKIE="furniture_stickie",t.FURNITURE_PRESENT="furniture_present",t.FURNITURE_TROPHY="furniture_trophy",t.FURNITURE_ECOTRON_BOX="furniture_ecotron_box",t.FURNITURE_DICE="furniture_dice",t.FURNITURE_HOCKEY_SCORE="furniture_hockey_score",t.FURNITURE_HABBOWHEEL="furniture_habbowheel",t.FURNITURE_ONE_WAY_DOOR="furniture_one_way_door",t.FURNITURE_PLANET_SYSTEM="furniture_planet_system",t.FURNITURE_WINDOW="furniture_window",t.FURNITURE_EXTERNAL_IMAGE_WALLITEM="furniture_external_image_wallitem",t.FURNITURE_ROOMDIMMER="furniture_roomdimmer",t.FURNITURE_SOUND_MACHINE="furniture_sound_machine",t.FURNITURE_JUKEBOX="furniture_jukebox",t.FURNITURE_CRACKABLE="furniture_crackable",t.FURNITURE_PUSHABLE="furniture_pushable",t.FURNITURE_CLOTHING_CHANGE="furniture_clothing_change",t.FURNITURE_COUNTER_CLOCK="furniture_counter_clock",t.FURNITURE_SCORE="furniture_score",t.FURNITURE_ES="furniture_es",t.FURNITURE_FIREWORKS="furniture_fireworks",t.FURNITURE_SONG_DISK="furniture_song_disk",t.FURNITURE_BB="furniture_bb",t.FURNITURE_BG="furniture_bg",t.FURNITURE_WELCOME_GIFT="furniture_welcome_gift",t.FURNITURE_FLOOR_HOLE="furniture_floor_hole",t.FURNITURE_MANNEQUIN="furniture_mannequin",t.FURNITURE_GUILD_CUSTOMIZED="furniture_guild_customized",t.FURNITURE_GROUP_FORUM_TERMINAL="furniture_group_forum_terminal",t.FURNITURE_PET_CUSTOMIZATION="furniture_pet_customization",t.FURNITURE_CUCKOO_CLOCK="furniture_cuckoo_clock",t.FURNITURE_VOTE_COUNTER="furniture_vote_counter",t.FURNITURE_VOTE_MAJORITY="furniture_vote_majority",t.FURNITURE_SOUNDBLOCK="furniture_soundblock",t.FURNITURE_RANDOM_TELEPORT="furniture_random_teleport",t.FURNITURE_MONSTERPLANT_SEED="furniture_monsterplant_seed",t.FURNITURE_PURCHASABLE_CLOTHING="furniture_purchasable_clothing",t.FURNITURE_BACKGROUND_COLOR="furniture_background_color",t.FURNITURE_MYSTERYBOX="furniture_mysterybox",t.FURNITURE_EFFECTBOX="furniture_effectbox",t.FURNITURE_MYSTERYTROPHY="furniture_mysterytrophy",t.FURNITURE_ACHIEVEMENT_RESOLUTION="furniture_achievement_resolution",t.FURNITURE_LOVELOCK="furniture_lovelock",t.FURNITURE_WILDWEST_WANTED="furniture_wildwest_wanted",t.FURNITURE_HWEEN_LOVELOCK="furniture_hween_lovelock",t.FURNITURE_BADGE_DISPLAY="furniture_badge_display",t.FURNITURE_HIGH_SCORE="furniture_high_score",t.FURNITURE_INTERNAL_LINK="furniture_internal_link",t.FURNITURE_CUSTOM_STACK_HEIGHT="furniture_custom_stack_height",t.FURNITURE_YOUTUBE="furniture_youtube",t.FURNITURE_RENTABLE_SPACE="furniture_rentable_space",t.FURNITURE_CHANGE_STATE_WHEN_STEP_ON="furniture_change_state_when_step_on",t.FURNITURE_VIMEO="furniture_vimeo",t.FURNITURE_EDITABLE_INTERNAL_LINK="furniture_editable_internal_link",t.FURNITURE_EDITABLE_ROOM_LINK="furniture_editable_room_link",t.FURNITURE_CRAFTING_GIZMO="furniture_crafting_gizmo",t.ROOM="room",t.USER="user",t.BOT="bot",t.RENTABLE_BOT="rentable_bot",t.PET="pet",t.TILE_CURSOR="tile_cursor",t.SELECTION_ARROW="selection_arrow",t.GAME_SNOWBALL="game_snowball",t.GAME_SNOWSPLASH="game_snowsplash",t})();class yg{constructor(){this._events=new N,this._cachedEvents=new Map,this._registeredEvents=new Map,this._functions=[]}getLogic(t){const e=this.getLogicType(t);if(!e)return null;const s=new e;if(!s)return null;if(s.eventDispatcher=this._events,!this._cachedEvents.get(t)){this._cachedEvents.set(t,!0);const e=s.getEventTypes();for(const t of e)t&&this.registerEventType(t)}return s}registerEventType(t){if(!this._registeredEvents.get(t)){this._registeredEvents.set(t,!0);for(const e of this._functions)e&&this._events.addEventListener(t,e)}}registerEventFunction(t){if(t&&!(this._functions.indexOf(t)>=0)){this._functions.push(t);for(const e of this._registeredEvents.keys())e&&this._events.addEventListener(e,t)}}removeEventFunction(t){if(!t)return;const e=this._functions.indexOf(t);if(-1!==e){this._functions.splice(e,1);for(const e of this._registeredEvents.keys())e&&this._events.removeEventListener(e,t)}}getLogicType(t){if(!t)return null;let e=null;switch(t){case Ag.ROOM:e=vg;break;case Ag.TILE_CURSOR:e=Og;break;case Ag.SELECTION_ARROW:e=Tg;break;case Ag.USER:case Ag.BOT:case Ag.RENTABLE_BOT:e=Pd;break;case Ag.PET:e=Rg;break;case Ag.FURNITURE_BASIC:e=xd;break;case Ag.FURNITURE_BADGE_DISPLAY:e=Fd;break;case Ag.FURNITURE_CHANGE_STATE_WHEN_STEP_ON:e=Gd;break;case Ag.FURNITURE_COUNTER_CLOCK:e=Vd;break;case Ag.FURNITURE_CREDIT:e=Yd;break;case Ag.FURNITURE_CUSTOM_STACK_HEIGHT:e=Bd;break;case Ag.FURNITURE_DICE:e=Hd;break;case Ag.FURNITURE_EDITABLE_INTERNAL_LINK:e=Wd;break;case Ag.FURNITURE_EDITABLE_ROOM_LINK:e=Zd;break;case Ag.FURNITURE_EXTERNAL_IMAGE_WALLITEM:e=zd;break;case Ag.FURNITURE_FIREWORKS:e=Xd;break;case Ag.FURNITURE_FLOOR_HOLE:e=Kd;break;case Ag.FURNITURE_GUILD_CUSTOMIZED:e=qd;break;case Ag.FURNITURE_HIGH_SCORE:e=Jd;break;case Ag.FURNITURE_HOCKEY_SCORE:e=Qd;break;case Ag.FURNITURE_ES:e=$d;break;case Ag.FURNITURE_MANNEQUIN:e=tg;break;case Ag.FURNITURE_MULTIHEIGHT:e=eg;break;case Ag.FURNITURE_MULTISTATE:e=jd;break;case Ag.FURNITURE_ONE_WAY_DOOR:e=sg;break;case Ag.FURNITURE_PET_CUSTOMIZATION:e=ig;break;case Ag.FURNITURE_PRESENT:e=rg;break;case Ag.FURNITURE_PURCHASABLE_CLOTHING:e=ng;break;case Ag.FURNITURE_PUSHABLE:e=ag;break;case Ag.FURNITURE_BACKGROUND_COLOR:e=og;break;case Ag.FURNITURE_BG:e=lg;break;case Ag.FURNITURE_BB:e=ug;break;case Ag.FURNITURE_ROOMDIMMER:e=dg;break;case Ag.FURNITURE_SCORE:e=gg;break;case Ag.FURNITURE_SOUNDBLOCK:e=mg;break;case Ag.FURNITURE_STICKIE:e=pg;break;case Ag.FURNITURE_TROPHY:e=Eg;break;case Ag.FURNITURE_VOTE_COUNTER:e=fg;break;case Ag.FURNITURE_VOTE_MAJORITY:e=Sg;break;case Ag.FURNITURE_WINDOW:e=bg;break;default:e=xd}return e||(D.log("Unknown Logic: "+t),null)}get events(){return this._events}}class Cg{constructor(t,e,s,i,r,n,a,o=NaN,c=-1,_=0,h=0,l="",u=!0,d=!0,g=-1){this._id=t,this._typeId=e,this._type=s,this._state=n,this._data=a,this._extra=o,this._expiryTime=c,this._usagePolicy=_,this._ownerId=h,this._ownerName=l,this._synchronized=u,this._realRoomObject=d,this._sizeZ=g,this._location=new ot,this._direction=new ot,this._location.assign(i),this._direction.assign(r)}get id(){return this._id}get typeId(){return this._typeId}get type(){return this._type}get location(){return this._location}get direction(){return this._direction}get state(){return this._state}get data(){return this._data}get extra(){return this._extra}get expiryTime(){return this._expiryTime}get usagePolicy(){return this._usagePolicy}get ownerId(){return this._ownerId}get ownerName(){return this._ownerName}get synchronized(){return this._synchronized}get realRoomObject(){return this._realRoomObject}get sizeZ(){return this._sizeZ}}class Mg{constructor(t,e){this._roomId=t,this._data=e,this._floorType=null,this._wallType=null,this._landscapeType=null}get roomId(){return this._roomId}get data(){return this._data}get floorType(){return this._floorType}set floorType(t){this._floorType=t}get wallType(){return this._wallType}set wallType(t){this._wallType=t}get landscapeType(){return this._landscapeType}set landscapeType(t){this._landscapeType=t}}let Dg=(()=>{class t{constructor(){this._targetId=-1,this._targetCategory=-2,this._targetLoc=null,this._moveDistance=0,this._previousMoveSpeed=0,this._maintainPreviousMoveSpeed=!1,this._currentLoc=null,this._limitedLocX=!1,this._limitedLocY=!1,this._centeredLocX=!1,this._centeredLocY=!1,this._screenWd=0,this._screenHt=0,this._scale=0,this._roomWd=0,this._roomHt=0,this._geometryUpdateId=-1,this._scaleChanged=!1,this._targetObjectLoc=new ot}get location(){return this._currentLoc}get _Str_10760(){return this._targetId}set _Str_10760(t){this._targetId=t}get _Str_16562(){return this._targetCategory}set _Str_16562(t){this._targetCategory=t}get _Str_16185(){return this._targetObjectLoc}set _Str_16185(t){this._targetObjectLoc.assign(t)}get _Str_10235(){return this._limitedLocX}set _Str_10235(t){this._limitedLocX=t}get _Str_10446(){return this._limitedLocY}set _Str_10446(t){this._limitedLocY=t}get _Str_8564(){return this._centeredLocX}set _Str_8564(t){this._centeredLocX=t}get _Str_8690(){return this._centeredLocY}set _Str_8690(t){this._centeredLocY=t}get _Str_7609(){return this._screenWd}set _Str_7609(t){this._screenWd=t}get _Str_7902(){return this._screenHt}set _Str_7902(t){this._screenHt=t}get scale(){return this._scale}set scale(t){this._scale!=t&&(this._scale=t,this._scaleChanged=!0)}get _Str_18975(){return this._roomWd}set _Str_18975(t){this._roomWd=t}get _Str_15953(){return this._roomHt}set _Str_15953(t){this._roomHt=t}get _Str_16377(){return this._geometryUpdateId}set _Str_16377(t){this._geometryUpdateId=t}get _Str_12536(){return null!=this._targetLoc&&null!=this._currentLoc}set target(t){let e;null==this._targetLoc&&(this._targetLoc=new ot),this._targetLoc.x==t.x&&this._targetLoc.y==t.y&&this._targetLoc.z==t.z||(this._targetLoc.assign(t),e=ot.dif(this._targetLoc,this._currentLoc),this._moveDistance=e.length,this._maintainPreviousMoveSpeed=!0)}dispose(){this._targetLoc=null,this._currentLoc=null}_Str_20685(t){null==this._currentLoc&&(this._currentLoc=new ot,this._currentLoc.assign(t))}_Str_25467(t){null==this._currentLoc&&(this._currentLoc=new ot),this._currentLoc.assign(t)}update(e,s){let i,r,n,a,o;if(this._followDuration>0&&null!=this._targetLoc&&null!=this._currentLoc){if(this._scaleChanged)return this._scaleChanged=!1,this._currentLoc=this._targetLoc,void(this._targetLoc=null);i=ot.dif(this._targetLoc,this._currentLoc),i.length>this._moveDistance&&(this._moveDistance=i.length),i.length<=s?(this._currentLoc=this._targetLoc,this._targetLoc=null,this._previousMoveSpeed=0):(r=Math.sin(Math.PI*i.length/this._moveDistance),n=.5*s,a=this._moveDistance/t.MOVE_SPEED_DENOMINATOR,o=n+(a-n)*r,this._maintainPreviousMoveSpeed&&(o<this._previousMoveSpeed?(o=this._previousMoveSpeed,o>i.length&&(o=i.length)):this._maintainPreviousMoveSpeed=!1),this._previousMoveSpeed=o,i.divide(i.length),i.multiply(o),this._currentLoc=ot.sum(this._currentLoc,i))}}reset(){this._geometryUpdateId=-1}_Str_19465(t){this._followDuration=t}}return t.MOVE_SPEED_DENOMINATOR=12,t})();class Ng{constructor(t,e){this._tileObjectMap=new Map;let s=0;for(;s<e;)this._tileObjectMap.set(s,new Map),s++;this._width=t,this._height=e}clear(){for(const t of this._tileObjectMap.values())t&&t.clear();this._tileObjectMap.clear()}populate(t){this.clear();for(const e of t)this._Str_21192(e)}dispose(){this._tileObjectMap=null,this._width=0,this._height=0}_Str_19056(t,e){if(t>=0&&t<this._width&&e>=0&&e<this._height){const s=this._tileObjectMap.get(e);if(s)return s.get(t)}return null}_Str_23932(t,e,s){if(s.isReady){if(t>=0&&t<this._width&&e>=0&&e<this._height){const i=this._tileObjectMap.get(e);i&&i.set(t,s)}}else D.log("Assigning non initialized object to tile object map!")}_Str_21192(t){if(!t||!t.model||!t.isReady)return;const e=t.getLocation(),s=t.getDirection();if(!e||!s)return;let i=t.model.getValue(st.FURNITURE_SIZE_X),r=t.model.getValue(st.FURNITURE_SIZE_Y);i<1&&(i=1),r<1&&(r=1);const n=Math.trunc(s.x+45)%360/90;1!==n&&3!==n||([i,r]=[r,i]);let a=e.y;for(;a<e.y+r;){let s=e.x;for(;s<e.x+i;){const i=this._Str_19056(s,a);(!i||i!==t&&i.getLocation().z<=e.z)&&this._Str_23932(s,a,t),s++}a++}}}class wg{constructor(t){this._roomId=t,this._modelName=null,this._legacyGeometry=new _d,this._tileObjectMap=null,this._roomCamera=new Dg,this._selectedObject=null,this._placedObject=null,this._furnitureStackingHeightMap=null,this._floorStack=new Map,this._wallStack=new Map,this._mouseButtonCursorOwners=[]}dispose(){}setModelName(t){this._modelName=t}setSelectedObject(t){this._selectedObject&&this._selectedObject.dispose(),this._selectedObject=t}setPlacedObject(t){this._placedObject&&this._placedObject.dispose(),this._placedObject=t}setFurnitureStackingHeightMap(t){this._furnitureStackingHeightMap&&this._furnitureStackingHeightMap.dispose(),this._furnitureStackingHeightMap=t,this._tileObjectMap&&this._tileObjectMap.dispose(),this._furnitureStackingHeightMap&&(this._tileObjectMap=new Ng(this._furnitureStackingHeightMap.width,this._furnitureStackingHeightMap.height))}addPendingFurnitureFloor(t){t&&(this._floorStack.delete(t.id),this._floorStack.set(t.id,t))}removePendingFunitureFloor(t){const e=this._floorStack.get(t);return e?(this._floorStack.delete(t),e):null}getPendingFurnitureFloor(t){const e=this._floorStack.get(t);return e?(this._floorStack.delete(t),e):null}getNextPendingFurnitureFloor(){if(!this._floorStack.size)return null;const t=this._floorStack.keys();return this.getPendingFurnitureFloor(t.next().value)}addPendingFurnitureWall(t){t&&(this._wallStack.delete(t.id),this._wallStack.set(t.id,t))}removePendingFurnitureWall(t){const e=this._wallStack.get(t);return e?(this._wallStack.delete(t),e):null}getPendingFurnitureWall(t){const e=this._wallStack.get(t);return e?(this._wallStack.delete(t),e):null}getNextPendingFurnitureWall(){if(!this._wallStack.size)return null;const t=this._wallStack.keys();return this.getPendingFurnitureWall(t.next().value)}_Str_16810(t){return-1===this._mouseButtonCursorOwners.indexOf(t)&&(this._mouseButtonCursorOwners.push(t),!0)}_Str_11959(t){const e=this._mouseButtonCursorOwners.indexOf(t);return e>-1&&(this._mouseButtonCursorOwners.splice(e,1),!0)}_Str_22598(){return this._mouseButtonCursorOwners.length>0}get roomId(){return this._roomId}get modelName(){return this._modelName}get legacyGeometry(){return this._legacyGeometry}get tileObjectMap(){return this._tileObjectMap}get roomCamera(){return this._roomCamera}get selectedObject(){return this._selectedObject}get placedObject(){return this._placedObject}get furnitureStackingHeightMap(){return this._furnitureStackingHeightMap}}class Ug{constructor(t,e){this._object=t,this._groupBadge=e}get object(){return this._object}get groupBadge(){return this._groupBadge}}let Lg=(()=>{class t{constructor(){this._Str_3008=0,this._Str_18433=0}static _Str_22230(e,s){const i=[];for(const r of e)if(r)if("boutique_mannequin1"===r.type&&0===r.name.indexOf("mannequin_")){const e=s.getRoomObject(s.activeRoomId,r.objectId,tt.FLOOR);if(e){const s=e.visualization.getSpriteList();if(s)for(const e of s)e.x=e.x+(r.x+r.width/2+t._Str_16967),e.y=e.y+(r.y+r.height+t._Str_18197),e.z=e.z+r.z,i.push(e)}}else i.push(r);return i}static _Str_22564(t,e){return t.z<e.z?1:-1}static _Str_20789(t,e,s){return!0}static _Str_14110(t,e,s,i){const r=[];if(t.x==e.x?r.push(t,s,e,i):t.x==s.x?r.push(t,e,s,i):e.x<t.x&&e.y>t.y||e.x>t.x&&e.y<t.y?r.push(t,s,e,i):r.push(t,e,s,i),r[0].x<r[1].x){let t=r[0];r[0]=r[1],r[1]=t,t=r[2],r[2]=r[3],r[3]=t}if(r[0].y<r[2].y){let t=r[0];r[0]=r[2],r[2]=t,t=r[1],r[1]=r[3],r[3]=t}return r}_Str_4536(e,s,i,r){const n=[];let a=s.getSortableSpriteList();const o=i._Str_21072(i.activeRoomId,tt.UNIT);for(const c of o)if(c.id!==r){const e=c.visualization.getSpriteList();if(e){let r=0,n=0;for(const t of a)if(t.name==="avatar_"+c.id){r=t.z,n=t.y+t.height-s.geometry.scale/4;break}const o=i.getRoomObjectScreenLocation(i.activeRoomId,c.id,tt.UNIT,s.id);if(o){0===n&&(n=o.y);for(const i of e)i.x=i.x+(o.x-s.screenOffsetX),i.y=i.y+n,i.z=i.z+r,0!==i.name.indexOf("h_std_fx29_")&&0!==i.name.indexOf("h_std_fx185_")||(i.y=i.y+t._Str_18565),a.push(i)}}}a=t._Str_22230(a,i),a.sort(t._Str_22564);for(const c of a)null!==c.name&&c.name.length>0&&0!==c.name.indexOf("tile_cursor_")&&t._Str_20789(c,e,s)&&(r<0||c.objectId!=r)&&(n.push(this._Str_25132(c,e,s,i)),this._Str_6409||(this._Str_6409=c.z),this._Str_3008++);return JSON.stringify(n)}_Str_24177(t){return JSON.stringify(new Object)}_Str_25132(e,s,i,r){let n=[];const a={};let o=e.name;return-1!==e.name.indexOf("@")&&(n=e.name.split("@"),o=n[0]),a.name=o,a.x=e.x-s.x,a.y=e.y-s.y,a.x=a.x+i.screenOffsetX,a.y=a.y+i.screenOffsetY,a.z=e.z,e.alpha&&"255"!==e.alpha.toString()&&(a.alpha=e.alpha),e.flipH&&(a.flipH=e.flipH),e.skew&&(a.skew=e.skew),e.frame&&(a.frame=e.frame),e.color&&e.color.length>0&&(a.color=parseInt(e.color)),e.blendMode&&"normal"!==e.blendMode&&(a.blendMode=e.blendMode),0===o.indexOf("http")&&(a.width=e.width,a.height=e.height,this._Str_18433++,this._Str_18433>t._Str_17558&&(a.name="box")),e.posture&&(a.posture=e.posture),a}_Str_25196(e,s,i){const r=new A.j(0,0),n=new A.j(e.width,0),a=new A.j(0,e.height),o=new A.j(e.width,e.height),c=t._Str_14110(r,n,a,o);let _=0;i.length>0?(_=i[0].z,this._Str_6409&&(_=Math.max(this._Str_6409,_))):_=this._Str_6409?this._Str_6409:0,_+=1.776104*this._Str_3008+2.31743*i.length;const h=new yu(null,s);return h.cornerPoints=c,h.z=_,h}_Str_25623(t,e,s){const i=new Map;let r=1;this._Str_6409&&(r+=this._Str_6409);for(const o of t)i.set(o.uniqueId,{plane:o,z:r});const n=e._Str_14588();n.sort((t,e)=>e.z-t.z),n.reverse();let a=[];for(const o of n){const t=o.sprite;if(t){const e=i.get(t.id);e&&(i.delete(t.id),e.z=o.z,a.push(e))}}return a=a.concat(Array.from(i.values())),a}_Str_22985(e,s,i,r){const n=[],a=i.getRoomObject(i.activeRoomId,Pg.ROOM_OBJECT_ID,tt.ROOM).visualization;if(a){const o=s.geometry,c=this._Str_25623(a._Str_19113,s,i),_=um.instance.stage;for(const i of c){const r=i.plane,a=[],c=ot.sum(r.location,r._Str_5424),h=o.getScreenPoint(r.location),l=o.getScreenPoint(c),u=o.getScreenPoint(ot.sum(r.location,r._Str_4968)),d=o.getScreenPoint(ot.sum(c,r._Str_4968));a.push(h,l,u,d);let g=0,m=0;for(const t of a)t.x+=_.width/2,t.y+=_.height/2,t.x+=s.screenOffsetX,t.y+=s.screenOffsetY,t.x+=-e.x,t.y+=-e.y,t.x<0?g--:t.x>=e.width&&g++,t.y<0?m--:t.y>=e.height&&m++;if(4===Math.abs(g)||4===Math.abs(m));else{const e=t._Str_14110(h,l,u,d);for(const t of r._Str_22136(o))t.cornerPoints=e,t.z=i.z,n.push(t)}}n.unshift(this._Str_25196(e,r,n))}return n}}return t._Str_16967=1,t._Str_18197=-16,t._Str_18565=-52,t._Str_17558=30,t})(),Pg=(()=>{class t extends z{constructor(t){super(),this._communication=t,this._sessionDataManager=null,this._roomSessionManager=null,this._roomManager=null,this._roomObjectEventHandler=new wd(this),this._roomMessageHandler=new hd(this),this._roomContentLoader=new rt,this._ready=!1,this._activeRoomId=-1,this._activeRoomActiveCanvas=-1,this._roomInstanceDatas=new Map,this._roomDatas=new Map,this._roomRendererFactory=new Rh,this._visualizationFactory=new nd,this._logicFactory=new yg,this._activeRoomActiveCanvasMouseX=0,this._activeRoomActiveCanvasMouseY=0,this._activeRoomIsDragged=!1,this._activeRoomWasDragged=!1,this._activeRoomDragStartX=0,this._activeRoomDragStartY=0,this._activeRoomDragX=0,this._activeRoomDragY=0,this._skipFurnitureCreationForNextFrame=!1,this._mouseCursorUpdate=!1,this._imageObjectIdBank=null,this._imageCallbacks=new Map,this._thumbnailCallbacks=new Map,this._roomDraggingAlwaysCenters=!1,this._roomAllowsDragging=!0,this._badgeListenerObjects=new Map,this.runVisibilityUpdate=this.runVisibilityUpdate.bind(this),this.processRoomObjectEvent=this.processRoomObjectEvent.bind(this),this.onRoomSessionEvent=this.onRoomSessionEvent.bind(this),this.onBadgeImageReadyEvent=this.onBadgeImageReadyEvent.bind(this)}onInit(){this._ready||(this._imageObjectIdBank=new Ih(1e3),this._thumbnailObjectIdBank=new Ih(1e3),this._logicFactory.registerEventFunction(this.processRoomObjectEvent),this._roomManager&&(this._roomManager.setContentLoader(this._roomContentLoader),this._roomManager.addUpdateCategory(tt.FLOOR),this._roomManager.addUpdateCategory(tt.WALL),this._roomManager.addUpdateCategory(tt.UNIT),this._roomManager.addUpdateCategory(tt.CURSOR),this._roomManager.addUpdateCategory(tt.ROOM)),this._roomMessageHandler.setConnection(this._communication.connection),this._roomContentLoader.initialize(this.events),this._roomContentLoader.setSessionDataManager(this._sessionDataManager),this._roomContentLoader.setIconListener(this),this._roomSessionManager&&(this._roomSessionManager.events.addEventListener(Fe.STARTED,this.onRoomSessionEvent),this._roomSessionManager.events.addEventListener(Fe.ENDED,this.onRoomSessionEvent)),um.instance.ticker.add(this.update,this),document.addEventListener("visibilitychange",this.runVisibilityUpdate))}onDispose(){if(this._ready){for(const[t,e]of this._roomInstanceDatas)this.removeRoomInstance(t);document.removeEventListener("visibilitychange",this.runVisibilityUpdate),um.instance.ticker.remove(this.update,this),this._roomObjectEventHandler&&this._roomObjectEventHandler.dispose(),this._roomMessageHandler&&this._roomMessageHandler.dispose(),this._roomSessionManager&&(this._roomSessionManager.events.removeEventListener(Fe.STARTED,this.onRoomSessionEvent),this._roomSessionManager.events.removeEventListener(Fe.ENDED,this.onRoomSessionEvent))}}onRoomSessionEvent(t){if(t instanceof Fe)switch(t.type){case Fe.STARTED:return void(this._roomMessageHandler&&this._roomMessageHandler.setRoomId(t.session.roomId));case Fe.ENDED:return void(this._roomMessageHandler&&(this._roomMessageHandler.clearRoomId(),this.removeRoomInstance(t.session.roomId)))}}setActiveRoomId(t){this._activeRoomId=t}destroyRoom(t){this.removeRoomInstance(t)}getRoomInstance(t){return this._roomManager&&this._roomManager.getRoomInstance(this.getRoomId(t))||null}removeRoomInstance(t){this.getRoomInstance(t)&&this._roomManager&&this._roomManager.removeRoomInstance(this.getRoomId(t));const e=this._roomInstanceDatas.get(t);e&&(this._roomInstanceDatas.delete(e.roomId),e.dispose()),this.events.dispatchEvent(new ih(ih.DISPOSED,t))}createRoomInstance(t,e){let s="111",i="201",r="1";if(!this._ready){let n=this._roomDatas.get(t);return n&&(this._roomDatas.delete(t),s=n.floorType,i=n.wallType,r=n.landscapeType),n=new Mg(t,e),n.floorType=s,n.wallType=i,n.landscapeType=r,this._roomDatas.set(t,n),void D.log("Room Engine not initilized yet, can not create room. Room data stored for later initialization.")}if(!e)return void D.log("Room property messages received before floor height map, will initialize when floor height map received.");const n=this._roomDatas.get(t);n&&(this._roomDatas.delete(t),n.floorType&&(s=n.floorType),n.wallType&&(i=n.wallType),n.landscapeType&&(r=n.landscapeType)),this.setupRoomInstance(t,e,s,i,r,this.getRoomInstanceModelName(t))&&(this._roomAllowsDragging=!e.restrictsDragging,this.events.dispatchEvent(new ih(ih.INITIALIZED,t)))}setupRoomInstance(e,s,i,r,n,a){if(!this._ready||!this._roomManager)return;const o=this._roomManager.createRoomInstance(this.getRoomId(e));if(!o)return null;const c=o.createRoomObjectAndInitalize(t.ROOM_OBJECT_ID,t.ROOM_OBJECT_TYPE,tt.ROOM);if(o.model.setValue(od.ROOM_IS_PUBLIC,0),o.model.setValue(od.ROOM_Z_SCALE,1),s&&(o.model.setValue(od.RESTRICTS_DRAGGING,s.restrictsDragging),o.model.setValue(od.RESTRICTS_SCALING,s.restrictsScaling),o.model.setValue(od.RESTRICTED_SCALE,s.restrictedScale),s.dimensions)){const t=s.dimensions.minX,e=s.dimensions.maxX,i=s.dimensions.minY,r=s.dimensions.maxY;o.model.setValue(od.ROOM_MIN_X,t),o.model.setValue(od.ROOM_MAX_X,e),o.model.setValue(od.ROOM_MIN_Y,i),o.model.setValue(od.ROOM_MAX_Y,r);const n=423*t+671*e+913*i+7509*r;c&&c.model&&c.model.setValue(st.ROOM_RANDOM_SEED,n)}const _=c&&c.logic||null;if(_&&(_.initialize(s),i&&(_.processUpdateMessage(new gl(gl.ROOM_FLOOR_UPDATE,i)),o.model.setValue(st.ROOM_FLOOR_TYPE,i)),r&&(_.processUpdateMessage(new gl(gl.ROOM_WALL_UPDATE,r)),o.model.setValue(st.ROOM_WALL_TYPE,r)),n&&(_.processUpdateMessage(new gl(gl.ROOM_LANDSCAPE_UPDATE,n)),o.model.setValue(st.ROOM_LANDSCAPE_TYPE,n))),s&&s.doors.length){let t=0;for(;t<s.doors.length;){const e=s.doors[t];if(e){const s=e.x,i=e.y,r=e.z,n=e.dir,a=ll.DOOR,c="door_"+t,h=new ot(s,i,r);_.processUpdateMessage(new ll(ll.ADD_MASK,c,a,h,ll.HOLE)),90!==n&&180!==n||(90===n&&(o.model.setValue(st.ROOM_DOOR_X,s-.5),o.model.setValue(st.ROOM_DOOR_Y,i)),180===n&&(o.model.setValue(st.ROOM_DOOR_X,s),o.model.setValue(st.ROOM_DOOR_Y,i-.5)),o.model.setValue(st.ROOM_DOOR_Z,r),o.model.setValue(st.ROOM_DOOR_DIR,n))}t++}}return o.createRoomObjectAndInitalize(t.CURSOR_OBJECT_ID,t.CURSOR_OBJECT_TYPE,tt.CURSOR),o}getRoomInstanceDisplay(e,s,i,r,n){const a=this.getRoomInstance(e);if(!a)return null;let o=a.renderer;if(!o&&(o=this._roomRendererFactory.createRenderer(),!o))return null;o.roomObjectVariableAccurateZ=st.OBJECT_ACCURATE_Z_VALUE,a.setRenderer(o);const c=o.createCanvas(s,i,r,n);if(!c)return null;if(a.model.getValue(od.RESTRICTS_SCALING)){let t=a.model.getValue(od.RESTRICTED_SCALE);t||(t=1),c.setScale(t),c.restrictsScaling=!0}else c.restrictsScaling=!1;if(c.setMouseListener(this._roomObjectEventHandler),c.geometry){c.geometry.z_scale=a.model.getValue(od.ROOM_Z_SCALE);const e=a.model.getValue(st.ROOM_DOOR_X),s=a.model.getValue(st.ROOM_DOOR_Y),i=a.model.getValue(st.ROOM_DOOR_Z),r=a.model.getValue(st.ROOM_DOOR_DIR),n=new ot(e,s,i);let o=null;90===r&&(o=new ot(-2e3,0,0)),180===r&&(o=new ot(0,-2e3,0)),c.geometry.setDisplacement(n,o);const _=c.master;if(_){const e=A.n.from(A.p.EMPTY);e.name=t.OVERLAY,e.interactive=!1,_.addChild(e)}}return c.master}setRoomInstanceRenderingCanvasMask(t,e,s){const i=this.getRoomInstanceRenderingCanvas(t,e);i&&i.setMask(s)}setRoomInstanceRenderingCanvasScale(t,e,s,i=null,r=null,n=!1,a=!1){const o=this.getRoomInstanceRenderingCanvas(t,e);if(o){if(o.restrictsScaling&&!n)return;o.setScale(s,i,r,n,a),this.events.dispatchEvent(new ih(ih.ROOM_ZOOMED,t))}}getRoomInstanceRenderingCanvas(t,e=-1){const s=this.getRoomInstance(t);if(!s)return null;const i=s.renderer;return i?(-1===e&&(e=this._activeRoomActiveCanvas),i.getCanvas(e)||null):null}getActiveRoomInstanceRenderingCanvas(){return this.getRoomInstanceRenderingCanvas(this._activeRoomId,this._activeRoomActiveCanvas)}getRoomInstanceRenderingCanvasOffset(t,e=-1){-1===e&&(e=this._activeRoomActiveCanvas);const s=this.getRoomInstanceRenderingCanvas(t,e);return s?new A.j(s.screenOffsetX,s.screenOffsetY):null}setRoomInstanceRenderingCanvasOffset(t,e,s){const i=this.getRoomInstanceRenderingCanvas(t,e);return!(!i||!s||(i.screenOffsetX=s.x,i.screenOffsetY=s.y,0))}getRoomInstanceRenderingCanvasScale(t=-1e3,e=-1){-1e3===t&&(t=this._activeRoomId),-1===e&&(e=this._activeRoomActiveCanvas);const s=this.getRoomInstanceRenderingCanvas(t,e);return s?s.scale:1}initializeRoomInstanceRenderingCanvas(t,e,s,i){const r=this.getRoomInstanceRenderingCanvas(t,e);r&&r.initialize(s,i)}getRoomInstanceGeometry(t,e=-1){const s=this.getRoomInstance(t);if(!s)return null;const i=s.renderer;if(!i)return null;-1===e&&(e=this._activeRoomActiveCanvas);const r=i.getCanvas(e);return r?r.geometry:null}getRoomInstanceVariable(t,e){const s=this.getRoomInstance(t);return s&&s.model&&s.model.getValue(e)||null}updateRoomInstancePlaneVisibility(t,e,s=!0){const i=this.getRoomOwnObject(t);return!!i&&(i.processUpdateMessage(new dl(dl.WALL_VISIBILITY,e)),i.processUpdateMessage(new dl(dl.FLOOR_VISIBILITY,s)),!0)}updateRoomInstancePlaneThickness(t,e,s){const i=this.getRoomOwnObject(t);return!!i&&(i.processUpdateMessage(new ul(ul.WALL_THICKNESS,e)),i.processUpdateMessage(new ul(ul.FLOOR_THICKNESS,s)),!0)}updateRoomInstancePlaneType(t,e=null,s=null,i=null,r=!1){const n=this.getRoomOwnObject(t),a=this.getRoomInstance(t);if(!n){let r=this._roomDatas.get(t);return r||(r=new Mg(t,null),this._roomDatas.set(t,r)),e&&(r.floorType=e),s&&(r.wallType=s),i&&(r.landscapeType=i),!0}return e&&(a&&!r&&a.model.setValue(st.ROOM_FLOOR_TYPE,e),n.processUpdateMessage(new gl(gl.ROOM_FLOOR_UPDATE,e))),s&&(a&&!r&&a.model.setValue(st.ROOM_WALL_TYPE,s),n.processUpdateMessage(new gl(gl.ROOM_WALL_UPDATE,s))),i&&(a&&!r&&a.model.setValue(st.ROOM_LANDSCAPE_TYPE,i),n.processUpdateMessage(new gl(gl.ROOM_LANDSCAPE_UPDATE,i))),!0}_Str_17804(t,e,s,i){const r=this.getRoomOwnObject(t);if(!r||!r.logic)return!1;const n=new _l(_l.BACKGROUND_COLOR,e,s,i);return r.logic.processUpdateMessage(n),this.events.dispatchEvent(new Dh(t,e,s,i)),!0}addRoomInstanceFloorHole(t,e){if(e<0)return;const s=this.getRoomOwnObject(t),i=this.getRoomObjectFloor(t,e);if(s&&s.logic&&i&&i.model){const t=i.getLocation(),r=i.model.getValue(st.FURNITURE_SIZE_X),n=i.model.getValue(st.FURNITURE_SIZE_Y);s.processUpdateMessage(new hl(hl.ADD,e,t.x,t.y,r,n))}}removeRoomInstanceFloorHole(t,e){if(e<0)return;const s=this.getRoomOwnObject(t);s&&s.processUpdateMessage(new hl(hl.REMOVE,e))}setRoomEngineGameMode(t,e){const s=this.getRoomInstance(t);if(!s)return;const i=e?1:0;s.model.setValue(od.IS_PLAYING_GAME,i),this.events.dispatchEvent(new ih(0===i?ih.NORMAL_MODE:ih.GAME_MODE,t))}isPlayingGame(){return this.getRoomInstance(this._activeRoomId).model.getValue(od.IS_PLAYING_GAME)>0}disableUpdate(t){t?um.instance.ticker.remove(this.update,this):(um.instance.ticker.remove(this.update,this),um.instance.ticker.add(this.update,this))}runUpdate(){this.update(1)}runVisibilityUpdate(){document.hidden||this.update(1,!0)}update(t,e=!1){this._roomManager&&(t=um.instance.time,hh.turnVisualizationOn(),this.processPendingFurniture(),this._roomManager.update(t,e),this._Str_22919(t),this._mouseCursorUpdate&&this.setPointer(),hh.turnVisualizationOff())}setPointer(){this._mouseCursorUpdate=!1;const t=this.getRoomInstanceData(this._activeRoomId);t&&t._Str_22598()?document.body.style.cursor="pointer":document.body.style.cursor="auto"}processPendingFurniture(){if(this._skipFurnitureCreationForNextFrame)return void(this._skipFurnitureCreationForNextFrame=!1);const t=(new Date).valueOf();for(const e of this._roomInstanceDatas.values()){if(!e)continue;let s=null,i=0,r=!1;for(;s=e.getNextPendingFurnitureFloor();)if(r=this.processPendingFurnitureFloor(e.roomId,s.id,s),!(++i%5)&&(new Date).valueOf()-t>=40){this._skipFurnitureCreationForNextFrame=!0;break}for(;!this._skipFurnitureCreationForNextFrame&&(s=e.getNextPendingFurnitureWall());)if(r=this.processPendingFurnitureWall(e.roomId,s.id,s),!(++i%5)&&(new Date).valueOf()-t>=40){this._skipFurnitureCreationForNextFrame=!0;break}if(r&&this._roomManager&&(this._roomManager.getRoomInstance(this.getRoomId(e.roomId)).hasUninitializedObjects()||this.objectsInitialized(e.roomId.toString())),this._skipFurnitureCreationForNextFrame)return}}onRoomEngineInitalized(t){if(t){this._ready=!0,this.events.dispatchEvent(new ih(ih.ENGINE_INITIALIZED,0));for(const t of this._roomDatas.values())t&&this.createRoomInstance(t.roomId,t.data)}}processPendingFurnitureFloor(t,e,s){if(!s){const i=this.getRoomInstanceData(t);if(i&&(s=i.getPendingFurnitureFloor(e)),!s)return!1}let i=s.type;i||(i=this.getFurnitureFloorName(s.typeId));const r=this.createRoomObjectFloor(t,e,i);if(!r)return!1;const n=r.model;if(n&&(n.setValue(st.FURNITURE_COLOR,this.getFurnitureFloorColorIndex(s.typeId)),n.setValue(st.FURNITURE_TYPE_ID,s.typeId),n.setValue(st.FURNITURE_REAL_ROOM_OBJECT,s.realRoomObject?1:0),n.setValue(st.FURNITURE_EXPIRY_TIME,s.expiryTime),n.setValue(st.FURNITURE_EXPIRTY_TIMESTAMP,um.instance.time),n.setValue(st.FURNITURE_USAGE_POLICY,s.usagePolicy),n.setValue(st.FURNITURE_OWNER_ID,s.ownerId),n.setValue(st.FURNITURE_OWNER_NAME,s.ownerName)),!this.updateRoomObjectFloor(t,e,s.location,s.direction,s.state,s.data,s.extra))return!1;if(s.sizeZ>=0&&!this.updateRoomObjectFloorHeight(t,e,s.sizeZ))return!1;this.events&&this.events.dispatchEvent(new Nh(Nh.ADDED,t,e,tt.FLOOR));const a=this.getPlacedRoomObjectData(t);return a&&a.id===e&&a.category===tt.FLOOR&&this.selectRoomObject(t,e,tt.FLOOR),r.isReady&&s.synchronized&&this._Str_21543(t,r),!0}processPendingFurnitureWall(t,e,s){if(!s){const i=this.getRoomInstanceData(t);if(i&&(s=i.getPendingFurnitureWall(e)),!s)return!1}let i="";s.data&&(i=s.data.getLegacyString());let r=this.getFurnitureWallName(s.typeId,i);r||(r="");const n=this.createRoomObjectWall(t,e,r);if(!n)return!1;const a=n.model;if(a&&(a.setValue(st.FURNITURE_COLOR,this.getFurnitureWallColorIndex(s.typeId)),a.setValue(st.FURNITURE_TYPE_ID,s.typeId),a.setValue(st.FURNITURE_REAL_ROOM_OBJECT,s.realRoomObject?1:0),a.setValue(st.OBJECT_ACCURATE_Z_VALUE,1),a.setValue(st.FURNITURE_EXPIRY_TIME,s.expiryTime),a.setValue(st.FURNITURE_EXPIRTY_TIMESTAMP,um.instance.time),a.setValue(st.FURNITURE_USAGE_POLICY,s.usagePolicy),a.setValue(st.FURNITURE_OWNER_ID,s.ownerId),a.setValue(st.FURNITURE_OWNER_NAME,s.ownerName)),!this.updateRoomObjectWall(t,e,s.location,s.direction,s.state,i))return!1;this.events&&this.events.dispatchEvent(new Nh(Nh.ADDED,t,e,tt.WALL));const o=this.getPlacedRoomObjectData(t);return o&&Math.abs(o.id)===e&&o.category===tt.WALL&&this.selectRoomObject(t,e,tt.WALL),!0}setRoomSessionOwnUser(t,e){if(!this._roomSessionManager)return;const s=this._roomSessionManager.getSession(t);s&&s.setOwnRoomIndex(e);const i=this.getRoomCamera(t);i&&(i._Str_10760=e,i._Str_16562=tt.UNIT,i._Str_19465(this._Str_19549))}get _Str_19549(){return 1e3}_Str_22919(t){for(const s of this._roomInstanceDatas.values()){if(!s)continue;const e=s.roomCamera;if(!e)continue;const i=this.getRoomObject(s.roomId,e._Str_10760,e._Str_16562);i&&(s.roomId===this._activeRoomId&&this._activeRoomIsDragged||this._Str_25242(s.roomId,1,i.getLocation(),t))}const e=this.getRoomInstanceRenderingCanvas(this._activeRoomId,1);e&&this._activeRoomIsDragged&&(e.screenOffsetX=e.screenOffsetX+this._activeRoomDragX,e.screenOffsetY=e.screenOffsetY+this._activeRoomDragY,this._activeRoomDragX=0,this._activeRoomDragY=0)}_Str_25242(t,e,s,i){const r=this.getRoomInstanceRenderingCanvas(t,e),n=this.getRoomInstanceData(t);if(!r||!n||1!==r.scale)return;const a=r.geometry,o=n.roomCamera,c=this.getRoomInstance(t);if(!a||!o||!c)return;const _=this._Str_25261(t,e);if(!_)return;let h=Math.floor(s.z)+1;const l=Math.round(_.width),u=Math.round(_.height),d=this.getCanvasBoundingRectangle(e);if(d&&(d.right<0||d.bottom<0||d.left>=l||d.top>=u)&&o.reset(),o._Str_7609!==l||o._Str_7902!==u||o.scale!==a.scale||o._Str_16377!==a.updateId||!ot.isEqual(s,o._Str_16185)||o._Str_12536){o._Str_16185=s;const t=new ot;t.assign(s),t.x=Math.round(t.x),t.y=Math.round(t.y);const e=c.model.getValue(od.ROOM_MIN_X)-.5,n=c.model.getValue(od.ROOM_MIN_Y)-.5,g=c.model.getValue(od.ROOM_MAX_X)+.5,m=c.model.getValue(od.ROOM_MAX_Y)+.5,p=Math.round((e+g)/2),E=Math.round((n+m)/2),f=2;let S=new A.j(t.x-p,t.y-E);const b=a.scale/Math.sqrt(2),R=b/2,I=new A.i;I.rotate(-(a.direction.x+90)/180*Math.PI),S=I.apply(S),S.y=S.y*(R/b);const v=_.width/2/b-1,T=_.height/2/R-1;let O=0,y=0,C=0,M=0,D=a.getScreenPoint(new ot(p,E,f));if(!D)return;if(D.x=D.x+Math.round(_.width/2),D.y=D.y+Math.round(_.height/2),!d)return void a.adjustLocation(new ot(0,0),25);if(d.x+=-r.screenOffsetX,d.y+=-r.screenOffsetY,!(d.width>1&&d.height>1))return void a.adjustLocation(new ot(-30,-30),25);O=(d.left-D.x-.25*a.scale)/b,C=(d.right-D.x+.25*a.scale)/b,y=(d.top-D.y-.5*a.scale)/R,M=(d.bottom-D.y+.5*a.scale)/R;let N=!1,w=!1,U=!1,L=!1;Math.round((C-O)*b)<_.width?(h=2,S.x=(C+O)/2,U=!0):(S.x>C-v&&(S.x=C-v,N=!0),S.x<O+v&&(S.x=O+v,N=!0)),Math.round((M-y)*R)<_.height?(h=2,S.y=(M+y)/2,L=!0):(S.y>M-T&&(S.y=M-T,w=!0),S.y<y+T&&(S.y=y+T,w=!0),w&&(S.y=S.y/(R/b))),I.invert(),S=I.apply(S),S.x=S.x+p,S.y=S.y+E;let P=.35,x=.2,F=.2;const G=10,V=10;if(F*l>100&&(F=100/l),P*u>150&&(P=150/u),x*u>150&&(x=150/u),o._Str_10235&&o._Str_7609==l&&o._Str_7902==u&&(F=0),o._Str_10446&&o._Str_7609==l&&o._Str_7902==u&&(P=0,x=0),_.width=_.width*(1-2*F),_.height=_.height*(1-(P+x)),_.width<G&&(_.width=G),_.height<V&&(_.height=V),P+x>0?(_.x+=-_.width/2,_.y+=x/(P+x)*-_.height):(_.x+=-_.width/2,_.y+=-_.height/2),D=a.getScreenPoint(t),!D)return;if(D){D.x=D.x+r.screenOffsetX,D.y=D.y+r.screenOffsetY,t.z=h,t.x=Math.round(2*S.x)/2,t.y=Math.round(2*S.y)/2,o.location||(a.location=t,o._Str_20685(this._Str_11555?new ot(0,0,0):t));const e=a.getScreenPoint(t),s=new ot(0,0,0);e&&(s.x=e.x,s.y=e.y),(D.x<_.left||D.x>_.right)&&!o._Str_8564||(D.y<_.top||D.y>_.bottom)&&!o._Str_8690||U&&!o._Str_8564&&o._Str_7609!=l||L&&!o._Str_8690&&o._Str_7902!=u||o._Str_18975!=d.width||o._Str_15953!=d.height||o._Str_7609!=l||o._Str_7902!=u?(o._Str_10235=N,o._Str_10446=w,o.target=this._Str_11555?s:t):(N||(o._Str_10235=!1),w||(o._Str_10446=!1))}o._Str_8564=U,o._Str_8690=L,o._Str_7609=l,o._Str_7902=u,o.scale=a.scale,o._Str_16377=a.updateId,o._Str_18975=d.width,o._Str_15953=d.height,this._sessionDataManager.isCameraFollowDisabled||o.update(i,this._Str_11555?8:.5),this._Str_11555?(r.screenOffsetX=-o.location.x,r.screenOffsetY=-o.location.y):a.adjustLocation(o.location,25)}else o._Str_10235=!1,o._Str_10446=!1,o._Str_8564=!1,o._Str_8690=!1}_Str_25261(t,e){const s=this.getRoomInstanceRenderingCanvas(t,e);return s?new A.k(0,0,s.width,s.height):null}getRoomObjectBoundingRectangle(t,e,s,i){const r=this.getRoomInstanceGeometry(t,i);if(!r)return null;const n=this.getRoomObject(t,e,s);if(!n)return null;const a=n.visualization;if(!a)return null;const o=a.getBoundingRectangle(),c=this.getRoomInstanceRenderingCanvas(t,i),_=c?c.scale:1,h=r.getScreenPoint(n.getLocation());return h?(o.x=o.x*_,o.y=o.y*_,o.width=o.width*_,o.height=o.height*_,h.x=h.x*_,h.y=h.y*_,o.x+=h.x,o.y+=h.y,c?(o.x+=c.width/2+c.screenOffsetX,o.y+=c.height/2+c.screenOffsetY,o):null):null}getCanvasBoundingRectangle(e){return this.getRoomObjectBoundingRectangle(this._activeRoomId,t.ROOM_OBJECT_ID,tt.ROOM,e)}getFurnitureFloorName(t){return this._roomContentLoader?this._roomContentLoader.getFurnitureFloorNameForTypeId(t):null}getFurnitureWallName(t,e=null){return this._roomContentLoader?this._roomContentLoader.getFurnitureWallNameForTypeId(t,e):null}getFurnitureFloorColorIndex(t){return this._roomContentLoader?this._roomContentLoader.getFurnitureFloorColorIndex(t):null}getFurnitureWallColorIndex(t){return this._roomContentLoader?this._roomContentLoader.getFurnitureWallColorIndex(t):null}getRoomInstanceData(t){const e=this._roomInstanceDatas.get(t);if(e)return e;const s=new wg(t);return this._roomInstanceDatas.set(s.roomId,s),s}getRoomInstanceModelName(t){const e=this.getRoomInstanceData(t);return e?e.modelName:null}setRoomInstanceModelName(t,e){const s=this.getRoomInstanceData(t);s&&s.setModelName(e)}getRoomTileObjectMap(t){const e=this.getRoomInstanceData(t);return e?e.tileObjectMap:null}getCurrentRoomCamera(){return this.getRoomCamera(this._activeRoomId)}getRoomCamera(t){const e=this.getRoomInstanceData(t);return e?e.roomCamera:null}getSelectedRoomObjectData(t){const e=this.getRoomInstanceData(t);return e?e.selectedObject:null}setSelectedRoomObjectData(t,e){const s=this.getRoomInstanceData(t);if(!s)return null;s.setSelectedObject(e),e&&s.setPlacedObject(null)}getPlacedRoomObjectData(t){const e=this.getRoomInstanceData(t);return e?e.placedObject:null}setPlacedRoomObjectData(t,e){const s=this.getRoomInstanceData(t);if(!s)return null;s.setPlacedObject(e)}cancelRoomObjectPlacement(){this._roomObjectEventHandler&&this._roomObjectEventHandler.cancelRoomObjectPlacement(this._activeRoomId)}getFurnitureStackingHeightMap(t){const e=this.getRoomInstanceData(t);return e?e.furnitureStackingHeightMap:null}setFurnitureStackingHeightMap(t,e){const s=this.getRoomInstanceData(t);if(!s)return null;s.setFurnitureStackingHeightMap(e)}getLegacyWallGeometry(t){const e=this.getRoomInstanceData(t);return e?e.legacyGeometry:null}createRoomObjectAndInitialize(t,e,s,i){const r=this.getRoomInstance(t);return r?r.createRoomObjectAndInitalize(e,s,i):null}getTotalObjectsForManager(t,e){const s=this.getRoomInstance(t);return s?s.getTotalObjectsForManager(e):0}getRoomObject(t,e,s){const i=this.getRoomInstance(t);return i?i.getRoomObject(e,s):null}getRoomObjectByIndex(t,e,s){const i=this.getRoomInstance(t);return i?i.getRoomObjectByIndex(e,s):null}getRoomObjectCategoryForType(t){return t&&this._roomContentLoader?this._roomContentLoader.getCategoryForType(t):tt.MINIMUM}getRoomObjectCursor(e){return this.getRoomObject(e,t.CURSOR_OBJECT_ID,tt.CURSOR)}getRoomObjectSelectionArrow(e){return this.getRoomObject(e,t.ARROW_OBJECT_ID,tt.CURSOR)}getRoomOwnObject(e){return this.getRoomObject(e,t.ROOM_OBJECT_ID,tt.ROOM)}getRoomObjectUser(t,e){return this.getRoomObject(t,e,tt.UNIT)}removeRoomObjectUser(t,e){return this.removeRoomObject(t,e,tt.UNIT)}createRoomObjectUser(t,e,s){return this.createRoomObjectAndInitialize(t,e,s,tt.UNIT)}getRoomObjectFloor(t,e){return this.getRoomObject(t,e,tt.FLOOR)}createRoomObjectFloor(t,e,s){return this.createRoomObjectAndInitialize(t,e,s,tt.FLOOR)}removeRoomObjectFloor(t,e,s=-1,i=!1){const r=this.getRoomInstanceData(t);if(r&&r.removePendingFunitureFloor(e),this._sessionDataManager&&s===this._sessionDataManager.userId&&!Mh.isBuilderClubId(e)){const s=this.getRoomObject(t,e,tt.FLOOR);if(s){const i=this.getRoomObjectScreenLocation(t,e,tt.FLOOR,this._activeRoomActiveCanvas);if(i&&1!==s.model.getValue(st.FURNITURE_DISABLE_PICKING_ANIMATION)){const t=s.model.getValue(st.FURNITURE_TYPE_ID),e=s.model.getValue(st.FURNITURE_EXTRAS),r=s.model.getValue(st.FURNITURE_DATA_FORMAT),n=yi.getData(r),a=this.getFurnitureFloorIcon(t,null,e,n).data;if(a){const t=um.instance.renderer.extract.image(a);if(this.events){const e=new yh(t,i.x,i.y);e.iconName=Oh.INVENTORY,this.events.dispatchEvent(e)}}}}}this.removeRoomObject(t,e,tt.FLOOR),this.setMouseDefault(t,tt.FLOOR,e),i&&this._Str_17722(t,"RoomEngine.disposeObjectFurniture()")}getRoomObjectWall(t,e){return this.getRoomObject(t,e,tt.WALL)}removeRoomObjectWall(t,e,s=-1){if(this._sessionDataManager&&s===this._sessionDataManager.userId&&!Mh.isBuilderClubId(e)){const s=this.getRoomObject(t,e,tt.WALL);if(s&&-1===s.type.indexOf("post_it")&&-1===s.type.indexOf("external_image_wallitem")){const i=this.getRoomObjectScreenLocation(t,e,tt.WALL,this._activeRoomActiveCanvas);if(i){const t=s.model.getValue(st.FURNITURE_TYPE_ID),e=s.model.getValue(st.FURNITURE_DATA),r=this.getFurnitureWallIcon(t,null,e).data;if(r){const t=um.instance.renderer.extract.image(r);if(this.events){const e=new yh(t,i.x,i.y);e.iconName=Oh.INVENTORY,this.events.dispatchEvent(e)}}}}}this.removeRoomObject(t,e,tt.WALL),this.updateRoomObjectMask(t,e,!1),this.setMouseDefault(t,tt.WALL,e)}createRoomObjectWall(t,e,s){return this.createRoomObjectAndInitialize(t,e,s,tt.WALL)}removeRoomObject(t,e,s){const i=this.getRoomInstance(t);if(!i)return null;i.removeRoomObject(e,s),this.events&&this.events.dispatchEvent(new Nh(Nh.REMOVED,t,e,s))}addFurnitureFloor(t,e,s,i,r,n,a,o=NaN,c=-1,_=0,h=0,l="",u=!0,d=!0,g=-1){const m=this.getRoomInstanceData(t);if(!m)return!1;const p=new Cg(e,s,null,i,r,n,a,o,c,_,h,l,u,d,g);return m.addPendingFurnitureFloor(p),!0}addFurnitureFloorByTypeName(t,e,s,i,r,n,a,o=NaN,c=-1,_=0,h=0,l="",u=!0,d=!0,g=-1){const m=this.getRoomInstanceData(t);if(!m)return!1;const p=new Cg(e,0,s,i,r,n,a,o,c,_,h,l,u,d,g);return m.addPendingFurnitureFloor(p),!0}addFurnitureWall(t,e,s,i,r,n,a,o=-1,c=0,_=0,h="",l=!0){const u=this.getRoomInstanceData(t);if(!u)return!1;const d=new Ii;d.setString(a);const g=new Cg(e,s,null,i,r,n,d,NaN,o,c,_,h,!0,l);return u.addPendingFurnitureWall(g),!0}updateRoomObjectFloor(t,e,s,i,r,n,a=NaN){const o=this.getRoomObjectFloor(t,e);return!!o&&(o.processUpdateMessage(new ah(s,i)),o.processUpdateMessage(new nl(r,n,a)),!0)}updateRoomObjectWall(t,e,s,i,r,n=null){const a=this.getRoomObjectWall(t,e);if(!a||!a.logic)return!1;const o=new ah(s,i),c=new Ii,_=new nl(r,c);return c.setString(n),a.logic.processUpdateMessage(o),a.logic.processUpdateMessage(_),this.updateRoomObjectMask(t,e),!0}updateRoomObjectWallItemData(t,e,s){const i=this.getRoomObjectWall(t,e);return!(!i||!i.logic||(i.logic.processUpdateMessage(new cl(s)),0))}updateRoomObjectFloorHeight(t,e,s){const i=this.getRoomObjectFloor(t,e);return!!i&&(i.processUpdateMessage(new ol(null,null,s)),!0)}updateRoomObjectFloorExpiration(t,e,s){const i=this.getRoomObjectFloor(t,e);return!!i&&(i.model.setValue(st.FURNITURE_EXPIRY_TIME,s),i.model.setValue(st.FURNITURE_EXPIRTY_TIMESTAMP,um.instance.time),!0)}updateRoomObjectWallExpiration(t,e,s){const i=this.getRoomObjectWall(t,e);return!!i&&(i.model.setValue(st.FURNITURE_EXPIRY_TIME,s),i.model.setValue(st.FURNITURE_EXPIRTY_TIMESTAMP,um.instance.time),!0)}updateRoomObjectMask(t,e,s=!0){const i=tt.WALL+"_"+e,r=this.getRoomObjectWall(t,e);let n=null;if(r&&r.model){if(r.model.getValue(st.FURNITURE_USES_PLANE_MASK)>0){const t=r.model.getValue(st.FURNITURE_PLANE_MASK_TYPE),e=r.getLocation();n=s?new ll(ll.ADD_MASK,i,t,e):new ll(ll._Str_10260,i)}}else n=new ll(ll._Str_10260,i);const a=this.getRoomOwnObject(t);a&&a.logic&&n&&a.logic.processUpdateMessage(n)}rollRoomObjectFloor(t,e,s,i){const r=this.getRoomObjectFloor(t,e);r&&r.processUpdateMessage(new sl(s,i,null,!!i))}updateRoomObjectWallLocation(t,e,s){const i=this.getRoomObjectWall(t,e);return!!i&&(i.logic&&i.logic.processUpdateMessage(new sl(s,null,null)),this.updateRoomObjectMask(t,e),!0)}addRoomObjectUser(t,e,s,i,r,n,a){if(this.getRoomObjectUser(t,e))return!1;let o=et.getTypeString(n);o===et.PET&&(o=this.getPetType(a));const c=this.createRoomObjectUser(t,e,o);return!!c&&(c.processUpdateMessage(new il(this.fixedUserLocation(t,s),null,i,r,!1,0)),a&&c.processUpdateMessage(new Bh(a)),this.events&&this.events.dispatchEvent(new Nh(Nh.ADDED,t,e,tt.UNIT)),!0)}updateRoomObjectUserLocation(t,e,s,i,r=!1,n=0,a=null,o=NaN){const c=this.getRoomObjectUser(t,e);if(!c)return!1;s||(s=c.getLocation()),a||(a=c.getDirection()),isNaN(o)&&(o=c.model.getValue(st.HEAD_DIRECTION)),c.processUpdateMessage(new il(this.fixedUserLocation(t,s),this.fixedUserLocation(t,i),a,o,r,n));const _=this._roomSessionManager&&this._roomSessionManager.getSession(t)||null;return _&&_.ownRoomIndex===e&&this._logicFactory.events.dispatchEvent(new Lh(Lh.ROAME_MOVE_TO,i)),!0}fixedUserLocation(t,e){if(!e)return null;const s=this.getFurnitureStackingHeightMap(t),i=this.getLegacyWallGeometry(t);if(!s||!i)return e;let r=e.z;const n=s.getTileHeight(e.x,e.y),a=i.getHeight(e.x,e.y);return Math.abs(r-n)<.1&&Math.abs(n-a)<.1&&(r=i._Str_24141(e.x,e.y)),new ot(e.x,e.y,r)}updateRoomObjectUserAction(t,e,s,i,r=null){const n=this.getRoomObjectUser(t,e);if(!n)return!1;let a=null;switch(s){case st.FIGURE_TALK:a=new Gh(i);break;case st.FIGURE_SLEEP:a=new tl(1===i);break;case st.FIGURE_IS_TYPING:a=new el(1===i);break;case st.FIGURE_IS_MUTED:a=new zh(1===i);break;case st.FIGURE_CARRY_OBJECT:a=new Fh(i,r);break;case st.FIGURE_USE_OBJECT:a=new rl(i);break;case st.FIGURE_DANCE:a=new Vh(i);break;case st.FIGURE_GAINED_EXPERIENCE:a=new kh(i);break;case st.FIGURE_NUMBER_VALUE:a=new qh(i);break;case st.FIGURE_SIGN:a=new $h(i);break;case st.FIGURE_EXPRESSION:a=new jh(i);break;case st.FIGURE_IS_PLAYING_GAME:a=new Jh(1===i);break;case st.FIGURE_GUIDE_STATUS:a=new Zh(i)}return!!a&&(n.processUpdateMessage(a),!0)}updateRoomObjectUserFigure(t,e,s,i=null,r=null,n=!1){const a=this.getRoomObjectUser(t,e);return!!a&&(a.processUpdateMessage(new Bh(s,i,r,n)),!0)}updateRoomObjectUserFlatControl(t,e,s){const i=this.getRoomObjectUser(t,e);return!!i&&(i.processUpdateMessage(new Hh(parseInt(s))),!0)}updateRoomObjectUserEffect(t,e,s,i=0){const r=this.getRoomObjectUser(t,e);return!!r&&(r.processUpdateMessage(new Yh(s,i)),!0)}updateRoomObjectUserGesture(t,e,s){const i=this.getRoomObjectUser(t,e);return!!i&&(i.processUpdateMessage(new Wh(s)),!0)}updateRoomObjectUserPetGesture(t,e,s){const i=this.getRoomObjectUser(t,e);return!!i&&(i.processUpdateMessage(new Kh(s)),!0)}updateRoomObjectUserPosture(t,e,s,i=null){const r=this.getRoomObjectUser(t,e);return!!r&&(r.processUpdateMessage(new Qh(s,i)),!0)}updateRoomObjectUserOwn(t,e){const s=this.getRoomObjectUser(t,e);s&&s.processUpdateMessage(new Xh)}useRoomObject(t,e){const s=this.getRoomObject(this._activeRoomId,t,e);if(s){const t=s.logic;if(t)return t.useObject(),!0}return!1}objectInitialized(e,s,i){const r=this.getRoomIdFromString(e);i===tt.WALL&&this.updateRoomObjectMask(r,s);const n=this.getRoomObject(r,s,i);if(n&&n.model&&n.logic){const t=n.model.getValue(st.FURNITURE_DATA_FORMAT);if(!isNaN(t)){const e=yi.getData(t);e.initializeFromRoomObjectModel(n.model),n.processUpdateMessage(new nl(n.getState(0),e))}this.events.dispatchEvent(new Nh(Nh.CONTENT_UPDATED,r,s,i))}e!==t.TEMPORARY_ROOM&&this._Str_21543(r,n)}changeObjectState(t,e,s){const i=this.getRoomObject(t,e,s);if(!i||!i.model)return;let r=i.model.getValue(st.FURNITURE_AUTOMATIC_STATE_INDEX);isNaN(r)?r=1:r+=1,i.model.setValue(st.FURNITURE_AUTOMATIC_STATE_INDEX,r);const n=i.model.getValue(st.FURNITURE_DATA_FORMAT),a=yi.getData(n);a.initializeFromRoomObjectModel(i.model),i.logic&&i.logic.processUpdateMessage(new nl(r,a))}loadRoomObjectBadgeImage(t,e,s,i,r=!0){if(!this._sessionDataManager)return;const n=this.getRoomObjectFloor(t,e);if(!n||!n.logic)return;let a=r?this._sessionDataManager.loadGroupBadgeImage(i):this._sessionDataManager.loadBadgeImage(i);if(a)this.putBadgeInObjectAssets(n,i,r);else{a="loading_icon",this._badgeListenerObjects||(this._badgeListenerObjects=new Map),this._badgeListenerObjects.size||this._sessionDataManager.events.addEventListener(Ch.IMAGE_READY,this.onBadgeImageReadyEvent);let t=this._badgeListenerObjects.get(i);t||(t=[]),t.push(new Ug(n,r)),this._badgeListenerObjects.set(i,t)}n.logic.processUpdateMessage(new al(i,a))}onBadgeImageReadyEvent(t){if(!this._sessionDataManager)return;const e=this._badgeListenerObjects&&this._badgeListenerObjects.get(t.badgeId);if(e){for(const s of e){if(!s)continue;this.putBadgeInObjectAssets(s.object,t.badgeId,s.groupBadge);const e=s.groupBadge?this._sessionDataManager.loadGroupBadgeImage(t.badgeId):this._sessionDataManager.loadBadgeImage(t.badgeId);s.object&&s.object.logic&&s.object.logic.processUpdateMessage(new al(t.badgeId,e))}this._badgeListenerObjects.delete(t.badgeId),this._badgeListenerObjects.size||this._sessionDataManager.events.removeEventListener(Ch.IMAGE_READY,this.onBadgeImageReadyEvent)}}putBadgeInObjectAssets(t,e,s=!1){if(!this._roomContentLoader||!this._sessionDataManager)return;const i=s?this._sessionDataManager.loadGroupBadgeImage(e):this._sessionDataManager.loadBadgeImage(e),r=s?this._sessionDataManager.getGroupBadgeImage(e):this._sessionDataManager.getBadgeImage(e);r&&this._roomContentLoader.addAssetToCollection(t.type,i,r)}dispatchMouseEvent(e,s,i,r,n,a,o,c){const _=this.getRoomInstanceRenderingCanvas(this._activeRoomId,e);if(!_)return;const h=this.getRenderingCanvasOverlay(_),l=this._Str_16498(h,t.OBJECT_ICON_SPRITE);if(l){const t=l.getLocalBounds();l.x=s-t.width/2,l.y=i-t.height/2}if(!this._Str_25871(_,s,i,r,n,a,o)&&!_._Str_21232(s,i,r,n,a,o,c)){let e=null;r===oh.MOUSE_CLICK?(this.events&&this.events.dispatchEvent(new Nh(Nh.DESELECTED,this._activeRoomId,-1,tt.MINIMUM)),e=nh.CLICK):r===oh.MOUSE_MOVE?e=nh.MOUSE_MOVE:r===oh.MOUSE_DOWN?e=nh.MOUSE_DOWN:r===oh.MOUSE_UP&&(e=nh.MOUSE_UP),this._roomObjectEventHandler.handleRoomObjectEvent(new nh(e,this.getRoomObject(this._activeRoomId,t.ROOM_OBJECT_ID,tt.ROOM),null,n),this._activeRoomId)}this._activeRoomActiveCanvas=e,this._activeRoomActiveCanvasMouseX=s,this._activeRoomActiveCanvasMouseY=i}_Str_25871(e,s,i,r,n,a,o){let c=s-this._activeRoomActiveCanvasMouseX,_=i-this._activeRoomActiveCanvasMouseY;if(r===oh.MOUSE_DOWN)n||a||o||this.isDecorating||this._roomAllowsDragging&&(this._activeRoomIsDragged=!0,this._activeRoomWasDragged=!1,this._activeRoomDragStartX=this._activeRoomActiveCanvasMouseX,this._activeRoomDragStartY=this._activeRoomActiveCanvasMouseY);else if(r===oh.MOUSE_UP){if(this._activeRoomIsDragged&&(this._activeRoomIsDragged=!1,this._activeRoomWasDragged)){const t=this.getRoomInstanceData(this._activeRoomId);if(t){const s=t.roomCamera;s&&(this._Str_11555&&(s._Str_12536||(s._Str_8564=!1,s._Str_8690=!1),s._Str_25467(new ot(-e.screenOffsetX,-e.screenOffsetY))),this._roomDraggingAlwaysCenters&&s.reset())}}}else if(r===oh.MOUSE_MOVE)this._activeRoomIsDragged&&(this._activeRoomWasDragged||(c=s-this._activeRoomDragStartX,_=i-this._activeRoomDragStartY,(c<=-t.DRAG_THRESHOLD||c>=t.DRAG_THRESHOLD||_<=-t.DRAG_THRESHOLD||_>=t.DRAG_THRESHOLD)&&(this._activeRoomWasDragged=!0),c=0,_=0),0==c&&0==_||(this._activeRoomDragX+=c,this._activeRoomDragY+=_,this._activeRoomWasDragged=!0));else if((r===oh.MOUSE_CLICK||r===oh.DOUBLE_CLICK)&&(this._activeRoomIsDragged=!1,this._activeRoomWasDragged))return this._activeRoomWasDragged=!1,!0;return!1}updateMousePointer(t,e,s){const i=this.getRoomObjectCategoryForType(s);switch(t){case wh.MOUSE_BUTTON:return void this.setMouseButton(this._activeRoomId,i,e);default:return void this.setMouseDefault(this._activeRoomId,i,e)}}setMouseButton(t,e,s){if(!this._roomSessionManager)return;const i=this._roomSessionManager.getSession(t);if(i&&(e!==tt.FLOOR&&e!==tt.WALL||i.controllerLevel>=en.GUEST)){const i=this.getRoomInstanceData(t);i&&i._Str_16810(e+"_"+s)&&(this._mouseCursorUpdate=!0)}}setMouseDefault(t,e,s){if(!this._roomSessionManager)return;const i=this.getRoomInstanceData(t);i&&i._Str_11959(e+"_"+s)&&(this._mouseCursorUpdate=!0)}processRoomObjectOperation(t,e,s){if(!this._roomObjectEventHandler)return!1;this._roomObjectEventHandler.processRoomObjectOperation(this._activeRoomId,t,e,s)}processRoomObjectWallOperation(t,e,s,i){if(!this._roomObjectEventHandler)return!1;e===tt.WALL&&this._roomObjectEventHandler.processRoomObjectWallOperation(this._activeRoomId,t,e,s,i)}processRoomObjectFloorOperation(t,e,s,i){if(!this._roomObjectEventHandler)return!1;e===tt.FLOOR&&this._roomObjectEventHandler.processRoomObjectFloorOperation(this._activeRoomId,t,s,i)}processRoomObjectEvent(t){if(!this._roomObjectEventHandler)return;const e=this.getRoomObjectRoomId(t.object);if(!e)return;const s=this.getRoomIdFromString(e);this._roomObjectEventHandler.handleRoomObjectEvent(t,s)}processRoomObjectPlacement(t,e,s,i,r=null,n=null,a=-1,o=-1,c=null){const _=this.getRoomInstance(this._activeRoomId);return!(!_||0!==_.model.getValue(od.ROOM_IS_PUBLIC))&&!!this._roomObjectEventHandler&&this._roomObjectEventHandler.processRoomObjectPlacement(t,this._activeRoomId,e,s,i,r,n,a,o,c)}getRoomObjectScreenLocation(t,e,s,i=-1){-1==i&&(i=this._activeRoomActiveCanvas);const r=this.getRoomInstanceGeometry(t,i);if(!r)return null;const n=this.getRoomObject(t,e,s);if(!n)return null;const a=r.getScreenPoint(n.getLocation());if(!a)return null;const o=this.getRoomInstanceRenderingCanvas(t,i);return o?(a.x=a.x*o.scale,a.y=a.y*o.scale,a.x+=o.width/2+o.screenOffsetX,a.y+=o.height/2+o.screenOffsetY,a):null}selectRoomObject(t,e,s){this._roomObjectEventHandler&&this._roomObjectEventHandler._Str_17481(t,e,s)}_Str_8675(){this._roomObjectEventHandler&&this._roomObjectEventHandler._Str_8675(this._activeRoomId)}_Str_24651(t,e,s){if(!t||!s)return;let i=this._Str_16498(t,e);return i?null:(i=A.n.from(s),i.name=e,t.addChild(i),i)}onRoomContentLoaded(t,e,s){if(!this._roomContentLoader||-1===t)return;this._thumbnailObjectIdBank._Str_15187(t-1);const i=this._thumbnailCallbacks.get(e);if(i){this._thumbnailCallbacks.delete(e);const s=this._roomContentLoader.getImage(e);if(s)for(const e of i)e&&e.imageReady(t,null,s)}}_Str_16645(e,s,i,r=null,n=null,a=-1,o=-1,c=null){let _=null,h=0,l=null;if(i)l=this.getRoomObjectImage(this._activeRoomId,e,s,new ot,1,null);else if(this._roomContentLoader)if(s===tt.FLOOR?(_=this._roomContentLoader.getFurnitureFloorNameForTypeId(e),h=this._roomContentLoader.getFurnitureFloorColorIndex(e)):s===tt.WALL&&(_=this._roomContentLoader.getFurnitureWallNameForTypeId(e,r),h=this._roomContentLoader.getFurnitureWallColorIndex(e)),s===tt.UNIT)if(_=et.getTypeString(e),"pet"===_){_=this.getPetType(r);const t=new Th(r);l=this.getRoomObjectPetImage(t.typeId,t.paletteId,t.color,new ot(180),64,null,!0,0,t.customParts,c)}else l=this.getGenericRoomObjectImage(_,r,new ot(180),1,null,0,null,n,a,o,c);else l=this.getGenericRoomObjectImage(_,h.toString(),new ot,1,null,0,r,n,a,o,c);if(!l||!l.data)return;const u=this.getActiveRoomInstanceRenderingCanvas();if(!u)return;const d=this.getRenderingCanvasOverlay(u);this._Str_21215(d,t.OBJECT_ICON_SPRITE);const g=this._Str_24651(d,t.OBJECT_ICON_SPRITE,l.data);g&&(g.x=this._activeRoomActiveCanvasMouseX-l.data.width/2,g.y=this._activeRoomActiveCanvasMouseY-l.data.height/2)}getRoomObjectImage(t,e,s,i,r,n,a=0){if(!this._roomManager)return null;let o=-1,c=null,_=null,h="",l=null;const u=this.getRoomId(t),d=this._roomManager.getRoomInstance(u);if(d){const t=d.getRoomObject(e,s);if(t&&t.model)switch(o=t.id,c=t.type,s){case tt.FLOOR:case tt.WALL:{h=t.model.getValue(st.FURNITURE_COLOR).toString(),l=t.model.getValue(st.FURNITURE_EXTRAS);const e=t.model.getValue(st.FURNITURE_DATA_FORMAT);e!==Ii.FORMAT_KEY&&(_=yi.getData(e),_.initializeFromRoomObjectModel(t.model));break}case tt.UNIT:h=t.model.getValue(st.FIGURE)}}return this.getGenericRoomObjectImage(c,h,i,r,n,a,l,_,-1,-1,null,o)}getFurnitureFloorIconUrl(t){let e=null,s="";return this._roomContentLoader?(e=this._roomContentLoader.getFurnitureFloorNameForTypeId(t),s=this._roomContentLoader.getFurnitureFloorColorIndex(t).toString(),this._roomContentLoader.getAssetIconUrl(e,s)):null}getFurnitureFloorIcon(t,e,s=null,i=null){return this.getFurnitureFloorImage(t,new ot,1,e,0,s,-1,-1,i)}getFurnitureWallIconUrl(t,e=null){let s=null,i="";return this._roomContentLoader?(s=this._roomContentLoader.getFurnitureWallNameForTypeId(t,e),i=this._roomContentLoader.getFurnitureWallColorIndex(t).toString(),this._roomContentLoader.getAssetIconUrl(s,i)):null}getFurnitureWallIcon(t,e,s=null){return this.getFurnitureWallImage(t,new ot,1,e,0,s)}getFurnitureFloorImage(t,e,s,i,r=0,n=null,a=-1,o=-1,c=null){let _=null,h="";return this._roomContentLoader&&(_=this._roomContentLoader.getFurnitureFloorNameForTypeId(t),h=this._roomContentLoader.getFurnitureFloorColorIndex(t).toString()),1===s&&i?this.getGenericRoomObjectThumbnail(_,h,i,n,c):this.getGenericRoomObjectImage(_,h,e,s,i,r,n,c,a,o)}getFurnitureWallImage(t,e,s,i,r=0,n=null,a=-1,o=-1){let c=null,_="";return this._roomContentLoader&&(c=this._roomContentLoader.getFurnitureWallNameForTypeId(t),_=this._roomContentLoader.getFurnitureWallColorIndex(t).toString()),1===s&&i?this.getGenericRoomObjectThumbnail(c,_,i,n,null):this.getGenericRoomObjectImage(c,_,e,s,i,r,n,null,a,o)}getRoomObjectPetImage(t,e,s,i,r,n,a=!0,o=0,c=null,_=null){let h=null,l=t+" "+e+" "+s.toString(16);if(a||(l+=" head"),c){l=l+" "+c.length;for(const t of c)l=l+" "+t.layerId+" "+t.partId+" "+t.paletteId}return this._roomContentLoader&&(h=this._roomContentLoader.getPetNameForType(t)),this.getGenericRoomObjectImage(h,l,i,r,n,o,null,null,-1,-1,_)}getGenericRoomObjectImage(e,s,i,r,n,a=0,o=null,c=null,_=-1,h=-1,l=null,u=-1){if(!this._roomManager)return null;const d=new Ph;if(d.id=-1,!this._ready||!e)return d;let g=this._roomManager.getRoomInstance(t.TEMPORARY_ROOM);if(!g&&(g=this._roomManager.createRoomInstance(t.TEMPORARY_ROOM),!g))return d;let m=this._imageObjectIdBank._Str_19709();const p=this.getRoomObjectCategoryForType(e);if(m<0)return d;m++;const E=g.createRoomObjectAndInitalize(m,e,p);if(!E||!E.model||!E.logic)return d;const f=E.model;switch(p){case tt.FLOOR:case tt.WALL:f.setValue(st.FURNITURE_COLOR,parseInt(s));break;case tt.UNIT:if(e===et.USER||e===et.BOT||e===et.RENTABLE_BOT||e===et.PET)f.setValue(st.FIGURE,s);else{const t=new Th(s);f.setValue(st.PET_PALETTE_INDEX,t.paletteId),f.setValue(st.PET_COLOR,t.color),t.headOnly&&f.setValue(st.PET_HEAD_ONLY,1),t.hasCustomParts&&(f.setValue(st.PET_CUSTOM_LAYER_IDS,t.customLayerIds),f.setValue(st.PET_CUSTOM_PARTS_IDS,t.customPartIds),f.setValue(st.PET_CUSTOM_PALETTE_IDS,t.customPaletteIds)),l&&f.setValue(st.FIGURE_POSTURE,l)}}E.setDirection(i);const S=E.visualization;if(!S)return g.removeRoomObject(m,p),d;(_>-1||c)&&(c&&""!==c.getLegacyString()?E.logic.processUpdateMessage(new nl(parseInt(c.getLegacyString()),c)):E.logic.processUpdateMessage(new nl(_,c)));const b=new lh(r,new ot(-135,30,0),new ot(11,11,5));if(S.update(b,0,!0,!1),h>0){let t=0;for(;t<h;)S.update(b,0,!0,!1),t++}const R=S.getImage(a,u);if(d.data=R,d.id=m,!this.isRoomContentTypeLoaded(e)&&n){let t=this._imageCallbacks.get(m.toString());t||(t=[],this._imageCallbacks.set(m.toString(),t)),t.push(n),f.setValue(st.IMAGE_QUERY_SCALE,r)}else g.removeRoomObject(m,p),this._imageObjectIdBank._Str_15187(m-1),d.id=0;return b.dispose(),d}getGenericRoomObjectThumbnail(e,s,i,r=null,n=null){if(!this._roomManager)return null;const a=new Ph;if(a.id=-1,!this._ready||!e)return a;let o=this._roomManager.getRoomInstance(t.TEMPORARY_ROOM);if(!o&&(o=this._roomManager.createRoomInstance(t.TEMPORARY_ROOM),!o))return a;let c=this._thumbnailObjectIdBank._Str_19709();if(this.getRoomObjectCategoryForType(e),c<0)return a;c++,a.id=c,a.data=null,a.image=null;const _=[e,s].join("_"),h=this._roomContentLoader.getImage(_);if(!h&&i){let t=this._thumbnailCallbacks.get(_);t||(t=[],this._thumbnailCallbacks.set(_,t),this._roomContentLoader.downloadImage(c,e,s,null)),t.push(i)}else h&&(a.image=h),this._thumbnailObjectIdBank._Str_15187(c-1),a.id=0;return a}initalizeTemporaryObjectsByType(e,s){const i=this._roomManager.getRoomInstance(t.TEMPORARY_ROOM);if(!i||!this._roomContentLoader)return;const r=this._roomContentLoader.getCategoryForType(e),n=i.getManager(r);let a=null,o=0;if(n&&n.objects.length)for(const t of n.objects.getValues())if(t&&t.model&&t.type===e){const e=t.id,s=t.visualization;let n=null;if(s){const e=t.model.getValue(st.IMAGE_QUERY_SCALE);a&&o!==e&&(a.dispose(),a=null),a||(o=e,a=new lh(e,new ot(-135,30,0),new ot(11,11,5))),s.update(a,0,!0,!1),n=s.image}i.removeRoomObject(e,r),this._imageObjectIdBank._Str_15187(e-1);const c=this._imageCallbacks.get(e.toString());if(c){this._imageCallbacks.delete(e.toString());for(const t of c)t&&(n?t.imageReady(e,n):t.imageFailed(e))}}a&&a.dispose()}_Str_7972(e){const s=this.getActiveRoomInstanceRenderingCanvas();if(!s)return;const i=this.getRenderingCanvasOverlay(s),r=this._Str_16498(i,t.OBJECT_ICON_SPRITE);r&&(r.visible=e)}_Str_17948(){const e=this.getActiveRoomInstanceRenderingCanvas();if(!e)return;const s=this.getRenderingCanvasOverlay(e);this._Str_21215(s,t.OBJECT_ICON_SPRITE)}getRenderingCanvasOverlay(e){if(!e)return null;const s=e.master;return s&&s.getChildByName(t.OVERLAY)||null}_Str_21215(t,e){if(!t)return!1;let s=t.children.length-1;for(;s>=0;){const i=t.getChildAt(s);if(i&&i.name===e){if(t.removeChildAt(s),i.children.length){const t=i.getChildAt(0);t.parent.removeChild(t),t.destroy()}return!0}s--}return!1}_Str_16498(t,e){if(!t)return null;let s=t.children.length-1;for(;s>=0;){const i=t.getChildAt(s);if(i&&i.name===e)return i;s--}return null}_Str_21072(t,e){if(this._ready){const s=this.getRoomId(t),i=this._roomManager.getRoomInstance(s);if(i)return i.getRoomObjectsForCategory(e)}return[]}_Str_21543(t,e){const s=this.getRoomInstanceData(t).tileObjectMap;s&&s._Str_21192(e)}_Str_17722(t,e){const s=this.getRoomInstanceData(t).tileObjectMap;s&&s.populate(this._Str_21072(t,tt.FLOOR))}_Str_9972(t,e,s=!1,i=!0,r=!1,n=-1){let a=null;if(a=n>-1?this.getRoomInstanceRenderingCanvas(this._activeRoomId,n):this.getActiveRoomInstanceRenderingCanvas(),!a)return null;r&&a._Str_20787();let o=-1;i||null==this._roomSessionManager.getSession(this._activeRoomId)||(o=this._roomSessionManager.getSession(this._activeRoomId).ownRoomIndex);const c=new Lg,_=c._Str_4536(t,a,this,o),h=c._Str_24177(this),l=c._Str_22985(t,a,this,e);return r&&a._Str_22174(),console.log(_,h,l),null}createRoomScreenshot(t,e){const s=this.getRoomInstanceRenderingCanvas(t,e);if(!s)return;const i=s.getDisplayAsTexture(),r=um.instance.renderer.extract.base64(i),n=new Image;n.src=r,window.open("").document.write(n.outerHTML)}objectsInitialized(t){const e=this.getRoomIdFromString(t);this.events.dispatchEvent(new ih(ih.OBJECTS_INITIALIZED,e))}getRoomId(t){return t.toString()}getRoomIdFromString(t){if(!t)return-1;const e=t.split("_");return e.length<=0?-1:parseInt(e[0])}getRoomObjectRoomId(t){return t&&t.model?t.model.getValue(st.OBJECT_ROOM_ID):null}getPetTypeId(t){let e=-1;if(t){const s=t.split(" ");s.length>1&&(e=parseInt(s[0]))}return e}getPetType(t){if(!t)return null;const e=t.split(" ");if(e.length>1){const t=parseInt(e[0]);return this._roomContentLoader?this._roomContentLoader.getPetNameForType(t):"pet"}return null}isRoomContentTypeLoaded(t){return!!this._roomContentLoader&&null!==this._roomContentLoader.getCollection(t)}modifyRoomObjectData(t,e,s,i){return!(!this._roomObjectEventHandler||e!=tt.WALL)&&this._roomObjectEventHandler.modifyWallItemData(this._activeRoomId,t,s,i)}deleteRoomObject(t,e){return!(!this._roomObjectEventHandler||e!=tt.WALL)&&this._roomObjectEventHandler.deleteWallItem(this._activeRoomId,t)}get connection(){return this._communication.connection}get sessionDataManager(){return this._sessionDataManager}set sessionDataManager(t){this._sessionDataManager=t}get roomSessionManager(){return this._roomSessionManager}set roomSessionManager(t){this._roomSessionManager=t}get roomManager(){return this._roomManager}set roomManager(t){this._roomManager=t}get objectEventHandler(){return this._roomObjectEventHandler}get roomRendererFactory(){return this._roomRendererFactory}get visualizationFactory(){return this._visualizationFactory}get logicFactory(){return this._logicFactory}get activeRoomId(){return this._activeRoomId}get ready(){return this._ready}get roomContentLoader(){return this._roomContentLoader}get isDecorating(){if(!this._roomSessionManager)return!1;const t=this._roomSessionManager.getSession(this._activeRoomId);return t&&t.isDecorating||!1}get _Str_11555(){return!0}get selectedAvatarId(){return this._roomObjectEventHandler?this._roomObjectEventHandler.selectedAvatarId:-1}getRoomObjectCount(t,e){return null==this._roomManager?0:this._roomManager.getRoomInstance(t.toString()).getRoomObjectsForCategory(e).length}}return t.ROOM_OBJECT_ID=-1,t.ROOM_OBJECT_TYPE="room",t.CURSOR_OBJECT_ID=-2,t.CURSOR_OBJECT_TYPE="tile_cursor",t.ARROW_OBJECT_ID=-3,t.ARROW_OBJECT_TYPE="selection_arrow",t.OVERLAY="overlay",t.OBJECT_ICON_SPRITE="object_icon_sprite",t.DRAG_THRESHOLD=15,t.TEMPORARY_ROOM="temporary_room",t})(),xg=(()=>{class t{}return t.NORMAL=0,t.GENERIC=1,t.BOT=2,t})(),Fg=(()=>{class t extends Fe{constructor(t,e,s,i,r,n=0,a=null,o=-1){super(t,e),this._objectId=s,this._message=i,this._chatType=r,this._links=a,this._extraParam=o,this._style=n}get objectId(){return this._objectId}get message(){return this._message}get chatType(){return this._chatType}get links(){return this._links}get extraParam(){return this._extraParam}get style(){return this._style}}return t.CHAT_EVENT="RSCE_CHAT_EVENT",t.FLOOD_EVENT="RSCE_FLOOD_EVENT",t.CHAT_NORMAL=0,t.CHAT_WHISPER=1,t.CHAT_SHOUT=2,t._Str_5821=3,t._Str_6081=4,t._Str_8971=5,t._Str_5958=6,t._Str_6065=7,t._Str_5998=8,t._Str_5904=9,t._Str_8909=10,t})();class Gg extends M{constructor(t,e){super(),this._connection=t,this._listener=e,this._roomId=0}onDispose(){this._connection=null,this._listener=null}setRoomId(t){this._roomId=t}get connection(){return this._connection}get listener(){return this._listener}get roomId(){return this._roomId}}class Vg extends Gg{constructor(t,e){super(t,e),t.addMessageEvent(new Fa(this.onRoomUnitChatEvent.bind(this))),t.addMessageEvent(new Ga(this.onRoomUnitChatEvent.bind(this))),t.addMessageEvent(new Va(this.onRoomUnitChatEvent.bind(this))),t.addMessageEvent(new Hr(this.onRespectReceivedEvent.bind(this)))}onRoomUnitChatEvent(t){if(!this.listener)return;const e=this.listener.getSession(this.roomId);if(!e)return;const s=t.getParser();if(!s)return;let i=Fg.CHAT_NORMAL;t instanceof Ga?i=Fg.CHAT_SHOUT:t instanceof Va&&(i=Fg.CHAT_WHISPER);const r=new Fg(Fg.CHAT_EVENT,e,s.roomIndex,s.message,i,s.bubble);this.listener.events.dispatchEvent(r)}onRespectReceivedEvent(t){if(!this.listener)return;const e=this.listener.getSession(this.roomId);if(!e)return;const s=t.getParser();if(!s)return;const i=e.userDataManager.getUserData(s.userId);i&&this.listener.events.dispatchEvent(new Fg(Fg.CHAT_EVENT,e,i.roomIndex,"",Fg._Str_5821,xg.GENERIC))}}let Yg=(()=>{class t extends Fe{constructor(t,e){super(t,e)}}return t.RSDUE_ALLOW_PETS="RSDUE_ALLOW_PETS",t})();class kg extends Gg{constructor(t,e){super(t,e),t.addMessageEvent(new fn(this.onRoomInfoEvent.bind(this)))}onRoomInfoEvent(t){if(!(t instanceof fn))return;const e=t.getParser();if(!e)return;if(e.roomForward)return;const s=this.listener.getSession(this.roomId);if(!s)return;const i=e.data;s.tradeMode=i.tradeMode,s.isGuildRoom=0!==i.habboGroupId,s.doorMode=i.doorMode,s.allowPets=i.allowPets,s.moderationSettings=e.moderation,this.listener.events.dispatchEvent(new Yg(Yg.RSDUE_ALLOW_PETS,s)),this.listener.events.dispatchEvent(new Fe(Fe.ROOM_DATA,s))}}class jg{constructor(t){this._id=0,this._type=0,this._color=0,this._Str_3576=0,this._Str_2479=!1,this._id=t}_Str_4710(){this._Str_2479=!0}get id(){return this._id}get type(){return this._type}set type(t){this._Str_2479||(this._type=t)}get color(){return this._color}set color(t){this._Str_2479||(this._color=t)}get _Str_4272(){return this._Str_3576}set _Str_4272(t){this._Str_2479||(this._Str_3576=t)}}class Bg{constructor(){this._selectedPresetId=0,this._presets=[]}get _Str_10888(){return this._presets.length}get _Str_6226(){return this._selectedPresetId}_Str_14989(t){return t<0||t>=this._Str_10888?null:this._presets[t]}flush(){return this._presets=[],!0}parse(t){const e=t.readInt();this._selectedPresetId=t.readInt();let s=0;for(;s<e;){const e=t.readInt(),i=t.readInt(),r=t.readString(),n=parseInt(r.substr(1),16),a=t.readInt(),o=new jg(e);o.type=i,o.color=n,o._Str_4272=a,o._Str_4710(),this._presets.push(o),s++}return!0}}class Hg extends E{constructor(t){super(t,Bg)}getParser(){return this.parser}}class Wg extends Gg{constructor(t,e){super(t,e),t.addMessageEvent(new Hg(this._Str_25786.bind(this)))}_Str_25786(t){if(!t)return;const e=t.getParser();if(!e)return;const s=this.listener.getSession(this.roomId);if(!s)return;const i=new Ge(Ge.RSDPE_PRESETS,s);i._Str_6226=e._Str_6226;let r=0;for(;r<e._Str_10888;){const t=e._Str_14989(r);t&&i._Str_17287(t.id,t.type,t.color,t._Str_4272),r++}this.listener&&this.listener.events.dispatchEvent(i)}}class Zg extends Gg{constructor(t,e){super(t,e),t.addMessageEvent(new rn(this.onRoomRightsEvent.bind(this))),t.addMessageEvent(new tn(this.onRoomRightsClearEvent.bind(this))),t.addMessageEvent(new an(this.onRoomRightsOwnerEvent.bind(this)))}onRoomRightsEvent(t){if(!(t instanceof rn))return;const e=this.listener.getSession(this.roomId);e&&e.setControllerLevel(t.getParser().controllerLevel)}onRoomRightsClearEvent(t){if(!(t instanceof tn))return;const e=this.listener.getSession(this.roomId);e&&e.setControllerLevel(en.NONE)}onRoomRightsOwnerEvent(t){if(!(t instanceof an))return;const e=this.listener.getSession(this.roomId);e&&e.setRoomOwner()}}let zg=(()=>{class t extends Fe{constructor(t,e,s){super(t,e),this._userName="",this._userName=s}get userName(){return this._userName}}return t.DOORBELL="RSDE_DOORBELL",t.RSDE_REJECTED="RSDE_REJECTED",t.RSDE_ACCEPTED="RSDE_ACCEPTED",t})(),Xg=(()=>{class t extends Gg{constructor(t,e){super(t,e),t.addMessageEvent(new hn(this.onRoomEnterEvent.bind(this))),t.addMessageEvent(new Aa(this.onRoomModelNameEvent.bind(this))),t.addMessageEvent(new Es(this.onDesktopViewEvent.bind(this))),t.addMessageEvent(new Xr(this.onRoomDoorbellAcceptedEvent.bind(this))),t.addMessageEvent(new Qr(this.onRoomDoorbellRejectedEvent.bind(this)))}onRoomEnterEvent(e){e instanceof hn&&this.listener&&this.listener.sessionUpdate(this.roomId,t.RS_CONNECTED)}onRoomModelNameEvent(e){if(!(e instanceof Aa))return;const s=this.roomId,i=e.getParser().roomId;this.listener&&(this.listener.sessionReinitialize(s,i),this.listener.sessionUpdate(this.roomId,t.RS_READY))}onDesktopViewEvent(e){e instanceof Es&&this.listener&&this.listener.sessionUpdate(this.roomId,t.RS_DISCONNECTED)}onRoomDoorbellAcceptedEvent(t){if(!(t instanceof Xr&&this.listener))return;const e=t.getParser();if(!e)return;const s=e.userName;if(s&&s.length&&this.listener.events){const t=this.listener.getSession(this.roomId);if(!t)return;this.listener.events.dispatchEvent(new zg(zg.RSDE_ACCEPTED,t,s))}}onRoomDoorbellRejectedEvent(e){if(!(e instanceof Qr&&this.listener))return;const s=e.getParser();if(!s)return;const i=s.userName;if(i&&i.length){if(this.listener.events){const t=this.listener.getSession(this.roomId);if(!t)return;this.listener.events.dispatchEvent(new zg(zg.RSDE_REJECTED,t,i))}}else this.listener.sessionUpdate(this.roomId,t.RS_DISCONNECTED)}}return t.RS_CONNECTED="RS_CONNECTED",t.RS_READY="RS_READY",t.RS_DISCONNECTED="RS_DISCONNECTED",t})(),Kg=(()=>{class t extends Fe{constructor(e,s,i){super(t.RSDE_DANCE,e),this._roomIndex=s,this._danceId=i}get roomIndex(){return this._roomIndex}get danceId(){return this._danceId}}return t.RSDE_DANCE="RSDE_DANCE",t})(),qg=(()=>{class t extends Fe{constructor(e,s,i){super(t.RSUBE_BADGES,e),this._userId=0,this._badges=[],this._userId=s,this._badges=i}get userId(){return this._userId}get badges(){return this._badges}}return t.RSUBE_BADGES="RSUBE_BADGES",t})(),Jg=(()=>{class t extends Fe{constructor(e,s){super(t.USER_DATA_UPDATED,e),this._addedUsers=s}get addedUsers(){return this._addedUsers}}return t.USER_DATA_UPDATED="RMUDUE_USER_DATA_UPDATED",t})();class Qg{constructor(t){this._roomIndex=-1,this._name="",this._type=0,this._sex="",this._figure="",this._custom="",this._webID=0,this._groupID="",this._groupStatus=0,this._groupName="",this._ownerId=0,this._ownerName="",this._petLevel=0,this._rarityLevel=0,this._roomIndex=t}get roomIndex(){return this._roomIndex}get activityPoints(){return this._activityPoints}set activityPoints(t){this._activityPoints=t}get name(){return this._name}set name(t){this._name=t}get type(){return this._type}set type(t){this._type=t}get sex(){return this._sex}set sex(t){this._sex=t}get figure(){return this._figure}set figure(t){this._figure=t}get custom(){return this._custom}set custom(t){this._custom=t}get webID(){return this._webID}set webID(t){this._webID=t}get guildId(){return this._groupID}set guildId(t){this._groupID=t}get groupName(){return this._groupName}set groupName(t){this._groupName=t}get groupStatus(){return this._groupStatus}set groupStatus(t){this._groupStatus=t}get ownerId(){return this._ownerId}set ownerId(t){this._ownerId=t}get ownerName(){return this._ownerName}set ownerName(t){this._ownerName=t}get rarityLevel(){return this._rarityLevel}set rarityLevel(t){this._rarityLevel=t}get hasSaddle(){return this._hasSaddle}set hasSaddle(t){this._hasSaddle=t}get isRiding(){return this._isRiding}set isRiding(t){this._isRiding=t}get canBreed(){return this._canBreed}set canBreed(t){this._canBreed=t}get canHarvest(){return this._canHarvest}set canHarvest(t){this._canHarvest=t}get canRevive(){return this._canRevive}set canRevive(t){this._canRevive=t}get hasBreedingPermission(){return this._hasBreedingPermission}set hasBreedingPermission(t){this._hasBreedingPermission=t}get petLevel(){return this._petLevel}set petLevel(t){this._petLevel=t}get botSkills(){return this._botSkills}set botSkills(t){this._botSkills=t}get isModerator(){return this._Str_9831}set isModerator(t){this._Str_9831=t}}class $g extends Gg{constructor(t,e){super(t,e),t.addMessageEvent(new Ka(this.onRoomUnitEvent.bind(this))),t.addMessageEvent(new io(this.onRoomUnitInfoEvent.bind(this))),t.addMessageEvent(new oo(this.onRoomUnitRemoveEvent.bind(this))),t.addMessageEvent(new Ba(this.onRoomUnitDanceEvent.bind(this))),t.addMessageEvent(new xo(this.onUserCurrentBadgesEvent.bind(this))),t.addMessageEvent(new qr(this.onRoomDoorbellEvent.bind(this))),t.addMessageEvent(new Bo(this.onUserNameChangeMessageEvent.bind(this)))}onRoomUnitEvent(t){if(!this.listener)return;const e=this.listener.getSession(this.roomId);if(!e)return;const s=t.getParser().users,i=[];if(s&&s.length)for(const r of s){if(!r)continue;const t=new Qg(r.roomIndex);t.name=r.name,t.custom=r.custom,t.activityPoints=r.activityPoints,t.figure=r.figure,t.type=r.userType,t.webID=r.webID,t.guildId=r.groupID,t.groupName=r.groupName,t.groupStatus=r.groupStatus,t.sex=r.sex,t.ownerId=r.ownerId,t.ownerName=r.ownerName,t.rarityLevel=r.rarityLevel,t.hasSaddle=r.hasSaddle,t.isRiding=r.isRiding,t.canBreed=r.canBreed,t.canHarvest=r.canHarvest,t.canRevive=r.canRevive,t.hasBreedingPermission=r.hasBreedingPermission,t.petLevel=r.petLevel,t.botSkills=r.botSkills,t.isModerator=r.isModerator,e.userDataManager.getUserData(r.roomIndex)||i.push(t),e.userDataManager.updateUserData(t)}this.listener.events.dispatchEvent(new Jg(e,i))}onRoomUnitInfoEvent(t){if(!this.listener)return;const e=this.listener.getSession(this.roomId);if(!e)return;const s=t.getParser();s&&(e.userDataManager.updateFigure(s.unitId,s.figure,s.gender,!1,!1),e.userDataManager.updateMotto(s.unitId,s.motto))}onRoomUnitRemoveEvent(t){if(!this.listener)return;const e=this.listener.getSession(this.roomId);e&&e.userDataManager.removeUserData(t.getParser().unitId)}onRoomUnitDanceEvent(t){if(!this.listener)return;const e=t.getParser();if(!e)return;const s=this.listener.getSession(this.roomId);s&&this.listener.events.dispatchEvent(new Kg(s,e.unitId,e.danceId))}onUserCurrentBadgesEvent(t){if(!this.listener)return;const e=t.getParser();if(!e)return;const s=this.listener.getSession(this.roomId);s&&(s.userDataManager.setUserBadges(e.userId,e.badges),this.listener.events.dispatchEvent(new qg(s,e.userId,e.badges)))}onRoomDoorbellEvent(t){if(!this.listener)return;const e=t.getParser();if(!e)return;const s=e.userName;if(!s||!s.length)return;const i=this.listener.getSession(this.roomId);i&&this.listener.events.dispatchEvent(new zg(zg.DOORBELL,i,s))}onUserNameChangeMessageEvent(t){if(!this.listener)return;const e=t.getParser();if(!e)return;const s=this.listener.getSession(this.roomId);s&&s.userDataManager.updateName(e.id,e.newName)}}let tm=(()=>{class t{static _Str_22614(e){switch(e){case t._Str_9173:return"${trading.mode.free}";case t._Str_14475:return"${trading.mode.controller}";case t._Str_12752:return"${trading.mode.not.allowed}"}return""}}return t._Str_12752=0,t._Str_14475=1,t._Str_9173=2,t})(),em=(()=>{class t extends M{constructor(){super(),this._connection=null,this._userDataByType=new Map,this._userDataByRoomIndex=new Map,this._userBadges=new Map}onDispose(){this._connection=null}setConnection(t){this._connection=t}getUserData(e){return this.getDataByType(e,t.TYPE_USER)}getPetData(e){return this.getDataByType(e,t.TYPE_PET)}getBotData(e){return this.getDataByType(e,t.TYPE_BOT)}getRentableBotData(e){return this.getDataByType(e,t.TYPE_RENTABLE_BOT)}getDataByType(t,e){const s=this._userDataByType.get(e);return s&&s.get(t)||null}getUserDataByIndex(t){return this._userDataByRoomIndex.get(t)||null}updateUserData(t){if(!t)return;this.removeUserData(t.roomIndex);let e=this._userDataByType.get(t.type);e||(e=new Map,this._userDataByType.set(t.type,e)),e.set(t.webID,t),this._userDataByRoomIndex.set(t.roomIndex,t)}removeUserData(t){const e=this.getUserDataByIndex(t);if(!e)return;this._userDataByRoomIndex.delete(t);const s=this._userDataByType.get(e.type);s&&s.delete(e.webID)}getUserBadges(t){return this._connection&&this._connection.send(new G_(t)),this._userBadges.get(t)||[]}setUserBadges(t,e){this._userBadges.set(t,e)}updateFigure(t,e,s,i,r){const n=this.getUserDataByIndex(t);n&&(n.figure=e,n.sex=s,n.hasSaddle=i,n.isRiding=r)}updateName(t,e){const s=this.getUserDataByIndex(t);s&&(s.name=e)}updateMotto(t,e){const s=this.getUserDataByIndex(t);s&&(s.custom=e)}get connection(){return this._connection}}return t.TYPE_USER=1,t.TYPE_PET=2,t.TYPE_BOT=3,t.TYPE_RENTABLE_BOT=4,t})();class sm extends M{constructor(){super(),this._connection=null,this._userData=new em,this._roomId=0,this._password=null,this._state=Fe.CREATED,this._tradeMode=tm._Str_12752,this._doorMode=0,this._controllerLevel=en.NONE,this._ownRoomIndex=-1,this._isGuildRoom=!1,this._isRoomOwner=!1,this._isDecorating=!1,this._isSpectator=!1,this._moderationSettings=null}onDispose(){this._userData&&(this._userData.dispose(),this._userData=null),this._connection=null}setConnection(t){!this._connection&&t&&(this._connection=t,this._userData&&this._userData.setConnection(t))}setControllerLevel(t){this._controllerLevel=t>=en.NONE&&t<=en.MODERATOR?t:en.NONE}setOwnRoomIndex(t){this._ownRoomIndex=t}setRoomOwner(){this._isRoomOwner=!0}start(){return!(this._state!==Fe.CREATED||!this._connection)&&(this._state=Fe.STARTED,this.enterRoom())}enterRoom(){return!!this._connection&&(this._connection.send(new Bc(this._roomId,this._password)),!0)}reset(t){t!==this._roomId&&(this._roomId=t)}sendChatMessage(t,e){this._connection.send(new b_(t,e))}sendShoutMessage(t,e){this._connection.send(new R_(t,e))}sendWhisperMessage(t,e,s){this._connection.send(new I_(t,e,s))}sendChatTypingMessage(t){this._connection.send(t?new v_:new T_)}sendMottoMessage(t){this._connection.send(new k_(t))}sendDanceMessage(t){this._connection.send(new A_(t))}sendExpressionMessage(t){this._connection.send(new O_(t))}sendSignMessage(t){t<0||t>17||this._connection.send(new N_(t))}sendPostureMessage(t){this._connection.send(new D_(t))}sendDoorbellApprovalMessage(t,e){this._connection.send(new z_(t,e))}sendAmbassadorAlertMessage(t){this._connection.send(new Hc(t))}sendKickMessage(t){this._connection.send(new zc(t))}sendMuteMessage(t,e){this._connection.send(new Xc(t,e,this._roomId))}sendBanMessage(t,e){this._connection.send(new Wc(t,e,this._roomId))}sendGiveRightsMessage(t){this._connection.send(new Zc(t))}sendTakeRightsMessage(t){this._connection.send(new Kc(t))}pickupPet(t){}pickupBot(t){this._connection&&this._connection.send(new t_(t))}get connection(){return this._connection}get userDataManager(){return this._userData}get roomId(){return this._roomId}set roomId(t){this._roomId=t}get password(){return this._password}set password(t){this._password=t}get state(){return this._state}get _Str_7411(){return!0}get tradeMode(){return this._tradeMode}set tradeMode(t){this._tradeMode=t}get doorMode(){return this._doorMode}set doorMode(t){this._doorMode=t}get allowPets(){return this._allowPets}set allowPets(t){this._allowPets=t}get controllerLevel(){return this._controllerLevel}get ownRoomIndex(){return this._ownRoomIndex}get isGuildRoom(){return this._isGuildRoom}set isGuildRoom(t){this._isGuildRoom=t}get isRoomOwner(){return this._isRoomOwner}get isDecorating(){return this._isDecorating}set isDecorating(t){this._isDecorating=t}get isSpectator(){return this._isSpectator}set isSpectator(t){this._isSpectator=t}get moderationSettings(){return this._moderationSettings}set moderationSettings(t){this._moderationSettings=t}}class im extends z{constructor(t,e){super(),this._communication=t,this._roomEngine=e,this._handlers=[],this._sessions=new Map,this._pendingSession=null,this._sessionStarting=!1,this._viewerSession=null,this.onRoomEngineEvent=this.onRoomEngineEvent.bind(this)}onInit(){this.createHandlers(),this.processPendingSession(),this._roomEngine.events.addEventListener(ih.ENGINE_INITIALIZED,this.onRoomEngineEvent)}onDispose(){this._roomEngine.events.removeEventListener(ih.ENGINE_INITIALIZED,this.onRoomEngineEvent),super.onDispose()}createHandlers(){const t=this._communication&&this._communication.connection;t&&this._handlers.push(new Vg(t,this),new kg(t,this),new Wg(t,this),new Zg(t,this),new Xg(t,this),new $g(t,this))}setHandlers(t){if(this._handlers&&this._handlers.length)for(const e of this._handlers)e&&e.setRoomId(t.roomId)}onRoomEngineEvent(t){this.processPendingSession()}processPendingSession(){this._pendingSession&&this._roomEngine.ready&&(this.addSession(this._pendingSession),this._pendingSession=null)}getSession(t){return this._sessions.get(this.getRoomId(t))||null}createSession(t,e=null){const s=new sm;return s.roomId=t,s.password=e,this.addSession(s)}addSession(t){return this._roomEngine.ready?(this._sessionStarting=!0,this._sessions.get(this.getRoomId(t.roomId))&&this.removeSession(t.roomId,!1),t.setConnection(this._communication.connection),this._sessions.set(this.getRoomId(t.roomId),t),this.events.dispatchEvent(new Fe(Fe.CREATED,t)),this._viewerSession=t,this.startSession(this._viewerSession),!0):(this._pendingSession=t,!1)}startSession(t){return t.state!==Fe.STARTED&&(this._sessionStarting=!1,t.start()?(this.events.dispatchEvent(new Fe(Fe.STARTED,t)),this.setHandlers(t),!0):(this.removeSession(t.roomId),!1))}removeSession(t,e=!0){const s=this.getSession(t);s&&(this._sessions.delete(this.getRoomId(t)),this.events.dispatchEvent(new Fe(Fe.ENDED,s,e)),s.dispose())}sessionUpdate(t,e){if(this.getSession(t))switch(e){case Xg.RS_CONNECTED:case Xg.RS_READY:return;case Xg.RS_DISCONNECTED:return void this.removeSession(t)}}sessionReinitialize(t,e){const s=this.getSession(t);s&&(this._sessions.delete(this.getRoomId(t)),s.reset(e),this._sessions.set(this.getRoomId(e),s),this.setHandlers(s))}getRoomId(t){return"hard_coded_room_id"}get communication(){return this._communication}get roomEngine(){return this._roomEngine}get viewerSession(){return this._viewerSession}}let rm=(()=>{class t{static logEventLog(t){try{Q_.available&&Q_.call("logEventLog",t)}catch(e){D.log("External interface not working, failed to log event log.")}}static openPage(t){try{Q_.available?Q_.call("openPage",t):D.log("External interface not available, openPage failed.")}catch(e){D.log("Failed to open web page "+t)}}static sendHeartBeat(){try{Q_.available&&Q_.call("heartBeat")}catch(t){D.log("Failed to send heartbeat")}}static openWebPageAndMinimizeClient(e){try{Q_.available&&t.openPage(e)}catch(s){D.log("Failed to open web page "+e)}}static closeWebPageAndRestoreClient(){try{Q_.available&&Q_.call("closeWebPageAndRestoreClient")}catch(t){D.log("Failed to close web page and restore client!")}}static openHabblet(t,e=null){try{Q_.available&&Q_.call("openHabblet",t,e)}catch(s){D.log("Failed to open Habblet "+t)}}static closeHabblet(t,e=null){try{Q_.available&&Q_.call("closeHabblet",t,e)}catch(s){D.log("Failed to close Habblet "+t)}}static send(t,e){try{Q_.available&&Q_.call("disconnect",t,e)}catch(s){D.log("Failed to close send ")}}static showGame(t){try{Q_.available&&Q_.callGame("showGame",t)}catch(e){D.log("Failed to open game: "+e)}}static hideGame(){try{Q_.available&&Q_.callGame("hideGame")}catch(t){D.log("Failed to hide game")}}static open(t){try{Q_.available?Q_.call("openExternalLink",escape(t)):D.log("External interface not available. Could not request to open: "+t)}catch(e){D.log("External interface not working. Could not request to open: "+t)}}static roomVisited(t){try{Q_.available?Q_.call("roomVisited",t):D.log("External interface not available. Could not store last room visit.")}catch(e){D.log("External interface not working. Could not store last room visit.")}}static openMinimail(t){try{Q_.available?Q_.call("openMinimail",t):D.log("External interface not available. Could not open minimail.")}catch(e){D.log("External interface not working. Could not open minimail.")}}static openNews(){try{Q_.available?Q_.call("openNews"):D.log("External interface not available. Could not open news.")}catch(t){D.log("External interface not working. Could not open news.")}}static closeNews(){try{Q_.available?Q_.call("closeNews"):D.log("External interface not available. Could not close news.")}catch(t){D.log("External interface not working. Could not close news.")}}static openAvatars(){try{Q_.available?Q_.call("openAvatars"):D.log("External interface not available. Could not open avatars.")}catch(t){D.log("External interface not working. Could not open avatars.")}}static openRoomEnterAd(){try{Q_.available?Q_.call("openRoomEnterAd"):D.log("External interface not available. Could not open roomenterad.")}catch(t){D.log("External interface not working. Could not open roomenterad.")}}static updateFigure(t){try{Q_.available?Q_.call("updateFigure",t):D.log("External interface not available. Could not update figure.")}catch(e){D.log("External interface not working. Could not update figure.")}}}return t.ADVERTISEMENT="advertisement",t.OPENLINK="openlink",t.OPENROOM="openroom",t})();class nm{constructor(t,e){this._image=t,this._placeHolder=e}get image(){return this._image}get placeHolder(){return this._placeHolder}}let am=(()=>{class t{constructor(t,e){this._assets=t,this._events=e,this._requestedBadges=new Map}dispose(){this._assets=null}getBadgeImage(t,e="normal_badge",s=!0){let i=this.getBadgeTexture(t,e);return!i&&s&&(i=this.getBadgePlaceholder()),i}getBadgeInfo(t){const e=this.getBadgeTexture(t);return e?new nm(e,!1):new nm(this.getBadgePlaceholder(),!0)}loadBadgeImage(t,e="normal_badge"){return this._assets.getTexture(t)?t:(this.getBadgeTexture(t,e),null)}getBadgeTexture(t,e="normal_badge"){const s=this._assets.getTexture(t);if(s)return s.clone();if(this._requestedBadges.get(t))return null;const i=this.getBadgeUrl(t,e);return i&&(this._requestedBadges.set(t,!0),this._assets.downloadAsset(i,e=>{if(e){const e=this._assets.getTexture(t);e&&this._events&&this._events.dispatchEvent(new Ch(t,e.clone()))}})),null}getBadgePlaceholder(){const t=this._assets.getTexture("loading_icon");return t?t.clone():null}getBadgeUrl(e,s="normal_badge"){let i=null;switch(s){case t.NORMAL_BADGE:i=um.instance.getConfiguration("badge.asset.url").replace("%badgename%",e);break;case t.GROUP_BADGE:i=um.instance.getConfiguration("badge.asset.group.url").replace("%badgedata%",e)}return i}}return t.GROUP_BADGE="group_badge",t.NORMAL_BADGE="normal_badge",t})(),om=(()=>{class t{}return t.SUPER_USER=9,t.ADMINISTRATOR=8,t.COMMUNITY=7,t.PLAYER_SUPPORT=6,t.MODERATOR=5,t.EMPLOYEE=4,t.BUS_PARTNER=3,t.PARTNER=2,t.CELEBRITY=1,t.NONE=0,t})(),cm=(()=>{class t extends y{constructor(e){super(t.UNUE_NAME_UPDATED),this._name=e}get name(){return this._name}}return t.UNUE_NAME_UPDATED="unue_name_updated",t})();class _m{constructor(t,e,s,i,r,n,a,o,c,_,h,l,u,d,g,m){const[p,E]=s.split("*");this._type=t,this._id=e,this._fullName=s,this._className=p,this._colorId=parseInt(E)||0,this._name=i,this._description=r,this._furniLine=n,this._offerId=l,this._adUrl=u,this._excludeDynamic=d,this._specialType=g,this._customParams=m,this._dimensions=o,this._canStandOn=c,this._canSitOn=_,this._canLayOn=h}get type(){return this._type}get id(){return this._id}get fullName(){return this._fullName}get className(){return this._className}get colorId(){return this._colorId}get name(){return this._name}get description(){return this._description}get furniLine(){return this._furniLine}get colors(){return this._colors}get dimensions(){return this._dimensions}get canStandOn(){return this._canStandOn}get canSitOn(){return this._canSitOn}get canLayOn(){return this._canLayOn}get offerId(){return this._offerId}get adUrl(){return this._adUrl}get excludeDynamic(){return this._excludeDynamic}get specialType(){return this._specialType}get customParams(){return this._customParams}get isExternalImage(){return-1!==this._className.indexOf("external_image")}}let hm=(()=>{class t extends N{constructor(t,e,s){super(),this._floorItems=t,this._wallItems=e,this._localization=s}loadFurnitureData(t){if(!t)return;const e=new XMLHttpRequest;e.addEventListener("loadend",this.onFurnitureDataLoaded.bind(this,e)),e.addEventListener("error",this.onFurnitureDataError.bind(this,e)),e.open("GET",t),e.send()}onFurnitureDataLoaded(e){if(e){if(e.removeEventListener("loadend",this.onFurnitureDataLoaded.bind(this,e)),e.removeEventListener("error",this.onFurnitureDataError.bind(this,e)),e.responseText){const t=JSON.parse(e.responseText);t.floorItems&&this.parseFloorItems(t.floorItems),t.wallItems&&this.parseWallItems(t.wallItems)}this.dispatchEvent(new y(t.FURNITURE_DATA_READY))}}onFurnitureDataError(e){e||e.removeEventListener("loadend",this.onFurnitureDataLoaded.bind(this,e)),e.removeEventListener("error",this.onFurnitureDataError.bind(this,e)),this.dispatchEvent(new y(t.FURNITURE_DATA_ERROR))}parseFloorItems(t){if(t&&t.length)for(const e of t){if(!e)continue;const t=new _m($.FLOOR,e.id,e.className,e.name,e.description,e.furniLine,e.colors,e.dimensions,e.canStandOn,e.canSitOn,e.canLayOn,e.offerId,e.adUrl,e.excludeDynamic,e.specialType,e.customParams);this._floorItems.set(t.id,t),this.updateLocalizations(t)}}parseWallItems(t){if(t&&t.length)for(const e of t){if(!e)continue;const t=new _m($.WALL,e.id,e.className,e.name,e.description,e.furniLine,e.colors,e.dimensions,e.canStandOn,e.canSitOn,e.canLayOn,e.offerId,e.adUrl,e.excludeDynamic,e.specialType,e.customParams);this._wallItems.set(t.id,t),this.updateLocalizations(t)}}updateLocalizations(t){if(this._localization)switch(t.type){case $.FLOOR:return this._localization.setValue("roomItem.name."+t.id,t.name),void this._localization.setValue("roomItem.desc."+t.id,t.description);case $.WALL:return this._localization.setValue("wallItem.name."+t.id,t.name),void this._localization.setValue("wallItem.desc."+t.id,t.description)}}}return t.FURNITURE_DATA_READY="FDP_FURNITURE_DATA_READY",t.FURNITURE_DATA_ERROR="FDP_FURNITURE_DATA_ERROR",t})();class lm extends z{constructor(t){super(),this._communication=t,this.resetUserInfo(),this._clubLevel=0,this._securityLevel=0,this._isAmbassador=!1,this._systemOpen=!1,this._systemShutdown=!1,this._isAuthenticHabbo=!1,this._isRoomCameraFollowDisabled=!1,this._uiFlags=0,this._floorItems=new Map,this._wallItems=new Map,this._furnitureData=null,this._furnitureReady=!1,this._furnitureListenersNotified=!1,this._pendingFurnitureListeners=[],this._badgeImageManager=null,this.onFurnitureDataReadyEvent=this.onFurnitureDataReadyEvent.bind(this)}onInit(){this.loadFurnitureData(),this.loadBadgeImageManager(),this._communication.registerMessageEvent(new Go(this.onUserFigureEvent.bind(this))),this._communication.registerMessageEvent(new ko(this.onUserInfoEvent.bind(this))),this._communication.registerMessageEvent(new Lo(this.onUserPermissionsEvent.bind(this))),this._communication.registerMessageEvent(new Ye(this.onAvailabilityStatusMessageEvent.bind(this))),this._communication.registerMessageEvent(new Wo(this.onUserSettingsEvent.bind(this))),this._communication.registerMessageEvent(new je(this.onChangeNameUpdateEvent.bind(this))),this._communication.registerMessageEvent(new Bo(this.onUserNameChangeMessageEvent.bind(this))),this._communication.registerMessageEvent(new Aa(this.onRoomModelNameEvent.bind(this)))}onDispose(){this.destroyFurnitureData(),super.onDispose()}resetUserInfo(){this._userId=0,this._name=null,this._figure=null,this._gender=null,this._realName=null,this._canChangeName=!1}loadFurnitureData(){this.destroyFurnitureData(),this._furnitureData=new hm(this._floorItems,this._wallItems,um.instance.localization),this._furnitureData.addEventListener(hm.FURNITURE_DATA_READY,this.onFurnitureDataReadyEvent),this._furnitureData.loadFurnitureData(um.instance.getConfiguration("furnidata.url"))}loadBadgeImageManager(){this._badgeImageManager||(this._badgeImageManager=new am(um.instance.core.asset,this.events))}getAllFurnitureData(t){if(!this._floorItems||!this._floorItems.size)return void(-1===this._pendingFurnitureListeners.indexOf(t)&&this._pendingFurnitureListeners.push(t));const e=[];for(const s of this._floorItems.values())s&&e.push(s);for(const s of this._wallItems.values())s&&e.push(s);return e&&e.length?e:null}removePendingFurniDataListener(t){if(!this._pendingFurnitureListeners)return;const e=this._pendingFurnitureListeners.indexOf(t);-1!==e&&this._pendingFurnitureListeners.splice(e,1)}onUserFigureEvent(t){t&&t.connection&&(this._figure=t.getParser().figure,this._gender=t.getParser().gender,rm.updateFigure(this._figure))}onUserInfoEvent(t){if(!t||!t.connection)return;this.resetUserInfo();const e=t.getParser().userInfo;e&&(this._userId=e.userId,this._name=e.username,this._figure=e.figure,this._gender=e.gender,this._realName=e.realName,this._respectsReceived=e.respectsReceived,this._respectsLeft=e.respectsRemaining,this._respectsPetLeft=e.respectsPetRemaining,this._canChangeName=e.canChangeName)}onUserPermissionsEvent(t){t&&t.connection&&(this._clubLevel=t.getParser().clubLevel,this._securityLevel=t.getParser().securityLevel,this._isAmbassador=t.getParser().isAmbassador)}onAvailabilityStatusMessageEvent(t){if(!t||!t.connection)return;const e=t.getParser();if(e&&(this._systemOpen=e.isOpen,this._systemShutdown=e.onShutdown,this._isAuthenticHabbo=e.isAuthenticUser,this._isAuthenticHabbo&&this._furnitureReady&&!this._furnitureListenersNotified&&(this._furnitureListenersNotified=!0,this._pendingFurnitureListeners&&this._pendingFurnitureListeners.length)))for(const s of this._pendingFurnitureListeners)s&&s.loadFurnitureData()}onUserSettingsEvent(t){if(!t||!t.connection)return;const e=t.getParser();e&&(this._isRoomCameraFollowDisabled=e.cameraFollow,this._uiFlags=e.flags)}onChangeNameUpdateEvent(t){if(!t||!t.connection)return;const e=t.getParser();e&&e.resultCode===je._Str_5797&&(this._canChangeName=!1,this.events.dispatchEvent(new cm(e.name)))}onUserNameChangeMessageEvent(t){if(!t||!t.connection)return;const e=t.getParser();e&&e.webId===this.userId&&(this._name=e.newName,this._canChangeName=!1,this.events.dispatchEvent(new cm(this._name)))}onRoomModelNameEvent(t){if(!t)return;const e=t.getParser();e&&rm.roomVisited(e.roomId)}onFurnitureDataReadyEvent(t){if(this._furnitureData.removeEventListener(hm.FURNITURE_DATA_READY,this.onFurnitureDataReadyEvent),this._furnitureReady=!0,this._isAuthenticHabbo&&!this._furnitureListenersNotified&&(this._furnitureListenersNotified=!0,this._pendingFurnitureListeners&&this._pendingFurnitureListeners.length))for(const e of this._pendingFurnitureListeners)e&&e.loadFurnitureData()}destroyFurnitureData(){this._furnitureData&&(this._furnitureData.dispose(),this._furnitureData=null)}getFloorItemData(t){return this._floorItems.get(t)||null}getFloorItemDataByName(t){if(!t||!this._floorItems||!this._floorItems.size)return null;for(const e of this._floorItems.values())if(e&&e.className===t)return e}getWallItemData(t){return this._wallItems.get(t)||null}getWallItemDataByName(t){if(!t||!this._wallItems||!this._wallItems.size)return null;for(const e of this._wallItems.values())if(e&&e.className===t)return e}getBadgeUrl(t){return this._badgeImageManager.getBadgeUrl(t)}getGroupBadgeUrl(t){return this._badgeImageManager.getBadgeUrl(t,am.GROUP_BADGE)}getBadgeImage(t){return this._badgeImageManager.getBadgeImage(t)}getGroupBadgeImage(t){return this._badgeImageManager.getBadgeImage(t,am.GROUP_BADGE)}loadBadgeImage(t){return this._badgeImageManager.loadBadgeImage(t)}loadGroupBadgeImage(t){return this._badgeImageManager.loadBadgeImage(t,am.GROUP_BADGE)}isUserIgnored(t){return!1}hasSecurity(t){return this._securityLevel>=t}giveRespect(t){t<0||this._respectsLeft<=0||(this.send(new H_(t)),this._respectsLeft--)}givePetRespect(t){t<0||this._respectsPetLeft<=0||(this.send(new jc(t)),this._respectsPetLeft--)}sendSpecialCommandMessage(t,e=0){this.send(new b_(t))}send(t){this._communication.connection.send(t)}get communication(){return this._communication}get userId(){return this._userId}get userName(){return this._name}get figure(){return this._figure}get gender(){return this._gender}get realName(){return this._realName}get respectsReceived(){return this._respectsReceived}get respectsLeft(){return this._respectsLeft}get respectsPetLeft(){return this._respectsPetLeft}get canChangeName(){return this._canChangeName}get clubLevel(){return this._clubLevel}get securityLevel(){return this._securityLevel}get isAmbassador(){return this._isAmbassador}get isSystemOpen(){return this._systemOpen}get isSystemShutdown(){return this._systemShutdown}get isAuthenticHabbo(){return this._isAuthenticHabbo}get isModerator(){return this._securityLevel>=om.MODERATOR}get isCameraFollowDisabled(){return this._isRoomCameraFollowDisabled}get uiFlags(){return this._uiFlags}}A.s.SCALE_MODE=A.m.NEAREST;let um=(()=>{class t extends A.a{constructor(e,s){super(s),t.INSTANCE||(t.INSTANCE=this),this._nitroTimer=new J,this._core=e,this._events=new N,this._localization=new sh,this._communication=new J_(e.communication),this._avatar=new ve,this._roomEngine=new Pg(this._communication),this._sessionDataManager=new lm(this._communication),this._roomSessionManager=new im(this._communication,this._roomEngine),this._roomManager=new ht(this._roomEngine,this._roomEngine.visualizationFactory,this._roomEngine.logicFactory),this._linkTrackers=[],this._isReady=!1,this._isDisposed=!1,this._core.configuration.events.addEventListener(C.LOADED,this.onConfigurationLoadedEvent.bind(this)),this._roomEngine.events.addEventListener(ih.ENGINE_INITIALIZED,this.onRoomEngineReady.bind(this))}static bootstrap(){t.INSTANCE&&(t.INSTANCE.dispose(),t.INSTANCE=null);const e=document.createElement("canvas");e.id="client-wrapper",e.className="client-canvas";const s=new this(new q,{transparent:!0,autoDensity:!0,resizeTo:window,resolution:window.devicePixelRatio,width:window.innerWidth,height:window.innerHeight,powerPreference:"high-performance",view:e});e.addEventListener("webglcontextlost",()=>s.events.dispatchEvent(new y(t.WEBGL_CONTEXT_LOST)));const i=NitroConfig.sso;s.communication.demo.setSSO(i)}init(){if(!this._isReady&&!this._isDisposed){if(this._avatar&&this._avatar.init(),this._roomEngine&&(this._roomEngine.sessionDataManager=this._sessionDataManager,this._roomEngine.roomSessionManager=this._roomSessionManager,this._roomEngine.roomManager=this._roomManager,this._roomEngine.init(),this._sessionDataManager&&this._sessionDataManager.init(),this._roomManager&&this._roomManager.init(),this._roomSessionManager&&this._roomSessionManager.init()),new $_(this._communication.connection),!this._communication.connection)throw new Error("No connection found");this._isReady=!0}}dispose(){this._isDisposed||(this._roomManager&&(this._roomManager.dispose(),this._roomManager=null),this._roomSessionManager&&(this._roomSessionManager.dispose(),this._roomSessionManager=null),this._sessionDataManager&&(this._sessionDataManager.dispose(),this._sessionDataManager=null),this._roomEngine&&(this._roomEngine.dispose(),this._roomEngine=null),this._avatar&&(this._avatar.dispose(),this._avatar=null),this._communication&&(this._communication.dispose(),this._communication=null),super.destroy(),this._isDisposed=!0,this._isReady=!1)}onConfigurationLoadedEvent(e){const s=this.getConfiguration("animation.fps",24);this.getConfiguration("limits.fps",!0),t.instance.ticker.maxFPS=s}onRoomEngineReady(t){this.startSendingHeartBeat()}getConfiguration(t,e=null){return this._core.configuration.getValue(t,e)}getLocalization(t){return this._localization.getValue(t)}getLocalizationWithParameter(t,e,s){return this._localization.getValueWithParameter(t,e,s)}addLinkEventTracker(t){this._linkTrackers.indexOf(t)>=0||this._linkTrackers.push(t)}removeLinkEventTracker(t){const e=this._linkTrackers.indexOf(t);-1!==e&&this._linkTrackers.splice(e,1)}createLinkEvent(t){if(t&&""!==t)for(const e of this._linkTrackers){if(!e)continue;const s=e.eventUrlPrefix;s.length>0?t.substr(0,s.length)===s&&e.linkReceived(t):e.linkReceived(t)}}startSendingHeartBeat(){this.sendHeartBeat(),setInterval(this.sendHeartBeat,1e4)}sendHeartBeat(){rm.sendHeartBeat()}get nitroTimer(){return this._nitroTimer}get core(){return this._core}get events(){return this._events}get localization(){return this._localization}get communication(){return this._communication}get avatar(){return this._avatar}get roomEngine(){return this._roomEngine}get sessionDataManager(){return this._sessionDataManager}get roomSessionManager(){return this._roomSessionManager}get roomManager(){return this._roomManager}get width(){return this.renderer.width/this.renderer.resolution}get height(){return this.renderer.height/this.renderer.resolution}get time(){return this.ticker.lastTime}get isReady(){return this._isReady}get isDisposed(){return this._isDisposed}static get instance(){return this.INSTANCE||null}}return t.WEBGL_CONTEXT_LOST="NE_WEBGL_CONTEXT_LOST",t.WEBGL_UNAVAILABLE="NE_WEBGL_UNAVAILABLE",t.RELEASE_VERSION="NITRO-0-4-0",t.READY="NE_READY",t.INSTANCE=null,t})();class dm{constructor(t){this._name=t,this._achievements=[]}get name(){return this._name}set name(t){this._name=t}get achievements(){return this._achievements}set achievements(t){this._achievements=t}}let gm=(()=>{class t{constructor(){this._isReady=!1,this._avatarEditorVisible=!1,this._navigatorVisible=!1,this._catalogVisible=!1,this._inventoryVisible=!1,this._friendlistVisible=!1,this._achievementsVisible=!1,this._meMenuVisible=!1}showAvatarEditor(){this._avatarEditorVisible=!0}hideAvatarEditor(){this._avatarEditorVisible=!1}showNavigator(){this._navigatorVisible=!0}hideNavigator(){this._navigatorVisible=!1}toggleAvatarEditor(){this._avatarEditorVisible=!this._avatarEditorVisible}toggleNavigator(){this._navigatorVisible=!this._navigatorVisible}showCatalog(){this._catalogVisible=!0}hideCatalog(){this._catalogVisible=!1}toggleCatalog(){this._catalogVisible=!this._catalogVisible}showInventory(){this._inventoryVisible=!0}hideInventory(){this._inventoryVisible=!1}toggleInventory(){this._inventoryVisible=!this._inventoryVisible}showFriendList(){this._friendlistVisible=!0}hideFriendList(){this._friendlistVisible=!1}toggleFriendList(){this._friendlistVisible=!this._friendlistVisible}showAchievements(){this._achievementsVisible=!0}hideAchievements(){this._achievementsVisible=!1}toggleAchievements(){this._achievementsVisible=!this._achievementsVisible}showMeMenu(){this._meMenuVisible=!0}hideMeMenu(){this._meMenuVisible=!1}toggleMeMenu(){this._meMenuVisible=!this._meMenuVisible}get avatarEditorVisible(){return this._avatarEditorVisible}get navigatorVisible(){return this._navigatorVisible}get catalogVisible(){return this._catalogVisible}get inventoryVisible(){return this._inventoryVisible}get friendListVisible(){return this._friendlistVisible}get achievementsVisible(){return this._achievementsVisible}get meMenuVisible(){return this._meMenuVisible}set isReady(t){this._isReady=t}get isReady(){return this._isReady}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275prov=i.Qb({token:t,factory:t.\u0275fac}),t})(),mm=(()=>{class t{constructor(t,e){this._settingsService=t,this._ngZone=e,this._messages=[],this._categories=[],this._selectedCategory=null,this._achievementScore=0,this._isInitalized=!1,this.registerMessages()}ngOnDestroy(){this.unregisterMessages()}registerMessages(){this._ngZone.runOutsideAngular(()=>{this._messages=[new I(this.onAchievementsMessageEvent.bind(this)),new T(this.onAchievementsScoreEvent.bind(this)),new b(this.onAchievementEvent.bind(this))];for(const t of this._messages)um.instance.communication.registerMessageEvent(t)})}unregisterMessages(){this._ngZone.runOutsideAngular(()=>{for(const t of this._messages)um.instance.communication.removeMessageEvent(t);this._messages=[]})}onAchievementsScoreEvent(t){if(!t)return;const e=t.getParser();e&&this._ngZone.run(()=>this._achievementScore=e.score)}onAchievementsMessageEvent(t){if(!t)return;const e=t.getParser();if(!e)return;const s=[];for(const i of e.achievements){if(!i)continue;let t=null;for(const e of s)if(e&&e.name===i.category){t=e;break}t||(t=new dm(i.category),s.push(t)),t.achievements.push(i)}this._ngZone.run(()=>{this._categories=s,this._selectedCategory=this._categories[0],this._isInitalized=!0})}onAchievementEvent(t){if(!t)return;const e=t.getParser();if(!e)return;const s=e.achievement;s&&this._ngZone.run(()=>{for(const t of this._categories){if(!t||t.name!==s.category)continue;let e=!1;for(const i of t.achievements)if(i&&i.achievementId===s.achievementId){e=!0,i.progress!==s.progress&&(i.reset(s),this.isIgnoredAchievement(i)||this._selectedCategory!==t&&i.unseen++);break}if(e)break}})}isIgnoredAchievement(t){if(!t)return!1;const e=um.instance.getConfiguration("achievements.unseen.ignored"),s=t.badgeId.replace(/[0-9]/g,"");return e.indexOf(s)>=0}loadAchievements(){um.instance.communication.connection.send(new O)}get categories(){return this._categories}get selectedCategory(){return this._selectedCategory}set selectedCategory(t){this._selectedCategory=t}get achievementScore(){return this._achievementScore}get isInitalized(){return this._isInitalized}get unseenCount(){let t=0;for(const e of this._categories)if(e)for(const s of e.achievements)s&&(t+=s.unseen);return t}}return t.\u0275fac=function(e){return new(e||t)(i.gc(gm),i.gc(i.E))},t.\u0275prov=i.Qb({token:t,factory:t.\u0275fac}),t})(),pm=(()=>{class t{}return t.\u0275mod=i.Sb({type:t}),t.\u0275inj=i.Rb({factory:function(e){return new(e||t)},providers:[mm],imports:[[p]]}),t})(),Em=(()=>{class t{}return t.GENERIC="hd",t.HEAD="head",t.TORSO="torso",t.LEGS="legs",t.HOTLOOKS="hotlooks",t.WARDROBE="wardrobe",t.EFFECTS="effects",t})(),fm=(()=>{class t{constructor(t){this._model=t,this._figureString=null,this._isDisposed=!1}dispose(){this._isDisposed=!0}update(t,e=0,s=4){this._figureString=t}resetFigure(t){}get disposed(){return this._isDisposed}get figureString(){return this._figureString}}return t._Str_9887=4,t})(),Sm=(()=>{class t{constructor(){this._gender="M",this._direction=4,this._avatarEffectType=-1,this._direction=fm._Str_9887,this._view=new fm(this)}loadAvatarData(t,e){this._data=new Map,this._colors=new Map,this._gender=e,this.parseFigureString(t),this.updateView()}dispose(){this._data=null,this._colors=null,this._isDisposed=!0,this._view&&(this._view.dispose(),this._view=null)}get disposed(){return this._isDisposed}parseFigureString(t){if(!t)return;const e=t.split(".");if(e&&e.length)for(const s of e){const t=s.split("-");if(!t.length)continue;const e=t[0],i=parseInt(t[1]),r=[];let n=2;for(;n<t.length;)r.push(parseInt(t[n])),n++;r.length||r.push(0),this.savePartSetId(e,i,!1),this.savePartSetColourId(e,r,!1)}}getPartSetId(t){const e=this._data.get(t);return void 0!==e?e:-1}getColourIds(t){const e=this._colors.get(t);return void 0!==e?e:[]}getFigureString(){let t="";const e=[];for(const[i,r]of this._data.entries()){const t=this._colors.get(i);let s=i+"-"+r;if(t&&t.length){let e=0;for(;e<t.length;)s=s+"-"+t[e],e++}e.push(s)}let s=0;for(;s<e.length;)t+=e[s],s<e.length-1&&(t+="."),s++;return t}savePartData(t,e,s,i=!1){this.savePartSetId(t,e,i),this.savePartSetColourId(t,s,i)}savePartSetId(e,s,i=!0){switch(e){case t.FACE:case t.HR:case t.HA:case t.HE:case t.EA:case t.FA:case t.CH:case t.CC:case t.CHEST_ACCESSORIES:case t.CHEST_PRINTS:case t.LG:case t.SH:case t.WA:s>=0?this._data.set(e,s):this._data.delete(e)}i&&this.updateView()}savePartSetColourId(e,s,i=!0){switch(e){case t.FACE:case t.HR:case t.HA:case t.HE:case t.EA:case t.FA:case t.CH:case t.CC:case t.CHEST_ACCESSORIES:case t.CHEST_PRINTS:case t.LG:case t.SH:case t.WA:this._colors.set(e,s)}i&&this.updateView()}getFigureStringWithFace(e,s=!0){let i="";const r=[t.FACE],n=[];for(const o of r){const i=this._colors.get(o);if(void 0===i)continue;let r=this._data.get(o);o===t.FACE&&s&&(r=e);let a=o+"-"+r;if(r>=0){let t=0;for(;t<i.length;)a=a+"-"+i[t],t++}n.push(a)}let a=0;for(;a<n.length;)i+=n[a],a<n.length-1&&(i+="."),a++;return i}updateView(){this._view.update(this.getFigureString(),this._avatarEffectType,this._direction)}get view(){return this._view}get gender(){return this._gender}resetFigure(t){this.updateView()}set avatarEffectType(t){this._avatarEffectType=t}get avatarEffectType(){return this._avatarEffectType}get direction(){return this._direction}set direction(t){this._direction=t,this.updateView()}}return t.M="M",t.F="F",t.U="U",t.H="h",t.STD="std",t._Str_2028="0",t.FACE="hd",t.HR="hr",t.HA="ha",t.HE="he",t.EA="ea",t.FA="fa",t.CC="cc",t.CH="ch",t.CHEST_ACCESSORIES="ca",t.CHEST_PRINTS="cp",t.LG="lg",t.SH="sh",t.WA="wa",t})();class bm{constructor(t,e,s=!1){this._model=t,this._partColor=e,this._isSelected=!1,this._isDisabledForWearing=s,this._Str_22595()}dispose(){this._model=null,this._partColor=null}get isSelected(){return this._isSelected}set isSelected(t){this._isSelected=t}_Str_22595(){this._isHC=!!this._partColor&&this._partColor.clubLevel>0}get _Str_3420(){return this._partColor}get color(){return Ig.int2rgb(this._partColor._Str_915)}get _Str_14863(){return this._isDisabledForWearing}get isHC(){return this._isHC}}let Rm=(()=>{class t{constructor(t,e,s,i=!0,r=!1){if(this._renderManager=um.instance.avatar,this._model=t,this._partSet=e,this._colors=s,this._useColors=i,this._isDisabledForWearing=r,this._thumbContainer=null,this._imageUrl=null,this._maxColorIndex=0,this._isValidFigure=!1,this._isSelected=!1,this._isHC=!1,this._isSellable=!1,this._disposed=!1,this._isInitalized=!1,e){const t=e._Str_806;for(const e of t)this._maxColorIndex=Math.max(this._maxColorIndex,e._Str_827)}}init(){this._isInitalized||(this._isInitalized=!0,this.update())}dispose(){this._disposed||(this._renderManager=null,this._model=null,this._partSet=null,this._colors=null,this._imageUrl=null,this._disposed=!0,this._isInitalized=!1,this._thumbContainer&&(this._thumbContainer.destroy(),this._thumbContainer=null))}update(){this.updateThumbVisualization()}analyzeFigure(){if(!(this._renderManager&&this._model&&this.partSet&&this.partSet._Str_806&&this.partSet._Str_806.length))return!1;const t=this._renderManager.createFigureContainer(this.partSet.type+"-"+this.partSet.id);return this._renderManager.isFigureContainerReady(t)?(this._isValidFigure=!0,!0):(this._renderManager.downloadAvatarFigure(t,this),!1)}renderThumb(){if(!this._renderManager||!this.partSet||!this._model)return null;if(!this._isValidFigure&&!this.analyzeFigure())return null;const e=this.partSet._Str_806.concat().sort(this.sortByDrawOrder),s=new A.d;for(const i of e){if(!i)continue;let e=null,r=0,n=!1;for(;!n&&r<t.THUMB_DIRECTIONS.length;)e=this._renderManager.getAssetByName(Sm.H+"_"+Sm.STD+"_"+i.type+"_"+i.id+"_"+t.THUMB_DIRECTIONS[r]+"_"+Sm._Str_2028),e&&e.texture?n=!0:r++;if(!n)continue;const a=e.offsetX,o=e.offsetY;let c=null;if(this._useColors&&i._Str_827>0){const t=this._colors[i._Str_827-1];t&&(c=t)}const _=new A.n(e.texture);_.position.set(a,o),c&&(_.tint=c._Str_915),s.addChild(_)}return s}updateThumbVisualization(){if(!this._isInitalized)return;let t=this._thumbContainer;t||(t=this.renderThumb()),t&&(this._partSet?(this._isHC=this._partSet.clubLevel>0,this._isSellable=this._partSet._Str_651):(this._isHC=!1,this._isSellable=!1),this._isDisabledForWearing&&this.setAlpha(t,.2),this._imageUrl=bt.generateImageUrl(t))}setAlpha(t,e){return t.alpha=e,t}sortByDrawOrder(e,s){const i=t.DRAW_ORDER.indexOf(e.type),r=t.DRAW_ORDER.indexOf(s.type);return i<r?-1:i>r?1:e.index<s.index?-1:e.index>s.index?1:0}resetFigure(t){this.analyzeFigure()&&this.update()}get disposed(){return this._disposed}get id(){return this._partSet?this._partSet.id:-1}get partSet(){return this._partSet}set colors(t){this._colors=t,this.update()}get isDisabledForWearing(){return this._isDisabledForWearing}set iconImage(t){this._thumbContainer=t,this.update()}get imageUrl(){return this._imageUrl}get colorLayerCount(){return this._maxColorIndex}get isSelected(){return this._isSelected}set isSelected(t){this._isSelected=t}get isHC(){return this._isHC}get isSellable(){return this._isSellable}}return t.THUMB_DIRECTIONS=[2,6,0,4,3,1],t.DRAW_ORDER=[At.LEFT_HAND_ITEM,At.LEFT_HAND,At.LEFT_SLEEVE,At.LEFT_COAT_SLEEVE,At.BODY,At.SHOES,At.LEGS,At.CHEST,At.CHEST_ACCESSORY,At.COAT_CHEST,At.CHEST_PRINT,At.WAIST_ACCESSORY,At.RIGHT_HAND,At.RIGHT_SLEEVE,At.RIGHT_COAT_SLEEVE,At.HEAD,At.FACE,At.EYES,At.HAIR,At.HAIR_BIG,At.FACE_ACCESSORY,At.EYE_ACCESSORY,At.HEAD_ACCESSORY,At.HEAD_ACCESSORY_EXTRA,At.RIGHT_HAND_ITEM],t})();class Im{constructor(t,e,s){this.MAX_PALETTES=2,this._selectedPartIndex=-1,this._name=t,this._parts=e,this._palettes=s,this._selectedPartIndex=-1}static defaultColorId(t,e){if(!t||!t.length)return-1;let s=0;for(;s<t.length;){const i=t[s];if(i._Str_3420&&i._Str_3420.clubLevel<=e)return i._Str_3420.id;s++}return-1}init(){for(const t of this._parts)t&&t.init()}dispose(){if(this._parts){for(const t of this._parts)t.dispose();this._parts=null}if(this._palettes){for(const t of this._palettes)if(t)for(const e of t)e.dispose();this._palettes=null}this._selectedPartIndex=-1,this._paletteIndexes=null}selectPartId(t){if(!this._parts)return;let e=0;for(;e<this._parts.length;){if(this._parts[e].id===t)return void this.selectPartIndex(e);e++}}selectColorIds(t){if(!t||!this._palettes)return;this._paletteIndexes=new Array(t.length);let e=0;for(;e<this._palettes.length;){const s=this.getPalette(e);if(s){let i=0;if(t.length>e)i=t[e];else{const t=s[0];t&&t._Str_3420&&(i=t._Str_3420.id)}let r=0;for(;r<s.length;){const t=s[r];t._Str_3420.id===i?(this._paletteIndexes[e]=r,t.isSelected=!0):t.isSelected=!1,r++}}e++}this.updatePartColors()}selectPartIndex(t){if(!this._parts)return null;if(this._selectedPartIndex>=0&&this._parts.length>this._selectedPartIndex){const t=this._parts[this._selectedPartIndex];t&&(t.isSelected=!1)}if(this._parts.length>t){const e=this._parts[t];if(e)return e.isSelected=!0,this._selectedPartIndex=t,e}return null}selectColorIndex(t,e){const s=this.getPalette(e);if(!s)return null;if(s.length<=t)return null;this.deselectColorIndex(this._paletteIndexes[e],e),this._paletteIndexes[e]=t;const i=s[t];return i?(i.isSelected=!0,this.updatePartColors(),i):null}getCurrentColorIndex(t){return this._paletteIndexes[t]}deselectColorIndex(t,e){const s=this.getPalette(e);if(!s)return;if(s.length<=t)return;const i=s[t];i&&(i.isSelected=!1)}getSelectedColorIds(){if(!this._paletteIndexes||!this._paletteIndexes.length)return null;if(!this._palettes||!this._palettes.length)return null;const t=this._palettes[0];if(!t||!t.length)return null;const e=t[0];if(!e||!e._Str_3420)return null;const s=e._Str_3420.id,i=[];let r=0;for(;r<this._paletteIndexes.length;){const t=this._palettes[r];if(t&&!(t.length<=r))if(t.length>this._paletteIndexes[r]){const e=t[this._paletteIndexes[r]];i.push(e&&e._Str_3420?e._Str_3420.id:s)}else i.push(s);r++}const n=this.getCurrentPart();return n?i.slice(0,Math.max(n.colorLayerCount,1)):null}getSelectedColors(){const t=[];let e=0;for(;e<this._paletteIndexes.length;){const s=this.getSelectedColor(e);t.push(s?s._Str_3420:null),e++}return t}getSelectedColor(t){const e=this.getPalette(t);return!e||e.length<=this._paletteIndexes[t]?null:e[this._paletteIndexes[t]]}getSelectedColorId(t){const e=this.getSelectedColor(t);return e&&e._Str_3420?e._Str_3420.id:0}get parts(){return this._parts}getPalette(t){return!this._paletteIndexes||!this._palettes||this._palettes.length<=t?null:this._palettes[t]}getCurrentPart(){return this._parts[this._selectedPartIndex]}updatePartColors(){const t=this.getSelectedColors();for(const e of this._parts)e&&(e.colors=t)}hasClubSelectionsOverLevel(t){let e=!1;const s=this.getSelectedColors();if(s){let i=0;for(;i<s.length;){const r=s[i];r&&r.clubLevel>t&&(e=!0),i++}}let i=!1;const r=this.getCurrentPart();if(r&&r.partSet){const e=r.partSet;e&&e.clubLevel>t&&(i=!0)}return e||i}hasInvalidSelectedItems(t){const e=this.getCurrentPart();if(!e)return!1;const s=e.partSet;return s&&s._Str_651?!t.hasFigureSetId(s.id):void 0}stripClubItemsOverLevel(t){const e=this.getCurrentPart();if(e&&e.partSet&&e.partSet.clubLevel>t){const t=this.selectPartIndex(0);return t&&!t.partSet&&this.selectPartIndex(1),!0}return!1}stripClubColorsOverLevel(t){const e=[],s=this.getSelectedColors();let i=!1;const r=this.getPalette(0),n=Im.defaultColorId(r,t);if(-1===n)return!1;let a=0;for(;a<s.length;){const r=s[a];r?r.clubLevel>t?(e.push(n),i=!0):e.push(r.id):(e.push(n),i=!0),a++}return i&&this.selectColorIds(e),i}get name(){return this._name}get selectedPartIndex(){return this._selectedPartIndex}}class vm{constructor(t){this._editor=t,this._isInitalized=!1,this._maxPaletteCount=0}dispose(){this._categories=null,this._editor=null,this._disposed=!0}get disposed(){return this._disposed}init(){this._categories||(this._categories=new X)}reset(){if(this._isInitalized=!1,this._categories)for(const t of this._categories.getValues())t&&t.dispose();this._categories=new X,this._viewer&&this._viewer.prepareModel()}setViewer(t){this._viewer=t}addCategory(t){let e=this._categories.getValue(t);e||(e=this._editor._Str_24037(this,t),e&&(this._categories.add(t,e),this.updateSelectionsFromFigure(t)))}updateSelectionsFromFigure(t){if(!this._categories||!this._editor||!this._editor.figureData)return;const e=this._categories.getValue(t);if(!e)return;const s=this._editor.figureData.getPartSetId(t);let i=this._editor.figureData.getColourIds(t);i||(i=[]),e.selectPartId(s),e.selectColorIds(i)}hasClubSelectionsOverLevel(t){if(!this._categories)return!1;for(const e of this._categories.getValues())if(e&&e.hasClubSelectionsOverLevel(t))return!0;return!1}hasInvalidSelectedItems(t){if(!this._categories)return!1;for(const e of this._categories.getValues())if(e&&e.hasInvalidSelectedItems(t))return!0;return!1}_Str_15298(t){if(!this._categories)return!1;let e=!1;for(const s of this._categories.getKeys()){const i=this._categories.getValue(s);if(!i)continue;let r=!1;if(i.stripClubItemsOverLevel(t)&&(r=!0),i.stripClubColorsOverLevel(t)&&(r=!0),r){const t=i.getCurrentPart();t&&this._editor&&this._editor.figureData&&i&&this._editor.figureData.savePartData(s,t.id,i.getSelectedColorIds(),!0),e=!0}}return e}_Str_8360(){if(!this._categories)return!1;for(const t of this._categories.getKeys())this._categories.getValue(t);return!1}selectPart(t,e){const s=this._categories.getValue(t);if(!s)return;const i=s.selectedPartIndex;s.selectPartIndex(e);const r=s.getCurrentPart();if(r){if(r.isDisabledForWearing)return s.selectPartIndex(i),void this._editor.openHabboClubAdWindow();this._maxPaletteCount=r.colorLayerCount,this._editor&&this._editor.figureData&&this._editor.figureData.savePartData(t,r.id,s.getSelectedColorIds(),!0)}}selectColor(t,e,s){const i=this._categories.getValue(t);if(!i)return;const r=i.getCurrentColorIndex(s);if(i.selectColorIndex(e,s),this._editor&&this._editor.figureData){if(i.getSelectedColor(s)._Str_14863)return i.selectColorIndex(r,s),void this._editor.openHabboClubAdWindow();this._editor.figureData.savePartSetColourId(t,i.getSelectedColorIds(),!0)}}get controller(){return this._editor}getCategoryData(t){return this._isInitalized||this.init(),this._categories?this._categories.getValue(t):null}get categories(){return this._categories}get canSetGender(){return!1}get maxPaletteCount(){return this._maxPaletteCount}set maxPaletteCount(t){this._maxPaletteCount=t}get name(){return null}}class Tm extends vm{constructor(){super(...arguments),this._imageCallBackHandled=!1}init(){super.init(),this.addCategory(Sm.FACE),this._isInitalized=!0}selectColor(t,e,s){super.selectColor(t,e,s),this.updateSelectionsFromFigure(Sm.FACE)}updateSelectionsFromFigure(t){if(!this._categories||!this._editor||!this._editor.figureData)return;const e=this._categories.getValue(t);if(!e)return;const s=this._editor.figureData.getPartSetId(t);let i=this._editor.figureData.getColourIds(t);i||(i=[]),e.selectPartId(s),e.selectColorIds(i);for(const r of e.parts){const t=this.controller.figureData.getFigureStringWithFace(r.id),e=um.instance.avatar.createAvatarImage(t,yt.LARGE,null,this),s=e.getImageAsSprite(Pt.HEAD);s&&(s.y=10,r.iconImage=s,setTimeout(()=>e.dispose(),0))}}resetFigure(t){this._imageCallBackHandled||(this._imageCallBackHandled=!0,this.updateSelectionsFromFigure(Sm.FACE))}get canSetGender(){return!0}get name(){return Em.GENERIC}}class Om extends vm{init(){super.init(),this.addCategory(Sm.HR),this.addCategory(Sm.HA),this.addCategory(Sm.HE),this.addCategory(Sm.EA),this.addCategory(Sm.FA),this._isInitalized=!0}get name(){return Em.HEAD}}class Am extends vm{init(){super.init(),this.addCategory(Sm.LG),this.addCategory(Sm.SH),this.addCategory(Sm.WA),this._isInitalized=!0}get name(){return Em.LEGS}}class ym extends vm{init(){super.init(),this.addCategory(Sm.CH),this.addCategory(Sm.CHEST_PRINTS),this.addCategory(Sm.CC),this.addCategory(Sm.CHEST_ACCESSORIES),this._isInitalized=!0}get name(){return Em.TORSO}}let Cm=(()=>{class t{}return t.FURNI=1,t.RENTABLE=2,t.PET=3,t.BADGE=4,t.BOT=5,t.GAMES=6,t._Str_12463=[t.FURNI,t.RENTABLE,t.PET,t.BADGE,t.BOT],t})();class Mm{constructor(t,e){this._communication=t,this._inventoryService=e,this._unseenItems=[],this._messages=[],this.registerMessages()}dispose(){this.unregisterMessages(),this._communication=null,this._unseenItems=null}registerMessages(){this.unregisterMessages(),this._messages=[new Zr(this.onUnseenItemsEvent.bind(this))];for(const t of this._messages)this._communication.registerMessageEvent(t)}unregisterMessages(){for(const t of this._messages)this._communication.removeMessageEvent(t);this._messages=[]}_Str_8813(t){return!!this._Str_5621(t)&&(delete this._unseenItems[t],this._Str_20981(t),!0)}_Str_18075(t,e){if(!this._Str_5621(t))return!1;const s=this._unseenItems[t];for(const i of e)s.splice(s.indexOf(i),1);return this._Str_23994(t,e),!0}_Str_17159(t){return!this._Str_5621(t)&&(delete this._unseenItems[t],this._Str_20981(t),!0)}_Str_3613(t,e){return!!this._unseenItems[t]&&this._unseenItems[t].indexOf(e)>=0}_Str_16745(t,e){if(!this._unseenItems[t])return!1;const s=this._unseenItems[t],i=s.indexOf(e);return-1!==i&&(s.splice(i,1),!0)}_Str_11239(t){return this._unseenItems?this._unseenItems[t]:[]}_Str_5621(t){return this._unseenItems[t]?this._unseenItems[t].length:0}onUnseenItemsEvent(t){if(!t)return;const e=t.getParser();if(e){for(const t of e.categories){const s=e.getItemsByCategory(t);this._Str_18112(t,s)}this._inventoryService.updateUnseenCount()}}_Str_18112(t,e){if(!e)return;let s=this._unseenItems[t];s||(s=[],this._unseenItems[t]=s);for(const i of e)-1===s.indexOf(i)&&s.push(i)}_Str_20981(t){}_Str_23994(t,e){}}let Dm=(()=>{class t{constructor(t,e){this._settingsService=t,this._ngZone=e,this._messages=[],this._botsController=null,this._furniController=null,this._controller=null,this._petsController=null,this._tradeController=null,this._roomSession=null,this._unseenCount=0,this._botsVisible=!1,this._furnitureVisible=!1,this._petsVisible=!1,this._tradingVisible=!1,this._figureSetIds=[],this._boundFurnitureNames=[],this._unseenTracker=new Mm(um.instance.communication,this),this._unseenCounts=new Map,this.onRoomSessionEvent=this.onRoomSessionEvent.bind(this),this.registerMessages()}ngOnDestroy(){this.unregisterMessages(),this._unseenTracker&&(this._unseenTracker.dispose(),this._unseenTracker=null)}registerMessages(){this._ngZone.runOutsideAngular(()=>{um.instance.roomSessionManager.events.addEventListener(Fe.STARTED,this.onRoomSessionEvent),um.instance.roomSessionManager.events.addEventListener(Fe.ENDED,this.onRoomSessionEvent),this._messages=[new gi(this.onFigureSetIdsMessageEvent.bind(this))];for(const t of this._messages)um.instance.communication.registerMessageEvent(t)})}unregisterMessages(){this._ngZone.runOutsideAngular(()=>{um.instance.roomSessionManager.events.removeEventListener(Fe.STARTED,this.onRoomSessionEvent),um.instance.roomSessionManager.events.removeEventListener(Fe.ENDED,this.onRoomSessionEvent);for(const t of this._messages)um.instance.communication.removeMessageEvent(t);this._messages=[]})}onRoomSessionEvent(t){if(t)switch(t.type){case Fe.STARTED:return void(this._roomSession=t.session);case Fe.ENDED:return this._roomSession=null,void this._ngZone.run(()=>this.hideWindow())}}onFigureSetIdsMessageEvent(t){if(!t)return;const e=t.getParser();e&&this._ngZone.run(()=>{this._figureSetIds=e.figureSetIds,this._boundFurnitureNames=e.boundsFurnitureNames})}updateUnseenCount(){function t(){let t=0;const e=this._unseenTracker._Str_5621(Cm.FURNI);t+=e,this._unseenCounts.set(Cm.FURNI,e),this._unseenCount=t}i.E.isInAngularZone()?t.apply(this):this._ngZone.run(()=>t.apply(this))}updateItemLocking(){this.controller&&this.controller.updateItemLocking()}showWindow(){this._settingsService.showInventory()}hideWindow(){this.furniController&&(this.furniController.mouseDown=!1),this._settingsService.hideInventory()}hasFigureSetId(t){return this._figureSetIds.indexOf(t)>-1}hasBoundFigureSetFurniture(t){return this._boundFurnitureNames.indexOf(t)>-1}get botsController(){return this._botsController}set botsController(t){this._botsController=t}get furniController(){return this._furniController}set furniController(t){this._furniController=t}get controller(){return this._controller}set controller(t){this._controller=t}get petsController(){return this._petsController}set petsController(t){this._petsController=t}get tradeController(){return this._tradeController}set tradeController(t){this._tradeController=t}get unseenTracker(){return this._unseenTracker}get roomSession(){return this._roomSession}get unseenCount(){return this._unseenCount}get botsVisible(){return this._botsVisible}set botsVisible(t){this._botsVisible=t}get furnitureVisible(){return this._furnitureVisible}set furnitureVisible(t){this._furnitureVisible=t}get petsVisible(){return this._petsVisible}set petsVisible(t){this._petsVisible=t}get tradingVisible(){return this._tradingVisible}set tradingVisible(t){this._tradingVisible=t}get figureSetIds(){return this._figureSetIds}get boundFurnitureNames(){return this._boundFurnitureNames}}return t.\u0275fac=function(e){return new(e||t)(i.gc(gm),i.gc(i.E))},t.\u0275prov=i.Qb({token:t,factory:t.\u0275fac}),t})(),Nm=(()=>{class t{constructor(t){this._ngZone=t,this._component=null,this.registerMessages()}ngOnDestroy(){this.unregisterMessages()}registerMessages(){this._ngZone.runOutsideAngular(()=>{this._messages&&this.unregisterMessages(),this._messages=[new Gr(this.onHabboBroadcastMessageEvent.bind(this)),new cr(this.onModeratorMessageEvent.bind(this)),new Yr(this.onMOTDNotificationEvent.bind(this)),new jr(this.onNotificationDialogMessageEvent.bind(this))];for(const t of this._messages)um.instance.communication.registerMessageEvent(t)})}unregisterMessages(){this._ngZone.runOutsideAngular(()=>{for(const t of this._messages)um.instance.communication.removeMessageEvent(t);this._messages=[]})}onHabboBroadcastMessageEvent(t){if(!t)return;const e=t.getParser();e&&this._ngZone.run(()=>this.alert(e.message))}onNotificationDialogMessageEvent(t){if(!t)return;const e=t.getParser();if(!e)return;const s=[];e.parameters.forEach(t=>{s.push(t)}),"BUBBLE"===s[1]&&this._ngZone.run(()=>this._notificationCentre.publish(s,e.type))}onModeratorMessageEvent(t){if(!t)return;const e=t.getParser();this._ngZone.run(()=>this.alertWithLink(e.message,e.link))}onMOTDNotificationEvent(t){if(!t)return;const e=t.getParser();e&&this._ngZone.run(()=>this.alertWithScrollableMessages(e.messages))}alert(t,e=null){return this._component?this._component.alert(t,e):null}alertWithLink(t,e,s=null){return this._component?this._component.alertWithLink(t,e,s):null}alertWithConfirm(t,e=null,s=null){return this._component?this._component.alertWithConfirm(t,e,s):null}alertWithScrollableMessages(t,e=null){return this._component?this._component.alertWithScrollableMessages(t,e):null}closeAlert(t){t&&this._component&&this._component.close(t)}closeAll(){this._component&&this._component.closeAll()}get component(){return this._component}set component(t){this._component=t}get notificationCentre(){return this._notificationCentre}set notificationCentre(t){this._notificationCentre=t}}return t.\u0275fac=function(e){return new(e||t)(i.gc(i.E))},t.\u0275prov=i.Qb({token:t,factory:t.\u0275fac}),t})(),wm=(()=>{class t{constructor(t,e,s){this._notificationService=t,this._settingsService=e,this._ngZone=s,this._component=null,this._messages=[],this.registerMessages()}ngOnDestroy(){this.unregisterMessages()}registerMessages(){this._ngZone.runOutsideAngular(()=>{this._messages=[];for(const t of this._messages)um.instance.communication.registerMessageEvent(t)})}unregisterMessages(){this._ngZone.runOutsideAngular(()=>{for(const t of this._messages)um.instance.communication.removeMessageEvent(t);this._messages=[]})}loadOwnAvatarInEditor(){if(!this._component)return;const t=um.instance.sessionDataManager;this._component.loadAvatarInEditor(t.figure,t.gender,t.clubLevel)}get component(){return this._component}set component(t){this._component=t}}return t.\u0275fac=function(e){return new(e||t)(i.gc(Nm),i.gc(gm),i.gc(i.E))},t.\u0275prov=i.Qb({token:t,factory:t.\u0275fac}),t})();const Um=function(t){return{active:t}};function Lm(t,e){if(1&t){const t=i.ac();i.Zb(0,"button",12),i.jc("click",(function(){i.Ec(t);const s=e.$implicit;return i.lc(2).selectCategory(s.name)})),i.Rc(1),i.mc(2,"translate"),i.Yb()}if(2&t){const t=e.$implicit,s=i.lc(2);i.sc("ngClass",i.vc(4,Um,s.activeCategory===t)),i.Gb(1),i.Sc(i.nc(2,2,"avatareditor.category."+t.name))}}function Pm(t,e){if(1&t&&i.Vb(0,"div",13),2&t){const t=i.lc(2);i.sc("model",t.activeCategory)("gender",t.gender)}}function xm(t,e){if(1&t){const t=i.ac();i.Zb(0,"div",14),i.Zb(1,"div",15),i.Vb(2,"div",16),i.Vb(3,"div",17),i.Vb(4,"div",18),i.Zb(5,"div",19),i.Zb(6,"i",20),i.jc("click",(function(){i.Ec(t);const e=i.lc(2);return e.rotateAvatar(e.figureData.direction+1)})),i.Yb(),i.Zb(7,"i",21),i.jc("click",(function(){i.Ec(t);const e=i.lc(2);return e.rotateAvatar(e.figureData.direction-1)})),i.Yb(),i.Yb(),i.Yb(),i.Zb(8,"div",22),i.Zb(9,"button",23),i.jc("click",(function(){return i.Ec(t),i.lc(2).resetFigure()})),i.Vb(10,"i",24),i.Yb(),i.Zb(11,"button",23),i.jc("click",(function(){return i.Ec(t),i.lc(2).clearFigure()})),i.Vb(12,"i",25),i.Yb(),i.Yb(),i.Zb(13,"button",26),i.jc("click",(function(){return i.Ec(t),i.lc(2).saveFigure()})),i.Rc(14),i.mc(15,"translate"),i.Yb(),i.Yb()}if(2&t){const t=i.lc(2);i.Gb(4),i.sc("figure",t.figureData.view.figureString)("direction",t.figureData.direction)("scale",2),i.Gb(10),i.Sc(i.nc(15,4,"avatareditor.save"))}}function Fm(t,e){if(1&t){const t=i.ac();i.Zb(0,"div",1),i.Zb(1,"div",2),i.Zb(2,"h6",3),i.Rc(3),i.mc(4,"translate"),i.Yb(),i.Zb(5,"button",4),i.jc("click",(function(){return i.Ec(t),i.lc().hide()})),i.Vb(6,"i",5),i.Yb(),i.Yb(),i.Zb(7,"div",6),i.Zb(8,"div",7),i.Zb(9,"div",8),i.Pc(10,Lm,3,6,"button",9),i.Yb(),i.Pc(11,Pm,1,2,"div",10),i.Yb(),i.Pc(12,xm,16,6,"div",11),i.Yb(),i.Yb()}if(2&t){const t=i.lc();i.Gb(3),i.Sc(i.nc(4,4,"avatareditor.title")),i.Gb(7),i.sc("ngForOf",t.categories.getValues()),i.Gb(1),i.sc("ngIf",t.activeCategory),i.Gb(1),i.sc("ngIf",t.figureData)}}let Gm=(()=>{class t{constructor(t,e,s){this._inventoryService=t,this._settingsService=e,this._avatarEditorService=s,this.visible=!1}ngOnInit(){this._avatarEditorService.component=this,this._figureStructureData=um.instance.avatar.structureData,this._categories=new X,this._figures=new Map,this._gender=Sm.M,this._clubMemberLevel=0,this._lastSavedFigure="",this._lastSavedGender=Sm.M;const e=new Sm,s=new Sm;e.loadAvatarData(t._Str_18590,Sm.M),s.loadAvatarData(t._Str_18820,Sm.F),this._figures.set(Sm.M,e),this._figures.set(Sm.F,s),this._categories.add(Em.GENERIC,new Tm(this)),this._categories.add(Em.HEAD,new Om(this)),this._categories.add(Em.TORSO,new ym(this)),this._categories.add(Em.LEGS,new Am(this)),this.selectFirstCategory()}ngOnDestroy(){this._avatarEditorService.component=null}hide(){this._settingsService.hideAvatarEditor()}selectFirstCategory(){const t=this._categories.getWithIndex(0);t&&this.selectCategory(t.name)}selectCategory(t){if(!t)return;const e=this._categories.getValue(t);e&&(this._aciveCategory=e)}loadAvatarInEditor(t,e,s,i=!0){switch(e){case Sm.M:case"m":case"M":e=Sm.M;break;case Sm.F:case"f":case"F":e=Sm.F;break;default:e=Sm.M}let r=!1;this._clubMemberLevel=s;const n=this._figures.get(e);if(n){if(t!==n.getFigureString()&&(r=!0),e!==this._gender&&(this._gender=e,r=!0),n.loadAvatarData(t,e),r)for(const t of this._categories.getValues())t&&t.reset();i&&(this._lastSavedFigure=t,this._lastSavedGender=this._gender)}}_Str_24037(e,s){if(!e||!s)return null;const i=[],r=[];let n=0;for(;n<t._Str_6331;)r.push([]),n++;const a=this._Str_20100(s);if(!a)return null;const o=this._Str_783(a._Str_734);if(!o)return null;let c=this.figureData.getColourIds(s);c||(c=[]);const _=new Array(c.length),h=this._Str_24175;for(const p of o.colors.values())if(p.isSelectable&&(h||this.clubMemberLevel>=p.clubLevel)){let i=0;for(;i<t._Str_6331;){const t=new bm(e,p,this.clubMemberLevel<p.clubLevel);r[i].push(t),i++}if(s!==Sm.FACE){let t=0;for(;t<c.length;)p.id===c[t]&&(_[t]=p),t++}}let l=0,u=[];if(h?(l=2,u=um.instance.avatar._Str_838(this.gender,l)):u=um.instance.avatar._Str_838(this.gender,this.clubMemberLevel),-1==u.indexOf(s)){const t=new Rm(e,null,null,!1),s=um.instance.core.asset.getTexture("clear_icon");s&&(t.iconImage=new A.n(s)),i.push(t)}const d=s!==Sm.FACE,g=a._Str_710;let m=g.length-1;for(;m>=0;){const t=g.getWithIndex(m);let s=!1;if((t.gender===Sm.U||t.gender==this.gender)&&(s=!0),t._Str_608&&s&&(h||this.clubMemberLevel>=t.clubLevel)){const s=this.clubMemberLevel<t.clubLevel;let r=!0;if(t._Str_651&&(r=this._inventoryService&&this._inventoryService.hasFigureSetId(t.id)),r){const r=new Rm(e,t,_,d,s);i.push(r)}}m--}for(i.sort(this._Str_25757?this._Str_25189:this._Str_23935),n=0;n<t._Str_6331;)r[n].sort(this._Str_23625),n++;return new Im(s,i,r)}openHabboClubAdWindow(){}_Str_20100(t){return this._figureStructureData?this._figureStructureData._Str_740(t):null}_Str_783(t){return this._figureStructureData?this._figureStructureData._Str_783(t):null}_Str_25189(t,e){const s=t.partSet?t.partSet.clubLevel:9999999999,i=e.partSet?e.partSet.clubLevel:9999999999,r=!!t.partSet&&t.partSet._Str_651,n=!!e.partSet&&e.partSet._Str_651;return r&&!n?1:n&&!r||s>i?-1:s<i?1:t.partSet.id>e.partSet.id?-1:t.partSet.id<e.partSet.id?1:0}_Str_23935(t,e){const s=t.partSet?t.partSet.clubLevel:-1,i=e.partSet?e.partSet.clubLevel:-1,r=!!t.partSet&&t.partSet._Str_651,n=!!e.partSet&&e.partSet._Str_651;return r&&!n?1:n&&!r||s<i?-1:s>i?1:t.partSet.id<e.partSet.id?-1:t.partSet.id>e.partSet.id?1:0}_Str_23625(t,e){const s=t._Str_3420?t._Str_3420.clubLevel:-1,i=e._Str_3420?e._Str_3420.clubLevel:-1;return s<i?-1:s>i?1:t._Str_3420.index<e._Str_3420.index?-1:t._Str_3420.index>e._Str_3420.index?1:0}rotateAvatar(t){let e=t;e<Ot.MIN_DIRECTION&&(e=Ot.MAX_DIRECTION+(e+1)),e>Ot.MAX_DIRECTION&&(e-=Ot.MAX_DIRECTION+1),this.figureData.direction=e}saveFigure(){const t=this.figureData;t&&(this._lastSavedFigure=t.getFigureString(),this._lastSavedGender=t.gender,um.instance.communication.connection.send(new V_(t.gender,this._lastSavedFigure)),this.hide())}clearFigure(){const t=this.figureData;t&&this.loadAvatarInEditor(t.getFigureStringWithFace(0,!1),t.gender,this._clubMemberLevel,!1)}resetFigure(){this.loadAvatarInEditor(this._lastSavedFigure,this._gender,this._clubMemberLevel)}get _Str_25757(){return um.instance.getConfiguration("avatareditor.show.clubitems.first",!0)}get _Str_24175(){return um.instance.getConfiguration("avatareditor.show.clubitems.dimmed",!0)}get clubMemberLevel(){return this._clubMemberLevel?this._clubMemberLevel:um.instance.sessionDataManager.clubLevel}set clubMemberLevel(t){this._clubMemberLevel=t}get figureStructureData(){return this._figureStructureData}get figureData(){return this._figures.get(this._gender)}get gender(){return this._gender}set gender(t){if(this._gender!==t){switch(t){case Sm.M:case"m":case"M":t=Sm.M;break;case Sm.F:case"f":case"F":t=Sm.F;break;default:t=Sm.M}this._gender=t;for(const t of this._categories.getValues())t.reset();this.selectFirstCategory()}}get categories(){return this._categories}get activeCategory(){return this._aciveCategory}}return t._Str_18590="hr-100.hd-180-7.ch-215-66.lg-270-79.sh-305-62.ha-1002-70.wa-2007",t._Str_18820="hr-515-33.hd-600-1.ch-635-70.lg-716-66-62.sh-735-68",t._Str_6331=2,t.\u0275fac=function(e){return new(e||t)(i.Ub(Dm),i.Ub(gm),i.Ub(wm))},t.\u0275cmp=i.Ob({type:t,selectors:[["nitro-avatar-editor-main-component"]],inputs:{visible:"visible"},decls:1,vars:1,consts:[["class","nitro-avatar-editor card",3,"bringToTop","draggable",4,"ngIf"],[1,"nitro-avatar-editor","card",3,"bringToTop","draggable"],[1,"drag-handler","d-flex","justify-content-between","align-items-center","px-3","pt-3"],[1,"m-0"],["type","button",1,"close",3,"click"],[1,"fas","fa-times"],[1,"row","p-3"],[1,"col","d-flex","flex-column"],[1,"btn-group"],["type","button","class","btn btn-secondary",3,"ngClass","click",4,"ngFor","ngForOf"],["class","d-flex flex-column","nitro-avatar-model-viewer-component","",3,"model","gender",4,"ngIf"],["class","col-4 d-flex flex-column",4,"ngIf"],["type","button",1,"btn","btn-secondary",3,"ngClass","click"],["nitro-avatar-model-viewer-component","",1,"d-flex","flex-column",3,"model","gender"],[1,"col-4","d-flex","flex-column"],[1,"d-flex","position-relative","flex-grow-1","justify-content-center"],[1,"avatar-spotlight","position-absolute"],[1,"avatar-shadow","position-absolute"],["nitro-avatar-image","",1,"d-flex","justify-content-center","position-absolute","w-100","h-100","avatar-container",3,"figure","direction","scale"],[1,"arrow-container"],[1,"icon","arrow-left-icon",3,"click"],[1,"icon","arrow-right-icon",3,"click"],[1,"btn-group","mb-1"],["type","button",1,"btn","btn-sm","btn-secondary",3,"click"],[1,"fas","fa-undo"],[1,"fas","fa-trash"],["type","button",1,"btn","btn-sm","btn-success",3,"click"]],template:function(t,e){1&t&&i.Pc(0,Fm,13,6,"div",0),2&t&&i.sc("ngIf",e.visible)},encapsulation:2}),t})();const Vm=["nitro-avatar-model-viewer-component",""],Ym=function(t){return{active:t}},km=function(t){return{selected:t}};function jm(t,e){if(1&t){const t=i.ac();i.Zb(0,"button",3),i.jc("click",(function(){i.Ec(t);const s=e.$implicit;return i.lc(2).selectCategory(s.name)})),i.Vb(1,"i",4),i.Yb()}if(2&t){const t=e.$implicit,s=i.lc(2);i.sc("ngClass",i.vc(5,Ym,s.activeCategory===t)),i.Gb(1),i.Jb("icon ",t.name,"-icon"),i.sc("ngClass",i.vc(7,km,s.activeCategory===t))}}function Bm(t,e){if(1&t&&(i.Xb(0),i.Pc(1,jm,2,9,"button",2),i.Wb()),2&t){const t=i.lc();i.Gb(1),i.sc("ngForOf",t.categories.getValues())}}function Hm(t,e){if(1&t){const t=i.ac();i.Xb(0),i.Zb(1,"button",3),i.jc("click",(function(){return i.Ec(t),i.lc().selectGender("M")})),i.Vb(2,"i",5),i.Yb(),i.Zb(3,"button",3),i.jc("click",(function(){return i.Ec(t),i.lc().selectGender("F")})),i.Vb(4,"i",6),i.Yb(),i.Wb()}if(2&t){const t=i.lc();i.Gb(1),i.sc("ngClass",i.vc(4,Ym,"M"===t.gender)),i.Gb(1),i.sc("ngClass",i.vc(6,km,"M"===t.gender)),i.Gb(1),i.sc("ngClass",i.vc(8,Ym,"F"===t.gender)),i.Gb(1),i.sc("ngClass",i.vc(10,km,"F"===t.gender))}}const Wm=function(t,e){return{"col-6 pr-1":t,"flex-grow-1":e}};function Zm(t,e){if(1&t&&(i.Zb(0,"div",12),i.Vb(1,"div",13),i.Yb()),2&t){const t=i.lc(2);i.sc("ngClass",i.wc(6,Wm,t.maxPaletteCount>=2,t.maxPaletteCount<=1)),i.Gb(1),i.sc("model",t.model)("category",t.activeCategory)("paletteSet",t.activeCategory.getPalette(0))("paletteIndex",0)("maxPaletteCount",t.maxPaletteCount)}}function zm(t,e){if(1&t&&(i.Zb(0,"div",14),i.Vb(1,"div",13),i.Yb()),2&t){const t=i.lc(2);i.Gb(1),i.sc("model",t.model)("category",t.activeCategory)("paletteSet",t.activeCategory.getPalette(1))("paletteIndex",1)("maxPaletteCount",t.maxPaletteCount)}}function Xm(t,e){if(1&t&&(i.Xb(0),i.Zb(1,"div",7),i.Vb(2,"div",8),i.Yb(),i.Zb(3,"div",9),i.Pc(4,Zm,2,9,"div",10),i.Pc(5,zm,2,5,"div",11),i.Yb(),i.Wb()),2&t){const t=i.lc();i.Gb(2),i.sc("model",t.model)("category",t.activeCategory)("partSet",t.activeCategory.parts),i.Gb(2),i.sc("ngIf",t.maxPaletteCount>=1),i.Gb(1),i.sc("ngIf",2===t.maxPaletteCount)}}let Km=(()=>{class t{constructor(t){this._avatarEditorService=t,this.model=null,this.gender=null}ngOnChanges(t){this.prepareModel()}prepareModel(){this.model&&(this.model.setViewer(this),this.model.init(),this._activeCategory=null,this.selectFirstCategory())}selectFirstCategory(){if(this.model)for(const t of this.model.categories.getKeys())if(t)return void this.selectCategory(t)}selectCategory(t){if(!this.model||!t)return;const e=this.model.categories.getValue(t);if(e){e.init(),this._activeCategory=e;for(const t of this._activeCategory.parts)if(t&&t.isSelected){this.model.maxPaletteCount=t.colorLayerCount;break}}}selectGender(t){this.model&&t&&this._avatarEditorService.component&&(this._avatarEditorService.component.gender=t)}get categories(){return this.model.categories}get activeCategory(){return this._activeCategory}get canSetGender(){return this.model&&this.model.canSetGender}get maxPaletteCount(){return this.model&&this.model.maxPaletteCount||1}}return t.\u0275fac=function(e){return new(e||t)(i.Ub(wm))},t.\u0275cmp=i.Ob({type:t,selectors:[["","nitro-avatar-model-viewer-component",""]],inputs:{model:"model",gender:"gender"},features:[i.Eb],attrs:Vm,decls:4,vars:3,consts:[[1,"btn-group","w-100","my-1",2,"min-height","45px"],[4,"ngIf"],["type","button","class","btn btn-secondary d-flex justify-content-center align-items-center",3,"ngClass","click",4,"ngFor","ngForOf"],["type","button",1,"btn","btn-secondary","d-flex","justify-content-center","align-items-center",3,"ngClass","click"],[3,"ngClass"],[1,"icon","male-icon",3,"ngClass"],[1,"icon","female-icon",3,"ngClass"],[1,"d-flex"],["nitro-avatar-set-viewer-component","",1,"w-100",3,"model","category","partSet"],[1,"d-flex","no-gutters","mt-1"],["class","d-flex flex-column",3,"ngClass",4,"ngIf"],["class","d-flex col-6 pl-1 flex-column",4,"ngIf"],[1,"d-flex","flex-column",3,"ngClass"],["nitro-avatar-palette-viewer-component","",3,"model","category","paletteSet","paletteIndex","maxPaletteCount"],[1,"d-flex","col-6","pl-1","flex-column"]],template:function(t,e){1&t&&(i.Zb(0,"div",0),i.Pc(1,Bm,2,1,"ng-container",1),i.Pc(2,Hm,5,12,"ng-container",1),i.Yb(),i.Pc(3,Xm,6,5,"ng-container",1)),2&t&&(i.Gb(1),i.sc("ngIf",e.categories.length>1),i.Gb(1),i.sc("ngIf",e.canSetGender),i.Gb(1),i.sc("ngIf",e.activeCategory))},encapsulation:2}),t})();const qm=["nitro-avatar-palette-viewer-component",""],Jm=function(t){return{active:t}},Qm=function(t){return{"background-color":t}};function $m(t,e){if(1&t){const t=i.ac();i.Zb(0,"div",3),i.jc("click",(function(){i.Ec(t);const s=e.$implicit;return i.lc().selectPalette(s)})),i.Vb(1,"button",4),i.Yb()}if(2&t){const t=e.$implicit;i.Gb(1),i.sc("ngClass",i.vc(2,Jm,t.isSelected))("ngStyle",i.vc(4,Qm,t.color))}}const tp=function(t,e){return{"grid-6":t,"grid-12":e}};let ep=(()=>{class t{constructor(){this.model=null,this.category=null,this.paletteSet=[],this.paletteIndex=-1,this.maxPaletteCount=1}ngOnChanges(t){t.category&&this.perfectScrollBar&&this.perfectScrollBar.directiveRef&&this.perfectScrollBar.directiveRef.scrollToTop()}selectPalette(t){if(!(this.model&&this.category&&this.paletteSet&&t))return;if(!t||!this.model)return;const e=this.paletteSet.indexOf(t);-1!==e&&this.model.selectColor(this.category.name,e,this.paletteIndex)}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275cmp=i.Ob({type:t,selectors:[["","nitro-avatar-palette-viewer-component",""]],viewQuery:function(t,e){if(1&t&&i.Wc(u.b,!0),2&t){let t;i.Ac(t=i.kc())&&(e.perfectScrollBar=t.first)}},inputs:{model:"model",category:"category",paletteSet:"paletteSet",paletteIndex:"paletteIndex",maxPaletteCount:"maxPaletteCount"},features:[i.Eb],attrs:qm,decls:3,vars:5,consts:[[1,"grid-container","palette-grid",2,"min-height","84px","max-height","84px","height","84px"],[1,"grid-items",3,"ngClass"],["class","d-flex flex-column item-detail justify-content-center align-items-center",3,"click",4,"ngFor","ngForOf"],[1,"d-flex","flex-column","item-detail","justify-content-center","align-items-center",3,"click"],["type","button",1,"btn","btn-primary","detail-info",3,"ngClass","ngStyle"]],template:function(t,e){1&t&&(i.Zb(0,"perfect-scrollbar",0),i.Zb(1,"div",1),i.Pc(2,$m,2,6,"div",2),i.Yb(),i.Yb()),2&t&&(i.Gb(1),i.sc("ngClass",i.wc(2,tp,e.maxPaletteCount>=2,e.maxPaletteCount<=1)),i.Gb(1),i.sc("ngForOf",e.paletteSet))},directives:[u.b,o.k,o.l,o.n],encapsulation:2}),t})();const sp=["nitro-avatar-set-viewer-component",""],ip=function(t){return{active:t}},rp=function(t){return{"background-image":t}};function np(t,e){if(1&t){const t=i.ac();i.Zb(0,"div",3),i.jc("click",(function(){i.Ec(t);const s=e.$implicit;return i.lc().selectPart(s)})),i.Vb(1,"button",4),i.Yb()}if(2&t){const t=e.$implicit;i.Gb(1),i.sc("ngClass",i.vc(2,ip,t.isSelected))("ngStyle",t.imageUrl&&i.vc(4,rp,"url("+t.imageUrl+")"))}}let ap=(()=>{class t{constructor(){this.model=null,this.category=null,this.partSet=[]}ngOnChanges(t){t.category&&this.perfectScrollBar&&this.perfectScrollBar.directiveRef&&this.perfectScrollBar.directiveRef.scrollToTop()}selectPart(t){if(!(this.model&&this.category&&this.partSet&&t))return;const e=this.partSet.indexOf(t);-1!==e&&this.model.selectPart(this.category.name,e)}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275cmp=i.Ob({type:t,selectors:[["","nitro-avatar-set-viewer-component",""]],viewQuery:function(t,e){if(1&t&&i.Wc(u.b,!0),2&t){let t;i.Ac(t=i.kc())&&(e.perfectScrollBar=t.first)}},inputs:{model:"model",category:"category",partSet:"partSet"},features:[i.Eb],attrs:sp,decls:3,vars:1,consts:[[1,"grid-container",2,"min-height","158px","max-height","158px","height","158px"],[1,"grid-items","grid-6"],["class","d-flex flex-column item-detail justify-content-center align-items-center",3,"click",4,"ngFor","ngForOf"],[1,"d-flex","flex-column","item-detail","justify-content-center","align-items-center",3,"click"],["type","button",1,"btn","btn-secondary","detail-info","has-image",3,"ngClass","ngStyle"]],template:function(t,e){1&t&&(i.Zb(0,"perfect-scrollbar",0),i.Zb(1,"div",1),i.Pc(2,np,2,6,"div",2),i.Yb(),i.Yb()),2&t&&(i.Gb(2),i.sc("ngForOf",e.partSet))},directives:[u.b,o.l,o.k,o.n],encapsulation:2}),t})(),op=(()=>{class t{constructor(t,e){this.elementRef=t,this.ngZone=e,this.target=null,this.bringToFront=this.bringToFront.bind(this)}ngAfterViewInit(){const t=this.elementRef.nativeElement;t&&(this.target=t,this.addTarget(),this.registerEvents(),this.bringToFront())}ngOnDestroy(){this.unregisterEvents(),this.removeTarget(),this.bringToFront()}addTarget(){this.target&&(t.TOP_TARGETS.indexOf(this.target)>=0||t.TOP_TARGETS.push(this.target))}removeTarget(){if(!this.target)return;const e=t.TOP_TARGETS.indexOf(this.target);-1!==e&&t.TOP_TARGETS.splice(e,1)}registerEvents(){this.ngZone.runOutsideAngular(()=>{this.target&&this.target.addEventListener("mousedown",this.bringToFront)})}unregisterEvents(){this.ngZone.runOutsideAngular(()=>{this.target&&this.target.removeEventListener("mousedown",this.bringToFront)})}bringToFront(e=null){this.moveTarget();let s=t.Z_INDEX_START;for(const i of t.TOP_TARGETS)i&&(s+=t.Z_INDEX_INCREASE,i.style.zIndex=s.toString())}moveTarget(){const e=t.TOP_TARGETS.indexOf(this.target);if(-1===e)return;const s=t.TOP_TARGETS.splice(e,1);t.TOP_TARGETS.push(...s)}isTopTarget(){if(!this.target)return!1;const e=t.TOP_TARGETS.indexOf(this.target);return!(-1===e||e<t.TOP_TARGETS.length-1)}}return t.TOP_TARGETS=[],t.Z_INDEX_START=400,t.Z_INDEX_INCREASE=1,t.\u0275fac=function(e){return new(e||t)(i.Ub(i.o),i.Ub(i.E))},t.\u0275dir=i.Pb({type:t,selectors:[["","bringToTop",""]],inputs:{bringToTop:"bringToTop"}}),t})();var cp=s("XNiG"),_p=s("xgIS"),hp=s("eIep"),lp=s("lJxs"),up=s("1G5W");let dp=(()=>{class t{constructor(t,e,s){this._viewContainerRef=t,this._elementRef=e,this._ngZone=s,this.dragHandle=".drag-handler",this.center=!0,this.noMemory=!1,this._name=null,this._target=null,this._handle=null,this._delta={x:0,y:0},this._offset={x:0,y:0},this._destroy=new cp.a}ngAfterViewInit(){this._name=this._viewContainerRef._hostTNode.classesWithoutHost;const e=this._elementRef.nativeElement;if(!e)return;this._handle=this.dragHandle?e.querySelector(this.dragHandle):e,this._target=this.dragTarget?e.querySelector(this.dragTarget):e,this._handle&&(this._handle.classList.add("header-draggable"),this._handle.parentElement.classList.add("header-draggable")),this.center&&(e.style.top=`calc(50vh - ${e.offsetHeight/2}px)`,e.style.left=`calc(50vw - ${e.offsetWidth/2}px)`);const s=t.POS_MEMORY.get(this._name);s&&(this._offset.x=s.offset.x,this._offset.y=s.offset.y,this._delta.x=s.delta.x,this._delta.y=s.delta.y,this.translate()),this.setupEvents()}ngOnDestroy(){this._handle&&(this._handle.classList.remove("header-draggable"),this._handle.parentElement.classList.remove("header-draggable")),this._destroy.next()}setupEvents(){this._ngZone.runOutsideAngular(()=>{const e=Object(_p.a)(this._handle,"mousedown"),s=Object(_p.a)(document,"mousemove"),i=Object(_p.a)(document,"mouseup");e.pipe(Object(hp.a)(t=>{const e=t.clientX,r=t.clientY;return s.pipe(Object(lp.a)(t=>{t.preventDefault(),this._delta={x:t.clientX-e,y:t.clientY-r}}),Object(up.a)(i))}),Object(up.a)(this._destroy)).subscribe(()=>{0===this._delta.x&&0===this._delta.y||this.translate()}),i.pipe(Object(up.a)(this._destroy)),i.subscribe(()=>{this._offset.x+=this._delta.x,this._offset.y+=this._delta.y,this._delta={x:0,y:0},this.noMemory||t.POS_MEMORY.set(this._name,{offset:{x:this._offset.x,y:this._offset.y},delta:{x:this._delta.x,y:this._delta.y}})})})}translate(){this._target.style.transform=`translate(${this._offset.x+this._delta.x}px, ${this._offset.y+this._delta.y}px)`}}return t.POS_MEMORY=new Map,t.\u0275fac=function(e){return new(e||t)(i.Ub(i.W),i.Ub(i.o),i.Ub(i.E))},t.\u0275dir=i.Pb({type:t,selectors:[["","draggable",""]],inputs:{dragHandle:"dragHandle",dragTarget:"dragTarget",center:"center",noMemory:"noMemory"}}),t})();const gp=["nitro-avatar-image",""];function mp(t,e){if(1&t&&i.Vb(0,"img",1),2&t){const t=i.lc();i.Jb("avatar-image scale-",t.scale,""),i.sc("src",t.avatarUrl,i.Gc)}}let pp=(()=>{class t{constructor(t){this._ngZone=t,this.figure="",this.gender="M",this.headOnly=!1,this.direction=0,this.scale=1,this._avatarImageCache=new X,this.avatarUrl=null,this.disposed=!1,this.needsUpdate=!0}ngOnInit(){this.needsUpdate&&this.buildAvatar()}ngOnDestroy(){this.dispose()}ngOnChanges(t){const e=t.figure;e&&e.previousValue!==e.currentValue&&(this.needsUpdate=!0);const s=t.gender;s&&s.previousValue!==s.currentValue&&(this.needsUpdate=!0);const i=t.headOnly;i&&i.previousValue!==i.currentValue&&(this.needsUpdate=!0);const r=t.direction;r&&r.previousValue!==r.currentValue&&(this.needsUpdate=!0),this.needsUpdate&&this.buildAvatar()}dispose(){}resetFigure(t){this._avatarImageCache.remove(this.getAvatarBuildString()),this.buildAvatar()}buildAvatar(){this._ngZone.runOutsideAngular(()=>{this.needsUpdate=!1;const t=this.getUserImageUrl();t&&this._ngZone.run(()=>this.avatarUrl=t)})}getUserImageUrl(){const t=this.getAvatarBuildString();let e=this._avatarImageCache.getValue(t);if(!e){const s=um.instance.avatar.createAvatarImage(this.figure,yt.LARGE,this.gender,this,null);if(s){let t=Pt.FULL;this.headOnly&&(t=Pt.HEAD),s.setDirection(t,this.direction);const i=s.getCroppedImage(t);i&&(e=i.src),s.dispose()}e&&this.putInCache(t,e)}return e}putInCache(e,s){this._avatarImageCache.length===t.MAX_CACHE_SIZE&&this._avatarImageCache.remove(this._avatarImageCache.getKey(0)),this._avatarImageCache.add(e,s)}getAvatarBuildString(){return`${this.figure}:${this.gender}:${this.direction}:${this.headOnly}`}}return t.MAX_CACHE_SIZE=10,t.\u0275fac=function(e){return new(e||t)(i.Ub(i.E))},t.\u0275cmp=i.Ob({type:t,selectors:[["","nitro-avatar-image",""]],inputs:{figure:"figure",gender:"gender",headOnly:"headOnly",direction:"direction",scale:"scale"},features:[i.Eb],attrs:gp,decls:1,vars:1,consts:[[3,"class","src",4,"ngIf"],[3,"src"]],template:function(t,e){1&t&&i.Pc(0,mp,1,4,"img",0),2&t&&i.sc("ngIf",e.avatarUrl)},directives:[o.m],encapsulation:2}),t})(),Ep=(()=>{class t{transform(t,e=null,s=null){return e?um.instance.getLocalizationWithParameter(t,e,s&&s.toString()):um.instance.getLocalization(t)}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275pipe=i.Tb({name:"translate",type:t,pure:!0}),t})(),fp=(()=>{class t{}return t.\u0275mod=i.Sb({type:t}),t.\u0275inj=i.Rb({factory:function(e){return new(e||t)},providers:[wm],imports:[[p]]}),t})();i.Hc(Gm,[o.m,op,dp,o.l,o.k,Km,pp],[Ep]),i.Hc(Km,[o.m,o.l,o.k,ap,ep],[]);let Sp=(()=>{class t{constructor(t,e){this._notificationService=t,this._ngZone=e,this._component=null,this.registerMessages()}static getReasonAsString(t){switch(t){case 1:return"useless";case 2:return"abusive";default:return"resolved"}}ngOnDestroy(){this.unregisterMessages()}registerMessages(){this._messages&&this.unregisterMessages(),this._messages=[new ri(this.onCallForHelpResultMessageEvent.bind(this))];for(const t of this._messages)um.instance.communication.registerMessageEvent(t)}unregisterMessages(){if(this._messages&&this._messages.length)for(const t of this._messages)um.instance.communication.removeMessageEvent(t)}onCallForHelpResultMessageEvent(e){if(!e)return;const s=e.getParser();if(!s)return;let i=s.messageText;""===i&&(i=um.instance.getLocalization("${help.cfh.closed."+t.getReasonAsString(s.resultType)+"}")),this._ngZone.run(()=>this._notificationService.alert(i,"${mod.alert.title}"))}get component(){return this._component}set component(t){this._component=t}}return t.\u0275fac=function(e){return new(e||t)(i.gc(Nm),i.gc(i.E))},t.\u0275prov=i.Qb({token:t,factory:t.\u0275fac}),t})(),bp=(()=>{class t{}return t.\u0275mod=i.Sb({type:t}),t.\u0275inj=i.Rb({factory:function(e){return new(e||t)},providers:[Sp],imports:[[p]]}),t})();class Rp{}let Ip=(()=>{class t{constructor(t,e,s){this._settingsService=t,this._notificationService=e,this._ngZone=s,this._messages=[],this._component=null,this._catalogMode=-1,this._catalogRoot=null,this._activePage=null,this._activePageData=null,this._manuallyCollapsed=[],this._isLoading=!1,this._purse=new Rp,this._clubOffers=[],this._vipTemplate=null,this.registerMessages()}ngOnDestroy(){this.unregisterMessages(),this._vipTemplate=null}registerMessages(){this._ngZone.runOutsideAngular(()=>{this._messages=[new We(this.onCatalogClubEvent.bind(this)),new ze(this.onCatalogModeEvent.bind(this)),new $e(this.onCatalogPageEvent.bind(this)),new ss(this.onCatalogPagesEvent.bind(this)),new ns(this.onCatalogPurchaseEvent.bind(this)),new os(this.onCatalogPurchaseFailedEvent.bind(this)),new _s(this.onCatalogPurchaseUnavailableEvent.bind(this)),new ls(this.onCatalogSearchEvent.bind(this)),new ds(this.onCatalogSoldOutEvent.bind(this)),new ms(this.onCatalogUpdatedEvent.bind(this)),new $o(this.onUserSubscriptionEvent.bind(this))];for(const t of this._messages)um.instance.communication.registerMessageEvent(t)})}unregisterMessages(){this._ngZone.runOutsideAngular(()=>{for(const t of this._messages)um.instance.communication.removeMessageEvent(t);this._messages=[]})}onCatalogClubEvent(t){if(!t||!t.getParser()||!this._vipTemplate)return;const e=t.getParser().offers;this._clubOffers=e,this._vipTemplate.setOffers(e)}registerVipBuyTemplate(t){this._vipTemplate=t}onCatalogModeEvent(t){if(!t)return;const e=t.getParser();e&&this._ngZone.run(()=>this._catalogMode=e.mode)}onCatalogPageEvent(t){if(!t)return;const e=t.getParser();e&&this._ngZone.run(()=>{this._activePage=e,this._manuallyCollapsed=[],this._component&&this._component.setupLayout(),this._isLoading=!1})}onCatalogPagesEvent(t){if(!t)return;const e=t.getParser();e&&this._ngZone.run(()=>{this._catalogRoot=e.root,this._isLoading=!1,this._component&&this._component.selectFirstTab()})}onCatalogPurchaseEvent(t){t&&t.getParser()&&this._ngZone.run(()=>this._component&&this._component.hidePurchaseConfirmation())}onCatalogPurchaseFailedEvent(t){if(!t)return;const e=t.getParser();e&&this._ngZone.run(()=>{this._notificationService.alert("${catalog.alert.purchaseerror.description."+e.code+"}","${catalog.alert.purchaseerror.title}"),this._component&&this._component.hidePurchaseConfirmation()})}onCatalogPurchaseUnavailableEvent(t){t&&t.getParser()}onCatalogSearchEvent(t){t&&t.getParser()}onCatalogSoldOutEvent(t){t&&t.getParser()}onUserSubscriptionEvent(t){if(!t)return;const e=t.getParser();e&&(this._purse.clubDays=Math.max(0,e.days),this._purse.clubPeriods=Math.max(0,e.months),this._purse.isVip=e.isVip,this._purse.pastClubDays=e.pastClubDays,this._purse.Str_14389=e.years==Qo._Str_14729,this._purse.minutesUntilExpiration=e.totalSeconds)}onCatalogUpdatedEvent(t){t&&t.getParser()&&this._ngZone.run(()=>{this._isLoading=!1,this._catalogMode=-1,this._catalogRoot=null,this._activePage=null,this._activePageData=null,this._component&&this._component.reset(),this._settingsService.catalogVisible&&(this._component.hide(),this._notificationService.alert("${catalog.alert.published.description}","${catalog.alert.published.title}"))})}setupCatalog(t){t&&(this._isLoading=!0,this._catalogRoot=null,this._activePage=null,this._activePageData=null,this._component&&this._component.reset(),um.instance.communication.connection.send(new tc(t)))}requestPage(e){e&&this.canSelectPage(e)&&(this._activePageData=e,-1!==e.pageId&&(this._isLoading=!0,this.requestPageData(e.pageId,-1,t.MODE_NORMAL)))}requestPageData(t,e,s){um.instance.communication.connection.send(new ec(t,e,s))}isDescendant(t,e){if(!t||!e)return!1;if(t===e)return!0;if(t.children.length)for(const s of t.children)if(s){if(s===e)return!0;if(this.isDescendant(s,e))return!0}return!1}getFurnitureDataForProductOffer(t){if(!t)return null;let e=null;switch(t.productType.toUpperCase()){case $.FLOOR:e=um.instance.sessionDataManager.getFloorItemData(t.furniClassId);break;case $.WALL:e=um.instance.sessionDataManager.getWallItemData(t.furniClassId)}return e}getFurnitureDataIconUrl(t){if(!t)return null;const e=um.instance.roomEngine.roomContentLoader.getAssetUrls(t.className,t.colorId.toString(),!0);return e&&e[0]||null}purchase(t,e,s,i=null){t&&e&&s&&this.purchaseById(t.pageId,e.offerId,s,i)}purchaseById(t,e,s,i=null){t&&e&&s&&um.instance.communication.connection.send(new sc(t,e,i,s))}requestOffers(t){um.instance.communication.connection.send(new Z_(t))}redeemVoucher(t){t&&0!==t.trim().length&&um.instance.communication.connection.send(new rc(t))}manuallyCollapsePage(t){const e=this._manuallyCollapsed.indexOf(t);-1===e?this._manuallyCollapsed.push(t):this._manuallyCollapsed.splice(e,1)}canSelectPage(t){return!(!t||!t.visible)}get component(){return this._component}set component(t){this._component=t}get catalogMode(){return this._catalogMode}get catalogRoot(){return this._catalogRoot}get activePage(){return this._activePage}get activePageData(){return this._activePageData}get manuallyCollapsed(){return this._manuallyCollapsed}get purse(){return this._purse}get vipOffers(){return this._clubOffers}}return t.MODE_NORMAL="NORMAL",t.\u0275fac=function(e){return new(e||t)(i.gc(gm),i.gc(Nm),i.gc(i.E))},t.\u0275prov=i.Qb({token:t,factory:t.\u0275fac}),t})();const vp=["imageElement"];function Tp(t,e){if(1&t&&(i.Zb(0,"div",19),i.Rc(1),i.Yb()),2&t){const t=i.lc();i.Gb(1),i.Tc("X ",t.quantity,"")}}function Op(t,e){if(1&t&&(i.Zb(0,"p",20),i.Vb(1,"i",21),i.Rc(2),i.Yb()),2&t){const t=i.lc();i.Gb(2),i.Tc(" ",t.costCredits,"")}}function Ap(t,e){1&t&&(i.Zb(0,"p",22),i.Rc(1,"+"),i.Yb())}function yp(t,e){if(1&t&&(i.Zb(0,"p",20),i.Vb(1,"i"),i.Rc(2),i.Yb()),2&t){const t=i.lc();i.Gb(1),i.Jb("icon icon-currency-",t.pointsType," mr-1"),i.Gb(1),i.Sc(t.costPoints)}}const Cp=function(t){return{"background-image":t}};let Mp=(()=>{class t{constructor(t,e){this._catalogService=t,this._ngZone=e,this.page=null,this.offer=null,this.quantity=1,this.extra=null,this.completed=!1,this._imageUrl=""}ngOnChanges(t){const e=t.offer.currentValue;e&&t.offer.previousValue!==e&&this.refresh()}hide(){this._catalogService.component&&this._catalogService.component.hidePurchaseConfirmation()}refresh(){this.refreshImage()}refreshImage(){this._ngZone.runOutsideAngular(()=>{this._imageUrl="";const t=this._catalogService.component&&this._catalogService.component.roomPreviewer;if(!t)return;const e=t.getRoomPreviewObject();if(e){const t=e.visualization.getImage(16711680,-1),s=bt.generateImage(t);s&&(this._imageUrl=s.src)}})}purchase(){this._catalogService.purchase(this.page,this.offer,this.quantity,this.extra)}completePurchase(){this._ngZone.runOutsideAngular(()=>{const t=new HTMLImageElement;t.className="toolbar-icon-animation",t.src=this._imageUrl,t.style.visibility="hidden",this.imageElement&&this.imageElement.nativeElement.appendChild(t);const e=t.getBoundingClientRect(),s=new yh(t,e.x,e.y);s.iconName=Oh.INVENTORY,um.instance.roomEngine.events.dispatchEvent(s)})}get costCredits(){return this.offer.priceCredits*this.quantity}get costPoints(){return this.offer.priceActivityPoints*this.quantity}get pointsType(){return this.offer.priceActivityPointsType}get imageUrl(){return this._imageUrl}}return t.\u0275fac=function(e){return new(e||t)(i.Ub(Ip),i.Ub(i.E))},t.\u0275cmp=i.Ob({type:t,selectors:[["nitro-catalog-confirm-purchase-component"]],viewQuery:function(t,e){if(1&t&&i.Wc(vp,!0),2&t){let t;i.Ac(t=i.kc())&&(e.imageElement=t.first)}},inputs:{page:"page",offer:"offer",quantity:"quantity",extra:"extra",completed:"completed"},features:[i.Eb],decls:27,vars:17,consts:[[1,"nitro-catalog-confirm-purchase-component","card",3,"bringToTop","draggable"],[1,"drag-handler","d-flex","justify-content-between","align-items-center","px-3","pt-3"],[1,"m-0"],["type","button",1,"close",3,"click"],[1,"fas","fa-times"],[1,"row","p-3"],[1,"col-6","d-flex","flex-column"],[1,"product-preview","bg-secondary","rounded",3,"ngStyle"],["imageElement",""],[1,"col-6","d-flex","flex-column","align-items-center","justify-content-center"],[1,"offer-name"],["class","offer-quantity",4,"ngIf"],[1,"d-flex","align-items-center","justify-content-center","bg-secondary","rounded","w-100"],["class","d-flex align-items-center mb-0",4,"ngIf"],["class","mx-2 mb-0",4,"ngIf"],[1,"row","align-items-end","pt-0","px-3","pb-3"],[1,"col","btn-group"],["type","button",1,"btn","btn-primary",3,"click"],["type","button",1,"btn","btn-success",3,"click"],[1,"offer-quantity"],[1,"d-flex","align-items-center","mb-0"],[1,"icon","icon-currency--1","mr-1"],[1,"mx-2","mb-0"]],template:function(t,e){1&t&&(i.Zb(0,"div",0),i.Zb(1,"div",1),i.Zb(2,"h6",2),i.Rc(3),i.mc(4,"translate"),i.Yb(),i.Zb(5,"button",3),i.jc("click",(function(){return e.hide()})),i.Vb(6,"i",4),i.Yb(),i.Yb(),i.Zb(7,"div",5),i.Zb(8,"div",6),i.Vb(9,"div",7,8),i.Yb(),i.Zb(11,"div",9),i.Zb(12,"div",10),i.Rc(13),i.Yb(),i.Pc(14,Tp,2,1,"div",11),i.Zb(15,"div",12),i.Pc(16,Op,3,1,"p",13),i.Pc(17,Ap,2,0,"p",14),i.Pc(18,yp,3,4,"p",13),i.Yb(),i.Yb(),i.Yb(),i.Zb(19,"div",15),i.Zb(20,"div",16),i.Zb(21,"button",17),i.jc("click",(function(){return e.hide()})),i.Rc(22),i.mc(23,"translate"),i.Yb(),i.Zb(24,"button",18),i.jc("click",(function(){return e.purchase()})),i.Rc(25),i.mc(26,"translate"),i.Yb(),i.Yb(),i.Yb(),i.Yb()),2&t&&(i.Gb(3),i.Sc(i.nc(4,9,"catalog.purchase_confirmation.title")),i.Gb(6),i.sc("ngStyle",i.vc(15,Cp,"url("+e.imageUrl+")")),i.Gb(4),i.Sc(e.offer.localizationId),i.Gb(1),i.sc("ngIf",e.quantity),i.Gb(2),i.sc("ngIf",e.costCredits),i.Gb(1),i.sc("ngIf",e.costCredits&&e.costPoints),i.Gb(1),i.sc("ngIf",e.costPoints),i.Gb(4),i.Sc(i.nc(23,11,"catalog.purchase_confirmation.cancel")),i.Gb(3),i.Sc(i.nc(26,13,"catalog.purchase_confirmation.buy")))},directives:[op,dp,o.n,o.m],pipes:[Ep],encapsulation:2}),t})(),Dp=(()=>{class t{constructor(t,e){this._catalogService=t,this._ngZone=e,this.activePage=null}getText(t=0){let e=this.activePage.localization.texts[t]||null;return e=e.replace(/\r\n|\r|\n/g,"<br />"),e}getImage(t=0){let e=um.instance.getConfiguration("catalog.asset.image.url");return e=e.replace("%name%",this.activePage.localization.images[t]),e}get headerText(){return this._catalogService.catalogRoot.localization||null}get offers(){return this._catalogService.activePage.offers}get activeOffer(){return this._catalogService.component&&this._catalogService.component.activeOffer||null}get roomPreviewer(){return this._catalogService.component&&this._catalogService.component.roomPreviewer||null}}return t.\u0275fac=function(e){return new(e||t)(i.Ub(Ip),i.Ub(i.E))},t.\u0275dir=i.Pb({type:t}),t})(),Np=(()=>{class t{}return t.WALL="i",t.FLOOR="s",t.EFFECT="e",t.HABBO_CLUB="h",t.BADGE="b",t.GAME_TOKEN="GAME_TOKEN",t.PET="p",t.ROBOT="r",t})();function wp(t,e){if(1&t&&i.Vb(0,"img",7),2&t){const t=i.lc();i.sc("src",t.getImage(1),i.Gc)}}function Up(t,e){if(1&t&&(i.Zb(0,"div",8),i.Zb(1,"div",9),i.Rc(2),i.Yb(),i.Vb(3,"div",10),i.Vb(4,"div",11),i.Yb()),2&t){const t=i.lc();i.Gb(2),i.Sc(t.offerName(t.activeOffer)),i.Gb(1),i.sc("roomPreviewer",t.roomPreviewer)("width",364)("height",167),i.Gb(1),i.sc("activePage",t.activePage)("activeOffer",t.activeOffer)("quantityEnabled",t.activeOffer.bundlePurchaseAllowed)}}function Lp(t,e){if(1&t&&(i.Zb(0,"div",15),i.Rc(1),i.Yb()),2&t){const t=i.lc().$implicit,e=i.lc();i.Gb(1),i.Sc(e.offerCount(t))}}const Pp=function(t){return{active:t}},xp=function(t){return{"background-image":t}};function Fp(t,e){if(1&t){const t=i.ac();i.Zb(0,"div",12),i.jc("click",(function(){i.Ec(t);const s=e.$implicit;return i.lc().selectOffer(s)})),i.Zb(1,"button",13),i.Pc(2,Lp,2,1,"div",14),i.Yb(),i.Yb()}if(2&t){const t=e.$implicit,s=i.lc();i.Gb(1),i.sc("ngClass",i.vc(3,Pp,s.activeOffer===t))("ngStyle",i.vc(5,xp,"url("+s.offerImage(t)+")")),i.Gb(1),i.sc("ngIf",s.offerCount(t)>1)}}let Gp=(()=>{class t extends Dp{selectOffer(t){t&&this._catalogService.component&&this._catalogService.component.selectOffer(t)}getFirstProduct(t){return t&&t.products[0]||null}hasMultipleProducts(t){return t.products.length>1}offerName(t){let e="";const s=this.getFirstProduct(t);if(s)switch(s.productType){case Np.FLOOR:e="roomItem.name."+s.furniClassId;break;case Np.WALL:e="wallItem.name."+s.furniClassId}return""===e?e:um.instance.getLocalization(e)}getProductFurniData(t){return t?this._catalogService.getFurnitureDataForProductOffer(t):null}offerImage(t){if(!t)return"";const e=t.products[0];if(!e)return"";const s=this.getProductFurniData(e);if(!s)return"";switch(e.productType){case Np.FLOOR:case Np.WALL:return this._catalogService.getFurnitureDataIconUrl(s)}return""}offerCount(t){if(!this.hasMultipleProducts(t)){const e=this.getFirstProduct(t);if(e)return e.productCount}return 1}}return t.CODE="default_3x3",t.\u0275fac=function(e){return Vp(e||t)},t.\u0275cmp=i.Ob({type:t,selectors:[["ng-component"]],features:[i.Db],decls:7,vars:3,consts:[[1,"d-flex","flex-column","w-100","h-100"],[1,"d-flex","flex-column","justify-content-center","align-items-center","w-100","h-100"],[3,"src",4,"ngIf"],["class","position-relative w-100 h-100",4,"ngIf"],[1,"grid-container","w-100",2,"min-height","156px","max-height","156px","height","156px"],[1,"grid-items","grid-6"],["class","d-flex flex-column item-detail justify-content-center align-items-center",3,"click",4,"ngFor","ngForOf"],[3,"src"],[1,"position-relative","w-100","h-100"],[1,"position-absolute","bg-secondary","rounded","text-center","m-2","p-2",2,"z-index","1"],["nitro-room-preview-component","",1,"room-preview",3,"roomPreviewer","width","height"],["nitro-catalog-purchase-component","",1,"bg-secondary","rounded","my-3","py-2","px-3",3,"activePage","activeOffer","quantityEnabled"],[1,"d-flex","flex-column","item-detail","justify-content-center","align-items-center",3,"click"],["type","button",1,"position-relative","btn","btn-secondary","align-items-end","detail-info","has-image",3,"ngClass","ngStyle"],["class","position-absolute bg-danger px-1 py-0 rounded shadow count",4,"ngIf"],[1,"position-absolute","bg-danger","px-1","py-0","rounded","shadow","count"]],template:function(t,e){1&t&&(i.Zb(0,"div",0),i.Zb(1,"div",1),i.Pc(2,wp,1,1,"img",2),i.Pc(3,Up,5,7,"div",3),i.Yb(),i.Zb(4,"perfect-scrollbar",4),i.Zb(5,"div",5),i.Pc(6,Fp,3,7,"div",6),i.Yb(),i.Yb(),i.Yb()),2&t&&(i.Gb(2),i.sc("ngIf",!e.activeOffer&&e.getImage(1)),i.Gb(1),i.sc("ngIf",e.activeOffer),i.Gb(3),i.sc("ngForOf",e.offers))},encapsulation:2}),t})();const Vp=i.bc(Gp),Yp=function(t){return{"background-image":t}};function kp(t,e){if(1&t&&(i.Zb(0,"div",8),i.Zb(1,"div",9),i.Rc(2),i.Yb(),i.Yb()),2&t){const t=i.lc();i.sc("ngStyle",i.vc(2,Yp,"url("+t.getImagesUrl()+t.activePage.frontPageItems[0].itemPromoImage+")")),i.Gb(2),i.Sc(t.activePage.frontPageItems[0].itemName)}}function jp(t,e){if(1&t&&(i.Zb(0,"div",10),i.Zb(1,"div",9),i.Rc(2),i.Yb(),i.Yb()),2&t){const t=i.lc();i.sc("ngStyle",i.vc(2,Yp,"url("+t.getImagesUrl()+t.activePage.frontPageItems[1].itemPromoImage+")")),i.Gb(2),i.Sc(t.activePage.frontPageItems[1].itemName)}}function Bp(t,e){if(1&t&&(i.Zb(0,"div",10),i.Zb(1,"div",9),i.Rc(2),i.Yb(),i.Yb()),2&t){const t=i.lc();i.sc("ngStyle",i.vc(2,Yp,"url("+t.getImagesUrl()+t.activePage.frontPageItems[2].itemPromoImage+")")),i.Gb(2),i.Sc(t.activePage.frontPageItems[2].itemName)}}function Hp(t,e){if(1&t&&(i.Zb(0,"div",11),i.Zb(1,"div",9),i.Rc(2),i.Yb(),i.Yb()),2&t){const t=i.lc();i.sc("ngStyle",i.vc(2,Yp,"url("+t.getImagesUrl()+t.activePage.frontPageItems[3].itemPromoImage+")")),i.Gb(2),i.Sc(t.activePage.frontPageItems[3].itemName)}}let Wp=(()=>{class t extends Dp{getImagesUrl(){return um.instance.core.configuration.getValue("c.images.url")+"/"}}return t.CODE="frontpage4",t.\u0275fac=function(e){return Zp(e||t)},t.\u0275cmp=i.Ob({type:t,selectors:[["ng-component"]],features:[i.Db],decls:9,vars:5,consts:[[1,"nitro-catalog-layout-frontpage4-component","row"],[1,"col-4"],["class","front-page-item tall",3,"ngStyle",4,"ngIf"],[1,"col-8"],[1,"d-flex","flex-column","w-100","mb-3"],["class","front-page-item wide mb-3",3,"ngStyle",4,"ngIf"],["class","front-page-item wide mb-0",3,"ngStyle",4,"ngIf"],[3,"localization"],[1,"front-page-item","tall",3,"ngStyle"],[1,"front-page-item-caption"],[1,"front-page-item","wide","mb-3",3,"ngStyle"],[1,"front-page-item","wide","mb-0",3,"ngStyle"]],template:function(t,e){1&t&&(i.Zb(0,"div",0),i.Zb(1,"div",1),i.Pc(2,kp,3,4,"div",2),i.Yb(),i.Zb(3,"div",3),i.Zb(4,"div",4),i.Pc(5,jp,3,4,"div",5),i.Pc(6,Bp,3,4,"div",5),i.Pc(7,Hp,3,4,"div",6),i.Yb(),i.Vb(8,"redeem-voucher-component",7),i.Yb(),i.Yb()),2&t&&(i.Gb(2),i.sc("ngIf",e.activePage.frontPageItems[0]),i.Gb(3),i.sc("ngIf",e.activePage.frontPageItems[1]),i.Gb(1),i.sc("ngIf",e.activePage.frontPageItems[2]),i.Gb(1),i.sc("ngIf",e.activePage.frontPageItems[3]),i.Gb(1),i.sc("localization",e.activePage.localization))},encapsulation:2}),t})();const Zp=i.bc(Wp);let zp=(()=>{class t{static makeRoomPreviewerId(e){return(65535&e)+t.PREVIEW_ROOM_ID_BASE}static isRoomPreviewerId(e){return e>=t.PREVIEW_ROOM_ID_BASE}}return t.PREVIEW_ROOM_ID_BASE=2147418112,t})(),Xp=(()=>{class t{constructor(t,e=1){this._previewRoomId=1,this._currentPreviewObjectType=0,this._currentPreviewObjectCategory=0,this._currentPreviewObjectData="",this._currentPreviewRectangle=null,this._currentPreviewCanvasWidth=0,this._currentPreviewCanvasHeight=0,this._currentPreviewScale=64,this._disableUpdate=!1,this._roomEngine=t,this._previewRoomId=zp.makeRoomPreviewerId(e),this._addViewOffset=new A.j(0,0),this.onRoomObjectAdded=this.onRoomObjectAdded.bind(this),this.onRoomInitializedonRoomInitialized=this.onRoomInitializedonRoomInitialized.bind(this),this.isRoomEngineReady&&this._roomEngine.events&&(this._roomEngine.events.addEventListener(Nh.ADDED,this.onRoomObjectAdded),this._roomEngine.events.addEventListener(Nh.CONTENT_UPDATED,this.onRoomObjectAdded),this._roomEngine.events.addEventListener(ih.INITIALIZED,this.onRoomInitializedonRoomInitialized)),this.createRoomForPreview()}dispose(){this.reset(!0),this.isRoomEngineReady&&this._roomEngine.events&&(this._roomEngine.events.removeEventListener(Nh.ADDED,this.onRoomObjectAdded),this._roomEngine.events.removeEventListener(Nh.CONTENT_UPDATED,this.onRoomObjectAdded),this._roomEngine.events.removeEventListener(ih.INITIALIZED,this.onRoomInitializedonRoomInitialized))}createRoomForPreview(){if(this.isRoomEngineReady){const t=7,e=new Ia;e.initializeTileMap(t+2,t+2);let s=1;for(;s<1+t;){let i=1;for(;i<1+t;)e.setTileHeight(i,s,0),i++;s++}e.initializeFromTileData(),this._roomEngine.createRoomInstance(this._previewRoomId,e.getMapData()),e.dispose()}}reset(e){this.isRoomEngineReady&&(this._roomEngine.removeRoomObjectFloor(this._previewRoomId,t.PREVIEW_OBJECT_ID),this._roomEngine.removeRoomObjectWall(this._previewRoomId,t.PREVIEW_OBJECT_ID),this._roomEngine.removeRoomObjectUser(this._previewRoomId,t.PREVIEW_OBJECT_ID),e||this.updatePreviewRoomView()),this._currentPreviewObjectCategory=tt.MINIMUM}addFurnitureIntoRoom(e,s,i=null,r=null){if(i||(i=new Ii),this.isRoomEngineReady){if(this._currentPreviewObjectCategory===tt.FLOOR&&this._currentPreviewObjectType===e)return t.PREVIEW_OBJECT_ID;if(this.reset(!1),this._currentPreviewObjectType=e,this._currentPreviewObjectCategory=tt.FLOOR,this._currentPreviewObjectData="",this._roomEngine.addFurnitureFloor(this._previewRoomId,t.PREVIEW_OBJECT_ID,e,new ot(t.PREVIEW_OBJECT_LOCATION_X,t.PREVIEW_OBJECT_LOCATION_Y,0),s,0,i,NaN,-1,0,-1,"",!0,!1)){if(this._previousAutomaticStateChangeTime=um.instance.time,this._automaticStateChange=!0,r){const e=this._roomEngine.getRoomObject(this._previewRoomId,t.PREVIEW_OBJECT_ID,this._currentPreviewObjectCategory);e&&e.model.setValue(st.FURNITURE_EXTRAS,r)}return this.updatePreviewRoomView(),t.PREVIEW_OBJECT_ID}}return-1}addWallItemIntoRoom(e,s,i){if(this.isRoomEngineReady){if(this._currentPreviewObjectCategory===tt.WALL&&this._currentPreviewObjectType===e&&this._currentPreviewObjectData===i)return t.PREVIEW_OBJECT_ID;if(this.reset(!1),this._currentPreviewObjectType=e,this._currentPreviewObjectCategory=tt.WALL,this._currentPreviewObjectData=i,this._roomEngine.addFurnitureWall(this._previewRoomId,t.PREVIEW_OBJECT_ID,e,new ot(.5,2.3,1.8),s,0,i,0,0,-1,"",!1))return this._previousAutomaticStateChangeTime=um.instance.time,this._automaticStateChange=!0,this.updatePreviewRoomView(),t.PREVIEW_OBJECT_ID}return-1}addAvatarIntoRoom(e,s){return this.isRoomEngineReady?(this.reset(!1),this._currentPreviewObjectType=1,this._currentPreviewObjectCategory=tt.UNIT,this._currentPreviewObjectData=e,this._roomEngine.addRoomObjectUser(this._previewRoomId,t.PREVIEW_OBJECT_ID,new ot(t.PREVIEW_OBJECT_LOCATION_X,t.PREVIEW_OBJECT_LOCATION_Y,0),new ot(90,0,0),135,1,e)&&(this._previousAutomaticStateChangeTime=um.instance.time,this._automaticStateChange=!0,this.updateUserGesture(1),this.updateUserEffect(s),this.updateUserPosture("std")),this.updatePreviewRoomView(),t.PREVIEW_OBJECT_ID):-1}updateUserPosture(e,s=""){this.isRoomEngineReady&&this._roomEngine.updateRoomObjectUserPosture(this._previewRoomId,t.PREVIEW_OBJECT_ID,e,s)}updateUserGesture(e){this.isRoomEngineReady&&this._roomEngine.updateRoomObjectUserGesture(this._previewRoomId,t.PREVIEW_OBJECT_ID,e)}updateUserEffect(e){this.isRoomEngineReady&&this._roomEngine.updateRoomObjectUserEffect(this._previewRoomId,t.PREVIEW_OBJECT_ID,e)}updateObjectUserFigure(e,s=null,i=null,r=!1){return!!this.isRoomEngineReady&&this._roomEngine.updateRoomObjectUserFigure(this._previewRoomId,t.PREVIEW_OBJECT_ID,e,s,i,r)}updateObjectUserAction(e,s,i=null){this.isRoomEngineReady&&this._roomEngine.updateRoomObjectUserAction(this._previewRoomId,t.PREVIEW_OBJECT_ID,e,s,i)}changeRoomObjectState(){this.isRoomEngineReady&&(this._automaticStateChange=!1,this._currentPreviewObjectCategory!==tt.UNIT&&this._roomEngine.changeObjectState(this._previewRoomId,t.PREVIEW_OBJECT_ID,this._currentPreviewObjectCategory))}changeRoomObjectDirection(){if(this.isRoomEngineReady){const e=this._roomEngine.getRoomObject(this._previewRoomId,t.PREVIEW_OBJECT_ID,this._currentPreviewObjectCategory);if(!e)return;const s=this._roomEngine.objectEventHandler._Str_17555(e,!0);switch(this._currentPreviewObjectCategory){case tt.FLOOR:{const e=new ot(t.PREVIEW_OBJECT_LOCATION_X,t.PREVIEW_OBJECT_LOCATION_Y),i=new ot(s,s,s);return void this._roomEngine.updateRoomObjectFloor(this._previewRoomId,t.PREVIEW_OBJECT_ID,e,i,null,null)}case tt.WALL:return}}}checkAutomaticRoomObjectStateChange(){if(this._automaticStateChange){const e=um.instance.time;e>this._previousAutomaticStateChangeTime+t.AUTOMATIC_STATE_CHANGE_INTERVAL&&(this._previousAutomaticStateChangeTime=e,this.isRoomEngineReady&&this._roomEngine.changeObjectState(this._previewRoomId,t.PREVIEW_OBJECT_ID,this._currentPreviewObjectCategory))}}getRoomCanvas(e,s){if(this.isRoomEngineReady){const i=this._roomEngine.getRoomInstanceDisplay(this._previewRoomId,t.PREVIEW_CANVAS_ID,e,s,this._currentPreviewScale);this._roomEngine.setRoomInstanceRenderingCanvasMask(this._previewRoomId,t.PREVIEW_CANVAS_ID,!0);const r=this._roomEngine.getRoomInstanceGeometry(this._previewRoomId,t.PREVIEW_CANVAS_ID);return r&&r.adjustLocation(new ot(t.PREVIEW_OBJECT_LOCATION_X,t.PREVIEW_OBJECT_LOCATION_Y,0),30),this._currentPreviewCanvasWidth=e,this._currentPreviewCanvasHeight=s,i}return null}modifyRoomCanvas(e,s){this.isRoomEngineReady&&(this._currentPreviewCanvasWidth=e,this._currentPreviewCanvasHeight=s,this._roomEngine.initializeRoomInstanceRenderingCanvas(this._previewRoomId,t.PREVIEW_CANVAS_ID,e,s))}set addViewOffset(t){this._addViewOffset=t}get addViewOffset(){return this._addViewOffset}updatePreviewObjectBoundingRectangle(e){const s=this._roomEngine.getRoomObjectBoundingRectangle(this._previewRoomId,t.PREVIEW_OBJECT_ID,this._currentPreviewObjectCategory,t.PREVIEW_CANVAS_ID);if(s&&e)if(s.x+=-(this._currentPreviewCanvasWidth>>1),s.y+=-(this._currentPreviewCanvasHeight>>1),s.x+=-e.x,s.y+=-e.y,this._currentPreviewRectangle){const t=this._currentPreviewRectangle.clone().enlarge(s);(t.width-this._currentPreviewRectangle.width>this._currentPreviewCanvasWidth-this._currentPreviewRectangle.width>>1||t.height-this._currentPreviewRectangle.height>this._currentPreviewCanvasHeight-this._currentPreviewRectangle.height>>1||this._currentPreviewRectangle.width<1||this._currentPreviewRectangle.height<1)&&(this._currentPreviewRectangle=t)}else this._currentPreviewRectangle=s}validatePreviewSize(e){if(this._currentPreviewRectangle.width<1||this._currentPreviewRectangle.height<1)return e;if(this.isRoomEngineReady){const s=this._roomEngine.getRoomInstanceGeometry(this._previewRoomId,t.PREVIEW_CANVAS_ID);this._currentPreviewRectangle.width>this._currentPreviewCanvasWidth*(1+t.ALLOWED_IMAGE_CUT)||this._currentPreviewRectangle.height>this._currentPreviewCanvasHeight*(1+t.ALLOWED_IMAGE_CUT)?t.ZOOM_ENABLED?.5!==this._roomEngine.getRoomInstanceRenderingCanvasScale(this._previewRoomId,t.PREVIEW_CANVAS_ID)&&(this._roomEngine.setRoomInstanceRenderingCanvasScale(this._previewRoomId,t.PREVIEW_CANVAS_ID,.5,null,null),this._currentPreviewScale=t.SCALE_SMALL,this._currentPreviewNeedsZoomOut=!0,e.x=e.x>>1,e.y=e.y>>1,this._currentPreviewRectangle.x=this._currentPreviewRectangle.x>>2,this._currentPreviewRectangle.y=this._currentPreviewRectangle.y>>2,this._currentPreviewRectangle.width=this._currentPreviewRectangle.width>>2,this._currentPreviewRectangle.height=this._currentPreviewRectangle.height>>2):s.isZoomedIn()&&(s.performZoomOut(),this._currentPreviewScale=t.SCALE_SMALL,this._currentPreviewNeedsZoomOut=!0,e.x=e.x>>1,e.y=e.y>>1,this._currentPreviewRectangle.x=this._currentPreviewRectangle.x>>2,this._currentPreviewRectangle.y=this._currentPreviewRectangle.y>>2,this._currentPreviewRectangle.width=this._currentPreviewRectangle.width>>2,this._currentPreviewRectangle.height=this._currentPreviewRectangle.height>>2):this._currentPreviewRectangle.width<<1<this._currentPreviewCanvasWidth*(1+t.ALLOWED_IMAGE_CUT)-5&&this._currentPreviewRectangle.height<<1<this._currentPreviewCanvasHeight*(1+t.ALLOWED_IMAGE_CUT)-5&&(t.ZOOM_ENABLED?1===this._roomEngine.getRoomInstanceRenderingCanvasScale(this._previewRoomId,t.PREVIEW_CANVAS_ID)||this._currentPreviewNeedsZoomOut||(this._roomEngine.setRoomInstanceRenderingCanvasScale(this._previewRoomId,t.PREVIEW_CANVAS_ID,1,null,null),this._currentPreviewScale=t.SCALE_NORMAL,e.x=e.x<<1,e.y=e.y<<1):s.isZoomedIn()||this._currentPreviewNeedsZoomOut||(s.performZoomIn(),this._currentPreviewScale=t.SCALE_NORMAL,e.x=e.x<<1,e.y=e.y<<1))}return e}zoomIn(){this.isRoomEngineReady&&(t.ZOOM_ENABLED&&this._roomEngine.setRoomInstanceRenderingCanvasScale(this._previewRoomId,t.PREVIEW_CANVAS_ID,1),this._roomEngine.getRoomInstanceGeometry(this._previewRoomId,t.PREVIEW_CANVAS_ID).performZoomIn()),this._currentPreviewScale=t.SCALE_NORMAL}zoomOut(){this.isRoomEngineReady&&(t.ZOOM_ENABLED?this._roomEngine.setRoomInstanceRenderingCanvasScale(this._previewRoomId,t.PREVIEW_CANVAS_ID,.5):this._roomEngine.getRoomInstanceGeometry(this._previewRoomId,t.PREVIEW_CANVAS_ID).performZoomOut()),this._currentPreviewScale=t.SCALE_SMALL}updateAvatarDirection(e,s){this.isRoomEngineReady&&this._roomEngine.updateRoomObjectUserLocation(this._previewRoomId,t.PREVIEW_OBJECT_ID,new ot(t.PREVIEW_OBJECT_LOCATION_X,t.PREVIEW_OBJECT_LOCATION_Y,0),new ot(t.PREVIEW_OBJECT_LOCATION_X,t.PREVIEW_OBJECT_LOCATION_Y,0),!1,0,new ot(45*e,0,0),45*s)}updateObjectRoom(t=null,e=null,s=null,i=!1){return!!this.isRoomEngineReady&&this._roomEngine.updateRoomInstancePlaneType(this._previewRoomId,t,e,s,i)}updateRoomWallsAndFloorVisibility(t,e=!0){this.isRoomEngineReady&&this._roomEngine.updateRoomInstancePlaneVisibility(this._previewRoomId,t,e)}getCanvasOffset(t){if(this._currentPreviewRectangle.width<1||this._currentPreviewRectangle.height<1)return t;let e=-(this._currentPreviewRectangle.left+this._currentPreviewRectangle.right)>>1,s=-(this._currentPreviewRectangle.top+this._currentPreviewRectangle.bottom)>>1;const i=this._currentPreviewCanvasHeight-this._currentPreviewRectangle.height>>1;i>10?s+=Math.min(15,i-10):this._currentPreviewObjectCategory!==tt.UNIT?s+=5-Math.max(0,i/2):s-=5-Math.min(0,i/2),s+=this._addViewOffset.y,e+=this._addViewOffset.x;const r=e-t.x,n=s-t.y;if(0!==r||0!==n){const i=Math.sqrt(r*r+n*n);return i>10&&(e=t.x+10*r/i,s=t.y+10*n/i),new A.j(e,s)}return null}updatePreviewRoomView(e=!1){if((!this._disableUpdate||e)&&(this.checkAutomaticRoomObjectStateChange(),this.isRoomEngineReady)){let e=this._roomEngine.getRoomInstanceRenderingCanvasOffset(this._previewRoomId,t.PREVIEW_CANVAS_ID);if(e&&(this.updatePreviewObjectBoundingRectangle(e),this._currentPreviewRectangle)){const s=this._currentPreviewScale;e=this.validatePreviewSize(e);const i=this.getCanvasOffset(e);i&&this._roomEngine.setRoomInstanceRenderingCanvasOffset(this._previewRoomId,t.PREVIEW_CANVAS_ID,i),this._currentPreviewScale!==s&&(this._currentPreviewRectangle=null)}}}set disableUpdate(t){this._disableUpdate=t}set disableRoomEngineUpdate(t){this.isRoomEngineReady&&this._roomEngine.disableUpdate(t)}onRoomInitializedonRoomInitialized(t){if(t)switch(t.type){case ih.INITIALIZED:return void(t.roomId===this._previewRoomId&&this.isRoomEngineReady&&this._roomEngine.updateRoomInstancePlaneType(this._previewRoomId,"110","99999"))}}onRoomObjectAdded(e){if(e.roomId===this._previewRoomId&&e.objectId===t.PREVIEW_OBJECT_ID&&e.category===this._currentPreviewObjectCategory){this._currentPreviewRectangle=null,this._currentPreviewNeedsZoomOut=!1;const t=this._roomEngine.getRoomObject(e.roomId,e.objectId,e.category);if(t&&t.model&&e.category===tt.WALL){const s=t.model.getValue(st.FURNITURE_SIZE_Z),i=t.model.getValue(st.FURNITURE_CENTER_Z);null===s&&null===i||this._roomEngine.updateRoomObjectWallLocation(e.roomId,e.objectId,new ot(.5,2.3,(3.6-s)/2+i))}}}updateRoomEngine(){this.isRoomEngineReady&&this._roomEngine.runUpdate()}getRenderingCanvas(){return this._roomEngine.getRoomInstanceRenderingCanvas(this._previewRoomId,t.PREVIEW_CANVAS_ID)||null}getGenericRoomObjectImage(t,e,s,i,r,n=0,a=null,o=null,c=-1,_=-1,h=null){return this.isRoomEngineReady?this._roomEngine.getGenericRoomObjectImage(t,e,s,i,r,n,a,o,c,_,h):null}getRoomObjectImage(e,s,i,r=0){return this.isRoomEngineReady?this._roomEngine.getRoomObjectImage(this._previewRoomId,t.PREVIEW_OBJECT_ID,this._currentPreviewObjectCategory,e,s,i,r):null}getRoomObjectCurrentImage(){if(this.isRoomEngineReady){const e=this._roomEngine.getRoomObject(this._previewRoomId,t.PREVIEW_OBJECT_ID,tt.UNIT);if(e&&e.visualization)return e.visualization.getImage(16777215,-1)}return null}getRoomPreviewObject(){if(this.isRoomEngineReady){const e=this._roomEngine.getRoomObject(this._previewRoomId,t.PREVIEW_OBJECT_ID,this._currentPreviewObjectCategory);if(e)return e}return null}get isRoomEngineReady(){return this._roomEngine&&this._roomEngine.ready}get roomId(){return this._previewRoomId}}return t.SCALE_NORMAL=64,t.SCALE_SMALL=32,t.PREVIEW_COUNTER=0,t.PREVIEW_CANVAS_ID=1,t.PREVIEW_OBJECT_ID=1,t.PREVIEW_OBJECT_LOCATION_X=2,t.PREVIEW_OBJECT_LOCATION_Y=2,t.ALLOWED_IMAGE_CUT=.25,t.AUTOMATIC_STATE_CHANGE_INTERVAL=2500,t.ZOOM_ENABLED=!0,t})(),Kp=(()=>{class t extends Dp{}return t.CODE="frontpage_featured",t.\u0275fac=function(e){return qp(e||t)},t.\u0275cmp=i.Ob({type:t,selectors:[["ng-component"]],features:[i.Db],decls:2,vars:0,consts:[[1,"nitro-catalog-layout-frontpagefeatured-component"]],template:function(t,e){1&t&&(i.Zb(0,"div",0),i.Rc(1," frontpage\n"),i.Yb())},encapsulation:2}),t})();const qp=i.bc(Kp);let Jp=(()=>{class t extends Dp{}return t.CODE="pets",t.\u0275fac=function(e){return Qp(e||t)},t.\u0275cmp=i.Ob({type:t,selectors:[["ng-component"]],features:[i.Db],decls:1,vars:0,consts:[[1,"d-flex","flex-column","w-100","h-100","card","nitro-catalog-layout-pets2-component"]],template:function(t,e){1&t&&i.Vb(0,"div",0)},encapsulation:2}),t})();const Qp=i.bc(Jp);let $p=(()=>{class t extends Dp{}return t.CODE="pets2",t.\u0275fac=function(e){return tE(e||t)},t.\u0275cmp=i.Ob({type:t,selectors:[["ng-component"]],features:[i.Db],decls:10,vars:4,consts:[[1,"d-flex","flex-column","w-100","h-100","card","nitro-catalog-layout-pets3-component","small","p-1"],[1,"position-relative","w-100",2,"min-height","422px","max-height","422px","height","422px"],[1,"overflow-hidden","d-flex","flex-column",2,"min-height","422px"],[1,"row","m-3"],[1,"col-sm-3","overflow-hidden","d-flex","justify-content-center","px-1"],[1,"align-self-center",3,"src"],[1,"col-sm","d-flex","justify-content-center","px-2"],[1,"align-self-center",3,"innerHtml"],[1,"mx-3",3,"innerHtml"],[1,"mx-3","mt-auto","mb-3",3,"innerHtml"]],template:function(t,e){1&t&&(i.Zb(0,"div",0),i.Zb(1,"perfect-scrollbar",1),i.Zb(2,"div",2),i.Zb(3,"div",3),i.Zb(4,"div",4),i.Vb(5,"img",5),i.Yb(),i.Zb(6,"div",6),i.Vb(7,"h5",7),i.Yb(),i.Yb(),i.Vb(8,"div",8),i.Vb(9,"span",9),i.Yb(),i.Yb(),i.Yb()),2&t&&(i.Gb(5),i.sc("src",e.getImage(1),i.Gc),i.Gb(2),i.sc("innerHtml",e.getText(1),i.Fc),i.Gb(1),i.sc("innerHtml",e.getText(2),i.Fc),i.Gb(1),i.sc("innerHtml",e.getText(3),i.Fc))},directives:[u.b],encapsulation:2}),t})();const tE=i.bc($p);let eE=(()=>{class t extends Dp{}return t.CODE="pets3",t.\u0275fac=function(e){return sE(e||t)},t.\u0275cmp=i.Ob({type:t,selectors:[["ng-component"]],features:[i.Db],decls:10,vars:4,consts:[[1,"d-flex","flex-column","w-100","h-100","card","nitro-catalog-layout-pets3-component","small","p-1"],[1,"position-relative","w-100",2,"min-height","422px","max-height","422px","height","422px"],[1,"overflow-hidden","d-flex","flex-column",2,"min-height","422px"],[1,"row","m-3"],[1,"col-sm-3","overflow-hidden","d-flex","justify-content-center","px-1"],[1,"align-self-center",3,"src"],[1,"col-sm","d-flex","justify-content-center","px-2"],[1,"align-self-center",3,"innerHtml"],[1,"mx-3",3,"innerHtml"],[1,"mx-3","mt-auto","mb-3",3,"innerHtml"]],template:function(t,e){1&t&&(i.Zb(0,"div",0),i.Zb(1,"perfect-scrollbar",1),i.Zb(2,"div",2),i.Zb(3,"div",3),i.Zb(4,"div",4),i.Vb(5,"img",5),i.Yb(),i.Zb(6,"div",6),i.Vb(7,"h5",7),i.Yb(),i.Yb(),i.Vb(8,"div",8),i.Vb(9,"span",9),i.Yb(),i.Yb(),i.Yb()),2&t&&(i.Gb(5),i.sc("src",e.getImage(1),i.Gc),i.Gb(2),i.sc("innerHtml",e.getText(1),i.Fc),i.Gb(1),i.sc("innerHtml",e.getText(2),i.Fc),i.Gb(1),i.sc("innerHtml",e.getText(3),i.Fc))},directives:[u.b],encapsulation:2}),t})();const sE=i.bc(eE),iE=["previewImage"],rE=["nitro-room-preview-component",""];let nE=(()=>{class t{constructor(t,e){this._elementRef=t,this.ngZone=e,this.roomPreviewer=null,this.width=1,this.height=1,this.renderingCanvas=null,this.displayObject=null,this.imageUrl=null,this.isRunning=!1,this.onClick=this.onClick.bind(this)}ngOnInit(){this.roomPreviewer&&(1===this.width&&(this.width=Math.trunc(this._elementRef.nativeElement.offsetWidth)),1===this.height&&(this.height=Math.trunc(this._elementRef.nativeElement.offsetHeight)),this._elementRef.nativeElement.style.minWidth=this._elementRef.nativeElement.offsetWidth+"px",this._elementRef.nativeElement.style.minHeight=this._elementRef.nativeElement.offsetHeight+"px")}ngOnDestroy(){this.stop()}ngAfterViewInit(){this.roomPreviewer&&(this.displayObject=this.roomPreviewer.getRoomCanvas(this.width,this.height),this.renderingCanvas=this.roomPreviewer.getRenderingCanvas()),this.start()}start(){this.isRunning||(this.ngZone.runOutsideAngular(()=>{this.previewImageElement.addEventListener("click",this.onClick),um.instance.ticker.add(this.update,this)}),this.isRunning=!0)}stop(){this.isRunning&&(this.ngZone.runOutsideAngular(()=>{this.previewImageElement.removeEventListener("click",this.onClick),um.instance.ticker.remove(this.update,this)}),this.isRunning=!1)}update(t){if(this.roomPreviewer&&this.renderingCanvas&&this.displayObject&&(this.roomPreviewer.updatePreviewRoomView(),this.renderingCanvas.canvasUpdated)){const t=um.instance.renderer.extract.base64(this.displayObject);this.previewImageElement.src=t}}onClick(t){t&&this.isRunning&&this.roomPreviewer&&(t.shiftKey?this.roomPreviewer.changeRoomObjectDirection():this.roomPreviewer.changeRoomObjectState())}get previewImageElement(){return this.previewImage&&this.previewImage.nativeElement||null}}return t.\u0275fac=function(e){return new(e||t)(i.Ub(i.o),i.Ub(i.E))},t.\u0275cmp=i.Ob({type:t,selectors:[["","nitro-room-preview-component",""]],viewQuery:function(t,e){if(1&t&&i.Wc(iE,!0),2&t){let t;i.Ac(t=i.kc())&&(e.previewImage=t.first)}},inputs:{roomPreviewer:"roomPreviewer",width:"width",height:"height"},attrs:rE,decls:2,vars:0,consts:[[1,"room-preview-image"],["previewImage",""]],template:function(t,e){1&t&&i.Vb(0,"img",0,1)},encapsulation:2}),t})();function aE(t,e){if(1&t&&i.Vb(0,"img",8),2&t){const t=i.lc();i.sc("src",t.getImage(1),i.Gc)}}function oE(t,e){if(1&t&&(i.Xb(0),i.Vb(1,"div",9),i.Zb(2,"div",10),i.Vb(3,"nitro-catalog-purchase-component",11),i.Yb(),i.Wb()),2&t){const t=i.lc();i.Gb(1),i.sc("roomPreviewer",t.roomPreviewer)("width",265)("height",170),i.Gb(2),i.sc("activePage",t.activePage)("activeOffer",t.activeOffer)("vertical",!0)}}function cE(t,e){if(1&t&&(i.Zb(0,"div",22),i.Rc(1),i.Yb()),2&t){const t=i.lc().$implicit,e=i.lc(2);i.Gb(1),i.Sc(e.offerCount(t))}}function _E(t,e){1&t&&(i.Zb(0,"div",23),i.Rc(1,"+"),i.Yb())}function hE(t,e){if(1&t&&(i.Zb(0,"div",24),i.Vb(1,"i",25),i.Rc(2),i.Yb()),2&t){const t=i.lc().$implicit;i.Gb(2),i.Tc(" ",t.priceCredits," ")}}function lE(t,e){if(1&t&&(i.Zb(0,"div",24),i.Vb(1,"i"),i.Rc(2),i.Yb()),2&t){const t=i.lc().$implicit;i.Gb(1),i.Jb("icon icon-currency-",t.priceActivityPointsType," scale-0-75"),i.Gb(1),i.Tc(" ",t.priceActivityPoints," ")}}const uE=function(t){return{active:t}},dE=function(t){return{"background-image":t}};function gE(t,e){if(1&t){const t=i.ac();i.Zb(0,"div",15),i.jc("click",(function(){i.Ec(t);const s=e.$implicit;return i.lc(2).selectOffer(s)})),i.Vb(1,"div",16),i.Pc(2,cE,2,1,"div",17),i.Zb(3,"div",18),i.Pc(4,_E,2,0,"div",19),i.Zb(5,"div",20),i.Pc(6,hE,3,1,"div",21),i.Pc(7,lE,3,4,"div",21),i.Yb(),i.Yb(),i.Yb()}if(2&t){const t=e.$implicit,s=i.lc(2);i.sc("ngClass",i.vc(6,uE,s.activeOffer===t)),i.Gb(1),i.sc("ngStyle",i.vc(8,dE,"url("+s.offerImage(t)+")")),i.Gb(1),i.sc("ngIf",s.offerCount(t)>1),i.Gb(2),i.sc("ngIf",t.priceCredits&&t.priceActivityPoints),i.Gb(2),i.sc("ngIf",t.priceCredits),i.Gb(1),i.sc("ngIf",t.priceActivityPoints)}}function mE(t,e){if(1&t&&(i.Zb(0,"perfect-scrollbar",12),i.Zb(1,"div",13),i.Pc(2,gE,8,10,"div",14),i.Yb(),i.Yb()),2&t){const t=i.lc();i.Gb(2),i.sc("ngForOf",t.groups[t.activeGroupIndex])}}let pE=(()=>{class t extends Gp{constructor(){super(...arguments),this._groupNames=["wallpaper","floor","landscape"],this._groups=[],this._activeGroupIndex=-1}ngOnInit(){this.sortOffers(),this.selectFirstSpace()}sortOffers(){for(const t of this.offers){if(!t)continue;const e=this.getFirstProduct(t);if(e&&(e.productType===Np.WALL||e.productType===Np.FLOOR)){const s=this.getProductFurniData(e);if(s){const e=s.className,i=this._groupNames.indexOf(e);for(-1===i&&this._groupNames.push(e);this._groups.length<this._groupNames.length;)this._groups.push([]);switch(e){case"floor":case"wallpaper":case"landscape":this._groups[i].push(t)}}}}this.switchCategory("walls")}switchCategory(t){let e=-1;switch(t){case"walls":e=0;break;case"floor":e=1;break;case"landscape":e=2}this._activeGroupIndex=e}selectFirstSpace(){if(-1===this._activeGroupIndex)return;const t=this._groups[this.activeGroupIndex];t&&t.length&&this.selectOffer(t[0])}offerName(t){let e="";const s=this.getFirstProduct(t);if(s)switch(s.productType){case Np.FLOOR:e="roomItem.name."+s.furniClassId;break;case Np.WALL:e="wallItem.name."+s.furniClassId}return""===e?e:um.instance.getLocalization(e)}offerImage(t){if(!t)return"";const e=t.products[0];if(!e)return"";const s=this.getProductFurniData(e);if(!s)return"";const i=um.instance.getConfiguration("catalog.asset.url");let r="";switch(e.productType){case Np.WALL:switch(s.className){case"floor":r=["th",s.className,e.extraParam].join("_");break;case"wallpaper":r=["th","wall",e.extraParam].join("_");break;case"landscape":r=["th",s.className,e.extraParam.replace(".","_"),"001"].join("_")}break;default:return super.offerImage(t)}return i+"/"+r+".png"}get groups(){return this._groups}get activeGroupIndex(){return this._activeGroupIndex}}return t.CODE="spaces_new",t.\u0275fac=function(e){return EE(e||t)},t.\u0275cmp=i.Ob({type:t,selectors:[["ng-component"]],features:[i.Db],decls:16,vars:21,consts:[[1,"d-flex","flex-column","w-100","h-100","nitro-catalog-layout-spaces-component"],[1,"d-flex","justify-content-center","align-items-center","position-relative","w-100","flex-grow-1"],[3,"src",4,"ngIf"],[4,"ngIf"],[1,"d-flex","justify-content-center","align-items-center"],[1,"btn-group","my-2"],["type","button",1,"btn","btn-primary","btn-sm",3,"ngClass","click"],["class","grid-container position-relative w-100","style","min-height: 205px;max-height: 205px;",4,"ngIf"],[3,"src"],["nitro-room-preview-component","",1,"room-preview",3,"roomPreviewer","width","height"],[1,"flex-grow-1"],[3,"activePage","activeOffer","vertical"],[1,"grid-container","position-relative","w-100",2,"min-height","205px","max-height","205px"],[1,"grid-items","grid-6"],["class","d-flex flex-column item-detail justify-content-center align-items-center",3,"ngClass","click",4,"ngFor","ngForOf"],[1,"d-flex","flex-column","item-detail","justify-content-center","align-items-center",3,"ngClass","click"],[1,"d-flex","flex-grow-1","align-items-center","detail-image",3,"ngStyle"],["class","badge badge-secondary",4,"ngIf"],[1,"d-flex","align-items-center","justify-content-center","badge","badge-secondary"],["class","d-flex mr-1",4,"ngIf"],[1,"d-flex","flex-column"],["class","d-flex align-items-center",4,"ngIf"],[1,"badge","badge-secondary"],[1,"d-flex","mr-1"],[1,"d-flex","align-items-center"],[1,"icon","icon-currency--1","scale-0-75"]],template:function(t,e){1&t&&(i.Zb(0,"div",0),i.Zb(1,"div",1),i.Pc(2,aE,1,1,"img",2),i.Pc(3,oE,4,6,"ng-container",3),i.Yb(),i.Zb(4,"div",4),i.Zb(5,"div",5),i.Zb(6,"button",6),i.jc("click",(function(){return e.switchCategory("walls")})),i.Rc(7),i.mc(8,"translate"),i.Yb(),i.Zb(9,"button",6),i.jc("click",(function(){return e.switchCategory("floor")})),i.Rc(10),i.mc(11,"translate"),i.Yb(),i.Zb(12,"button",6),i.jc("click",(function(){return e.switchCategory("landscape")})),i.Rc(13),i.mc(14,"translate"),i.Yb(),i.Yb(),i.Yb(),i.Pc(15,mE,3,1,"perfect-scrollbar",7),i.Yb()),2&t&&(i.Gb(2),i.sc("ngIf",!e.activeOffer&&e.getImage(1)),i.Gb(1),i.sc("ngIf",e.activeOffer),i.Gb(3),i.sc("ngClass",i.vc(15,uE,0===e.activeGroupIndex)),i.Gb(1),i.Sc(i.nc(8,9,"catalog.spaces.tab.walls")),i.Gb(2),i.sc("ngClass",i.vc(17,uE,1===e.activeGroupIndex)),i.Gb(1),i.Sc(i.nc(11,11,"catalog.spaces.tab.floors")),i.Gb(2),i.sc("ngClass",i.vc(19,uE,2===e.activeGroupIndex)),i.Gb(1),i.Sc(i.nc(14,13,"catalog.spaces.tab.views")),i.Gb(2),i.sc("ngIf",e.activeGroupIndex>=0))},directives:[o.m,o.k,nE,u.b,o.l,o.n],pipes:[Ep],encapsulation:2}),t})();const EE=i.bc(pE);let fE=(()=>{class t extends Dp{}return t.CODE="UNSUPPORTED",t.\u0275fac=function(e){return SE(e||t)},t.\u0275cmp=i.Ob({type:t,selectors:[["ng-component"]],features:[i.Db],decls:2,vars:0,consts:[[1,"d-flex","flex-column","justify-content-center","align-items-center","w-100","h-100","nitro-catalog-layout-unsupported-component"]],template:function(t,e){1&t&&(i.Zb(0,"div",0),i.Rc(1," This layout is not yet implemented\n"),i.Yb())},encapsulation:2}),t})();const SE=i.bc(fE);function bE(t,e){if(1&t&&i.Vb(0,"img",8),2&t){const t=i.lc();i.sc("src",t.getImage(1),i.Gc)}}function RE(t,e){if(1&t&&(i.Zb(0,"div",17),i.Vb(1,"i",18),i.Zb(2,"span"),i.Rc(3),i.Yb(),i.Yb()),2&t){const t=i.lc().$implicit,e=i.lc();i.Gb(3),i.Sc(e.getOfferText(t.productCode))}}function IE(t,e){if(1&t&&(i.Zb(0,"b"),i.Rc(1),i.Vb(2,"img",19),i.Yb()),2&t){const t=i.lc().$implicit,e=i.lc();i.Gb(1),i.Tc("",t.priceCredits," "),i.Gb(1),i.sc("src",e.getCurrencyUrl(-1),i.Gc)}}function vE(t,e){if(1&t&&(i.Zb(0,"b"),i.Rc(1),i.Vb(2,"img",19),i.Yb()),2&t){const t=i.lc().$implicit,e=i.lc();i.Gb(1),i.Tc(" + ",t.priceActivityPoints," "),i.Gb(1),i.sc("src",e.getCurrencyUrl(t.priceActivityPointsType),i.Gc)}}function TE(t,e){if(1&t){const t=i.ac();i.Zb(0,"button",20),i.jc("click",(function(){i.Ec(t);const e=i.lc().$implicit;return i.lc().buyVip(e)})),i.Rc(1),i.mc(2,"translate"),i.Yb()}2&t&&(i.Gb(1),i.Sc(i.nc(2,1,"catalog.purchase_confirmation.gift")))}function OE(t,e){if(1&t){const t=i.ac();i.Xb(0),i.Zb(1,"div",9),i.Pc(2,RE,4,1,"div",10),i.Zb(3,"div",11),i.Zb(4,"div",12),i.Pc(5,IE,3,2,"b",13),i.Pc(6,vE,3,2,"b",13),i.Yb(),i.Zb(7,"div",14),i.Pc(8,TE,3,3,"button",15),i.Zb(9,"button",16),i.jc("click",(function(){i.Ec(t);const s=e.$implicit;return i.lc().buyVip(s)})),i.Rc(10),i.mc(11,"translate"),i.Yb(),i.Yb(),i.Yb(),i.Yb(),i.Wb()}if(2&t){const t=e.$implicit;i.Gb(2),i.sc("ngIf",t.productCode),i.Gb(3),i.sc("ngIf",t.priceCredits),i.Gb(1),i.sc("ngIf",t.priceActivityPoints),i.Gb(2),i.sc("ngIf",t.giftable),i.Gb(2),i.Sc(i.nc(11,5,"buy"))}}let AE=(()=>{class t extends Dp{constructor(t,e){super(t,e),this._catalogService=t,this._ngZone=e,this.vipOffers=[],t.registerVipBuyTemplate(this),t.requestOffers(6)}setOffers(t){this._ngZone.run(()=>{this.vipOffers=t.reverse()})}getPurseContent(){const t=this._catalogService.purse;return um.instance.localization.getValueWithParameter("catalog.vip.extend.info","days",(31*t.clubPeriods+t.clubDays).toString())}buyVip(t){this._catalogService.component&&this._catalogService.component.confirmVipSubscription(t)}getCurrencyUrl(t){return um.instance.getConfiguration("currency.asset.icon.url").replace("%type%",t.toString())}getOfferText(t){return um.instance.getLocalizationWithParameter("friendlytime.months.short","amount",t.replace(/[^\d.]/g,""))}}return t.CODE="vip_buy",t.\u0275fac=function(e){return new(e||t)(i.Ub(Ip),i.Ub(i.E))},t.\u0275cmp=i.Ob({type:t,selectors:[["ng-component"]],features:[i.Db],decls:11,vars:6,consts:[[1,"w-100","h-100","nitro-catalog-layout-default-component"],[1,"row"],[1,"col-5"],[3,"src",4,"ngIf"],[1,"col-7"],[1,"small",3,"innerHtml"],[1,"col-12","mt-1"],[4,"ngFor","ngForOf"],[3,"src"],[1,"bg-secondary","rounded","mb-2","p-1"],["class","bg-primary rounded p-1 w-100 mb-1 d-flex flex-row",4,"ngIf"],[1,"d-flex","flex-row","justify-content-between","px-2","py-1"],[1,"align-self-center"],[4,"ngIf"],[1,"d-flex","flex-row"],["type","button","class","btn btn-success btn-sm mr-1",3,"click",4,"ngIf"],["type","button",1,"btn","btn-success","btn-sm",3,"click"],[1,"bg-primary","rounded","p-1","w-100","mb-1","d-flex","flex-row"],[1,"icon","icon-catalogue-hc_small","mr-2","d-block","align-self-center"],[1,"pl-1",3,"src"],["type","button",1,"btn","btn-success","btn-sm","mr-1",3,"click"]],template:function(t,e){1&t&&(i.Zb(0,"div",0),i.Zb(1,"div",1),i.Zb(2,"div",2),i.Pc(3,bE,1,1,"img",3),i.Yb(),i.Zb(4,"div",4),i.Zb(5,"h6"),i.Rc(6),i.mc(7,"translate"),i.Yb(),i.Vb(8,"p",5),i.Yb(),i.Zb(9,"div",6),i.Pc(10,OE,12,7,"ng-container",7),i.Yb(),i.Yb(),i.Yb()),2&t&&(i.Gb(3),i.sc("ngIf",!e.activeOffer&&e.getImage(1)),i.Gb(3),i.Sc(i.nc(7,4,"catalog.vip.extend.title")),i.Gb(2),i.sc("innerHtml",e.getPurseContent(),i.Fc),i.Gb(2),i.sc("ngForOf",e.vipOffers))},directives:[o.m,o.l],pipes:[Ep],encapsulation:2}),t})();class yE{getLayoutForType(t){switch(t){case Kp.CODE:return Kp;case Wp.CODE:return Wp;case Jp.CODE:return Jp;case $p.CODE:return $p;case eE.CODE:return eE;case pE.CODE:return pE;case Gp.CODE:return Gp;case AE.CODE:return AE;default:return fE}}}let CE=(()=>{class t{}return t.DEFAULT=1,t.WALL_PAPER=2,t.FLOOR=3,t.LANDSCAPE=4,t.POST_IT=5,t.POSTER=6,t.SOUND_SET=7,t.TRAX_SONG=8,t.PRESENT=9,t.ECOTRON_BOX=10,t.TROPHY=11,t.CREDIT_FURNI=12,t.PET_SHAMPOO=13,t.PET_CUSTOM_PART=14,t.PET_CUSTOM_PART_SHAMPOO=15,t.PET_SADDLE=16,t.GUILD_FURNI=17,t.GAME_FURNI=18,t.MONSTERPLANT_SEED=19,t.MONSTERPLANT_REVIVAL=20,t.MONSTERPLANT_REBREED=21,t.MONSTERPLANT_FERTILIZE=22,t.FIGURE_PURCHASABLE_SET=23,t})(),ME=(()=>{class t{constructor(t){this._ngZone=t,this._isReady=!1,this._messages=[],this._currencies=new Map,this.registerMessages()}ngOnDestroy(){this.unregisterMessages()}registerMessages(){this._ngZone.runOutsideAngular(()=>{this.unregisterMessages(),this._messages=[new zo(this.onUserCreditsEvent.bind(this)),new Ko(this.onUserCurrencyEvent.bind(this)),new Jo(this.onUserCurrencyUpdateEvent.bind(this)),new $o(this.onUserSubscriptionEvent.bind(this))];for(const t of this._messages)um.instance.communication.registerMessageEvent(t)})}unregisterMessages(){this._ngZone.runOutsideAngular(()=>{if(this._messages&&this._messages.length){for(const t of this._messages)um.instance.communication.removeMessageEvent(t);this._messages=[]}})}requestUpdate(){um.instance.communication.connection.send(new j_)}onUserCreditsEvent(t){if(!t)return;const e=t.getParser();this._isReady=!0,this._ngZone.run(()=>this.setCurrency(-1,parseFloat(e.credits)))}onUserCurrencyEvent(t){if(!t)return;const e=t.getParser();this._ngZone.run(()=>{for(const[t,s]of e.currencies)this.setCurrency(t,s)})}onUserCurrencyUpdateEvent(t){if(!t)return;const e=t.getParser();this._ngZone.run(()=>this.setCurrency(e.type,e.amount))}onUserSubscriptionEvent(t){if(!t)return;const e=t.getParser();if(e)switch(e.name){case"habbo_club":return void(this._habboClubSubscription=e);default:console.log("unknown")}}setCurrency(t,e){this._currencies.set(t,e)}get currencies(){return this._currencies}get visibleCurrencies(){return um.instance.getConfiguration("system.currency.types",[])}get hcSub(){return this._habboClubSubscription}get isReady(){return this._isReady}}return t.\u0275fac=function(e){return new(e||t)(i.gc(i.E))},t.\u0275prov=i.Qb({token:t,factory:t.\u0275fac}),t})();const DE=["layoutsContainer"],NE=function(t){return{active:t}};function wE(t,e){if(1&t){const t=i.ac();i.Xb(0),i.Zb(1,"button",18),i.jc("click",(function(){i.Ec(t);const s=e.$implicit;return i.lc(3).selectTab(s)})),i.Rc(2),i.Yb(),i.Wb()}if(2&t){const t=e.$implicit,s=i.lc(3);i.Gb(1),i.sc("ngClass",i.vc(2,NE,s.activeTab===t)),i.Gb(1),i.Sc(t.localization)}}function UE(t,e){if(1&t&&(i.Zb(0,"div",14),i.Zb(1,"div",15),i.Zb(2,"div",16),i.Pc(3,wE,3,4,"ng-container",17),i.Yb(),i.Yb(),i.Yb()),2&t){const t=i.lc(2);i.Gb(3),i.sc("ngForOf",t.catalogRoot.children)}}function LE(t,e){1&t&&i.Vb(0,"div",19)}function PE(t,e){}function xE(t,e){if(1&t){const t=i.ac();i.Zb(0,"div",4),i.Zb(1,"div",5),i.Zb(2,"h6",6),i.Rc(3),i.mc(4,"translate"),i.Yb(),i.Zb(5,"button",7),i.jc("click",(function(){return i.Ec(t),i.lc().hide()})),i.Vb(6,"i",8),i.Yb(),i.Yb(),i.Pc(7,UE,4,1,"div",9),i.Zb(8,"div",10),i.Pc(9,LE,1,0,"div",11),i.Zb(10,"div",12),i.Pc(11,PE,0,0,"ng-template",null,13,i.Qc),i.Yb(),i.Yb(),i.Yb()}if(2&t){const t=i.lc();i.Gb(3),i.Sc(i.nc(4,3,"catalog.title")),i.Gb(4),i.sc("ngIf",t.catalogRoot&&t.catalogRoot.children.length>0),i.Gb(2),i.sc("ngIf",t.activeTab&&t.activeTab.children.length>0)}}function FE(t,e){if(1&t&&i.Vb(0,"nitro-catalog-confirm-purchase-component",20),2&t){const t=i.lc();i.sc("page",t.purchaseOfferPage)("offer",t.purchaseOffer)("quantity",t.purchaseOfferQuantity)("extra",t.purchaseOfferExtra)("completed",t.purchaseCompleted)}}function GE(t,e){if(1&t&&i.Vb(0,"nitro-catalog-confirm-vip-subscription-component",21),2&t){const t=i.lc();i.sc("subscription",t.purchaseVipSubscription)}}function VE(t,e){1&t&&i.Vb(0,"nitro-catalog-confirm-purchase-insufficient-funds")}let YE=(()=>{class t{constructor(t,e,s,i,r,n){this._settingsService=t,this._notificationService=e,this._catalogService=s,this._componentFactoryResolver=i,this._purseService=r,this._ngZone=n,this.visible=!1,this._roomPreviewer=null,this._lastComponent=null,this._layoutFactory=null,this._activeTab=null,this._activeOffer=null,this._purchaseOfferPage=null,this._purchaseOffer=null,this._purchaseVipSubscription=null,this._purchaseOfferQuantity=1,this._purchaseOfferExtra=null,this._purchaseCompleted=!1,this._showInsufficientFunds=!1}ngOnInit(){this._catalogService.component=this,this._layoutFactory=new yE,this._roomPreviewer||(this._roomPreviewer=new Xp(um.instance.roomEngine,++Xp.PREVIEW_COUNTER))}ngOnChanges(t){const e=t.visible.currentValue;e!==t.visible.previousValue&&(e?this.prepareCatalog():this.removeLastComponent())}ngOnDestroy(){this._roomPreviewer&&this._roomPreviewer.dispose(),this.reset(),this._catalogService.component=null,this._layoutFactory=null}reset(){this.removeLastComponent(),this._activeTab=null,this._activeOffer=null,this.hidePurchaseConfirmation()}hide(){this._settingsService.hideCatalog()}hidePurchaseConfirmation(){this._purchaseOfferPage=null,this._purchaseOffer=null,this._purchaseOfferQuantity=1,this._purchaseOfferExtra=null,this._purchaseVipSubscription=null}prepareCatalog(){this._catalogService.catalogRoot?setTimeout(()=>{this._activeTab?this._catalogService.activePage?this.setupLayout():this.selectFirstPage(this._activeTab):this.selectFirstTab()},0):this._catalogService.setupCatalog(Ip.MODE_NORMAL)}setupLayout(){const t=this._catalogService.activePage;if(!t)return;const e=this._layoutFactory.getLayoutForType(t.layoutCode);e?(this.createComponent(e),this._lastComponent&&(this._lastComponent.instance.activePage=t),this.selectOffer(null)):this.removeLastComponent()}createComponent(t){if(!t)return;this.removeLastComponent();const e=this._componentFactoryResolver.resolveComponentFactory(t);let s=null;e&&(s=this.layoutsContainer.createComponent(e)),this._lastComponent=s}removeLastComponent(){this.layoutsContainer&&this.layoutsContainer.remove(),this._lastComponent=null,this._activeOffer=null}selectTab(t){t&&(this._activeTab=t,this.selectFirstPage(t))}selectPage(t){t&&this._catalogService.requestPage(t)}selectFirstPage(t){t&&this.selectPage(0===t.children.length?t:t.children&&t.children[0])}selectFirstTab(){if(!this.catalogRoot)return;const t=this.catalogRoot.children&&this.catalogRoot.children[0];t&&this.selectTab(t)}selectOffer(t){if(this._activeOffer=t,this._activeOffer){const t=this._activeOffer.products[0];if(!t)return;if(!this._roomPreviewer)return;const e=this._catalogService.getFurnitureDataForProductOffer(t);if(!this._roomPreviewer)return;this._ngZone.runOutsideAngular(()=>{switch(t.productType){case Np.FLOOR:if(this._roomPreviewer.updateObjectRoom("default","default","default"),e.specialType===CE.FIGURE_PURCHASABLE_SET){const t=[],s=e.customParams.split(",");for(const e of s){const s=parseInt(e);um.instance.avatar.isValidFigureSetForGender(s,um.instance.sessionDataManager.gender)&&t.push(s)}const i=um.instance.avatar.getFigureStringWithFigureIds(um.instance.sessionDataManager.figure,um.instance.sessionDataManager.gender,t);this._roomPreviewer.addAvatarIntoRoom(i,0)}else this._roomPreviewer.addFurnitureIntoRoom(t.furniClassId,new ot(90));return;case Np.WALL:switch(e.className){case"floor":this._roomPreviewer.reset(!1),this._roomPreviewer.updateObjectRoom(t.extraParam);break;case"wallpaper":this._roomPreviewer.reset(!1),this._roomPreviewer.updateObjectRoom(null,t.extraParam);break;case"landscape":this._roomPreviewer.reset(!1),this._roomPreviewer.updateObjectRoom(null,null,t.extraParam);break;default:return this._roomPreviewer.updateObjectRoom("default","default","default"),void this._roomPreviewer.addWallItemIntoRoom(t.furniClassId,new ot(90),null)}return}})}else this._ngZone.runOutsideAngular(()=>this._roomPreviewer&&this._roomPreviewer.reset(!1))}hasSufficientFunds(t,e,s,i=1){if(!this._purseService)return!1;const r=this._purseService.currencies,n=r.get(-1),a=r.get(e);return!(n<t*i||a<s*i)}confirmPurchase(t,e,s=1,i=null){this.hasSufficientFunds(e.priceCredits,e.priceActivityPointsType,e.priceActivityPoints,s)?(this._purchaseOfferPage=t,this._purchaseOffer=e,this._purchaseOfferQuantity=s,this._purchaseOfferExtra=i):this.setInsufficientFunds(!0)}confirmVipSubscription(t){this.hasSufficientFunds(t.priceCredits,t.priceActivityPointsType,t.priceActivityPoints,1)?this._purchaseVipSubscription=t:this.setInsufficientFunds(!0)}get roomPreviewer(){return this._roomPreviewer}get catalogRoot(){return this._catalogService.catalogRoot}get activeTab(){return this._activeTab}get activeOffer(){return this._activeOffer}get activePage(){return this._catalogService.activePage}get activePageData(){return this._catalogService.activePageData}get purchaseOfferPage(){return this._purchaseOfferPage}get purchaseOffer(){return this._purchaseOffer}get purchaseOfferQuantity(){return this._purchaseOfferQuantity}get purchaseOfferExtra(){return this._purchaseOfferExtra}get purchaseCompleted(){return this._purchaseCompleted}get purchaseVipSubscription(){return this._purchaseVipSubscription}setInsufficientFunds(t){this._showInsufficientFunds=t}get showInsufficientFunds(){return this._showInsufficientFunds}}return t.\u0275fac=function(e){return new(e||t)(i.Ub(gm),i.Ub(Nm),i.Ub(Ip),i.Ub(i.l),i.Ub(ME),i.Ub(i.E))},t.\u0275cmp=i.Ob({type:t,selectors:[["nitro-catalog-main-component"]],viewQuery:function(t,e){if(1&t&&i.Wc(DE,!0,i.W),2&t){let t;i.Ac(t=i.kc())&&(e.layoutsContainer=t.first)}},inputs:{visible:"visible"},features:[i.Eb],decls:4,vars:4,consts:[["class","nitro-catalog card",3,"bringToTop","draggable",4,"ngIf"],[3,"page","offer","quantity","extra","completed",4,"ngIf"],[3,"subscription",4,"ngIf"],[4,"ngIf"],[1,"nitro-catalog","card",3,"bringToTop","draggable"],[1,"drag-handler","d-flex","justify-content-between","align-items-center","px-3","pt-3"],[1,"m-0"],["type","button",1,"close",3,"click"],[1,"fas","fa-times"],["class","row px-3 pt-3",4,"ngIf"],[1,"row","p-3"],["nitro-catalog-navigation-component","","class","col-4",4,"ngIf"],[1,"col"],["layoutsContainer",""],[1,"row","px-3","pt-3"],[1,"col-12","d-flex"],[1,"btn-group","w-100"],[4,"ngFor","ngForOf"],["type","button",1,"btn","btn-secondary","btn-sm",3,"ngClass","click"],["nitro-catalog-navigation-component","",1,"col-4"],[3,"page","offer","quantity","extra","completed"],[3,"subscription"]],template:function(t,e){1&t&&(i.Pc(0,xE,13,5,"div",0),i.Pc(1,FE,1,5,"nitro-catalog-confirm-purchase-component",1),i.Pc(2,GE,1,1,"nitro-catalog-confirm-vip-subscription-component",2),i.Pc(3,VE,1,0,"nitro-catalog-confirm-purchase-insufficient-funds",3)),2&t&&(i.sc("ngIf",e.visible),i.Gb(1),i.sc("ngIf",null!==e.purchaseOffer),i.Gb(1),i.sc("ngIf",null!==e.purchaseVipSubscription),i.Gb(1),i.sc("ngIf",e.showInsufficientFunds))},encapsulation:2}),t})();function kE(t,e){if(1&t&&i.Vb(0,"nitro-catalog-navigation-item-component",3),2&t){const t=i.lc().$implicit;i.sc("catalogPage",t)}}function jE(t,e){if(1&t&&(i.Xb(0),i.Pc(1,kE,1,1,"nitro-catalog-navigation-item-component",2),i.Wb()),2&t){const t=e.$implicit;i.Gb(1),i.sc("ngIf",t.visible)}}let BE=(()=>{class t{constructor(t){this._catalogService=t,this.catalogPage=null}}return t.\u0275fac=function(e){return new(e||t)(i.Ub(Ip))},t.\u0275cmp=i.Ob({type:t,selectors:[["nitro-catalog-navigation-set-component"]],inputs:{catalogPage:"catalogPage"},decls:2,vars:1,consts:[[1,"list-group","list-group-flush"],[4,"ngFor","ngForOf"],[3,"catalogPage",4,"ngIf"],[3,"catalogPage"]],template:function(t,e){1&t&&(i.Zb(0,"ul",0),i.Pc(1,jE,2,1,"ng-container",1),i.Yb()),2&t&&(i.Gb(1),i.sc("ngForOf",e.catalogPage.children))},encapsulation:2}),t})();const HE=function(t,e){return{"fa-sort-down":t,"fa-sort-up":e}};function WE(t,e){if(1&t&&i.Vb(0,"i",8),2&t){const t=i.lc();i.sc("ngClass",i.wc(1,HE,!t.isToggled,t.isToggled))}}function ZE(t,e){if(1&t&&i.Vb(0,"nitro-catalog-navigation-set-component",9),2&t){const t=i.lc();i.sc("catalogPage",t.catalogPage)}}const zE=function(t){return{active:t}};let XE=(()=>{class t{constructor(t){this._catalogService=t,this.catalogPage=null}selectPage(){this.isActive?this._catalogService.manuallyCollapsePage(this.catalogPage):this._catalogService.component&&this._catalogService.component.selectPage(this.catalogPage)}get activePage(){return this._catalogService.activePage}get activePageData(){return this._catalogService.activePageData}get isDescendant(){return this._catalogService.isDescendant(this.catalogPage,this.activePageData)}get isActive(){return this.catalogPage.pageId===(this.activePage&&this.activePage.pageId)||this.isDescendant}get isCollapsed(){return!!(this._catalogService.manuallyCollapsed.indexOf(this.catalogPage)>=0)}get isToggled(){return!this.isCollapsed&&!!this.isActive}get iconUrl(){return um.instance.getConfiguration("catalog.asset.icon.url").replace("%name%",(this.catalogPage.icon||0).toString())}}return t.\u0275fac=function(e){return new(e||t)(i.Ub(Ip))},t.\u0275cmp=i.Ob({type:t,selectors:[["nitro-catalog-navigation-item-component"]],inputs:{catalogPage:"catalogPage"},decls:9,vars:7,consts:[[1,"nav-item"],[1,"d-flex","list-group-item","align-items-center",3,"ngClass","click"],[1,"d-flex","flex-grow-1"],[1,"icon-container"],[1,"icon",3,"src"],[1,"flex-grow-1","mb-0"],["class","fas",3,"ngClass",4,"ngIf"],[3,"catalogPage",4,"ngIf"],[1,"fas",3,"ngClass"],[3,"catalogPage"]],template:function(t,e){1&t&&(i.Zb(0,"div",0),i.Zb(1,"li",1),i.jc("click",(function(){return e.selectPage()})),i.Zb(2,"div",2),i.Zb(3,"div",3),i.Vb(4,"img",4),i.Yb(),i.Zb(5,"p",5),i.Rc(6),i.Yb(),i.Yb(),i.Pc(7,WE,1,4,"i",6),i.Yb(),i.Pc(8,ZE,1,1,"nitro-catalog-navigation-set-component",7),i.Yb()),2&t&&(i.Gb(1),i.sc("ngClass",i.vc(5,zE,e.isActive)),i.Gb(3),i.sc("src",e.iconUrl,i.Gc),i.Gb(2),i.Sc(e.catalogPage.localization),i.Gb(1),i.sc("ngIf",e.catalogPage.children&&e.catalogPage.children.length),i.Gb(1),i.sc("ngIf",e.isToggled&&e.catalogPage.children&&e.catalogPage.children.length>0))},directives:[o.k,o.m,BE],encapsulation:2}),t})();const KE=["nitro-catalog-navigation-component",""];function qE(t,e){if(1&t&&i.Vb(0,"nitro-catalog-navigation-set-component",3),2&t){const t=i.lc();i.sc("catalogPage",t.catalogPage)}}let JE=(()=>{class t{constructor(t){this._catalogService=t}get catalogPage(){return this._catalogService.component&&this._catalogService.component.activeTab||null}}return t.\u0275fac=function(e){return new(e||t)(i.Ub(Ip))},t.\u0275cmp=i.Ob({type:t,selectors:[["","nitro-catalog-navigation-component",""]],attrs:KE,decls:3,vars:1,consts:[[1,"nitro-catalog-navigation-component","bg-secondary","rounded","overflow-hidden"],[2,"min-height","450px","max-height","450px","height","450px"],[3,"catalogPage",4,"ngIf"],[3,"catalogPage"]],template:function(t,e){1&t&&(i.Zb(0,"div",0),i.Zb(1,"perfect-scrollbar",1),i.Pc(2,qE,1,1,"nitro-catalog-navigation-set-component",2),i.Yb(),i.Yb()),2&t&&(i.Gb(2),i.sc("ngIf",e.catalogPage))},directives:[u.b,o.m,BE],encapsulation:2}),t})();const QE=["nitro-catalog-purchase-component",""];function $E(t,e){if(1&t){const t=i.ac();i.Zb(0,"div",11),i.Zb(1,"p",12),i.Rc(2),i.mc(3,"translate"),i.Yb(),i.Zb(4,"div",13),i.Zb(5,"div",14),i.Zb(6,"button",15),i.jc("click",(function(){return i.Ec(t),i.lc().decrease()})),i.Vb(7,"i",16),i.Yb(),i.Yb(),i.Zb(8,"input",17),i.jc("ngModelChange",(function(e){return i.Ec(t),i.lc().quantity=e})),i.Yb(),i.Zb(9,"div",18),i.Zb(10,"button",15),i.jc("click",(function(){return i.Ec(t),i.lc().increase()})),i.Vb(11,"i",19),i.Yb(),i.Yb(),i.Yb(),i.Yb()}if(2&t){const t=i.lc();i.Gb(2),i.Sc(i.nc(3,3,"catalog.bundlewidget.quantity")),i.Gb(6),i.sc("ngModel",t.quantity)("max",t.maxQuantity)}}function tf(t,e){if(1&t&&(i.Zb(0,"p",20),i.Vb(1,"i",21),i.Rc(2),i.Yb()),2&t){const t=i.lc();i.Gb(2),i.Tc(" ",t.costCredits,"")}}function ef(t,e){1&t&&(i.Zb(0,"p",22),i.Rc(1,"+"),i.Yb())}function sf(t,e){if(1&t&&(i.Zb(0,"p",20),i.Vb(1,"i"),i.Rc(2),i.Yb()),2&t){const t=i.lc();i.Gb(1),i.Jb("icon icon-currency-",t.pointsType," mr-1"),i.Gb(1),i.Sc(t.costPoints)}}const rf=function(t,e,s){return{"flex-column ml-2":t,"justify-content-center":e,"justify-content-between":s}};let nf=(()=>{class t{constructor(t){this._catalogService=t,this.activePage=null,this.activeOffer=null,this.quantityEnabled=!1,this.vertical=!1,this.quantity=1}ngOnChanges(t){const e=t.activeOffer.currentValue;e&&e!==t.activeOffer.previousValue&&this.resetOffer()}resetOffer(){this.quantity=1}purchase(){this._catalogService.component&&this._catalogService.component.confirmPurchase(this.activePage,this.activeOffer,this.quantity,this.extra)}increase(){this.quantity>=this.maxQuantity||this.quantity++}decrease(){this.quantity--,this.quantity<1&&(this.quantity=1)}get costCredits(){return this.activeOffer.priceCredits*this.quantity}get costPoints(){return this.activeOffer.priceActivityPoints*this.quantity}get pointsType(){return this.activeOffer.priceActivityPointsType}get extra(){return this.activeOffer.products[0]&&this.activeOffer.products[0].extraParam}get maxQuantity(){return 99}}return t.\u0275fac=function(e){return new(e||t)(i.Ub(Ip))},t.\u0275cmp=i.Ob({type:t,selectors:[["","nitro-catalog-purchase-component",""]],inputs:{activePage:"activePage",activeOffer:"activeOffer",quantityEnabled:"quantityEnabled",vertical:"vertical"},features:[i.Eb],attrs:QE,decls:18,vars:18,consts:[[1,"d-flex","w-100",3,"ngClass"],["class","d-flex flex-column justify-content-center mr-3 quantity-area",4,"ngIf"],[1,"d-flex","flex-column"],[1,"d-flex","flex-column","justify-content-center","align-items-end","price-area"],[1,"mb-0"],[1,"d-flex","mb-1"],["class","d-flex align-items-center mb-0",4,"ngIf"],["class","mx-2 mb-0",4,"ngIf"],[1,"btn-group"],["type","button",1,"btn","btn-success","btn-sm",3,"click"],["type","button",1,"btn","btn-secondary","btn-sm"],[1,"d-flex","flex-column","justify-content-center","mr-3","quantity-area"],[1,"mb-1"],[1,"d-flex","input-group"],[1,"input-group-prepend"],["type","button",1,"btn","btn-primary","btn-sm",3,"click"],[1,"fas","fa-arrow-left"],["type","number","min","1",1,"form-control","form-control-sm",3,"ngModel","max","ngModelChange"],[1,"input-group-append"],[1,"fas","fa-arrow-right"],[1,"d-flex","align-items-center","mb-0"],[1,"icon","icon-currency--1","mr-1"],[1,"mx-2","mb-0"]],template:function(t,e){1&t&&(i.Zb(0,"div",0),i.Pc(1,$E,12,5,"div",1),i.Zb(2,"div",2),i.Zb(3,"div",3),i.Zb(4,"p",4),i.Rc(5),i.mc(6,"translate"),i.Yb(),i.Zb(7,"div",5),i.Pc(8,tf,3,1,"p",6),i.Pc(9,ef,2,0,"p",7),i.Pc(10,sf,3,4,"p",6),i.Yb(),i.Yb(),i.Zb(11,"div",8),i.Zb(12,"button",9),i.jc("click",(function(){return e.purchase()})),i.Rc(13),i.mc(14,"translate"),i.Yb(),i.Zb(15,"button",10),i.Rc(16),i.mc(17,"translate"),i.Yb(),i.Yb(),i.Yb(),i.Yb()),2&t&&(i.sc("ngClass",i.xc(14,rf,e.vertical,!e.vertical&&!e.quantityEnabled,!e.vertical&&e.quantityEnabled)),i.Gb(1),i.sc("ngIf",e.quantityEnabled),i.Gb(4),i.Sc(i.nc(6,8,"catalog.bundlewidget.price")),i.Gb(3),i.sc("ngIf",e.costCredits),i.Gb(1),i.sc("ngIf",e.costCredits&&e.costPoints),i.Gb(1),i.sc("ngIf",e.costPoints),i.Gb(3),i.Sc(i.nc(14,10,"buy")),i.Gb(3),i.Sc(i.nc(17,12,"catalog.purchase_confirmation.gift")))},directives:[o.k,o.m,c.n,c.b,c.j,c.l],pipes:[Ep],encapsulation:2}),t})(),af=(()=>{class t{constructor(t){this._catalogService=t,this.localization=null,this.voucherCode=""}ngOnInit(){}redeem(){this._catalogService.redeemVoucher(this.voucherCode),this.voucherCode=""}}return t.\u0275fac=function(e){return new(e||t)(i.Ub(Ip))},t.\u0275cmp=i.Ob({type:t,selectors:[["redeem-voucher-component"]],inputs:{localization:"localization"},decls:7,vars:5,consts:[[1,"d-flex","flex-column","justify-content-center"],[1,"input-group"],["type","text",1,"form-control","form-control-sm",3,"ngModel","placeholder","ngModelChange"],[1,"input-group-append"],["type","button",1,"btn","btn-primary","btn-sm",3,"click"]],template:function(t,e){1&t&&(i.Zb(0,"div",0),i.Zb(1,"div",1),i.Zb(2,"input",2),i.jc("ngModelChange",(function(t){return e.voucherCode=t})),i.Yb(),i.Zb(3,"div",3),i.Zb(4,"button",4),i.jc("click",(function(){return e.redeem()})),i.Rc(5),i.mc(6,"translate"),i.Yb(),i.Yb(),i.Yb(),i.Yb()),2&t&&(i.Gb(2),i.tc("placeholder",e.localization.texts[1]),i.sc("ngModel",e.voucherCode),i.Gb(3),i.Sc(i.nc(6,3,"redeem")))},directives:[c.b,c.j,c.l],pipes:[Ep],encapsulation:2}),t})();function of(t,e){if(1&t&&(i.Zb(0,"p",13),i.Rc(1),i.Vb(2,"img",14),i.Yb()),2&t){const t=i.lc();i.Gb(1),i.Tc("",t.subscription.priceCredits," "),i.Gb(1),i.sc("src",t.getCurrencyUrl(-1),i.Gc)}}function cf(t,e){if(1&t&&(i.Zb(0,"p",13),i.Rc(1),i.Vb(2,"img",15),i.Yb()),2&t){const t=i.lc();i.Gb(1),i.Tc(" + ",t.subscription.priceActivityPoints," "),i.Gb(1),i.sc("src",t.getCurrencyUrl(t.subscription.priceActivityPointsType),i.Gc)}}let _f=(()=>{class t{constructor(t,e){this._catalogService=t,this._ngZone=e,this.subscription=null}getSubscriptionText(){let t=um.instance.localization.getValue("catalog.vip.buy.confirm.end_date");return t=t.replace("%month%",this.subscription.month.toString()),t=t.replace("%day%",this.subscription.day.toString()),t=t.replace("%year%",this.subscription.year.toString()),t}getSubscriptionHeader(){const t=this._catalogService.purse,e=0==this.subscription.months?"days":"months",s=um.instance.localization.getValue("catalog.vip.buy.confirm."+(t.clubDays>0||t.clubPeriods>0?"extension.":"subscription.")+e),i=0==this.subscription.months?this.subscription.extraDays:this.subscription.months;return s.replace("%NUM_"+e.toUpperCase()+"%",i.toString())}getCurrencyUrl(t){return um.instance.getConfiguration("currency.asset.icon.url").replace("%type%",t.toString())}hide(){this._catalogService.component&&this._catalogService.component.hidePurchaseConfirmation()}purchase(){this._catalogService.purchaseById(this._catalogService.activePage.pageId,this.subscription.offerId,1)}}return t.\u0275fac=function(e){return new(e||t)(i.Ub(Ip),i.Ub(i.E))},t.\u0275cmp=i.Ob({type:t,selectors:[["nitro-catalog-confirm-vip-subscription-component"]],inputs:{subscription:"subscription"},decls:24,vars:13,consts:[["dragHandle",".card-header",1,"card","nitro-catalog-confirm-vip-subscription-component",3,"bringToTop","draggable"],[1,"card-header"],["type","button",1,"close",3,"click"],[1,"fas","fa-times"],[1,"d-flex","card-body","flex-row"],[1,"icon","icon-catalogue-hc_big"],[1,"ml-3"],[1,"d-flex","align-items-center","justify-content-center","bg-secondary","rounded","p-1"],["class","mb-0",4,"ngIf"],[1,"card-footer"],[1,"d-flex","justify-space-between","button-container","btn-group"],["type","button",1,"btn","btn-primary",3,"click"],["type","button",1,"btn","btn-success",3,"click"],[1,"mb-0"],[1,"px-1",3,"src"],[1,"pl-1",3,"src"]],template:function(t,e){1&t&&(i.Zb(0,"div",0),i.Zb(1,"div",1),i.Rc(2),i.mc(3,"translate"),i.Zb(4,"button",2),i.jc("click",(function(){return e.hide()})),i.Vb(5,"i",3),i.Yb(),i.Yb(),i.Zb(6,"div",4),i.Vb(7,"i",5),i.Zb(8,"div",6),i.Zb(9,"h6"),i.Rc(10),i.Yb(),i.Zb(11,"p"),i.Rc(12),i.Yb(),i.Zb(13,"div",7),i.Pc(14,of,3,2,"p",8),i.Pc(15,cf,3,2,"p",8),i.Yb(),i.Yb(),i.Yb(),i.Zb(16,"div",9),i.Zb(17,"div",10),i.Zb(18,"button",11),i.jc("click",(function(){return e.hide()})),i.Rc(19),i.mc(20,"translate"),i.Yb(),i.Zb(21,"button",12),i.jc("click",(function(){return e.purchase()})),i.Rc(22),i.mc(23,"translate"),i.Yb(),i.Yb(),i.Yb(),i.Yb()),2&t&&(i.Gb(2),i.Tc(" ",i.nc(3,7,"catalog.club.buy.confirm")," "),i.Gb(8),i.Sc(e.getSubscriptionHeader()),i.Gb(2),i.Sc(e.getSubscriptionText()),i.Gb(2),i.sc("ngIf",e.subscription.priceCredits),i.Gb(1),i.sc("ngIf",e.subscription.priceActivityPoints),i.Gb(4),i.Sc(i.nc(20,9,"catalog.purchase_confirmation.cancel")),i.Gb(3),i.Sc(i.nc(23,11,"catalog.club.buy.subscribe")))},directives:[op,dp,o.m],pipes:[Ep],encapsulation:2}),t})(),hf=(()=>{class t{constructor(t,e){this._catalogService=t,this._ngZone=e}hide(){this._catalogService.component&&this._catalogService.component.setInsufficientFunds(!1)}}return t.\u0275fac=function(e){return new(e||t)(i.Ub(Ip),i.Ub(i.E))},t.\u0275cmp=i.Ob({type:t,selectors:[["nitro-catalog-confirm-purchase-insufficient-funds"]],decls:16,vars:9,consts:[["dragHandle",".card-header",1,"card","nitro-catalog-confirm-purchase-component",3,"bringToTop","draggable"],[1,"card-header"],["type","button",1,"close",3,"click"],[1,"fas","fa-times"],[1,"d-flex","card-body"],[1,"d-flex","flex-grow-1","flex-column","justify-content-center","p-2"],[1,"card-footer"],[1,"d-flex","justify-space-between","button-container","btn-group"],["type","button",1,"btn","btn-primary",3,"click"]],template:function(t,e){1&t&&(i.Zb(0,"div",0),i.Zb(1,"div",1),i.Rc(2),i.mc(3,"translate"),i.Zb(4,"button",2),i.jc("click",(function(){return e.hide()})),i.Vb(5,"i",3),i.Yb(),i.Yb(),i.Zb(6,"div",4),i.Zb(7,"div",5),i.Zb(8,"p"),i.Rc(9),i.mc(10,"translate"),i.Yb(),i.Yb(),i.Yb(),i.Zb(11,"div",6),i.Zb(12,"div",7),i.Zb(13,"button",8),i.jc("click",(function(){return e.hide()})),i.Rc(14),i.mc(15,"translate"),i.Yb(),i.Yb(),i.Yb(),i.Yb()),2&t&&(i.Gb(2),i.Tc(" ",i.nc(3,3,"catalog.alert.notenough.title")," "),i.Gb(7),i.Sc(i.nc(10,5,"catalog.alert.notenough.credits.description")),i.Gb(5),i.Sc(i.nc(15,7,"catalog.purchase_confirmation.cancel")))},directives:[op,dp],pipes:[Ep],encapsulation:2}),t})(),lf=(()=>{class t{}return t.\u0275mod=i.Sb({type:t}),t.\u0275inj=i.Rb({factory:function(e){return new(e||t)},providers:[Ip],imports:[[p]]}),t})();i.Hc(Gp,[o.m,nE,nf,u.b,o.l,o.k,o.n],[]),i.Hc(Wp,[o.m,o.n,af],[]),i.Hc(YE,[o.m,op,dp,o.l,o.k,JE,Mp,_f,hf],[Ep]),i.Hc(BE,[o.l,o.m,XE],[]);class uf extends E{constructor(t){super(t,W_)}getParser(){return this.parser}}let df=(()=>{class t{constructor(t,e,s=0,i=null,r=0){this._type=r,this._senderId=t,this._message=e,this._secondsSinceSent=s,this._extraData=i,this._date=new Date}get type(){return this._type}get senderId(){return this._senderId}get message(){return this._message}get secondsSinceSent(){return this._secondsSinceSent}get extraData(){return this._extraData}get date(){return this._date}}return t.CHAT=0,t.ROOM_INVITE=1,t.STATUS_NOTIFICATION=2,t})();class gf{constructor(){this._id=-1,this._name=null,this._gender=0,this._online=!1,this._followingAllowed=!1,this._figure=null,this._categoryId=0,this._motto=null,this._realName=null,this._lastAccess=null,this._persistedMessageUser=!1,this._vipMember=!1,this._pocketHabboUser=!1,this._relationshipStatus=-1,this._unread=0}populate(t){return!!t&&(this._id=t.id,this._name=t.name,this._gender=t.gender,this._online=t.online,this._followingAllowed=t.followingAllowed,this._figure=t.figure,this._categoryId=t.categoryId,this._motto=t.motto,this._realName=t.realName,this._lastAccess=t.lastAccess,this._persistedMessageUser=t.persistedMessageUser,this._vipMember=t.vipMember,this._pocketHabboUser=t.pocketHabboUser,this._relationshipStatus=t.relationshipStatus,!0)}get id(){return this._id}set id(t){this._id=t}get name(){return this._name}set name(t){this._name=t}get gender(){return this._gender}set gender(t){this._gender=t}get online(){return this._online}set online(t){this._online=t}get followingAllowed(){return this._followingAllowed}set followingAllowed(t){this._followingAllowed=t}get figure(){return this._figure}set figure(t){this._figure=t}get categoryId(){return this._categoryId}set categoryId(t){this._categoryId=t}get motto(){return this._motto}set motto(t){this._motto=t}get lastAccess(){return this._lastAccess}set lastAccess(t){this._lastAccess=t}get realName(){return this._realName}set realName(t){this._realName=t}get persistedMessageUser(){return this._persistedMessageUser}set persistedMessageUser(t){this._persistedMessageUser=t}get vipMember(){return this._vipMember}set vipMember(t){this._vipMember=t}get pocketHabboUser(){return this._pocketHabboUser}set pocketHabboUser(t){this._pocketHabboUser=t}get relationshipStatus(){return this._relationshipStatus}set relationshipStatus(t){this._relationshipStatus=t}get unread(){return this._unread}set unread(t){this._unread=t}}class mf{populate(t){return!!t&&(this._requestId=t.requestId,this._requesterName=t.requesterName,this._figureString=t.figureString,this._requesterUserId=t.requesterUserId,!0)}get requestId(){return this._requestId}get requesterName(){return this._requesterName}get requesterUserId(){return this._requesterUserId}get figureString(){return this._figureString}}let pf=(()=>{class t{constructor(t){this._participant=t,this._chats=[],this._lastUpdated=new Date,this._unread=!1,this._emitter=new i.q}insertChat(e,s,i=0,r=null,n=0){const a=new df(e,s,i,r,n);return this._chats.push(a),this._lastUpdated=new Date,this._unread=!0,this._emitter.emit(t.MESSAGE_RECEIVED),a}setRead(){this._unread=!1}get participant(){return this._participant}get chats(){return this._chats}get lastUpdated(){return this._lastUpdated}get unread(){return this._unread}get emitter(){return this._emitter}}return t.MESSAGE_RECEIVED="MT_MESSAGE_RECEIVED",t})(),Ef=(()=>{class t{constructor(t,e,s){this._notificationService=t,this._soundService=e,this._ngZone=s,this._friendListReady=!1,this._component=null,this._friends=new Map,this._requests=new Map,this._threads=new Map,this._userFriendLimit=0,this._normalFriendLimit=0,this._extendedFriendLimit=0,this.registerMessages()}ngOnDestroy(){this.unregisterMessages()}registerMessages(){this._ngZone.runOutsideAngular(()=>{this._messages&&this.unregisterMessages(),this._messages=[new bs(this.onAcceptFriendResultEvent.bind(this)),new Is(this.onFindFriendsProcessResultEvent.bind(this)),new Ts(this.onFollowFriendFailedEvent.bind(this)),new ys(this.onFriendListFragmentEvent.bind(this)),new Ds(this.onFriendListUpdateEvent.bind(this)),new ws(this.onFriendNotificationEvent.bind(this)),new Ps(this.onFriendRequestsEvent.bind(this)),new Gs(this.onHabboSearchResultEvent.bind(this)),new Ys(this.onInstantMessageErrorEvent.bind(this)),new js(this.onMessageErrorEvent.bind(this)),new Hs(this.onMessengerInitEvent.bind(this)),new Zs(this.onMiniMailNewMessageEvent.bind(this)),new uf(this.onMiniMailUnreadCountEvent.bind(this)),new Xs(this.onNewConsoleMessageEvent.bind(this)),new qs(this.onNewFriendRequestEvent.bind(this)),new Qs(this.onRoomInviteErrorEvent.bind(this)),new ti(this.onRoomInviteEvent.bind(this))];for(const t of this._messages)um.instance.communication.registerMessageEvent(t)})}unregisterMessages(){this._ngZone.runOutsideAngular(()=>{if(this._messages&&this._messages.length)for(const t of this._messages)um.instance.communication.removeMessageEvent(t);this._messages=null})}onAcceptFriendResultEvent(t){if(!t)return;const e=t.getParser();e&&console.log(e)}onFindFriendsProcessResultEvent(t){if(!t)return;const e=t.getParser();e&&console.log(e)}onFollowFriendFailedEvent(t){if(!t)return;const e=t.getParser();e&&console.log(e)}onFriendListFragmentEvent(t){if(!t)return;const e=t.getParser();e&&this._ngZone.run(()=>{for(const t of e.fragment)this.updateFriend(t);e.fragmentNumber+1===e.totalFragments&&(this._friendListReady=!0)})}onFriendListUpdateEvent(t){if(!t)return;const e=t.getParser();e&&this._ngZone.run(()=>{for(const t of e.addedFriends)this.updateFriend(t);for(const t of e.updatedFriends)this.updateFriend(t);for(const t of e.removedFriendIds)this.removeFriend(t)})}onFriendNotificationEvent(t){if(!t)return;const e=t.getParser();e&&console.log(e)}onFriendRequestsEvent(t){if(!t)return;const e=t.getParser();e&&this._ngZone.run(()=>{for(const t of e.requests)this.updateFriendRequest(t)})}onHabboSearchResultEvent(t){if(!t)return;const e=t.getParser();e&&console.log(e)}onInstantMessageErrorEvent(t){if(!t)return;const e=t.getParser();e&&console.log(e)}onMessageErrorEvent(t){if(!t)return;const e=t.getParser();if(!e)return;let s="";switch(e.errorCode){case 1:s="${friendlist.error.friendlistownlimit}";break;case 2:s="${friendlist.error.friendlistlimitofrequester}";break;case 3:s="${friendlist.error.friend_requests_disabled}";break;case 4:s="${friendlist.error.requestnotfound}";break;default:s=`Received messenger error: msg: ${e.clientMessageId}, errorCode: ${e.errorCode}`}this._ngZone.run(()=>this._notificationService.alert(s,"${friendlist.alert.title}"))}onMessengerInitEvent(t){if(!t)return;const e=t.getParser();e&&(this._ngZone.run(()=>{this._userFriendLimit=e.userFriendLimit,this._normalFriendLimit=e.normalFriendLimit,this._extendedFriendLimit=e.extendedFriendLimit}),this.requestFriendRequests())}onMiniMailNewMessageEvent(t){t&&t.getParser()}onMiniMailUnreadCountEvent(t){t&&t.getParser()}onNewConsoleMessageEvent(t){if(!t)return;const e=t.getParser();if(!e)return;const s=this.getMessageThread(e.senderId);s&&(this._ngZone.run(()=>{s.insertChat(e.senderId,e.messageText,e.secondsSinceSent,e.extraData),this._component&&this._component.currentThread===s&&s.setRead()}),this._soundService.playMessengerSound())}onNewFriendRequestEvent(t){if(!t)return;const e=t.getParser();e&&this._ngZone.run(()=>this.updateFriendRequest(e.request))}onRoomInviteErrorEvent(t){if(!t)return;const e=t.getParser();e&&console.log(e)}onRoomInviteEvent(t){if(!t)return;const e=t.getParser();if(!e)return;const s=this.getMessageThread(e.senderId);s&&this._ngZone.run(()=>{s.insertChat(e.senderId,e.messageText,0,null,df.ROOM_INVITE),this._component&&this._component.currentThread===s&&s.setRead()})}getFriend(t){return this._friends.get(t)||null}updateFriend(t){if(!t)return;let e=this._friends.get(t.id);e||(e=new gf,this._friends.set(t.id,e)),e.populate(t)}removeFriend(t){this._friends.delete(t),um.instance.communication.connection.send(new gc(t))}updateFriendRequest(t){if(!t)return;let e=this._requests.get(t.requestId);e||(e=new mf,this._requests.set(t.requestId,e)),e.populate(t)}acceptFriendRequest(t){this._requests.delete(t.requestId),um.instance.communication.connection.send(new ac(t.requestId))}removeFriendRequest(t){this._requests.delete(t.requestId),um.instance.communication.connection.send(new oc(!1,t.requestId))}removeAllFriendRequests(){this._requests.clear(),um.instance.communication.connection.send(new oc(!0))}getMessageThread(t){let e=this._threads.get(t);if(!e){const s=this.getFriend(t);if(!s)return;e=new pf(s),this._threads.set(t,e)}return e}requestFriendRequests(){um.instance.communication.connection.send(new lc)}canBeAskedForAFriend(t){return!this._friends.get(t)}sendFriendRequest(t,e){this._friends.get(t)||um.instance.communication.connection.send(new mc(e))}get component(){return this._component}set component(t){this._component=t}get friends(){return this._friends}get requests(){return this._requests}get threads(){return this._threads}get unreadCount(){let t=0;for(const e of this._threads.values())e&&e.unread&&t++;return t}get notificationCount(){return this.requests.size+this.unreadCount}}return t.\u0275fac=function(e){return new(e||t)(i.gc(Nm),i.gc(g),i.gc(i.E))},t.\u0275prov=i.Qb({token:t,factory:t.\u0275fac}),t})();const ff=["nitro-friendlist-friends-list-component",""];function Sf(t,e){if(1&t){const t=i.ac();i.Zb(0,"div",1),i.Zb(1,"button",2),i.jc("click",(function(){i.Ec(t);const s=e.$implicit;return i.lc().selectThread(s)})),i.Rc(2),i.Yb(),i.Zb(3,"button",3),i.jc("click",(function(){i.Ec(t);const s=e.$implicit;return i.lc().removeFriend(s)})),i.Vb(4,"i",4),i.Yb(),i.Yb()}if(2&t){const t=e.$implicit;i.Gb(2),i.Sc(t.name)}}let bf=(()=>{class t{constructor(t,e){this._friendListService=t,this._ngZone=e,this.threadSelector=null,this.onlineOnly=!1}selectThread(t){if(!t)return;const e=this._friendListService.getMessageThread(t.id);e&&this.threadSelector&&this.threadSelector(e)}removeFriend(t){t&&(um.instance.communication.connection.send(new gc(t.id)),this._friendListService.friends.delete(t.id))}get friends(){const t=Array.from(this._friendListService.friends.values());return this.onlineOnly?t.filter(t=>t.online):t}}return t.\u0275fac=function(e){return new(e||t)(i.Ub(Ef),i.Ub(i.E))},t.\u0275cmp=i.Ob({type:t,selectors:[["","nitro-friendlist-friends-list-component",""]],inputs:{threadSelector:"threadSelector",onlineOnly:"onlineOnly"},attrs:ff,decls:1,vars:1,consts:[["class","btn-group w-100 mb-1",4,"ngFor","ngForOf"],[1,"btn-group","w-100","mb-1"],["type","button",1,"btn","btn-secondary","w-100",3,"click"],["type","button",1,"btn","btn-danger",3,"click"],[1,"fas","fa-times"]],template:function(t,e){1&t&&i.Pc(0,Sf,5,1,"div",0),2&t&&i.sc("ngForOf",e.friends)},directives:[o.l],encapsulation:2}),t})();const Rf=["nitro-friendlist-requests-list-component",""];function If(t,e){if(1&t){const t=i.ac();i.Xb(0),i.Zb(1,"div",3),i.Zb(2,"button",4),i.Rc(3),i.Yb(),i.Zb(4,"button",5),i.jc("click",(function(){i.Ec(t);const s=e.$implicit;return i.lc(2).acceptRequest(s.value)})),i.Vb(5,"i",6),i.Yb(),i.Zb(6,"button",7),i.jc("click",(function(){i.Ec(t);const s=e.$implicit;return i.lc(2).declineRequest(s.value)})),i.Vb(7,"i",8),i.Yb(),i.Yb(),i.Wb()}if(2&t){const t=e.$implicit;i.Gb(3),i.Sc(t.value.requesterName)}}function vf(t,e){if(1&t){const t=i.ac();i.Xb(0),i.Zb(1,"button",1),i.jc("click",(function(){return i.Ec(t),i.lc().declineAllRequests()})),i.Rc(2),i.mc(3,"translate"),i.Yb(),i.Pc(4,If,8,1,"ng-container",2),i.mc(5,"keyvalue"),i.Wb()}if(2&t){const t=i.lc();i.Gb(2),i.Sc(i.nc(3,2,"friendbar.requests.discard")),i.Gb(2),i.sc("ngForOf",i.nc(5,4,t.requests))}}let Tf=(()=>{class t{constructor(t){this._friendListService=t}acceptRequest(t){t&&this._friendListService.acceptFriendRequest(t)}declineRequest(t){t&&this._friendListService.removeFriendRequest(t)}declineAllRequests(){this._friendListService.removeAllFriendRequests()}get requests(){return this._friendListService.requests}}return t.\u0275fac=function(e){return new(e||t)(i.Ub(Ef))},t.\u0275cmp=i.Ob({type:t,selectors:[["","nitro-friendlist-requests-list-component",""]],attrs:Rf,decls:1,vars:1,consts:[[4,"ngIf"],["type","button",1,"btn","btn-danger","mb-1","w-100",3,"click"],[4,"ngFor","ngForOf"],[1,"btn-group","w-100","mb-1"],["type","button",1,"btn","btn-primary","w-100"],["type","button",1,"btn","btn-success",3,"click"],[1,"fas","fa-check"],["type","button",1,"btn","btn-danger",3,"click"],[1,"fas","fa-times"]],template:function(t,e){1&t&&i.Pc(0,vf,6,6,"ng-container",0),2&t&&i.sc("ngIf",e.requests.size>0)},directives:[o.m,o.l],pipes:[Ep,o.g],encapsulation:2}),t})();const Of=["nitro-friendlist-friends-viewer-component",""];function Af(t,e){if(1&t&&(i.Zb(0,"span",8),i.Rc(1),i.Yb()),2&t){const t=i.lc();i.Gb(1),i.Sc(t.totalFriendRequests)}}function yf(t,e){if(1&t&&i.Vb(0,"div",9),2&t){const t=i.lc();i.sc("threadSelector",t.threadSelector)("onlineOnly",t.onlineOnly)}}function Cf(t,e){1&t&&i.Vb(0,"div",10)}const Mf=function(t){return{active:t}};let Df=(()=>{class t{constructor(t,e){this._friendListService=t,this._ngZone=e,this.threadSelector=null,this._requestsShowing=!1,this._friendsShowing=!0,this._onlineOnly=!0}showOnlineFriends(){this.showFriends(),this._onlineOnly=!0}showFriends(){this._requestsShowing=!1,this._friendsShowing=!0,this._onlineOnly=!1}showRequests(){this._requestsShowing=!0,this._friendsShowing=!1,this._onlineOnly=!1}get requestsShowing(){return this._requestsShowing}get friendsShowing(){return this._friendsShowing}get onlineOnly(){return this._onlineOnly}get totalFriendRequests(){return this._friendListService.requests.size}}return t.\u0275fac=function(e){return new(e||t)(i.Ub(Ef),i.Ub(i.E))},t.\u0275cmp=i.Ob({type:t,selectors:[["","nitro-friendlist-friends-viewer-component",""]],inputs:{threadSelector:"threadSelector"},attrs:Of,decls:18,vars:24,consts:[[1,"btn-group","w-100","mb-1"],["type","button",1,"btn","btn-secondary",3,"ngClass","click"],["class","badge badge-danger ml-1","style","font-size:12px;",4,"ngIf"],["type","button",1,"btn","btn-success"],[1,"d-flex","w-100"],[1,"position-relative","w-100",2,"min-height","350px","max-height","350px","height","350px"],["nitro-friendlist-friends-list-component","","class","w-100",3,"threadSelector","onlineOnly",4,"ngIf"],["nitro-friendlist-requests-list-component","","class","w-100",4,"ngIf"],[1,"badge","badge-danger","ml-1",2,"font-size","12px"],["nitro-friendlist-friends-list-component","",1,"w-100",3,"threadSelector","onlineOnly"],["nitro-friendlist-requests-list-component","",1,"w-100"]],template:function(t,e){1&t&&(i.Zb(0,"div",0),i.Zb(1,"button",1),i.jc("click",(function(){return e.showOnlineFriends()})),i.Rc(2),i.mc(3,"translate"),i.Yb(),i.Zb(4,"button",1),i.jc("click",(function(){return e.showFriends()})),i.Rc(5),i.mc(6,"translate"),i.Yb(),i.Zb(7,"button",1),i.jc("click",(function(){return e.showRequests()})),i.Rc(8),i.mc(9,"translate"),i.Pc(10,Af,2,1,"span",2),i.Yb(),i.Zb(11,"button",3),i.Rc(12),i.mc(13,"translate"),i.Yb(),i.Yb(),i.Zb(14,"div",4),i.Zb(15,"perfect-scrollbar",5),i.Pc(16,yf,1,2,"div",6),i.Pc(17,Cf,1,0,"div",7),i.Yb(),i.Yb()),2&t&&(i.Gb(1),i.sc("ngClass",i.vc(18,Mf,e.friendsShowing&&e.onlineOnly)),i.Gb(1),i.Sc(i.nc(3,10,"friendlist.online")),i.Gb(2),i.sc("ngClass",i.vc(20,Mf,e.friendsShowing&&!e.onlineOnly)),i.Gb(1),i.Sc(i.nc(6,12,"friendlist.friends.all")),i.Gb(2),i.sc("ngClass",i.vc(22,Mf,e.requestsShowing)),i.Gb(1),i.Sc(i.nc(9,14,"friendbar.requests.title")),i.Gb(2),i.sc("ngIf",e.totalFriendRequests>0),i.Gb(2),i.Sc(i.nc(13,16,"generic.search")),i.Gb(4),i.sc("ngIf",e.friendsShowing),i.Gb(1),i.sc("ngIf",e.requestsShowing))},directives:[o.k,o.m,u.b,bf,Tf],pipes:[Ep],encapsulation:2}),t})();function Nf(t,e){if(1&t&&(i.Zb(0,"span",17),i.Rc(1),i.Yb()),2&t){const t=i.lc(2);i.Gb(1),i.Sc(t.totalFriendRequests)}}function wf(t,e){if(1&t&&i.Vb(0,"div",18),2&t){const t=i.lc(2);i.sc("threadSelector",t.selectThread)}}function Uf(t,e){if(1&t&&i.Vb(0,"div",19),2&t){const t=i.lc(2);i.sc("thread",t.currentThread)}}const Lf=function(t){return{active:t}};function Pf(t,e){if(1&t){const t=i.ac();i.Zb(0,"div",1),i.Zb(1,"div",2),i.Zb(2,"h6",3),i.Rc(3),i.mc(4,"translate"),i.Yb(),i.Zb(5,"button",4),i.jc("click",(function(){return i.Ec(t),i.lc().hide()})),i.Vb(6,"i",5),i.Yb(),i.Yb(),i.Zb(7,"div",6),i.Zb(8,"div",7),i.Zb(9,"button",8),i.jc("click",(function(){return i.Ec(t),i.lc().displayFriends()})),i.Rc(10),i.mc(11,"translate"),i.Pc(12,Nf,2,1,"span",9),i.Yb(),i.Zb(13,"h6",10),i.Zb(14,"span",11),i.Rc(15),i.mc(16,"translate"),i.Yb(),i.Yb(),i.Zb(17,"perfect-scrollbar",12),i.Vb(18,"div",13),i.Yb(),i.Yb(),i.Zb(19,"div",14),i.Pc(20,wf,1,1,"div",15),i.Pc(21,Uf,1,1,"div",16),i.Yb(),i.Yb(),i.Yb()}if(2&t){const t=i.lc();i.Gb(3),i.Sc(i.nc(4,9,"messenger.title")),i.Gb(6),i.sc("ngClass",i.vc(15,Lf,t.friendsVisible)),i.Gb(1),i.Tc(" ",i.nc(11,11,"friendlist.friends"),""),i.Gb(2),i.sc("ngIf",t.totalFriendRequests>0),i.Gb(3),i.Sc(i.nc(16,13,"toolbar.icon.label.messenger")),i.Gb(3),i.sc("currentThread",t.currentThread)("threadSelector",t.selectThread),i.Gb(2),i.sc("ngIf",t.friendsVisible),i.Gb(1),i.sc("ngIf",t.currentThread)}}let xf=(()=>{class t{constructor(t,e,s){this._settingsService=t,this._friendListService=e,this._ngZone=s,this.visible=!1,this._friendsVisible=!0,this._currentThread=null,this.selectThread=this.selectThread.bind(this)}ngOnInit(){this._friendListService.component=this,um.instance.communication.connection.send(new dc)}ngOnChanges(t){const e=t.visible.currentValue;e||e===t.visible.previousValue||this.selectThread(null)}ngOnDestroy(){this._friendListService.component=null}hide(){this._settingsService.hideFriendList()}displayFriends(){this._friendsVisible=!0,this._currentThread=null}selectThread(t){if(t)return this._friendsVisible=!1,this._currentThread=t,void t.setRead();this._friendsVisible=!0,this._currentThread=null}get currentThread(){return this._currentThread}get friendsVisible(){return this._friendsVisible&&!this._currentThread}get totalFriendRequests(){return this._friendListService.requests.size}}return t.\u0275fac=function(e){return new(e||t)(i.Ub(gm),i.Ub(Ef),i.Ub(i.E))},t.\u0275cmp=i.Ob({type:t,selectors:[["nitro-friendlist-main-component"]],inputs:{visible:"visible"},features:[i.Eb],decls:1,vars:1,consts:[["class","nitro-friendlist card",3,"bringToTop","draggable",4,"ngIf"],[1,"nitro-friendlist","card",3,"bringToTop","draggable"],[1,"drag-handler","d-flex","justify-content-between","align-items-center","px-3","pt-3"],[1,"m-0"],["type","button",1,"close",3,"click"],[1,"fas","fa-times"],[1,"row","p-3"],[1,"col-4","d-flex","flex-column"],[1,"btn","btn-secondary","w-100","mb-1",3,"ngClass","click"],["class","badge badge-danger ml-1","style","font-size:12px;",4,"ngIf"],[1,"mt-2","mb-1"],[1,"badge","text-uppercase"],[1,"position-relative","w-100",2,"min-height","320px","max-height","320px","height","320px"],["nitro-friendlist-thread-list-component","",3,"currentThread","threadSelector"],[1,"col","d-flex","flex-column"],["nitro-friendlist-friends-viewer-component","",3,"threadSelector",4,"ngIf"],["nitro-friendlist-thread-viewer-component","",3,"thread",4,"ngIf"],[1,"badge","badge-danger","ml-1",2,"font-size","12px"],["nitro-friendlist-friends-viewer-component","",3,"threadSelector"],["nitro-friendlist-thread-viewer-component","",3,"thread"]],template:function(t,e){1&t&&i.Pc(0,Pf,22,17,"div",0),2&t&&i.sc("ngIf",e.visible)},encapsulation:2}),t})();const Ff=["nitro-friendlist-thread-list-component",""],Gf=function(t){return{active:t}};function Vf(t,e){if(1&t){const t=i.ac();i.Zb(0,"button",1),i.jc("click",(function(){i.Ec(t);const s=e.$implicit;return i.lc().selectThread(s)})),i.Rc(1),i.Yb()}if(2&t){const t=e.$implicit,s=i.lc();i.sc("ngClass",i.vc(2,Gf,s.currentThread===t)),i.Gb(1),i.Sc(t.participant.name)}}let Yf=(()=>{class t{constructor(t,e){this._friendListService=t,this._ngZone=e,this.currentThread=null,this.threadSelector=null}selectThread(t){t&&this.threadSelector&&this.threadSelector(t)}get threads(){const t=Array.from(this._friendListService.threads.values());return t.sort((t,e)=>e.lastUpdated-t.lastUpdated),t}}return t.THREAD_SELECTED="FLTLC_THREAD_SELECTED",t.\u0275fac=function(e){return new(e||t)(i.Ub(Ef),i.Ub(i.E))},t.\u0275cmp=i.Ob({type:t,selectors:[["","nitro-friendlist-thread-list-component",""]],inputs:{currentThread:"currentThread",threadSelector:"threadSelector"},attrs:Ff,decls:1,vars:1,consts:[["type","button","class","btn btn-secondary w-100 mb-1",3,"ngClass","click",4,"ngFor","ngForOf"],["type","button",1,"btn","btn-secondary","w-100","mb-1",3,"ngClass","click"]],template:function(t,e){1&t&&i.Pc(0,Vf,2,4,"button",0),2&t&&i.sc("ngForOf",e.threads)},directives:[o.l,o.k],encapsulation:2}),t})();var kf=s("3E0/");let jf=(()=>{class t{}return t.NONE=0,t.HEART=1,t.SMILE=2,t.BOBBA=3,t.RELATIONSHIP_TYPES=[0,1,2,3],t.RELATIONSHIP_NAMES=["None","Heart","Smile","Bobba"],t})();const Bf=["threadScroller"],Hf=["nitro-friendlist-thread-viewer-component",""];function Wf(t,e){if(1&t){const t=i.ac();i.Zb(0,"div",19),i.jc("click",(function(){return i.Ec(t),i.lc().followParticipant()})),i.Vb(1,"i",20),i.Yb()}}function Zf(t,e){if(1&t){const t=i.ac();i.Zb(0,"button",21),i.jc("click",(function(){i.Ec(t);const s=e.index;return i.lc().changeRelation(s)})),i.Rc(1),i.Yb()}if(2&t){const t=e.$implicit;i.Gb(1),i.Sc(t)}}const zf=function(t){return[t]};function Xf(t,e){if(1&t&&(i.Zb(0,"div",22),i.Zb(1,"div",23),i.Rc(2),i.Yb(),i.Yb()),2&t){const t=e.$implicit,s=i.lc();i.sc("ngClass",i.vc(2,zf,t.senderId===s.participant.id?"thread-viewer-list-left":"thread-viewer-list-right")),i.Gb(2),i.Sc(t.message)}}let Kf=(()=>{class t{constructor(t,e,s){this._friendListService=t,this._settingsService=e,this._ngZone=s,this.thread=null,this._subscription=null}ngOnChanges(t){const e=t.thread.previousValue,s=t.thread.currentValue;s&&s!==e?this.prepareThread():s||s===e||this.unsubscribe()}ngOnDestroy(){this.unsubscribe()}unsubscribe(){this._subscription&&(this._subscription.unsubscribe(),this._subscription=null)}prepareThread(){this.unsubscribe(),this._subscription=this.thread.emitter.asObservable().pipe(Object(kf.a)(1)).subscribe(t=>{switch(t){case pf.MESSAGE_RECEIVED:return void this.messageReceived()}})}messageReceived(){this.threadScroller&&this.threadScroller.directiveRef.scrollToBottom(0,200)}sendMessage(t){t&&t.length&&(this._ngZone.run(()=>{this.thread.insertChat(um.instance.sessionDataManager.userId,t,0,null),this.thread.setRead()}),um.instance.communication.connection.send(new pc(this.participant.id,t)))}changeRelation(t){this.participant&&-1!==jf.RELATIONSHIP_TYPES.indexOf(t)&&um.instance.communication.connection.send(new fc(this.participant.id,t))}followParticipant(){this.participant&&(this._settingsService.toggleFriendList(),um.instance.communication.connection.send(new _c(this.participant.id)))}onKeyDownEvent(t){if(!t)return;const e=t.target;if(e)switch(t.key){case"Enter":return this.sendMessage(e.value),void(e.value="")}}get participant(){return this.thread.participant}get chats(){return this.thread.chats}get relations(){return jf.RELATIONSHIP_NAMES}}return t.\u0275fac=function(e){return new(e||t)(i.Ub(Ef),i.Ub(gm),i.Ub(i.E))},t.\u0275cmp=i.Ob({type:t,selectors:[["","nitro-friendlist-thread-viewer-component",""]],viewQuery:function(t,e){if(1&t&&i.Wc(Bf,!0),2&t){let t;i.Ac(t=i.kc())&&(e.threadScroller=t.first)}},inputs:{thread:"thread"},features:[i.Eb],attrs:Hf,decls:23,vars:12,consts:[[1,"nitro-friendlist-thread-viewer-component"],[1,"d-flex","flex-row","thread-viewer-user","mb-1","justify-content-between"],[1,"d-flex","flex-row"],["nitro-avatar-image","",1,"avatar-img",3,"headOnly","figure","direction"],[1,"thread-viewer-user-info"],[1,"ml-2","p-1","rounded-circle","align-self-center",3,"ngClass"],[1,"d-block","text-muted","small","text-truncate"],["ngbDropdown","",1,"input-group-prepend","align-self-center"],[1,"btn-group"],["class","btn btn-sm btn-dgreen align-self-center",3,"click",4,"ngIf"],["type","button","ngbDropdownToggle","",1,"btn","btn-primary","btn-sm"],["ngbDropdownMenu","",1,"dropdown-menu"],["class","dropdown-item small","ngbDropdownItem","",3,"click",4,"ngFor","ngForOf"],[1,"position-relative","w-100","my-1",2,"min-height","299px","max-height","299px","height","299px"],["threadScroller",""],[1,"thread-viewer-list"],["class","thread-viewer-list-item mb-1",3,"ngClass",4,"ngFor","ngForOf"],[1,"thread-viewer-input"],["type","text","maxLength","420",1,"thread-viewer-input","form-control",3,"keydown.enter"],[1,"btn","btn-sm","btn-dgreen","align-self-center",3,"click"],[1,"fas","fa-arrow-right"],["ngbDropdownItem","",1,"dropdown-item","small",3,"click"],[1,"thread-viewer-list-item","mb-1",3,"ngClass"],[1,"thread-viewer-list-item-message","p-2"]],template:function(t,e){1&t&&(i.Zb(0,"div",0),i.Zb(1,"div",1),i.Zb(2,"div",2),i.Vb(3,"div",3),i.Zb(4,"div",4),i.Zb(5,"b",2),i.Rc(6),i.Vb(7,"div",5),i.Yb(),i.Zb(8,"span",6),i.Rc(9),i.Yb(),i.Yb(),i.Yb(),i.Zb(10,"div",7),i.Zb(11,"div",8),i.Pc(12,Wf,2,0,"div",9),i.Zb(13,"button",10),i.Rc(14),i.Yb(),i.Zb(15,"div",11),i.Pc(16,Zf,2,1,"button",12),i.Yb(),i.Yb(),i.Yb(),i.Yb(),i.Zb(17,"perfect-scrollbar",13,14),i.Zb(19,"div",15),i.Pc(20,Xf,3,4,"div",16),i.Yb(),i.Yb(),i.Zb(21,"div",17),i.Zb(22,"input",18),i.jc("keydown.enter",(function(t){return e.onKeyDownEvent(t)})),i.Yb(),i.Yb(),i.Yb()),2&t&&(i.Gb(3),i.sc("headOnly",1)("figure",e.thread.participant.figure)("direction",2),i.Gb(3),i.Sc(e.participant.name),i.Gb(1),i.sc("ngClass",i.vc(10,zf,e.participant.online?"bg-success":"bg-danger")),i.Gb(2),i.Sc(e.participant.motto),i.Gb(3),i.sc("ngIf",e.participant.online),i.Gb(2),i.Sc(e.relations[e.thread.participant.relationshipStatus]),i.Gb(2),i.sc("ngForOf",e.relations),i.Gb(4),i.sc("ngForOf",e.chats))},directives:[pp,o.k,_.b,o.m,_.f,_.d,o.l,u.b,_.c],encapsulation:2}),t})(),qf=(()=>{class t{}return t.\u0275mod=i.Sb({type:t}),t.\u0275inj=i.Rb({factory:function(e){return new(e||t)},providers:[Ef],imports:[[p]]}),t})();i.Hc(xf,[o.m,op,dp,o.k,u.b,Yf,Df,Kf],[Ep]);let Jf=(()=>{class t{openPage(t){}closePage(t){t&&this._component&&this._component.close(t)}closeAll(){this._component&&this._component.closeAll()}get component(){return this._component}set component(t){this._component=t}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275prov=i.Qb({token:t,factory:t.\u0275fac}),t})(),Qf=(()=>{class t{}return t.\u0275mod=i.Sb({type:t}),t.\u0275inj=i.Rb({factory:function(e){return new(e||t)},providers:[Jf],imports:[[]]}),t})(),$f=(()=>{class t{}return t.\u0275mod=i.Sb({type:t}),t.\u0275inj=i.Rb({factory:function(e){return new(e||t)},imports:[[p]]}),t})(),tS=(()=>{class t{}return t.DEFAULT=1,t._Str_3639=2,t._Str_3683=3,t._Str_3432=4,t._Str_12351=5,t._Str_5186=6,t._Str_21911=7,t._Str_9125=8,t._Str_5922=9,t._Str_18231=10,t._Str_4255=11,t._Str_19933=12,t._Str_7696=13,t._Str_7297=14,t._Str_7954=15,t._Str_6096=16,t._Str_12454=17,t._Str_19144=18,t.MONSTERPLANT_SEED=19,t._Str_6915=20,t._Str_8726=21,t._Str_9449=22,t._Str_12534=23,t})();const eS=["nitro-inventory-furniture-component",""];function sS(t,e){1&t&&(i.Zb(0,"div",4),i.Rc(1),i.mc(2,"translate"),i.mc(3,"translate"),i.Yb()),2&t&&(i.Gb(1),i.Uc(" ",i.nc(2,2,"inventory.empty.title")," ",i.nc(3,4,"inventory.empty.desc")," "))}function iS(t,e){if(1&t&&(i.Zb(0,"div",17),i.Rc(1),i.Yb()),2&t){const t=i.lc().$implicit;i.Gb(1),i.Sc(t.getUnlockedCount())}}function rS(t,e){if(1&t&&(i.Zb(0,"div",18),i.Rc(1),i.Yb()),2&t){const t=i.lc().$implicit;i.Gb(1),i.Sc(t.stuffData.uniqueNumber)}}const nS=function(t,e){return{unseen:t,active:e}},aS=function(t){return{opacity:t}},oS=function(t){return{active:t}},cS=function(t){return{"background-image":t}};function _S(t,e){if(1&t){const t=i.ac();i.Zb(0,"div",13),i.jc("mousedown",(function(){i.Ec(t);const s=e.$implicit;return i.lc(3).onMouseDown(s)}))("mouseout",(function(){i.Ec(t);const s=e.$implicit;return i.lc(3).onMouseOut(s)})),i.Zb(1,"button",14),i.Pc(2,iS,2,1,"div",15),i.Pc(3,rS,2,1,"div",16),i.Yb(),i.Yb()}if(2&t){const t=e.$implicit,s=i.lc(3);i.sc("ngClass",i.wc(6,nS,t.hasUnseenItems,t===s.selectedGroup))("ngStyle",i.vc(9,aS,t.getUnlockedCount()?"1":"0.5")),i.Gb(1),i.sc("ngClass",i.vc(11,oS,s.selectedGroup===t))("ngStyle",i.vc(13,cS,"url("+s.getIconUrl(t)+")")),i.Gb(1),i.sc("ngIf",!t.stuffData.uniqueNumber),i.Gb(1),i.sc("ngIf",t.stuffData.uniqueNumber)}}function hS(t,e){if(1&t){const t=i.ac();i.Zb(0,"div",26),i.jc("click",(function(){i.Ec(t);const e=i.lc().$implicit;return i.lc(),i.Bc(1).setCurrent(e.value)})),i.Rc(1),i.Yb()}if(2&t){const t=i.lc().$implicit;i.Gb(1),i.Tc(" ",t.label,"")}}function lS(t,e){if(1&t&&(i.Zb(0,"div",27),i.Rc(1),i.Yb()),2&t){const t=i.lc().$implicit;i.Gb(1),i.Sc(t.label)}}function uS(t,e){if(1&t&&(i.Zb(0,"li",23),i.Pc(1,hS,2,1,"div",24),i.Pc(2,lS,2,1,"div",25),i.Yb()),2&t){const t=e.$implicit;i.lc();const s=i.Bc(1);i.Mb("active",s.getCurrent()===t.value),i.Gb(1),i.sc("ngIf",s.getCurrent()!==t.value),i.Gb(1),i.sc("ngIf",s.getCurrent()===t.value)}}function dS(t,e){if(1&t){const t=i.ac();i.Zb(0,"pagination-template",19,20),i.jc("pageChange",(function(e){return i.Ec(t),i.lc(3).paginateConfig.currentPage=e})),i.Zb(2,"ul",21),i.Pc(3,uS,3,4,"li",22),i.Yb(),i.Yb()}if(2&t){const t=i.Bc(1),e=i.lc(3);i.sc("id",e.paginateConfig.id)("maxSize",11),i.Gb(3),i.sc("ngForOf",t.pages)}}function gS(t,e){if(1&t){const t=i.ac();i.Zb(0,"button",33),i.jc("click",(function(){return i.Ec(t),i.lc(4).attemptItemPlacement()})),i.Rc(1),i.mc(2,"translate"),i.Yb()}2&t&&(i.Gb(1),i.Sc(i.nc(2,1,"inventory.furni.placetoroom")))}const mS=function(t){return{disabled:t}};function pS(t,e){if(1&t){const t=i.ac();i.Zb(0,"button",34),i.jc("click",(function(){return i.Ec(t),i.lc(4).attemptItemOffer()})),i.Rc(1),i.mc(2,"translate"),i.Yb()}if(2&t){const t=i.lc(4);i.sc("ngClass",i.vc(4,mS,!t.selectedGroup.getUnlockedCount())),i.Gb(1),i.Sc(i.nc(2,2,"inventory.trading.offer"))}}function ES(t,e){if(1&t&&(i.Zb(0,"div",28),i.Zb(1,"div",29),i.Rc(2),i.Yb(),i.Zb(3,"div",30),i.Pc(4,gS,3,3,"button",31),i.Pc(5,pS,3,6,"button",32),i.Yb(),i.Yb()),2&t){const t=i.lc(3);i.Gb(2),i.Sc(t.selectedGroup.name),i.Gb(2),i.sc("ngIf",!t.tradeRunning&&t.canPlace),i.Gb(1),i.sc("ngIf",t.tradeRunning)}}function fS(t,e){if(1&t&&(i.Xb(0),i.Zb(1,"div",5),i.Zb(2,"perfect-scrollbar",6),i.Zb(3,"div",7),i.Pc(4,_S,4,15,"div",8),i.mc(5,"paginate"),i.Yb(),i.Yb(),i.Pc(6,dS,4,3,"pagination-template",9),i.Yb(),i.Zb(7,"div",10),i.Vb(8,"div",11),i.Pc(9,ES,6,3,"div",12),i.Yb(),i.Wb()),2&t){const t=i.lc(2);i.Gb(4),i.sc("ngForOf",i.oc(5,5,t.groupItems,t.paginateConfig)),i.Gb(2),i.sc("ngIf",t.groupItems.length>t.paginateConfig.itemsPerPage),i.Gb(2),i.sc("roomPreviewer",t.roomPreviewer)("height",140),i.Gb(1),i.sc("ngIf",t.selectedGroup)}}function SS(t,e){if(1&t){const t=i.ac();i.Zb(0,"div",1),i.jc("mouseup",(function(){return i.Ec(t),i.lc().onMouseUp()})),i.Pc(1,sS,4,6,"div",2),i.Pc(2,fS,10,8,"ng-container",3),i.Yb()}if(2&t){const t=i.lc();i.Gb(1),i.sc("ngIf",!t.groupItems.length),i.Gb(1),i.sc("ngIf",t.groupItems.length)}}let bS=(()=>{class t{constructor(t,e,s){this._notificationService=t,this._inventoryService=e,this._ngZone=s,this.visible=!1,this.roomPreviewer=null,this.selectedGroup=null,this.mouseDown=!1,this.paginateConfig={id:"custom",itemsPerPage:25,currentPage:1}}ngOnInit(){this._inventoryService.controller.furnitureService.isInitalized&&this.selectExistingGroupOrDefault(),this._inventoryService.furniController=this}ngOnChanges(t){const e=t.visible.currentValue;e!==(t.visible.previousValue||!1)&&(e?this.prepareInventory():this._inventoryService.controller.setAllFurnitureSeen())}ngOnDestroy(){this._inventoryService.furniController=null}prepareInventory(){!this._inventoryService.controller.furnitureService.isInitalized||this._inventoryService.controller.furnitureService.needsUpdate?this._inventoryService.controller.furnitureService.requestLoad():this.selectExistingGroupOrDefault()}selectExistingGroupOrDefault(){this.selectedGroup&&this.groupItems.indexOf(this.selectedGroup)>-1?this.selectGroup(this.selectedGroup):this.selectFirstGroup()}selectFirstGroup(){let t=null;for(const e of this.groupItems)if(e&&!e.locked){t=e;break}this.selectGroup(t)}selectGroup(t){if(this._inventoryService.controller.furnitureService.unselectAllGroupItems(),this.selectedGroup=t,this.selectedGroup){this.selectedGroup.selected=!0,this.selectedGroup.hasUnseenItems&&(this.selectedGroup.hasUnseenItems=!1);const e=this.selectedGroup.getItemByIndex(0);if(!e)return;this._ngZone.runOutsideAngular(()=>{if(this.roomPreviewer){let s=um.instance.roomEngine.getRoomInstanceVariable(um.instance.roomEngine.activeRoomId,st.ROOM_WALL_TYPE),i=um.instance.roomEngine.getRoomInstanceVariable(um.instance.roomEngine.activeRoomId,st.ROOM_FLOOR_TYPE),r=um.instance.roomEngine.getRoomInstanceVariable(um.instance.roomEngine.activeRoomId,st.ROOM_LANDSCAPE_TYPE);s=s&&s.length?s:"101",i=i&&i.length?i:"101",r=r&&r.length?r:"1.1",this.roomPreviewer.reset(!1),this.roomPreviewer.updateObjectRoom(i,s,r),e.category===tS._Str_3639||e.category===tS._Str_3683||e.category===tS._Str_3432?(this.roomPreviewer.updateRoomWallsAndFloorVisibility(!0,!0),i=e.category===tS._Str_3683?this.selectedGroup.stuffData.getLegacyString():i,s=e.category===tS._Str_3639?this.selectedGroup.stuffData.getLegacyString():s,r=e.category===tS._Str_3432?this.selectedGroup.stuffData.getLegacyString():r,this.roomPreviewer.updateObjectRoom(i,s,r)):t.isWallItem?(this.roomPreviewer.updateRoomWallsAndFloorVisibility(!0,!0),this.roomPreviewer.addWallItemIntoRoom(this.selectedGroup.type,new ot(90),e.stuffData.getLegacyString())):(this.roomPreviewer.updateRoomWallsAndFloorVisibility(!1,!0),this.roomPreviewer.addFurnitureIntoRoom(this.selectedGroup.type,new ot(90),this.selectedGroup.stuffData,this.selectedGroup.extra.toString()))}})}else this._ngZone.runOutsideAngular(()=>this.roomPreviewer&&this.roomPreviewer.reset(!1))}onMouseDown(t){t&&(this.selectGroup(t),this.mouseDown=!0)}onMouseUp(t){this.mouseDown=!1}onMouseOut(t){this.mouseDown&&this.selectedGroup===t&&this.attemptItemPlacement()}attemptItemPlacement(){this.canPlace&&!this.tradeRunning&&(this._ngZone.runOutsideAngular(()=>this._inventoryService.controller.furnitureService.attemptItemPlacement()),this._inventoryService.hideWindow())}attemptItemOffer(t=1){if(!this.selectedGroup||!this.tradeRunning)return;const e=this.selectedGroup;if(!e)return;const s=e.getTradeItems(t);if(!s||!s.length)return;let i=null;const r=[];for(const n of s)r.push(n.id),i||(i=n);i&&this.tradeRunning&&(this._inventoryService.controller.tradeService.getOwnTradingItemIds().length+r.length<=1500?this._inventoryService.controller.tradeService.offerItems(r,i.isWallItem,i.type,i.category,i.isGroupable,i.stuffData):this._notificationService.alert("${trading.items.too_many_items.desc}","${trading.items.too_many_items.title}"))}getIconUrl(t){return t&&t.iconUrl||null}get groupItems(){return this._inventoryService.controller.furnitureService.groupItems}get tradeRunning(){return this._inventoryService.controller.tradeService.running}get canPlace(){return!!this._inventoryService.roomSession}}return t.\u0275fac=function(e){return new(e||t)(i.Ub(Nm),i.Ub(Dm),i.Ub(i.E))},t.\u0275cmp=i.Ob({type:t,selectors:[["","nitro-inventory-furniture-component",""]],inputs:{visible:"visible",roomPreviewer:"roomPreviewer"},features:[i.Eb],attrs:eS,decls:1,vars:1,consts:[["class","row nitro-inventory-furni-component",3,"mouseup",4,"ngIf"],[1,"row","nitro-inventory-furni-component",3,"mouseup"],["class","col-12",4,"ngIf"],[4,"ngIf"],[1,"col-12"],[1,"col-7","d-flex","flex-column",2,"z-index","1"],[1,"grid-container","w-100",2,"min-height","209px","max-height","209px","height","209px"],[1,"grid-items","grid-5"],["class","d-flex flex-column item-detail justify-content-center align-items-center",3,"ngClass","ngStyle","mousedown","mouseout",4,"ngFor","ngForOf"],[3,"id","maxSize","pageChange",4,"ngIf"],[1,"col-5","d-flex","flex-column"],["nitro-room-preview-component","",1,"room-preview",3,"roomPreviewer","height"],["class","d-flex flex-column flex-grow-1 justify-content-between","style","z-index: 1;",4,"ngIf"],[1,"d-flex","flex-column","item-detail","justify-content-center","align-items-center",3,"ngClass","ngStyle","mousedown","mouseout"],["type","button",1,"position-relative","btn","btn-secondary","align-items-end","detail-info","has-image",3,"ngClass","ngStyle"],["class","position-absolute btn btn-sm btn-primary px-1 py-0 rounded count",4,"ngIf"],["class","badge badge-primary w-100",4,"ngIf"],[1,"position-absolute","btn","btn-sm","btn-primary","px-1","py-0","rounded","count"],[1,"badge","badge-primary","w-100"],[3,"id","maxSize","pageChange"],["p","paginationApi"],[1,"pagination","pagination-sm","custom-pagination"],["class","page-item",3,"active",4,"ngFor","ngForOf"],[1,"page-item"],["class","page-link",3,"click",4,"ngIf"],["class","page-link",4,"ngIf"],[1,"page-link",3,"click"],[1,"page-link"],[1,"d-flex","flex-column","flex-grow-1","justify-content-between",2,"z-index","1"],[1,"d-flex","justify-content-center","align-items-center","w-100","h-100"],[1,"btn-group-vertical","w-100"],["type","button","class","btn btn-secondary w-100",3,"click",4,"ngIf"],["type","button","class","btn btn-secondary w-100",3,"ngClass","click",4,"ngIf"],["type","button",1,"btn","btn-secondary","w-100",3,"click"],["type","button",1,"btn","btn-secondary","w-100",3,"ngClass","click"]],template:function(t,e){1&t&&i.Pc(0,SS,3,2,"div",0),2&t&&i.sc("ngIf",e.visible)},directives:[o.m,u.b,o.l,nE,o.k,o.n,l.c],pipes:[Ep,l.b],encapsulation:2}),t})();class RS{constructor(t){this._locked=!1,this._id=t.itemId,this._type=t.spriteId,this._ref=t.ref,this._category=t.category,this._groupable=t.isGroupable&&!t.rentable,this._tradeable=t.tradable,this._recyclable=t.isRecycleable,this._sellable=t.sellable,this._stuffData=t.stuffData,this._extra=t._Str_2794,this._secondsToExpiration=t.secondsToExpiration,this._expirationTimeStamp=t._Str_10616,this._hasRentPeriodStarted=t.hasRentPeriodStarted,this._creationDay=t._Str_8932,this._creationMonth=t._Str_9050,this._creationYear=t._Str_9408,this._slotId=t.slotId,this._songId=t._Str_3951,this._flatId=t.flatId,this._isRented=t.rentable,this._isWallItem=t.isWallItem}get rentable(){return this._isRented}get id(){return this._id}get ref(){return this._ref}get category(){return this._category}get type(){return this._type}get stuffData(){return this._stuffData}set stuffData(t){this._stuffData=t}get _Str_2794(){return this._extra}get _Str_16260(){return this._recyclable}get isTradable(){return this._tradeable}get isGroupable(){return this._groupable}get sellable(){return this._sellable}get secondsToExpiration(){if(-1===this._secondsToExpiration)return-1;let t=-1;return this._hasRentPeriodStarted?(t=this._secondsToExpiration-(um.instance.time-this._expirationTimeStamp)/1e3,t<0&&(t=0)):t=this._secondsToExpiration,t}get _Str_8932(){return this._creationDay}get _Str_9050(){return this._creationMonth}get _Str_9408(){return this._creationYear}get slotId(){return this._slotId}get _Str_3951(){return this._songId}get locked(){return this._locked}set locked(t){this._locked=t}get flatId(){return this._flatId}get isWallItem(){return this._isWallItem}get hasRentPeriodStarted(){return this._hasRentPeriodStarted}get _Str_10616(){return this._expirationTimeStamp}update(t){this._type=t.spriteId,this._ref=t.ref,this._category=t.category,this._groupable=t.isGroupable&&!t.rentable,this._tradeable=t.tradable,this._recyclable=t.isRecycleable,this._sellable=t.sellable,this._stuffData=t.stuffData,this._extra=t._Str_2794,this._secondsToExpiration=t.secondsToExpiration,this._expirationTimeStamp=t._Str_10616,this._hasRentPeriodStarted=t.hasRentPeriodStarted,this._creationDay=t._Str_8932,this._creationMonth=t._Str_9050,this._creationYear=t._Str_9408,this._slotId=t.slotId,this._songId=t._Str_3951,this._flatId=t.flatId,this._isRented=t.rentable,this._isWallItem=t.isWallItem}}let IS=(()=>{class t{constructor(t,e,s,i,r){this._Str_18094=1,this._Str_18535=.2,this._type=t,this._category=e,this._roomEngine=s,this._stuffData=i,this._extra=r,this._isWallItem=!1,this._iconUrl=null,this._name=null,this._description=null,this._locked=!1,this._selected=!1,this._hasUnseenItems=!1,this._items=new X}prepareGroup(){this.setIcon(),this.setName(),this.setDescription()}dispose(){}getItemByIndex(t){return this._items.getWithIndex(t)}getItemById(t){return this._items.getValue(t)}getTradeItems(t){const e=[],s=this.getLastItem();if(!s)return e;let i=0,r=0;for(;r<this._items.length&&!(i>=t);){const t=this.getItemByIndex(r);!t.locked&&t.isTradable&&t.type===s.type&&(e.push(t),i++),r++}return e}push(t,e=!1){const s=this._items.getValue(t.id);s?s.locked=!1:this._items.add(t.id,t),1===this._items.length&&this.prepareGroup()}pop(){let t=null;return this._items.length>0&&(t=this._items.getWithIndex(this._items.length-1),this._items.remove(t.id)),t}remove(t){const e=this._items.getValue(t);return e?(this._items.remove(t),e):null}getTotalCount(){if(this._category===tS._Str_12351){let t=0,e=0;for(;e<this._items.length;){const s=this._items.getWithIndex(e);t+=parseInt(s.stuffData.getLegacyString()),e++}return t}return this._items.length}getUnlockedCount(){if(this.category===tS._Str_12351)return this.getTotalCount();let t=0,e=0;for(;e<this._items.length;)this._items.getWithIndex(e).locked||t++,e++;return t}getLastItem(){return this._items.length?this._items.getWithIndex(this._items.length-1):null}unlockAllItems(){if(this._items.length)for(const t of this._items.getValues())t&&t.locked&&(t.locked=!1)}lockItemIds(t){for(const e of this._items.getValues()){const s=t.indexOf(e.ref)>=0;e.locked!==s&&(e.locked=s)}}setName(){const t=this.getLastItem();if(!t)return void(this._name="");let e="";switch(this._category){case tS._Str_5186:e="poster_"+t.stuffData.getLegacyString()+"_name";break;case tS._Str_9125:return void(this._name="SONG_NAME");default:e=this.isWallItem?"wallItem.name."+t.type:"roomItem.name."+t.type}this._name=um.instance.getLocalization(e)}setDescription(){this._description=""}setIcon(){if(this._iconUrl)return;let t=null;t=this.isWallItem?this._roomEngine.getFurnitureWallIcon(this._type,this,this._stuffData.getLegacyString()):this._roomEngine.getFurnitureFloorIcon(this._type,this,this._extra.toString(),this._stuffData),(t.image||t.data)&&this.setIconUrl(t.image?t.image.src:t.getImage().src)}setIconUrl(t){t&&(this._iconUrl=t)}imageReady(t,e,s=null){-1!==t&&s&&(this._iconUrl&&this._iconUrl.length&&s.src===this._iconUrl||this.setIconUrl(s.src))}imageFailed(t){}get type(){return this._type}get category(){return this._category}get stuffData(){return this._stuffData}get extra(){return this._extra}get iconUrl(){return this._iconUrl}get name(){return this._name}get description(){return this._description}get hasUnseenItems(){return this._hasUnseenItems}set hasUnseenItems(t){this._hasUnseenItems=t}get locked(){return this._locked}set locked(t){this._locked=t}get selected(){return this._selected}set selected(t){this._selected=t}get isWallItem(){const t=this.getItemByIndex(0);return!!t&&t.isWallItem}get isGroupable(){const t=this.getItemByIndex(0);return!!t&&t.isGroupable}get items(){return this._items}}return t.INVENTORY_THUMB_XML="inventory_thumb_xml",t._Str_4072=13421772,t._Str_4169=10275685,t})(),vS=(()=>{class t{constructor(t,e){this._inventoryService=t,this._ngZone=e,this._messages=[],this._furniMsgFragments=[],this._groupItems=[],this._itemIdInFurniPlacing=-1,this._isObjectMoverRequested=!1,this._isInitialized=!1,this._needsUpdate=!1,this.onRoomEngineObjectPlacedEvent=this.onRoomEngineObjectPlacedEvent.bind(this),this.registerMessages()}ngOnDestroy(){this.unregisterMessages()}registerMessages(){this._ngZone.runOutsideAngular(()=>{um.instance.roomEngine.events.addEventListener(Nh.PLACED,this.onRoomEngineObjectPlacedEvent),this._messages=[new Ni(this.onFurnitureListAddOrUpdateEvent.bind(this)),new Ui(this.onFurnitureListEvent.bind(this)),new Pi(this.onFurnitureListInvalidateEvent.bind(this)),new Fi(this.onFurnitureListRemovedEvent.bind(this)),new Vi(this.onFurniturePostItPlacedEvent.bind(this))];for(const t of this._messages)um.instance.communication.registerMessageEvent(t)})}unregisterMessages(){this._ngZone.runOutsideAngular(()=>{um.instance.roomEngine.events.removeEventListener(Nh.PLACED,this.onRoomEngineObjectPlacedEvent);for(const t of this._messages)um.instance.communication.removeMessageEvent(t);this._messages=[]})}onRoomEngineObjectPlacedEvent(t){t&&this._isObjectMoverRequested&&t.type===Nh.PLACED&&(this._isObjectMoverRequested=!1,t._Str_4057||this._ngZone.run(()=>this._inventoryService.showWindow()))}onFurnitureListAddOrUpdateEvent(t){if(!t)return;const e=t.getParser();if(!e)return;const s=e.items;this._ngZone.run(()=>{for(const t of s){const e=this.getGroupItemForFurnitureId(t.itemId);if(e){const s=e.getItemById(t.itemId);s&&(s.update(t),e.hasUnseenItems=!0)}else{const e=new RS(t);this.addFurnitureItem(e,!1)}}})}onFurnitureListEvent(t){if(!t)return;const e=t.getParser();if(!e)return;this._furniMsgFragments||(this._furniMsgFragments=new Array(e.totalFragments));const s=new Map([...e.fragment]),i=this.mergeFragments(s,e.totalFragments,e.fragmentNumber,this._furniMsgFragments);i&&(this._ngZone.run(()=>this.processFragment(i)),this._furniMsgFragments=null)}onFurnitureListInvalidateEvent(t){t&&t.getParser()&&(this._inventoryService.furnitureVisible?this.requestLoad():this._needsUpdate=!0)}onFurnitureListRemovedEvent(t){if(!t)return;const e=t.getParser();e&&this._ngZone.run(()=>{this.removeItemById(e.itemId)&&this.setAllFurnitureSeen()})}onFurniturePostItPlacedEvent(t){t&&t.getParser()}mergeFragments(t,e,s,i){if(1===e)return t;i[s]=t;for(const n of i)if(!n)return null;const r=new Map;for(const n of i){for(const[t,e]of n)r.set(t,e);n.clear()}return i=null,r}processFragment(t){const e=this.getAllItemIds(),s=[],i=[];for(const n of t.keys())-1===e.indexOf(n)&&s.push(n);for(const n of e)t.get(n)||i.push(n);const r=0===e.length;for(const n of i)this.removeItemById(n);for(const n of s){const e=t.get(n);if(!e)continue;const s=new RS(e);this.addFurnitureItem(s,!0)}r||s.length&&this._inventoryService.updateItemLocking(),s.length&&this._inventoryService.furniController&&(this._inventoryService.furniController.paginateConfig.currentPage=1),this._isInitialized=!0,this._inventoryService.furniController&&this._inventoryService.furniController.selectExistingGroupOrDefault()}getAllItemIds(){const t=[];for(const e of this._groupItems){let s=e.getTotalCount();e.category===tS._Str_12351&&(s=1);let i=0;for(;i<s;)t.push(e.getItemByIndex(i).id),i++}return t}addFurnitureItem(t,e){let s=null;s=t.isGroupable?this.addGroupableFurnitureItem(t,e):this.addSingleFurnitureItem(t,e),e||(s.hasUnseenItems=!0)}addSingleFurnitureItem(t,e){const s=[];for(const n of this._groupItems)n.type===t.type&&s.push(n);for(const n of s)if(n.getItemById(t.id))return n;const i=this.isFurnitureUnseen(t),r=this.createGroupItem(t.type,t.category,t.stuffData,t._Str_2794,e);return r.push(t,i),i?(r.hasUnseenItems=!0,this.unshiftGroupitem(r)):this.pushGroupItem(r),r}addGroupableFurnitureItem(t,e){let s=null;for(const r of this._groupItems)if(r.type===t.type&&r.isWallItem==t.isWallItem&&r.isGroupable)if(t.category===tS._Str_5186){if(r.stuffData.getLegacyString()===t.stuffData.getLegacyString()){s=r;break}}else{if(t.category!==tS._Str_12454){s=r;break}if(t.stuffData.compare(r.stuffData)){s=r;break}}const i=this.isFurnitureUnseen(t);return s?(s.push(t,i),i&&(s.hasUnseenItems=!0,this.removeAndUnshiftGroupitem(s)),s):(s=this.createGroupItem(t.type,t.category,t.stuffData,t._Str_2794,e),s.push(t,i),i?(s.hasUnseenItems=!0,this.unshiftGroupitem(s)):this.pushGroupItem(s),s)}createGroupItem(t,e,s,i=NaN,r=!1){return new IS(t,e,um.instance.roomEngine,s,i)}removeItemById(t){let e=0;for(;e<this._groupItems.length;){const s=this._groupItems[e],i=s.remove(t);if(i)return this._itemIdInFurniPlacing===i.ref&&(this.cancelRoomObjectPlacement(),this.attemptItemPlacement()||this._inventoryService.showWindow()),s.getTotalCount()<=0&&(this._groupItems.splice(e,1),s.dispose()),s;e++}return null}isFurnitureUnseen(t){let e=0;return e=t.rentable?Cm.RENTABLE:Cm.FURNI,this._inventoryService.unseenTracker._Str_3613(e,t.id)}setAllFurnitureSeen(){this._inventoryService.unseenTracker._Str_8813(Cm.FURNI);for(const t of this._groupItems)t.hasUnseenItems&&(t.hasUnseenItems=!1);this._inventoryService.updateUnseenCount()}attemptItemPlacement(t=!1){const e=this.getSelectedGroup();if(!e)return!1;if(!e.getUnlockedCount())return!1;const s=e.getLastItem();if(!s)return!1;if(s.category===tS._Str_3683||s.category===tS._Str_3639||s.category===tS._Str_3432){if(t)return!1;um.instance.communication.connection.send(new o_(s.id))}else this.startRoomObjectPlacement(s);return!0}startRoomObjectPlacement(t){let e=0,s=!1;e=t.isWallItem?tt.WALL:tt.FLOOR,s=t.category===tS._Str_5186?um.instance.roomEngine.processRoomObjectPlacement(ld.INVENTORY,t.id,e,t.type,t.stuffData.getLegacyString()):um.instance.roomEngine.processRoomObjectPlacement(ld.INVENTORY,t.id,e,t.type,t.stuffData.getLegacyString(),t.stuffData),s&&(this._itemIdInFurniPlacing=t.ref,this.setObjectMoverRequested(!0))}cancelRoomObjectPlacement(){this._itemIdInFurniPlacing>-1&&(um.instance.roomEngine.cancelRoomObjectPlacement(),this.setObjectMoverRequested(!1),this._itemIdInFurniPlacing=-1)}getGroupItemForFurnitureId(t){for(const e of this._groupItems)if(e.getItemById(t))return e;return null}getSelectedGroup(){for(const t of this._groupItems)if(t&&t.selected)return t;return null}unshiftGroupitem(t){this._groupItems.unshift(t)}pushGroupItem(t){this._groupItems.push(t)}removeGroupItem(t){const e=this._groupItems.indexOf(t);e>-1&&this._groupItems.splice(e,1)}removeAndUnshiftGroupitem(t){this.removeGroupItem(t),this.unshiftGroupitem(t)}unlockAllItems(){for(const t of this._groupItems)t.unlockAllItems()}unselectAllGroupItems(){for(const t of this._groupItems)t.selected=!1}requestLoad(){this._needsUpdate=!1,um.instance.communication.connection.send(new Ic)}setObjectMoverRequested(t){this._isObjectMoverRequested!==t&&this._ngZone.run(()=>this._isObjectMoverRequested=t)}get controller(){return this._inventoryService.controller}get isInitalized(){return this._isInitialized}get needsUpdate(){return this._needsUpdate}get groupItems(){return this._groupItems}get isObjectMoverRequested(){return this._isObjectMoverRequested}}return t.SELECT_FIRST_GROUP="IFS_SELECT_FIRST_GROUP",t.SELECT_EXISTING_GROUP_DEFAULT="IFS_SELECT_EXISTING_GROUP_DEFAULT",t.\u0275fac=function(e){return new(e||t)(i.gc(Dm),i.gc(i.E))},t.\u0275prov=i.Qb({token:t,factory:t.\u0275fac}),t})();const TS=["nitro-inventory-trading-component",""],OS=function(t){return{"background-image":t}};function AS(t,e){if(1&t&&i.Vb(0,"div",21),2&t){const t=i.lc().index,e=i.lc(2);i.sc("ngStyle",i.vc(1,OS,"url("+e.getIconUrl(e.ownUserItems[t])+")"))}}function yS(t,e){if(1&t&&(i.Zb(0,"div",23),i.Rc(1),i.Yb()),2&t){const t=i.lc(2).index,e=i.lc(2);i.Gb(1),i.Tc("x",e.ownUserItems[t].getUnlockedCount(),"")}}function CS(t,e){if(1&t&&(i.Zb(0,"div",23),i.Rc(1),i.Yb()),2&t){const t=i.lc(2).index,e=i.lc(2);i.Gb(1),i.Sc(e.ownUserItems[t].stuffData.uniqueNumber)}}function MS(t,e){if(1&t&&(i.Xb(0),i.Pc(1,yS,2,1,"div",22),i.Pc(2,CS,2,1,"div",22),i.Wb()),2&t){const t=i.lc().index,e=i.lc(2);i.Gb(1),i.sc("ngIf",!e.ownUserItems[t].stuffData.uniqueNumber),i.Gb(1),i.sc("ngIf",e.ownUserItems[t].stuffData.uniqueNumber)}}function DS(t,e){if(1&t){const t=i.ac();i.Zb(0,"div",19),i.jc("click",(function(){i.Ec(t);const s=e.index;return i.lc(2).removeItem(s)})),i.Pc(1,AS,1,3,"div",20),i.Pc(2,MS,3,2,"ng-container",0),i.Yb()}if(2&t){const t=e.index,s=i.lc(2);i.Gb(1),i.sc("ngIf",s.ownUserItems[t]),i.Gb(1),i.sc("ngIf",s.ownUserItems[t])}}function NS(t,e){if(1&t&&i.Vb(0,"div",21),2&t){const t=i.lc().index,e=i.lc(2);i.sc("ngStyle",i.vc(1,OS,"url("+e.getIconUrl(e.otherUserItems[t])+")"))}}function wS(t,e){if(1&t&&(i.Zb(0,"div",23),i.Rc(1),i.Yb()),2&t){const t=i.lc(2).index,e=i.lc(2);i.Gb(1),i.Tc("x",e.otherUserItems[t].getUnlockedCount(),"")}}function US(t,e){if(1&t&&(i.Zb(0,"div",23),i.Rc(1),i.Yb()),2&t){const t=i.lc(2).index,e=i.lc(2);i.Gb(1),i.Sc(e.otherUserItems[t].stuffData.uniqueNumber)}}function LS(t,e){if(1&t&&(i.Xb(0),i.Pc(1,wS,2,1,"div",22),i.Pc(2,US,2,1,"div",22),i.Wb()),2&t){const t=i.lc().index,e=i.lc(2);i.Gb(1),i.sc("ngIf",!e.otherUserItems[t].stuffData.uniqueNumber),i.Gb(1),i.sc("ngIf",e.otherUserItems[t].stuffData.uniqueNumber)}}function PS(t,e){if(1&t&&(i.Zb(0,"div",24),i.Pc(1,NS,1,3,"div",20),i.Pc(2,LS,3,2,"ng-container",0),i.Yb()),2&t){const t=e.index,s=i.lc(2);i.Gb(1),i.sc("ngIf",s.otherUserItems[t]),i.Gb(1),i.sc("ngIf",s.otherUserItems[t])}}function xS(t,e){if(1&t){const t=i.ac();i.Zb(0,"button",25),i.jc("click",(function(){return i.Ec(t),i.lc(2).progressTrade()})),i.Rc(1),i.mc(2,"translate"),i.Yb()}if(2&t){const t=i.lc(2);i.sc("disabled",!t.ownUserNumItems&&!t.otherUserNumItems),i.Gb(1),i.Sc(i.nc(2,2,"inventory.trading.accept"))}}function FS(t,e){if(1&t){const t=i.ac();i.Zb(0,"button",25),i.jc("click",(function(){return i.Ec(t),i.lc(2).progressTrade()})),i.Rc(1),i.mc(2,"translate"),i.Yb()}if(2&t){const t=i.lc(2);i.sc("disabled",!t.ownUserNumItems&&!t.otherUserNumItems),i.Gb(1),i.Sc(i.nc(2,2,t.ownUserAccepts?"inventory.trading.modify":"inventory.trading.accept"))}}function GS(t,e){if(1&t&&(i.Zb(0,"button",26),i.Rc(1),i.mc(2,"translate"),i.Yb()),2&t){const t=i.lc(2);i.Gb(1),i.Sc(i.pc(2,1,"inventory.trading.countdown","counter",t.timerTick))}}function VS(t,e){if(1&t){const t=i.ac();i.Zb(0,"button",18),i.jc("click",(function(){return i.Ec(t),i.lc(2).progressTrade()})),i.Rc(1),i.mc(2,"translate"),i.Yb()}2&t&&(i.Gb(1),i.Sc(i.nc(2,1,"inventory.trading.confirm")))}function YS(t,e){1&t&&(i.Zb(0,"button",26),i.Rc(1),i.mc(2,"translate"),i.Yb()),2&t&&(i.Gb(1),i.Sc(i.nc(2,1,"inventory.trading.info.waiting")))}function kS(t,e){1&t&&(i.Zb(0,"button",26),i.Rc(1),i.mc(2,"translate"),i.Yb()),2&t&&(i.Gb(1),i.Sc(i.nc(2,1,"inventory.trading.accept")))}const jS=function(t,e){return{"trade-unlocked-icon":t,"trade-locked-icon":e}};function BS(t,e){if(1&t){const t=i.ac();i.Xb(0),i.Zb(1,"div",1),i.Zb(2,"div",2),i.Zb(3,"div",3),i.Rc(4),i.mc(5,"translate"),i.Yb(),i.Zb(6,"div",4),i.Zb(7,"div",5),i.Zb(8,"div",6),i.Pc(9,DS,3,2,"div",7),i.Yb(),i.Yb(),i.Zb(10,"div",8),i.Vb(11,"i",9),i.Zb(12,"div",10),i.Zb(13,"span"),i.Rc(14),i.Yb(),i.Zb(15,"span"),i.Rc(16,"items"),i.Yb(),i.Yb(),i.Zb(17,"div",10),i.Zb(18,"span"),i.Rc(19),i.Yb(),i.Zb(20,"span"),i.Rc(21,"credits"),i.Yb(),i.Yb(),i.Yb(),i.Yb(),i.Yb(),i.Zb(22,"div",2),i.Zb(23,"div",3),i.Rc(24),i.Yb(),i.Zb(25,"div",4),i.Zb(26,"div",5),i.Zb(27,"div",6),i.Pc(28,PS,3,2,"div",11),i.Yb(),i.Yb(),i.Zb(29,"div",8),i.Vb(30,"i",9),i.Zb(31,"div",10),i.Zb(32,"span"),i.Rc(33),i.Yb(),i.Zb(34,"span"),i.Rc(35,"items"),i.Yb(),i.Yb(),i.Zb(36,"div",10),i.Zb(37,"span"),i.Rc(38),i.Yb(),i.Zb(39,"span"),i.Rc(40,"credits"),i.Yb(),i.Yb(),i.Yb(),i.Yb(),i.Yb(),i.Yb(),i.Zb(41,"div",12),i.Zb(42,"div",13),i.Xb(43,14),i.Pc(44,xS,3,4,"button",15),i.Pc(45,FS,3,4,"button",15),i.Pc(46,GS,3,5,"button",16),i.Pc(47,VS,3,3,"button",17),i.Pc(48,YS,3,3,"button",16),i.Pc(49,kS,3,3,"button",16),i.Wb(),i.Zb(50,"button",18),i.jc("click",(function(){return i.Ec(t),i.lc().cancelTrade()})),i.Rc(51),i.mc(52,"translate"),i.Yb(),i.Yb(),i.Yb(),i.Wb()}if(2&t){const t=i.lc();i.Gb(4),i.Sc(i.nc(5,18,"inventory.trading.you")),i.Gb(5),i.sc("ngForOf",t.indexs),i.Gb(2),i.sc("ngClass",i.wc(22,jS,!t.ownUserAccepts,t.ownUserAccepts)),i.Gb(3),i.Sc(t.ownUserNumItems),i.Gb(5),i.Sc(t.ownUserNumCredits),i.Gb(5),i.Sc(t.otherUserName),i.Gb(4),i.sc("ngForOf",t.indexs),i.Gb(2),i.sc("ngClass",i.wc(25,jS,!t.otherUserAccepts,t.otherUserAccepts)),i.Gb(3),i.Sc(t.otherUserNumItems),i.Gb(5),i.Sc(t.otherUserNumCredits),i.Gb(5),i.sc("ngSwitch",t.state),i.Gb(1),i.sc("ngSwitchCase",0),i.Gb(1),i.sc("ngSwitchCase",1),i.Gb(1),i.sc("ngSwitchCase",2),i.Gb(1),i.sc("ngSwitchCase",3),i.Gb(1),i.sc("ngSwitchCase",4),i.Gb(1),i.sc("ngSwitchCase",5),i.Gb(2),i.Sc(i.nc(52,20,"generic.cancel"))}}let HS=(()=>{class t{constructor(t,e,s){this._notificationService=t,this._inventoryService=e,this._ngZone=s,this.visible=!1,this.indexs=[0,1,2,3,4,5,6,7,8],this._timerTick=3}ngOnInit(){this._inventoryService.tradeController=this}ngOnDestroy(){this._inventoryService.tradeController=null}startTimer(){this._timer&&(clearInterval(this._timer),this._timer=null),this._timerTick=3,this._timer=setInterval(this.progressTimer.bind(this),1e3)}resetTimer(){this._timer&&clearInterval(this._timer),this._timerTick=-1}progressTimer(){-1!==this._timerTick?(this._timerTick--,0===this._timerTick&&this._inventoryService.controller.tradeService.onTimerFinished()):this.resetTimer()}getIconUrl(t){return t&&t.iconUrl||null}removeItem(t){this._inventoryService.controller.tradeService.removeItem(t)}progressTrade(){switch(this._inventoryService.controller.tradeService.state){case WS.TRADING_STATE_RUNNING:this.otherUserItems.length||this.ownUserAccepts||this._notificationService.alert("${inventory.trading.warning.other_not_offering}"),this.ownUserAccepts?this._inventoryService.controller.tradeService.sendTradingUnacceptComposer():this._inventoryService.controller.tradeService.sendTradingAcceptComposer();break;case WS.TRADING_STATE_CONFIRMING:this._inventoryService.controller.tradeService.sendTradingConfirmComposer()}}cancelTrade(){switch(this._inventoryService.controller.tradeService.state){case WS.TRADING_STATE_RUNNING:this._inventoryService.controller.tradeService.sendTradingCloseComposer();break;case WS.TRADING_STATE_CONFIRMING:this._inventoryService.controller.tradeService.sendTradingCancelComposer()}}get timerTick(){return this._timerTick}get state(){return this._inventoryService.controller.tradeService.state}get ownUserName(){return this._inventoryService.controller.tradeService.ownUserName}get ownUserItems(){return this._inventoryService.controller.tradeService.ownUserItems.getValues()}get ownUserNumItems(){return this._inventoryService.controller.tradeService.ownUserNumItems}get ownUserNumCredits(){return this._inventoryService.controller.tradeService.ownUserNumCredits}get ownUserAccepts(){return this._inventoryService.controller.tradeService.ownUserAccepts}get otherUserName(){return this._inventoryService.controller.tradeService.otherUserName}get otherUserItems(){return this._inventoryService.controller.tradeService.otherUserItems.getValues()}get otherUserNumItems(){return this._inventoryService.controller.tradeService.otherUserNumItems}get otherUserNumCredits(){return this._inventoryService.controller.tradeService.otherUserNumCredits}get otherUserAccepts(){return this._inventoryService.controller.tradeService.otherUserAccepts}}return t.COLOR_LOCKED=4284532064,t.COLOR_UNLOCKED=2577770,t.ALERT_SCAM=0,t.ALERT_OTHER_CANCELLED=1,t.ALERT_ALREADY_OPEN=2,t.\u0275fac=function(e){return new(e||t)(i.Ub(Nm),i.Ub(Dm),i.Ub(i.E))},t.\u0275cmp=i.Ob({type:t,selectors:[["","nitro-inventory-trading-component",""]],inputs:{visible:"visible"},attrs:TS,decls:1,vars:1,consts:[[4,"ngIf"],[1,"row"],[1,"col-6"],[1,"badge","badge-secondary","my-1","p-1"],[1,"d-flex"],[1,"grid-container","position-relative",2,"width","160px"],[1,"grid-items","grid-3"],["class","d-flex flex-column item-detail justify-content-center align-items-center",3,"click",4,"ngFor","ngForOf"],[1,"d-flex","flex-column","flex-grow-1","justify-content-center","align-items-center","px-1"],[1,"icon","my-2",3,"ngClass"],[1,"d-flex","flex-column","justify-content-center","align-items-center","badge","badge-secondary","my-2"],["class","d-flex flex-column item-detail justify-content-center align-items-center",4,"ngFor","ngForOf"],[1,"row","mt-2"],[1,"d-flex","col-12","justify-content-between"],[3,"ngSwitch"],["type","button","class","btn btn-primary",3,"disabled","click",4,"ngSwitchCase"],["type","button","class","btn btn-primary","disabled","",4,"ngSwitchCase"],["type","button","class","btn btn-primary",3,"click",4,"ngSwitchCase"],["type","button",1,"btn","btn-primary",3,"click"],[1,"d-flex","flex-column","item-detail","justify-content-center","align-items-center",3,"click"],["class","d-flex flex-grow-1 align-items-center detail-image",3,"ngStyle",4,"ngIf"],[1,"d-flex","flex-grow-1","align-items-center","detail-image",3,"ngStyle"],["class","badge badge-secondary",4,"ngIf"],[1,"badge","badge-secondary"],[1,"d-flex","flex-column","item-detail","justify-content-center","align-items-center"],["type","button",1,"btn","btn-primary",3,"disabled","click"],["type","button","disabled","",1,"btn","btn-primary"]],template:function(t,e){1&t&&i.Pc(0,BS,53,28,"ng-container",0),2&t&&i.sc("ngIf",e.visible)},directives:[o.m,o.l,o.k,o.o,o.p,o.n],pipes:[Ep],encapsulation:2}),t})(),WS=(()=>{class t{constructor(t,e,s){this._notificationService=t,this._inventoryService=e,this._ngZone=s,this._messages=[],this._state=0,this._running=!1,this._ownUserIndex=-1,this._ownUserName="",this._ownUserNumItems=0,this._ownUserNumCredits=0,this._ownUserAccepts=!1,this._ownUserCanTrade=!1,this._otherUserIndex=-1,this._otherUserName="",this._otherUserNumItems=0,this._otherUserNumCredits=0,this._otherUserAccepts=!1,this._otherUserCanTrade=!1,this._offeredItemIds=[],this.registerMessages()}static _Str_16998(t,e){let s=t.toString();const i=e;if(!(e instanceof Oi))return s;let r=1;for(;r<5;)s=s+","+i.getValue(r),r++;return s}ngOnDestroy(){this.unregisterMessages()}registerMessages(){this._ngZone.runOutsideAngular(()=>{this._messages=[new ki(this.onTradingAcceptEvent.bind(this)),new Bi(this.onTradingCloseEvent.bind(this)),new Wi(this.onTradingCompletedEvent.bind(this)),new zi(this.onTradingConfirmationEvent.bind(this)),new qi(this.onTradingListItemEvent.bind(this)),new Qi(this.onTradingNotOpenEvent.bind(this)),new tr(this.onTradingOpenEvent.bind(this)),new sr(this.onTradingOpenFailedEvent.bind(this)),new rr(this.onTradingOtherNotAllowedEvent.bind(this)),new ar(this.onTradingYouAreNotAllowedEvent.bind(this))];for(const t of this._messages)um.instance.communication.registerMessageEvent(t)})}unregisterMessages(){this._ngZone.runOutsideAngular(()=>{for(const t of this._messages)um.instance.communication.removeMessageEvent(t);this._messages=[]})}onTradingAcceptEvent(t){t&&(console.log(t),t.getParser()&&this._ngZone.run(()=>{t._Str_4963===this._ownUserIndex?this._ownUserAccepts=t._Str_15794:this._otherUserAccepts=t._Str_15794}))}tradingNotificationMessage(t){switch(t){case HS.ALERT_SCAM:return void this._notificationService.alert("${inventory.trading.notification.title}","${inventory.trading.warning.other_not_offering}");case HS.ALERT_OTHER_CANCELLED:return void this._notificationService.alert("${inventory.trading.notification.title}","${inventory.trading.info.closed}");case HS.ALERT_ALREADY_OPEN:return void this._notificationService.alert("${inventory.trading.notification.title}","${inventory.trading.info.already_open}")}}onTradingCloseEvent(t){if(!t)return;const e=t.getParser();e&&this._running&&this._ngZone.run(()=>{e.reason===ji._Str_16410?this._notificationService.alert("${inventory.trading.notification.caption}, ${inventory.trading.notification.commiterror.info}","${inventory.trading.notification.title}"):e._Str_4963!==this._ownUserIndex&&this.tradingNotificationMessage(HS.ALERT_OTHER_CANCELLED),this.close()})}onTradingCompletedEvent(e){e&&e.getParser()&&this._ngZone.run(()=>this.state=t.TRADING_STATE_COMPLETED)}onTradingConfirmationEvent(e){e&&e.getParser()&&this._ngZone.run(()=>this.state=t.TRADING_STATE_COUNTDOWN)}onTradingListItemEvent(t){if(!t)return;const e=t.getParser();e&&this._ngZone.run(()=>{const t=new X,s=new X;this.parseItems(e._Str_17841,t),this.parseItems(e._Str_17465,s),this.updateTrade(e,t,s)})}onTradingNotOpenEvent(t){}onTradingOpenEvent(t){if(!t)return;const e=t.getParser();if(!e)return;const s=um.instance.sessionDataManager,i=this._inventoryService.roomSession;if(!s||!i)return;let r=e._Str_4963;const n=i.userDataManager.getUserData(r);if(!n)return;let a=n.name,o=e._Str_16764,c=e._Str_17613;const _=i.userDataManager.getUserData(c);if(!_)return;let h=_.name,l=e._Str_13374;if(c===s.userId){const t=r,e=a,s=o;r=c,a=h,o=l,c=t,h=e,l=s}this._ngZone.run(()=>{this._inventoryService.showWindow(),this._inventoryService.furnitureVisible=!0,this._inventoryService.tradingVisible=!0,this._Str_23457(r,a,o,c,h,l)})}onTradingOpenFailedEvent(t){if(!t)return;const e=t.getParser();e&&(e.reason!==er._Str_18150&&e.reason!==er._Str_18383||this._ngZone.run(()=>{this.tradingNotificationMessage(HS.ALERT_ALREADY_OPEN)}))}onTradingOtherNotAllowedEvent(t){t&&this._ngZone.run(()=>{this._notificationService.alert("${inventory.trading.warning.others_account_disabled}","${inventory.trading.notification.title}")})}onTradingYouAreNotAllowedEvent(t){t&&this._ngZone.run(()=>{this._notificationService.alert("${inventory.trading.warning.own_account_disabled}","${inventory.trading.notification.title}")})}close(){this._running&&(this._state!==t.TRADING_STATE_READY&&this._state!==t.TRADING_STATE_COMPLETED&&(this.sendTradingCloseComposer(),this.state=t.TRADING_STATE_CANCELLED),this._inventoryService.controller.furnitureService.unlockAllItems(),this.state=t.TRADING_STATE_READY,this._running=!1,this._inventoryService.tradingVisible=!1)}startTrade(t,e){this.controller&&(this.controller.furnitureService.isInitalized||this.controller.furnitureService.requestLoad(),this.sendTradingOpenComposer(t))}_Str_23457(e,s,i,r,n,a){this._ownUserIndex=e,this._ownUserName=s,this._ownUserItems=new X,this._ownUserAccepts=!1,this._ownUserCanTrade=i,this._otherUserIndex=r,this._otherUserName=n,this._otherUserItems=new X,this._otherUserAccepts=!1,this._otherUserCanTrade=a,this._running=!0,this.state=t.TRADING_STATE_RUNNING}parseItems(t,e){if(!this.controller)return;const s=t.length;let i=0;for(;i<s;){const s=t[i];if(s){const t=s.spriteId,i=s.category;let r=s.furniType+t;s.isGroupable&&!this.isExternalImage(t)||(r="itemid"+s.itemId),s.category===tS._Str_5186?r=s.itemId+"poster"+s.stuffData.getLegacyString():s.category===tS._Str_12454&&(r="");let n=s.isGroupable&&!this.isExternalImage(s.spriteId)?e.getValue(r):null;n||(n=this.controller.furnitureService.createGroupItem(t,i,s.stuffData),e.add(r,n)),n.push(new RS(s))}i++}}isExternalImage(t){const e=um.instance.sessionDataManager.getWallItemData(t);return e&&e.isExternalImage}updateTrade(t,e,s){this._ownUserItems&&this._ownUserItems.reset(),this._otherUserItems&&this._otherUserItems.reset(),t._Str_15162===this._ownUserIndex?(this._ownUserItems=e,this._ownUserNumItems=t._Str_14946,this._ownUserNumCredits=t._Str_15709,this._otherUserItems=s,this._otherUserNumItems=t._Str_13801,this._otherUserNumCredits=t._Str_9138):(this._ownUserItems=s,this._ownUserNumItems=t._Str_13801,this._ownUserNumCredits=t._Str_9138,this._otherUserItems=e,this._otherUserNumItems=t._Str_14946,this._otherUserNumCredits=t._Str_15709),this._ownUserAccepts=!1,this._otherUserAccepts=!1,this._inventoryService.updateItemLocking()}offerItems(t,e,s,i,r,n){if(!r&&t.length)um.instance.communication.connection.send(new yc(t.pop()));else{const a=[];for(const o of t)this.canTradeItem(e,s,i,r,n)&&a.push(o);a.length&&um.instance.communication.connection.send(1===a.length?new yc(a.pop()):new Cc(...a))}}canTradeItem(e,s,i,r,n){if(this._ownUserAccepts)return!1;if(null==this._ownUserItems)return!1;if(this._ownUserItems.length<t.MAX_ITEMS_TO_TRADE)return!0;if(!r)return!1;let a=s.toString();return a=i===tS._Str_5186?a+"poster"+n.getLegacyString():i===tS._Str_12454?t._Str_16998(s,n):(e?"I":"S")+a,!!this._ownUserItems.getValue(a)}removeItem(t){const e=this._ownUserItems.getWithIndex(t);if(!e)return;const s=e.getLastItem();s&&um.instance.communication.connection.send(new Mc(s.id))}getOwnTradingItemIds(){const t=[];if(!this._ownUserItems||!this._ownUserItems.length)return t;for(const e of this._ownUserItems.getValues()){let s=0;for(;s<e.getTotalCount();){const i=e.getItemByIndex(s);i&&t.push(i.ref),s++}}return t}onTimerFinished(){this._state===t.TRADING_STATE_COUNTDOWN&&(this.state=t.TRADING_STATE_CONFIRMING)}sendTradingAcceptComposer(){um.instance.communication.connection.send(new vc)}sendTradingUnacceptComposer(){um.instance.communication.connection.send(new Nc)}sendTradingConfirmComposer(){this.state=t.TRADING_STATE_CONFIRMED,um.instance.communication.connection.send(new Ac)}sendTradingCloseComposer(){um.instance.communication.connection.send(new Oc)}sendTradingCancelComposer(){um.instance.communication.connection.send(new Tc)}sendTradingOpenComposer(t){um.instance.communication.connection.send(new Dc(t))}get controller(){return this._inventoryService.controller}get state(){return this._state}set state(e){if(this._state===e)return;const s=this._state;let i=!1;switch(this._state){case t.TRADING_STATE_READY:e!==t.TRADING_STATE_RUNNING&&e!==t.TRADING_STATE_COMPLETED||(this._state=e,i=!0);break;case t.TRADING_STATE_RUNNING:e===t.TRADING_STATE_COUNTDOWN?(this._state=e,i=!0,this._inventoryService.tradeController.startTimer()):e===t.TRADING_STATE_CANCELLED&&(this._state=e,i=!0);break;case t.TRADING_STATE_COUNTDOWN:(e===t.TRADING_STATE_CONFIRMING||e===t.TRADING_STATE_CANCELLED||e===t.TRADING_STATE_RUNNING)&&(this._state=e,i=!0);break;case t.TRADING_STATE_CONFIRMING:e===t.TRADING_STATE_CONFIRMED?(this._state=e,i=!0):(e===t.TRADING_STATE_COMPLETED||e===t.TRADING_STATE_CANCELLED)&&(this._state=e,i=!0,this.close());break;case t.TRADING_STATE_CONFIRMED:(e===t.TRADING_STATE_COMPLETED||e===t.TRADING_STATE_CANCELLED)&&(this._state=e,i=!0,this.close());break;case t.TRADING_STATE_COMPLETED:e===t.TRADING_STATE_READY&&(this._state=e,i=!0);break;case t.TRADING_STATE_CANCELLED:(e===t.TRADING_STATE_READY||e===t.TRADING_STATE_RUNNING)&&(this._state=e,i=!0)}console.log(s,this._state)}get running(){return this._running}get ownUserName(){return this._ownUserName}get ownUserItems(){return this._ownUserItems}get ownUserNumItems(){return this._ownUserNumItems}get ownUserNumCredits(){return this._ownUserNumCredits}get ownUserAccepts(){return this._ownUserAccepts}get ownUserCanTrade(){return this._ownUserCanTrade}get otherUserName(){return this._otherUserName}get otherUserItems(){return this._otherUserItems}get otherUserNumItems(){return this._otherUserNumItems}get otherUserNumCredits(){return this._otherUserNumCredits}get otherUserAccepts(){return this._otherUserAccepts}get otherUserCanTrade(){return this._otherUserCanTrade}}return t.MAX_ITEMS_TO_TRADE=9,t.TRADING_STATE_READY=0,t.TRADING_STATE_RUNNING=1,t.TRADING_STATE_COUNTDOWN=2,t.TRADING_STATE_CONFIRMING=3,t.TRADING_STATE_CONFIRMED=4,t.TRADING_STATE_COMPLETED=5,t.TRADING_STATE_CANCELLED=6,t.\u0275fac=function(e){return new(e||t)(i.gc(Nm),i.gc(Dm),i.gc(i.E))},t.\u0275prov=i.Qb({token:t,factory:t.\u0275fac}),t})();const ZS=function(t){return{active:t}};function zS(t,e){if(1&t){const t=i.ac();i.Zb(0,"div",1),i.Zb(1,"div",2),i.Zb(2,"h6",3),i.Rc(3),i.mc(4,"translate"),i.Yb(),i.Zb(5,"button",4),i.jc("click",(function(){return i.Ec(t),i.lc().hide()})),i.Vb(6,"i",5),i.Yb(),i.Yb(),i.Zb(7,"div",6),i.Zb(8,"div",7),i.Zb(9,"button",8),i.Rc(10),i.mc(11,"translate"),i.Yb(),i.Yb(),i.Vb(12,"div",9),i.Vb(13,"div",10),i.Yb(),i.Yb()}if(2&t){const t=i.lc();i.Gb(3),i.Sc(i.nc(4,6,"inventory.title")),i.Gb(6),i.sc("ngClass",i.vc(10,ZS,t.furnitureVisible||t.tradingVisible)),i.Gb(1),i.Sc(i.nc(11,8,"inventory.furni")),i.Gb(2),i.sc("visible",t.furnitureVisible)("roomPreviewer",t.roomPreviewer),i.Gb(1),i.sc("visible",t.tradingVisible)}}let XS=(()=>{class t{constructor(t,e,s,i){this._settingsService=t,this._inventoryService=e,this._inventoryFurnitureService=s,this._inventoryTradingService=i,this.visible=!1,this._roomPreviewer=null}ngOnInit(){this._roomPreviewer||(this._roomPreviewer=new Xp(um.instance.roomEngine,++Xp.PREVIEW_COUNTER)),this._inventoryService.controller=this}ngOnDestroy(){this._roomPreviewer&&this._roomPreviewer.dispose(),this._inventoryService.controller=null}ngOnChanges(t){const e=t.visible.currentValue;e!==t.visible.previousValue&&(e?this.showFurniture():(this._inventoryTradingService.close(),this.setAllFurnitureSeen()))}hide(){this._inventoryService.hideWindow()}showFurniture(){this._inventoryService.furnitureVisible=!0}updateItemLocking(){const t=[];if(t.push(...this._inventoryTradingService.getOwnTradingItemIds()),t.length)for(const e of this._inventoryFurnitureService.groupItems)e.lockItemIds(t);else this._inventoryFurnitureService.unlockAllItems()}setAllFurnitureSeen(){this._inventoryFurnitureService.setAllFurnitureSeen()}get roomPreviewer(){return this._roomPreviewer}get furnitureVisible(){return this._inventoryService.furnitureVisible}get tradingVisible(){return this._inventoryService.tradingVisible}get furnitureService(){return this._inventoryFurnitureService}get tradeService(){return this._inventoryTradingService}}return t.\u0275fac=function(e){return new(e||t)(i.Ub(gm),i.Ub(Dm),i.Ub(vS),i.Ub(WS))},t.\u0275cmp=i.Ob({type:t,selectors:[["nitro-inventory-main-component"]],inputs:{visible:"visible"},features:[i.Eb],decls:1,vars:1,consts:[["class","nitro-inventory card","dragHandle",".drag-handler",3,"bringToTop","draggable",4,"ngIf"],["dragHandle",".drag-handler",1,"nitro-inventory","card",3,"bringToTop","draggable"],[1,"drag-handler","d-flex","justify-content-between","align-items-center","px-3","pt-3"],[1,"m-0"],["type","button",1,"close",3,"click"],[1,"fas","fa-times"],[1,"d-flex","flex-column","p-3"],[1,"btn-group","w-100","mb-3"],["type","button",1,"btn","btn-secondary",3,"ngClass"],["nitro-inventory-furniture-component","",3,"visible","roomPreviewer"],["nitro-inventory-trading-component","",3,"visible"]],template:function(t,e){1&t&&i.Pc(0,zS,14,12,"div",0),2&t&&i.sc("ngIf",e.visible)},encapsulation:2}),t})(),KS=(()=>{class t{}return t.\u0275mod=i.Sb({type:t}),t.\u0275inj=i.Rb({factory:function(e){return new(e||t)},providers:[Dm,vS,WS],imports:[[p]]}),t})();i.Hc(XS,[o.m,op,dp,o.k,bS,HS],[Ep]);let qS=(()=>{class t{}return t._Str_3159=0,t._Str_2964=1,t._Str_2575=2,t})();class JS{constructor(t,e,s){this._level=t,this._tileSize=e,this._name=s}get level(){return this._level}get tileSize(){return this._tileSize}get name(){return this._name}}let QS=(()=>{class t{constructor(e,s,i){this._notificationService=e,this._settingsService=s,this._ngZone=i,this._messages=[],this._component=null,this._topLevelContexts=[],this._topLevelContext=null,this._categories=[],this._filter=t.SEARCH_FILTERS[0],this._lastSearchResults=[],this._lastSearch="",this._homeRoomId=-1,this._isSearching=!1,this._isLoaded=!1,this._isLoading=!1,this.onRoomSessionEvent=this.onRoomSessionEvent.bind(this),this.registerMessages(),um.instance.addLinkEventTracker(this)}ngOnDestroy(){this.unregisterMessages(),um.instance.removeLinkEventTracker(this)}registerMessages(){this._ngZone.runOutsideAngular(()=>{um.instance.roomSessionManager.events.addEventListener(Fe.CREATED,this.onRoomSessionEvent),this._messages=[new ko(this.onUserInfoEvent.bind(this)),new un(this.onRoomForwardEvent.bind(this)),new bn(this.onRoomInfoOwnerEvent.bind(this)),new fn(this.onRoomInfoEvent.bind(this)),new cn(this.onRoomEnterErrorEvent.bind(this)),new Pn(this.onRoomCreatedEvent.bind(this)),new qr(this.onRoomDoorbellEvent.bind(this)),new Xr(this.onRoomDoorbellAcceptedEvent.bind(this)),new K_(this.onGenericErrorEvent.bind(this)),new Qr(this.onRoomDoorbellRejectedEvent.bind(this)),new lr(this.onNavigatorCategoriesEvent.bind(this)),new dr(this.onNavigatorCollapsedEvent.bind(this)),new pr(this.onNavigatorEventCategoriesEvent.bind(this)),new Rr(this.onNavigatorLiftedEvent.bind(this)),new Or(this.onNavigatorMetadataEvent.bind(this)),new yr(this.onNavigatorOpenRoomCreatorEvent.bind(this)),new Mr(this.onNavigatorSearchesEvent.bind(this)),new Lr(this.onNavigatorSearchEvent.bind(this)),new xr(this.onNavigatorSettingsEvent.bind(this)),new fr(this.onNavigatorHomeRoomEvent.bind(this))];for(const t of this._messages)um.instance.communication.registerMessageEvent(t)})}unregisterMessages(){this._ngZone.runOutsideAngular(()=>{um.instance.roomSessionManager.events.removeEventListener(Fe.CREATED,this.onRoomSessionEvent);for(const t of this._messages)um.instance.communication.removeMessageEvent(t);this._messages=[]})}onRoomSessionEvent(t){if(t)switch(t.type){case Fe.CREATED:return void this._ngZone.run(()=>this._settingsService.hideNavigator())}}onUserInfoEvent(t){t&&t.getParser()&&(um.instance.communication.connection.send(new wc),um.instance.communication.connection.send(new Vc))}onRoomForwardEvent(t){if(!(t instanceof un))return;const e=t.getParser();e&&um.instance.communication.connection.send(new qc(e.roomId,!1,!0))}onRoomInfoOwnerEvent(t){if(!(t instanceof bn))return;const e=t.getParser();e&&(um.instance.communication.connection.send(new qc(e.roomId,!0,!1)),Q_.call("legacyTrack","navigator","private",[e.roomId]))}onRoomInfoEvent(t){if(!(t instanceof fn))return;const e=t.getParser();if(e)if(e.roomEnter);else if(e.roomForward){if(e.data.ownerName!==um.instance.sessionDataManager.userName)switch(e.data.doorMode){case Dr.DOORBELL_STATE:return void console.log("DOORBELL");case Dr.PASSWORD_STATE:return void console.log("PASSWORD")}this.goToRoom(e.data.roomId)}}onRoomEnterErrorEvent(t){if(!(t instanceof cn))return;const e=t.getParser();if(!e)return;switch(e.reason){case on.FULL_ERROR:this._ngZone.run(()=>this._notificationService.alert("${navigator.guestroomfull.text}","${navigator.guestroomfull.title}"));break;case on.QUEUE_ERROR:this._ngZone.run(()=>this._notificationService.alert("${room.queue.error.title}","${room.queue.error. "+e.parameter+"}"));break;case on.BANNED:this._ngZone.run(()=>this._notificationService.alert("${navigator.banned.title}","${navigator.banned.text}"));break;default:this._ngZone.run(()=>this._notificationService.alert("${room.queue.error.title}","${room.queue.error.title}"))}um.instance.communication.connection.send(new nc);const s=new Ah(Ah.TOOLBAR_CLICK);s.iconName=Oh.HOTEL_VIEW,um.instance.roomEngine.events.dispatchEvent(s)}onRoomCreatedEvent(t){if(!t)return;const e=t.getParser();e&&this.goToRoom(e.roomId)}onRoomDoorbellEvent(t){if(!t)return;const e=t.getParser();e&&(e.userName&&0!==e.userName.length||this._ngZone.run(()=>this._component&&this._component.openRoomDoorbell(null,!0)))}onRoomDoorbellAcceptedEvent(t){if(!t)return;const e=t.getParser();e&&(e.userName&&0!==e.userName.length||this._ngZone.run(()=>this._component&&this._component.closeRoomDoorbell()))}onGenericErrorEvent(t){if(!t)return;const e=t.getParser();e&&-100002===e.errorCode&&this._ngZone.run(()=>this._component&&this._component.openRoomPassword(null,!0))}onRoomDoorbellRejectedEvent(t){if(!t)return;const e=t.getParser();e&&(e.userName&&0!==e.userName.length||this._ngZone.run(()=>this._component&&this._component.openRoomDoorbell(null,!1,!0)))}onNavigatorCategoriesEvent(t){if(!t)return;const e=t.getParser();e&&this._ngZone.run(()=>this._categories=e.categories)}onNavigatorCollapsedEvent(t){t&&t.getParser()}onNavigatorEventCategoriesEvent(t){t&&t.getParser()}onNavigatorLiftedEvent(t){t&&t.getParser()}onNavigatorMetadataEvent(t){if(!t)return;const e=t.getParser();e&&this._ngZone.run(()=>{this._topLevelContexts=e.topLevelContexts,this._topLevelContexts.length>0&&this.setCurrentContext(this._topLevelContexts[0]),this.clearSearch()})}onNavigatorOpenRoomCreatorEvent(t){t&&t.getParser()&&this._component&&this._ngZone.run(()=>this._component.openRoomCreator())}onNavigatorSearchesEvent(t){t&&t.getParser()}onNavigatorSearchEvent(t){if(!t)return;const e=t.getParser();if(!e)return;const s=e.result;s&&this._ngZone.run(()=>{this.setCurrentContextByCode(s.code),this._lastSearchResults=s.results,this._isSearching=!1})}onNavigatorSettingsEvent(t){t&&t.getParser()}onNavigatorHomeRoomEvent(t){if(!t)return;const e=t.getParser();e&&(this._homeRoomId=e.homeRoomId)}goToRoom(t,e=null){um.instance.roomSessionManager.createSession(t,e)}goToPrivateRoom(t){um.instance.communication.connection.send(new qc(t,!1,!0))}goToHomeRoom(){return!(this._homeRoomId<1||(this.goToRoom(this._homeRoomId),0))}getContextByCode(t){if(!t)return null;for(const e of this._topLevelContexts)if(e&&e.code===t)return e;return null}setCurrentContext(t,e=!0){t&&this._topLevelContext!==t&&(this._topLevelContext=t)}setCurrentContextByCode(t,e=!0){if(!t)return;const s=this.getContextByCode(t);s&&this.setCurrentContext(s,e)}setCurrentFilter(t){t&&this._filter!==t&&(this._filter=t)}search(e=null){if(!this._topLevelContext||this._isSearching)return;this._filter||this.setCurrentFilter(t.SEARCH_FILTERS[0]);const s=this._filter&&this._filter.query?this._filter.query+":":"";let i=e;null===i&&(i=this._lastSearch),this._lastSearch=i||"",this.sendSearch(this._topLevelContext.code,s+this._lastSearch)}clearSearch(){this.setCurrentFilter(t.SEARCH_FILTERS[0]),this._lastSearch=null,this.isLoaded&&this.search()}sendSearch(t,e){t&&(this._isSearching=!0,this._ngZone.runOutsideAngular(()=>um.instance.communication.connection.send(new xc(t,e))))}loadNavigator(){this._ngZone.runOutsideAngular(()=>um.instance.communication.connection.send(new Lc)),this._isLoaded=!0}openRoomDoorbell(t){t&&this._component&&this._component.openRoomDoorbell(t)}openRoomPassword(t){t&&this._component&&this._component.openRoomPassword(t)}linkReceived(t){const e=t.split("/");if(!(e.length<2))switch(e[1]){case"goto":if(e.length>2)switch(e[2]){case"home":this.goToHomeRoom();break;default:{const t=parseInt(e[2]);t>0&&this.goToPrivateRoom(t)}}return}}get eventUrlPrefix(){return"navigator"}get component(){return this._component}set component(t){this._component=t}get topLevelContexts(){return this._topLevelContexts}get topLevelContext(){return this._topLevelContext}get categories(){return this._categories}get filter(){return this._filter}get lastSearch(){return this._lastSearch}set lastSearch(t){this._lastSearch=t}get lastSearchResults(){return this._lastSearchResults}get isSearching(){return this._isSearching}get isLoaded(){return this._isLoaded}get isLoading(){return this._isLoading}}return t.SEARCH_FILTERS=[{name:"anything",query:null},{name:"room.name",query:"roomname"},{name:"owner",query:"owner"},{name:"tag",query:"tag"},{name:"group",query:"group"}],t.\u0275fac=function(e){return new(e||t)(i.gc(Nm),i.gc(gm),i.gc(i.E))},t.\u0275prov=i.Qb({token:t,factory:t.\u0275fac}),t})();const $S=["nitro-navigator-room-creator-component",""],tb=function(t){return{active:t}},eb=function(t){return{"background-image":t}};function sb(t,e){if(1&t){const t=i.ac();i.Zb(0,"div",21),i.jc("click",(function(){i.Ec(t);const s=e.$implicit;return i.lc().setRoomLayout(s.name)})),i.Zb(1,"button",22),i.Zb(2,"div",23),i.Rc(3),i.mc(4,"translate"),i.Yb(),i.Yb(),i.Yb()}if(2&t){const t=e.$implicit,s=i.lc();i.Gb(1),i.sc("ngClass",i.vc(6,tb,s.roomLayoutControl.value===t.name))("ngStyle",i.vc(8,eb,"url("+s.getRoomLayoutImageUrl(t.name)+")")),i.Gb(2),i.Uc("",t.tileSize," ",i.nc(4,4,"navigator.createroom.tilesize"),"")}}function ib(t,e){if(1&t&&(i.Zb(0,"option",24),i.Rc(1),i.mc(2,"translate"),i.Yb()),2&t){const t=e.$implicit;i.sc("value",t.id),i.Gb(1),i.Sc(i.nc(2,2,t.name))}}function rb(t,e){if(1&t&&(i.Zb(0,"option",24),i.Rc(1),i.Yb()),2&t){const t=e.$implicit;i.sc("value",t),i.Gb(1),i.Sc(t)}}function nb(t,e){if(1&t&&(i.Zb(0,"option",24),i.Rc(1),i.mc(2,"translate"),i.Yb()),2&t){const t=e.$implicit;i.sc("value",t.key),i.Gb(1),i.Sc(i.nc(2,2,t.value))}}let ab=(()=>{class t{constructor(t,e,s){this._navigatorService=t,this._activeModal=e,this._formBuilder=s,this._layouts=[],this._maxVisitors=[],this._tradeSettings=[],this._roomCreateListener=null}ngOnInit(){this.setRoomLayouts(),this.setMaxVisitors(50),this.setTradeSettings(),this.createForm(),this._roomCreateListener=new Pn(this.onRoomCreatedEvent.bind(this)),um.instance.communication.registerMessageEvent(this._roomCreateListener)}ngOnDestroy(){um.instance.communication.removeMessageEvent(this._roomCreateListener)}onRoomCreatedEvent(t){this.hide()}createForm(){let t=0;const e=this.categories[0];e&&(t=e.id),this._form=this._formBuilder.group({roomName:["",c.r.required],roomDesc:[""],roomLayout:[this.layouts[0].name,c.r.required],roomCategory:[t.toString(),c.r.required],roomVisitors:[this.maxVisitors[0].toString(),c.r.required],roomTrade:["0",c.r.required]})}submit(){if(!this.form.valid)return;const t=this.roomNameControl.value,e=this.roomDescControl.value,s="model_"+this.roomLayoutControl.value,i=parseInt(this.roomCategoryControl.value),r=parseInt(this.roomVisitorsControl.value),n=parseInt(this.roomTradeControl.value);t&&""!==t&&um.instance.communication.connection.send(new S_(t,e,s,i,r,n))}hide(){this._activeModal.close()}setRoomLayouts(){this._layouts=[new JS(qS._Str_3159,104,"a"),new JS(qS._Str_3159,94,"b"),new JS(qS._Str_3159,36,"c"),new JS(qS._Str_3159,84,"d"),new JS(qS._Str_3159,80,"e"),new JS(qS._Str_3159,80,"f"),new JS(qS._Str_3159,416,"i"),new JS(qS._Str_3159,320,"j"),new JS(qS._Str_3159,448,"k"),new JS(qS._Str_3159,352,"l"),new JS(qS._Str_3159,384,"m"),new JS(qS._Str_3159,372,"n"),new JS(qS._Str_2964,80,"g"),new JS(qS._Str_2964,74,"h"),new JS(qS._Str_2964,416,"o"),new JS(qS._Str_2964,352,"p"),new JS(qS._Str_2964,304,"q"),new JS(qS._Str_2964,336,"r"),new JS(qS._Str_2964,748,"u"),new JS(qS._Str_2964,438,"v"),new JS(qS._Str_2575,540,"t"),new JS(qS._Str_2575,512,"w"),new JS(qS._Str_2575,396,"x"),new JS(qS._Str_2575,440,"y"),new JS(qS._Str_2575,456,"z"),new JS(qS._Str_2575,208,"0"),new JS(qS._Str_2575,1009,"1"),new JS(qS._Str_2575,1044,"2"),new JS(qS._Str_2575,183,"3"),new JS(qS._Str_2575,254,"4"),new JS(qS._Str_2575,1024,"5"),new JS(qS._Str_2575,801,"6"),new JS(qS._Str_2575,354,"7"),new JS(qS._Str_2575,888,"8"),new JS(qS._Str_2575,926,"9")]}setMaxVisitors(e){this._maxVisitors=[];let s=t.MAX_VISITOR_STEPPER;for(;s<=e;)this._maxVisitors.push(s),s+=t.MAX_VISITOR_INCREMENTOR}setTradeSettings(){this._tradeSettings=[],this._tradeSettings.push("${navigator.roomsettings.trade_not_allowed}","${navigator.roomsettings.trade_not_with_Controller}","${navigator.roomsettings.trade_allowed}")}setRoomLayout(t){const e=this.roomLayoutControl;e&&e.setValue(t)}getRoomLayoutImageUrl(t){let e=um.instance.getConfiguration("images.url");return e+=`/navigator/models/model_${t}.png`,e}get form(){return this._form}get categories(){return this._navigatorService.categories}get layouts(){return this._layouts}get maxVisitors(){return this._maxVisitors}get tradeSettings(){return this._tradeSettings}get roomNameControl(){return this._form.controls.roomName}get roomDescControl(){return this._form.controls.roomDesc}get roomLayoutControl(){return this._form.controls.roomLayout}get roomCategoryControl(){return this._form.controls.roomCategory}get roomVisitorsControl(){return this._form.controls.roomVisitors}get roomTradeControl(){return this._form.controls.roomTrade}get isLoading(){return!1}}return t.MAX_VISITOR_STEPPER=10,t.MAX_VISITOR_INCREMENTOR=5,t.\u0275fac=function(e){return new(e||t)(i.Ub(QS),i.Ub(_.a),i.Ub(c.c))},t.\u0275cmp=i.Ob({type:t,selectors:[["","nitro-navigator-room-creator-component",""]],attrs:$S,decls:49,vars:32,consts:[[1,"d-flex","justify-content-between","align-items-center","px-3","pt-3"],[1,"m-0"],["type","button",1,"close",3,"click"],[1,"fas","fa-times"],[1,"d-flex","row","p-3"],[1,"col-7"],[1,"grid-container",2,"height","479px","min-height","479px","max-height","479px"],[1,"grid-items","grid-2"],["class","d-flex flex-column item-detail justify-content-center align-items-center",3,"click",4,"ngFor","ngForOf"],[1,"col-5"],[3,"formGroup"],[1,"form-group"],["type","text","formControlName","roomName",1,"form-control","form-control-sm"],["formControlName","roomDesc",1,"form-control","form-control-sm"],["formControlName","roomCategory",1,"form-control","form-control-sm"],[3,"value",4,"ngFor","ngForOf"],["formControlName","roomVisitors",1,"form-control","form-control-sm"],["formControlName","roomTrade",1,"form-control","form-control-sm"],[1,"d-flex","justify-content-between"],["type","button",1,"btn","btn-success",3,"disabled","click"],["type","button",1,"btn","btn-secondary",3,"click"],[1,"d-flex","flex-column","item-detail","justify-content-center","align-items-center",3,"click"],["type","button",1,"btn","btn-secondary","align-items-end","detail-info","has-image",3,"ngClass","ngStyle"],[1,"badge","badge-primary"],[3,"value"]],template:function(t,e){1&t&&(i.Zb(0,"div",0),i.Zb(1,"h6",1),i.Rc(2),i.mc(3,"translate"),i.Yb(),i.Zb(4,"button",2),i.jc("click",(function(){return e.hide()})),i.Vb(5,"i",3),i.Yb(),i.Yb(),i.Zb(6,"div",4),i.Zb(7,"div",5),i.Zb(8,"perfect-scrollbar",6),i.Zb(9,"div",7),i.Pc(10,sb,5,10,"div",8),i.Yb(),i.Yb(),i.Yb(),i.Zb(11,"div",9),i.Zb(12,"form",10),i.Zb(13,"div",11),i.Zb(14,"label"),i.Rc(15),i.mc(16,"translate"),i.Yb(),i.Vb(17,"input",12),i.Yb(),i.Zb(18,"div",11),i.Zb(19,"label"),i.Rc(20),i.mc(21,"translate"),i.Yb(),i.Vb(22,"textarea",13),i.Yb(),i.Zb(23,"div",11),i.Zb(24,"label"),i.Rc(25),i.mc(26,"translate"),i.Yb(),i.Zb(27,"select",14),i.Pc(28,ib,3,4,"option",15),i.Yb(),i.Yb(),i.Zb(29,"div",11),i.Zb(30,"label"),i.Rc(31),i.mc(32,"translate"),i.Yb(),i.Zb(33,"select",16),i.Pc(34,rb,2,2,"option",15),i.Yb(),i.Yb(),i.Zb(35,"div",11),i.Zb(36,"label"),i.Rc(37),i.mc(38,"translate"),i.Yb(),i.Zb(39,"select",17),i.Pc(40,nb,3,4,"option",15),i.mc(41,"keyvalue"),i.Yb(),i.Yb(),i.Yb(),i.Zb(42,"div",18),i.Zb(43,"button",19),i.jc("click",(function(){return e.submit()})),i.Rc(44),i.mc(45,"translate"),i.Yb(),i.Zb(46,"button",20),i.jc("click",(function(){return e.hide()})),i.Rc(47),i.mc(48,"translate"),i.Yb(),i.Yb(),i.Yb(),i.Yb()),2&t&&(i.Gb(2),i.Sc(i.nc(3,14,"navigator.createroom.title")),i.Gb(8),i.sc("ngForOf",e.layouts),i.Gb(2),i.sc("formGroup",e.form),i.Gb(3),i.Sc(i.nc(16,16,"navigator.createroom.roomnameinfo")),i.Gb(5),i.Sc(i.nc(21,18,"navigator.createroom.roomdescinfo")),i.Gb(5),i.Sc(i.nc(26,20,"navigator.category")),i.Gb(3),i.sc("ngForOf",e.categories),i.Gb(3),i.Sc(i.nc(32,22,"navigator.maxvisitors")),i.Gb(3),i.sc("ngForOf",e.maxVisitors),i.Gb(3),i.Sc(i.nc(38,24,"navigator.tradesettings")),i.Gb(3),i.sc("ngForOf",i.nc(41,26,e.tradeSettings)),i.Gb(3),i.sc("disabled",e.form.pristine||e.form.invalid),i.Gb(1),i.Sc(i.nc(45,28,"navigator.createroom.create")),i.Gb(3),i.Sc(i.nc(48,30,"generic.cancel")))},directives:[u.b,o.l,c.t,c.k,c.e,c.b,c.j,c.d,c.q,o.k,o.n,c.m,c.s],pipes:[Ep,o.g],encapsulation:2}),t})();const ob=["nitro-navigator-room-doorbell-component",""];function cb(t,e){1&t&&(i.Zb(0,"span"),i.Rc(1),i.mc(2,"translate"),i.Yb()),2&t&&(i.Gb(1),i.Sc(i.nc(2,1,"navigator.doorbell.info")))}function _b(t,e){1&t&&(i.Zb(0,"span"),i.Rc(1),i.mc(2,"translate"),i.Yb()),2&t&&(i.Gb(1),i.Sc(i.nc(2,1,"navigator.doorbell.waiting")))}function hb(t,e){1&t&&(i.Zb(0,"span"),i.Rc(1),i.mc(2,"translate"),i.Yb()),2&t&&(i.Gb(1),i.Sc(i.nc(2,1,"navigator.doorbell.no.answer")))}function lb(t,e){if(1&t){const t=i.ac();i.Zb(0,"button",10),i.jc("click",(function(){return i.Ec(t),i.lc().ring()})),i.Rc(1),i.mc(2,"translate"),i.Yb()}2&t&&(i.Gb(1),i.Sc(i.nc(2,1,"navigator.doorbell.button.ring")))}let ub=(()=>{class t{constructor(t,e){this._navigatorService=t,this._activeModal=e,this.room=null,this.isWaiting=!1,this.noAnswer=!1}ring(){!this.room||this.isWaiting||this.noAnswer||(this._navigatorService.goToRoom(this.room.roomId),this.hide())}close(){this._navigatorService.component.closeRoomDoorbell(),this.isWaiting&&um.instance.communication.connection.send(new nc)}hide(){this._activeModal.close()}}return t.\u0275fac=function(e){return new(e||t)(i.Ub(QS),i.Ub(_.a))},t.\u0275cmp=i.Ob({type:t,selectors:[["","nitro-navigator-room-doorbell-component",""]],inputs:{room:"room",isWaiting:"isWaiting",noAnswer:"noAnswer"},attrs:ob,decls:18,vars:10,consts:[[1,"modal-header"],["type","button",1,"close",3,"click"],[1,"fas","fa-times"],[1,"modal-body"],[1,"row"],[1,"col-12"],[4,"ngIf"],[1,"d-flex","justify-content-between"],["type","button",1,"btn","btn-secondary",3,"click"],["type","button","class","btn btn-primary",3,"click",4,"ngIf"],["type","button",1,"btn","btn-primary",3,"click"]],template:function(t,e){1&t&&(i.Zb(0,"div",0),i.Rc(1),i.mc(2,"translate"),i.Zb(3,"button",1),i.jc("click",(function(){return e.close()})),i.Vb(4,"i",2),i.Yb(),i.Yb(),i.Zb(5,"div",3),i.Zb(6,"div",4),i.Zb(7,"div",5),i.Pc(8,cb,3,3,"span",6),i.Pc(9,_b,3,3,"span",6),i.Pc(10,hb,3,3,"span",6),i.Yb(),i.Yb(),i.Zb(11,"div",4),i.Zb(12,"div",5),i.Zb(13,"div",7),i.Zb(14,"button",8),i.jc("click",(function(){return e.close()})),i.Rc(15),i.mc(16,"translate"),i.Yb(),i.Pc(17,lb,3,3,"button",9),i.Yb(),i.Yb(),i.Yb(),i.Yb()),2&t&&(i.Gb(1),i.Tc(" ",i.nc(2,6,"navigator.doorbell.title")," "),i.Gb(7),i.sc("ngIf",!e.isWaiting&&!e.noAnswer),i.Gb(1),i.sc("ngIf",e.isWaiting&&!e.noAnswer),i.Gb(1),i.sc("ngIf",e.noAnswer),i.Gb(5),i.Sc(i.nc(16,8,"generic.cancel")),i.Gb(2),i.sc("ngIf",!e.isWaiting&&!e.noAnswer))},directives:[o.m],pipes:[Ep],encapsulation:2}),t})();const db=["nitro-navigator-room-password-component",""];function gb(t,e){if(1&t&&(i.Zb(0,"div",12),i.Rc(1),i.Yb()),2&t){const t=i.lc();i.Gb(1),i.Sc(t.room.roomName)}}function mb(t,e){1&t&&(i.Zb(0,"div"),i.Rc(1),i.mc(2,"translate"),i.Yb()),2&t&&(i.Gb(1),i.Sc(i.nc(2,1,"navigator.password.info")))}function pb(t,e){1&t&&(i.Zb(0,"div"),i.Rc(1),i.mc(2,"translate"),i.Yb()),2&t&&(i.Gb(1),i.Sc(i.nc(2,1,"navigator.password.retryinfo")))}let Eb=(()=>{class t{constructor(t,e){this._navigatorService=t,this._activeModal=e,this.room=null,this.isWrongPassword=!1,this.password=""}tryPassword(){this.room&&this.password&&(this._navigatorService.goToRoom(this.room.roomId,this.password),this.hide())}close(){this._navigatorService.component.closeRoomPassword()}hide(){this._activeModal.close()}}return t.\u0275fac=function(e){return new(e||t)(i.Ub(QS),i.Ub(_.a))},t.\u0275cmp=i.Ob({type:t,selectors:[["","nitro-navigator-room-password-component",""]],inputs:{room:"room",isWrongPassword:"isWrongPassword"},attrs:db,decls:25,vars:16,consts:[[1,"modal-header"],["type","button",1,"close",3,"click"],[1,"modal-body"],[1,"row"],[1,"col-12"],["class","font-weight-bold",4,"ngIf"],[4,"ngIf"],[1,"form-group"],["autocomplete","new-password","type","password","placeholder","*****",1,"form-control","form-control-sm",3,"ngModel","ngModelChange"],[1,"d-flex","justify-content-between"],["type","button",1,"btn","btn-secondary",3,"click"],["type","button",1,"btn","btn-primary",3,"click"],[1,"font-weight-bold"]],template:function(t,e){1&t&&(i.Zb(0,"div",0),i.Rc(1),i.mc(2,"translate"),i.Zb(3,"button",1),i.jc("click",(function(){return e.close()})),i.Yb(),i.Yb(),i.Zb(4,"div",2),i.Zb(5,"div",3),i.Zb(6,"div",4),i.Pc(7,gb,2,1,"div",5),i.Pc(8,mb,3,3,"div",6),i.Pc(9,pb,3,3,"div",6),i.Vb(10,"br"),i.Zb(11,"div",7),i.Zb(12,"label"),i.Rc(13),i.mc(14,"translate"),i.Yb(),i.Zb(15,"input",8),i.jc("ngModelChange",(function(t){return e.password=t})),i.Yb(),i.Yb(),i.Yb(),i.Yb(),i.Zb(16,"div",3),i.Zb(17,"div",4),i.Zb(18,"div",9),i.Zb(19,"button",10),i.jc("click",(function(){return e.close()})),i.Rc(20),i.mc(21,"translate"),i.Yb(),i.Zb(22,"button",11),i.jc("click",(function(){return e.tryPassword()})),i.Rc(23),i.mc(24,"translate"),i.Yb(),i.Yb(),i.Yb(),i.Yb(),i.Yb()),2&t&&(i.Gb(1),i.Tc(" ",i.nc(2,8,"navigator.password.title")," "),i.Gb(6),i.sc("ngIf",e.room),i.Gb(1),i.sc("ngIf",!e.isWrongPassword),i.Gb(1),i.sc("ngIf",e.isWrongPassword),i.Gb(4),i.Sc(i.nc(14,10,"navigator.password.enter")),i.Gb(2),i.sc("ngModel",e.password),i.Gb(5),i.Sc(i.nc(21,12,"generic.cancel")),i.Gb(3),i.Sc(i.nc(24,14,"navigator.password.button.try")))},directives:[o.m,c.b,c.j,c.l],pipes:[Ep],encapsulation:2}),t})();const fb=function(t){return{active:t}};function Sb(t,e){if(1&t){const t=i.ac();i.Zb(0,"button",15),i.jc("click",(function(){i.Ec(t);const s=e.$implicit;return i.lc(2).setCurrentContext(s)})),i.Rc(1),i.mc(2,"translate"),i.Yb()}if(2&t){const t=e.$implicit,s=i.lc(2);i.sc("ngClass",i.vc(4,fb,s.topLevelContext===t)),i.Gb(1),i.Sc(i.nc(2,2,"navigator.toplevelview."+t.code))}}function bb(t,e){1&t&&i.Vb(0,"div",16),2&t&&i.sc("result",e.$implicit)}function Rb(t,e){1&t&&i.Vb(0,"div",17)}function Ib(t,e){if(1&t){const t=i.ac();i.Zb(0,"div",1),i.Zb(1,"div",2),i.Zb(2,"h6",3),i.Rc(3),i.mc(4,"translate"),i.Yb(),i.Zb(5,"button",4),i.jc("click",(function(){return i.Ec(t),i.lc().hide()})),i.Vb(6,"i",5),i.Yb(),i.Yb(),i.Zb(7,"div",6),i.Zb(8,"div",7),i.Pc(9,Sb,3,6,"button",8),i.Zb(10,"button",9),i.jc("click",(function(){return i.Ec(t),i.lc().openRoomCreator()})),i.Vb(11,"i",10),i.Yb(),i.Yb(),i.Vb(12,"div",11),i.Zb(13,"perfect-scrollbar",12),i.Pc(14,bb,1,1,"div",13),i.Yb(),i.Pc(15,Rb,1,0,"div",14),i.Yb(),i.Yb()}if(2&t){const t=i.lc();i.Gb(3),i.Sc(i.nc(4,4,t.isLoading?"navigator.title.is.busy":"navigator.title")),i.Gb(6),i.sc("ngForOf",t.topLevelContexts),i.Gb(5),i.sc("ngForOf",t.lastSearchResults),i.Gb(1),i.sc("ngIf",t.sliderVisible)}}let vb=(()=>{class t{constructor(t,e,s){this._settingsService=t,this._navigatorService=e,this._modalService=s,this.visible=!1}ngOnInit(){this._navigatorService.component=this}ngOnChanges(t){const e=t.visible.currentValue;e&&e!==t.visible.previousValue&&this.prepareNavigator()}ngOnDestroy(){this._roomCreatorModal&&this._roomCreatorModal.close(),this._navigatorService.component=null}prepareNavigator(){this._navigatorService.isLoaded?this._navigatorService.search():this._navigatorService.loadNavigator()}setCurrentContext(t){this._navigatorService.setCurrentContext(t),this._navigatorService.clearSearch()}hide(){this._settingsService.hideNavigator()}openRoomCreator(){this._roomCreatorModal||(this._roomCreatorModal=this._modalService.open(ab,{backdrop:"static",size:"lg",centered:!0,keyboard:!1}),this._roomCreatorModal&&this._roomCreatorModal.result.then(()=>this._roomCreatorModal=null))}openRoomDoorbell(t,e=!1,s=!1){this._roomPasswordModal&&this._roomPasswordModal.close(),t||(t=this._lastRoom),this._lastRoom=t;let i=this._roomDoorbellModal;if(i||(i=this._roomDoorbellModal=this._modalService.open(ub,{backdrop:"static",size:"sm",centered:!0,keyboard:!1}),i.result.then(()=>this._roomDoorbellModal=null)),this._roomDoorbellModal=i,this._roomDoorbellModal){const r=i.componentInstance;r&&(r.room=t,r.isWaiting=e,r.noAnswer=s)}}closeRoomDoorbell(){this._roomDoorbellModal&&(this._roomDoorbellModal.close(),this._lastRoom=null)}openRoomPassword(t,e=!1){this._roomDoorbellModal&&this._roomDoorbellModal.close(),t||(t=this._lastRoom),this._lastRoom=t;let s=this._roomPasswordModal;if(s||(s=this._roomPasswordModal=this._modalService.open(Eb,{backdrop:"static",size:"sm",centered:!0,keyboard:!1}),s.result.then(()=>this._roomPasswordModal=null)),this._roomPasswordModal=s,this._roomPasswordModal){const i=s.componentInstance;if(!i)return;i.room=t,i.isWrongPassword=e}}closeRoomPassword(){this._roomPasswordModal&&(this._roomPasswordModal.close(),this._lastRoom=null)}get topLevelContext(){return this._navigatorService&&this._navigatorService.topLevelContext||null}get topLevelContexts(){return this._navigatorService&&this._navigatorService.topLevelContexts||null}get lastSearchResults(){return this._navigatorService.lastSearchResults}get isLoading(){return this._navigatorService&&(this._navigatorService.isLoading||this._navigatorService.isSearching)}get sliderVisible(){return um.instance.core.configuration.getValue("navigator.slider.enabled")}}return t.\u0275fac=function(e){return new(e||t)(i.Ub(gm),i.Ub(QS),i.Ub(_.g))},t.\u0275cmp=i.Ob({type:t,selectors:[["nitro-navigator-main-component"]],inputs:{visible:"visible"},features:[i.Eb],decls:1,vars:1,consts:[["class","nitro-navigator card",3,"bringToTop","draggable",4,"ngIf"],[1,"nitro-navigator","card",3,"bringToTop","draggable"],[1,"drag-handler","d-flex","justify-content-between","align-items-center","px-3","pt-3"],[1,"m-0"],["type","button",1,"close",3,"click"],[1,"fas","fa-times"],[1,"d-flex","flex-column","p-3"],[1,"btn-group","w-100","mb-2"],["type","button","class","btn btn-secondary",3,"ngClass","click",4,"ngFor","ngForOf"],["type","button",1,"btn","btn-secondary",3,"click"],[1,"fas","fa-plus"],["nitro-navigator-search-component",""],[1,"results-container","position-relative","w-100","pr-1",2,"min-height","350px","max-height","350px","height","350px"],["class","mb-1","nitro-navigator-search-result-component","",3,"result",4,"ngFor","ngForOf"],["nitro-navigator-slider-component","",4,"ngIf"],["type","button",1,"btn","btn-secondary",3,"ngClass","click"],["nitro-navigator-search-result-component","",1,"mb-1",3,"result"],["nitro-navigator-slider-component",""]],template:function(t,e){1&t&&i.Pc(0,Ib,16,6,"div",0),2&t&&i.sc("ngIf",e.visible)},encapsulation:2}),t})();const Tb=["nitro-navigator-search-component",""];function Ob(t,e){if(1&t){const t=i.ac();i.Zb(0,"button",6),i.jc("click",(function(){i.Ec(t);const s=e.$implicit;return i.lc().changeFilter(s)})),i.Rc(1),i.mc(2,"translate"),i.Yb()}if(2&t){const t=e.$implicit;i.Gb(1),i.Sc(i.nc(2,1,"navigator.filter."+t.name))}}let Ab=(()=>{class t{constructor(t,e){this._formBuilder=t,this._navigatorService=e}ngOnInit(){this._form=this._formBuilder.group({search:[""]})}changeFilter(t){this._navigatorService.setCurrentFilter(t)}search(t){this._navigatorService.search(this.searchValue)}clearSearch(){}get form(){return this._form}get searchValue(){return this._navigatorService.lastSearch}set searchValue(t){this._navigatorService.lastSearch=t}get currentFilter(){return this._navigatorService.filter}get searchFilters(){return QS.SEARCH_FILTERS}get hasSearchResults(){return this._navigatorService.lastSearchResults&&this._navigatorService.lastSearchResults.length>0}}return t.\u0275fac=function(e){return new(e||t)(i.Ub(c.c),i.Ub(QS))},t.\u0275cmp=i.Ob({type:t,selectors:[["","nitro-navigator-search-component",""]],attrs:Tb,decls:9,vars:8,consts:[[1,"input-group","mb-2"],["ngbDropdown","",1,"input-group-prepend"],["type","button","ngbDropdownToggle","",1,"btn","btn-secondary"],["ngbDropdownMenu","",1,"dropdown-menu"],["class","dropdown-item","ngbDropdownItem","",3,"click",4,"ngFor","ngForOf"],["type","text",1,"form-control",3,"ngModel","placeholder","ngModelChange","keydown.enter"],["ngbDropdownItem","",1,"dropdown-item",3,"click"]],template:function(t,e){1&t&&(i.Zb(0,"div",0),i.Zb(1,"div",1),i.Zb(2,"button",2),i.Rc(3),i.mc(4,"translate"),i.Yb(),i.Zb(5,"div",3),i.Pc(6,Ob,3,3,"button",4),i.Yb(),i.Yb(),i.Zb(7,"input",5),i.jc("ngModelChange",(function(t){return e.searchValue=t}))("keydown.enter",(function(t){return e.search(t)})),i.mc(8,"translate"),i.Yb(),i.Yb()),2&t&&(i.Gb(3),i.Sc(i.nc(4,4,"navigator.filter."+e.currentFilter.name)),i.Gb(3),i.sc("ngForOf",e.searchFilters),i.Gb(1),i.sc("ngModel",e.searchValue)("placeholder",i.nc(8,6,"navigator.filter.input.placeholder")))},directives:[_.b,_.f,_.d,o.l,c.b,c.j,c.l,_.c],pipes:[Ep],encapsulation:2}),t})(),yb=(()=>{class t{}return t.LIST=0,t.THUMBNAILS=1,t.FORCED_THUMBNAILS=2,t})();const Cb=["nitro-navigator-search-result-item-component",""];function Mb(t,e){1&t&&i.Vb(0,"i",13)}function Db(t,e){1&t&&i.Vb(0,"i",14)}function Nb(t,e){1&t&&i.Vb(0,"i",15)}function wb(t,e){if(1&t&&(i.Xb(0),i.Pc(1,Mb,1,0,"i",10),i.Pc(2,Db,1,0,"i",11),i.Pc(3,Nb,1,0,"i",12),i.Wb()),2&t){const t=i.lc();i.Gb(1),i.sc("ngIf",t.isGroup),i.Gb(1),i.sc("ngIf",t.isDoorbell),i.Gb(1),i.sc("ngIf",t.isPassword)}}function Ub(t,e){if(1&t&&(i.Zb(0,"span",17),i.Vb(1,"i",3),i.Rc(2),i.Yb()),2&t){const t=i.lc(2);i.Gb(2),i.Sc(t.room.ownerName)}}function Lb(t,e){if(1&t&&(i.Zb(0,"div",16),i.Zb(1,"span",17),i.Rc(2),i.Yb(),i.Zb(3,"span",18),i.Rc(4),i.Yb(),i.Pc(5,Ub,3,1,"span",19),i.Yb()),2&t){const t=i.lc();i.Gb(2),i.Sc(t.room.roomName),i.Gb(2),i.Tc('"',t.room.description,'"'),i.Gb(1),i.sc("ngIf",null!=t.room.ownerName)}}let Pb=(()=>{class t{constructor(t,e){this._navigatorService=t,this._ngZone=e,this._thumbnailUrl=null,this._didRequestUrl=!1}visit(){if(this.room.ownerId!==um.instance.sessionDataManager.userId){if(0!==this.room.habboGroupId)return void this._navigatorService.goToPrivateRoom(this.room.roomId);switch(this.room.doorMode){case Dr.DOORBELL_STATE:return void this._navigatorService.openRoomDoorbell(this.room);case Dr.PASSWORD_STATE:return void this._navigatorService.openRoomPassword(this.room)}}this._navigatorService.goToRoom(this.room.roomId)}get isGroup(){return this.room&&this.room.habboGroupId>0}get isDoorbell(){return this.room&&this.room.doorMode===Dr.DOORBELL_STATE}get isPassword(){return this.room&&this.room.doorMode===Dr.PASSWORD_STATE}get thumbnail(){if(this._thumbnailUrl)return this._thumbnailUrl;if(!this.room||this._didRequestUrl)return null;let t=um.instance.core.configuration.getValue("thumbnails.url");t=t.replace("%thumbnail%",this.room.roomId.toString());const e=new XMLHttpRequest;return e.open("GET",t,!0),e.onreadystatechange=()=>{4===e.readyState&&200===e.status&&(this._thumbnailUrl=t)},e.send(),this._didRequestUrl=!0,null}get entryBg(){const t=this.room.userCount/this.room.maxUserCount*100;let e="badge-secondary";return t>=92?e="badge-danger":t>=50?e="badge-warning text-white":t>0&&(e="badge-success"),e}}return t.\u0275fac=function(e){return new(e||t)(i.Ub(QS),i.Ub(i.E))},t.\u0275cmp=i.Ob({type:t,selectors:[["","nitro-navigator-search-result-item-component",""]],inputs:{room:"room",displayMode:"displayMode"},attrs:Cb,decls:13,vars:5,consts:[["type","button",1,"btn","btn-secondary","justify-content-between","detail-info",3,"click"],[1,"d-flex","justify-content-center","flex-grow-1","overflow-hidden"],[1,"d-flex","justify-content-center","align-items-center","badge","badge-secondary","text-center",3,"ngClass"],[1,"fas","fa-user","mr-1"],[1,"d-flex","flex-column","justify-content-center","align-items-start","flex-grow-1","px-2","overflow-hidden"],[1,"d-block","text-truncate",2,"max-width","95%"],[1,"d-flex","flex-row-reverse","align-items-center"],["tooltipClass","search-result-item-tooltip","placement","right","container","body",1,"fas","fa-info-circle",3,"ngbTooltip"],[4,"ngIf"],["roomInfoTooltip",""],["class","fas fa-users mr-2",4,"ngIf"],["class","fas fa-lock mr-2",4,"ngIf"],["class","fas fa-key mr-2",4,"ngIf"],[1,"fas","fa-users","mr-2"],[1,"fas","fa-lock","mr-2"],[1,"fas","fa-key","mr-2"],[1,"container"],[1,"d-block"],[1,"d-block","small","text-muted"],["class","d-block",4,"ngIf"]],template:function(t,e){if(1&t&&(i.Zb(0,"button",0),i.jc("click",(function(){return e.visit()})),i.Zb(1,"div",1),i.Zb(2,"div",2),i.Vb(3,"i",3),i.Rc(4),i.Yb(),i.Zb(5,"div",4),i.Zb(6,"span",5),i.Rc(7),i.Yb(),i.Yb(),i.Yb(),i.Zb(8,"div",6),i.Vb(9,"i",7),i.Pc(10,wb,4,3,"ng-container",8),i.Yb(),i.Pc(11,Lb,6,3,"ng-template",null,9,i.Qc),i.Yb()),2&t){const t=i.Bc(12);i.Gb(2),i.sc("ngClass",e.entryBg),i.Gb(2),i.Sc(e.room.userCount),i.Gb(3),i.Sc(e.room.roomName),i.Gb(2),i.sc("ngbTooltip",t),i.Gb(1),i.sc("ngIf",0===e.displayMode)}},directives:[o.k,_.i,o.m],encapsulation:2}),t})();const xb=["nitro-navigator-search-result-component",""],Fb=function(t,e){return{"fa-bars":t,"fa-th":e}};function Gb(t,e){if(1&t){const t=i.ac();i.Zb(0,"h6",1),i.jc("click",(function(){return i.Ec(t),i.lc().toggleListMode()})),i.Vb(1,"i",2),i.Yb()}if(2&t){const t=i.lc();i.Gb(1),i.sc("ngClass",i.wc(1,Fb,1===t.displayMode,0===t.displayMode))}}const Vb=function(t){return{"tall-detail":t}};function Yb(t,e){if(1&t&&i.Vb(0,"div",8),2&t){const t=e.$implicit,s=i.lc(2);i.sc("room",t)("displayMode",s.displayMode)("ngClass",i.vc(3,Vb,s.displayMode>=1))}}const kb=function(t,e){return{"grid-2":t,"grid-1":e}};function jb(t,e){if(1&t&&(i.Zb(0,"div",5),i.Zb(1,"div",6),i.Pc(2,Yb,1,5,"div",7),i.Yb(),i.Yb()),2&t){const t=i.lc();i.Gb(1),i.sc("ngClass",i.wc(2,kb,t.displayMode>=1,0===t.displayMode)),i.Gb(1),i.sc("ngForOf",t.result.rooms)}}const Bb=function(t,e){return{"fa-minus":t,"fa-plus":e}};let Hb=(()=>{class t{ngOnInit(){this._displayMode=this.result.mode,this._isCollapsed=this.result.closed}toggleListMode(){this._displayMode!==yb.FORCED_THUMBNAILS&&(this._displayMode=this._displayMode!==yb.LIST?yb.LIST:yb.THUMBNAILS)}toggleCollapsed(){this._isCollapsed=!this._isCollapsed}get resultCode(){let t=this.result.code;return t=this.result.code.startsWith("${")?t.substr(2,t.length-3):"navigator.searchcode.title."+t,t}get displayMode(){return this._displayMode}get isCollapsed(){return!this._isCollapsed}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275cmp=i.Ob({type:t,selectors:[["","nitro-navigator-search-result-component",""]],inputs:{result:"result"},attrs:xb,decls:7,vars:9,consts:[[1,"d-flex","justify-content-between","align-items-center","px-3","pt-3"],[1,"m-0",3,"click"],[1,"fas",3,"ngClass"],["class","m-0",3,"click",4,"ngIf"],["class","d-flex flex-column pt-3 grid-container",4,"ngIf"],[1,"d-flex","flex-column","pt-3","grid-container"],[1,"grid-items",3,"ngClass"],["nitro-navigator-search-result-item-component","","class","d-flex flex-column item-detail justify-content-center align-items-center",3,"room","displayMode","ngClass",4,"ngFor","ngForOf"],["nitro-navigator-search-result-item-component","",1,"d-flex","flex-column","item-detail","justify-content-center","align-items-center",3,"room","displayMode","ngClass"]],template:function(t,e){1&t&&(i.Zb(0,"div",0),i.Zb(1,"h6",1),i.jc("click",(function(){return e.toggleCollapsed()})),i.Vb(2,"i",2),i.Rc(3),i.mc(4,"translate"),i.Yb(),i.Pc(5,Gb,2,4,"h6",3),i.Yb(),i.Pc(6,jb,3,5,"div",4)),2&t&&(i.Gb(2),i.sc("ngClass",i.wc(6,Bb,e.isCollapsed,!e.isCollapsed)),i.Gb(1),i.Tc(" ",i.nc(4,4,e.resultCode)," "),i.Gb(2),i.sc("ngIf",2!==e.displayMode),i.Gb(1),i.sc("ngIf",e.isCollapsed&&e.result.rooms.length>0))},directives:[o.k,o.m,o.l,Pb],pipes:[Ep],encapsulation:2}),t})();const Wb=["nitro-navigator-slider-component",""];function Zb(t,e){if(1&t){const t=i.ac();i.Zb(0,"mdb-carousel-item"),i.Zb(1,"div",3),i.jc("click",(function(){i.Ec(t);const s=e.$implicit;return i.lc().visit(s.roomId)})),i.Zb(2,"div",4),i.Rc(3),i.Yb(),i.Yb(),i.Zb(4,"img",5),i.jc("click",(function(){return e.$implicit.roomId})),i.Yb(),i.Yb()}if(2&t){const t=e.$implicit;i.Gb(1),i.Lc("background:url("+t.image+")"),i.Gb(2),i.Sc(t.title),i.Gb(1),i.sc("src",t.image,i.Gc)}}let zb=(()=>{class t{constructor(t,e){this._navigatorService=t,this._ngZone=e}ngOnInit(){this._sliderContent=um.instance.core.configuration.getValue("navigator.slider.content")}visit(t){this._navigatorService.goToPrivateRoom(t)}get sliderContent(){return this._sliderContent}}return t.\u0275fac=function(e){return new(e||t)(i.Ub(QS),i.Ub(i.E))},t.\u0275cmp=i.Ob({type:t,selectors:[["","nitro-navigator-slider-component",""]],attrs:Wb,decls:3,vars:4,consts:[[1,"w-100","card","nitro-navigator-slider-component","mt-2","d-flex","flex-column"],[3,"isControls","animation"],[4,"ngFor","ngForOf"],[1,"nitro-navigator-slider-image-component","py-2","px-0","h-100",3,"click"],[1,"johnsshitblackbar","p-1","small"],[1,"d-block","w-100",3,"src","click"]],template:function(t,e){1&t&&(i.Zb(0,"div",0),i.Zb(1,"mdb-carousel",1),i.Pc(2,Zb,5,4,"mdb-carousel-item",2),i.Yb(),i.Yb()),2&t&&(i.Gb(1),i.sc("isControls",!1)("animation","slide")("isControls",!0),i.Gb(1),i.sc("ngForOf",e.sliderContent))},directives:[h.a,o.l,h.c],encapsulation:2}),t})(),Xb=(()=>{class t{}return t.\u0275mod=i.Sb({type:t}),t.\u0275inj=i.Rb({factory:function(e){return new(e||t)},providers:[QS],imports:[[p]]}),t})();i.Hc(vb,[o.m,op,dp,o.l,o.k,Ab,u.b,Hb,zb],[Ep]);let Kb=(()=>{class t{}return t.\u0275mod=i.Sb({type:t}),t.\u0275inj=i.Rb({factory:function(e){return new(e||t)},providers:[Nm],imports:[[p]]}),t})(),qb=(()=>{class t{}return t.\u0275mod=i.Sb({type:t}),t.\u0275inj=i.Rb({factory:function(e){return new(e||t)},providers:[ME],imports:[[p]]}),t})(),Jb=(()=>{class t{}return t.\u0275mod=i.Sb({type:t}),t.\u0275inj=i.Rb({factory:function(e){return new(e||t)},imports:[[p]]}),t})(),Qb=(()=>{class t{}return t.\u0275mod=i.Sb({type:t}),t.\u0275inj=i.Rb({factory:function(e){return new(e||t)},providers:[],imports:[[p]]}),t})();var $b=s("qoEl");class tR extends A.e{constructor(t,e){super("\nattribute vec2 aVertexPosition;\nattribute vec2 aTextureCoord;\nuniform mat3 projectionMatrix;\nvarying vec2 vTextureCoord;\nvoid main(void)\n{\n    gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);\n    vTextureCoord = aTextureCoord;\n}","\nvarying vec2 vTextureCoord;\nuniform sampler2D uSampler;\nuniform vec3 lineColor;\nuniform vec3 color;\nvoid main(void) {\n    vec4 currentColor = texture2D(uSampler, vTextureCoord);\n    vec3 colorLine = lineColor * currentColor.a;\n    vec3 colorOverlay = color * currentColor.a;\n\n    if(currentColor.r == 0.0 && currentColor.g == 0.0 && currentColor.b == 0.0 && currentColor.a > 0.0) {\n        gl_FragColor = vec4(colorLine.r, colorLine.g, colorLine.b, currentColor.a);\n    } else if(currentColor.a > 0.0) {\n        gl_FragColor = vec4(colorOverlay.r, colorOverlay.g, colorOverlay.b, currentColor.a);\n    }\n}"),this.uniforms.lineColor=new Float32Array(3),this.uniforms.color=new Float32Array(3),this.lineColor=t,this.color=e}get lineColor(){return this._lineColor}set lineColor(t){const e=this.uniforms.lineColor;"number"==typeof t?(Object($b.l)(t,e),this._lineColor=t):(e[0]=t[0],e[1]=t[1],e[2]=t[2],this._lineColor=Object($b.x)(e))}get color(){return this._color}set color(t){const e=this.uniforms.color;"number"==typeof t?(Object($b.l)(t,e),this._color=t):(e[0]=t[0],e[1]=t[1],e[2]=t[2],this._color=Object($b.x)(e))}}class eR{constructor(t){this._component=t;const e=new tR([1,1,1],[.6,.6,.6]);this._selectionShader=e}show(t){this.applySelectionShader(this.getRoomObject(t))}hide(t){this.clearSelectionShader(this.getRoomObject(t))}clearSelectionShaderFromFurni(t){for(const e of t)this.clearSelectionShader(this.getRoomObject(e))}applySelectionShaderToFurni(t){for(const e of t)this.applySelectionShader(this.getRoomObject(e))}getRoomObject(t){return this._component?um.instance.roomEngine.getRoomObject(this._component.roomId,t,tt.FLOOR):null}applySelectionShader(t){if(!t)return;const e=t.visualization;if(e)for(const s of e.sprites)s.blendMode!==A.b.ADD&&(s.filters=[this._selectionShader])}clearSelectionShader(t){if(!t)return;const e=t.visualization;if(e)for(const s of e.sprites)s.filters=[]}}let sR=(()=>{class t{constructor(t,e){this._settingsService=t,this._ngZone=e,this._messages=[],this._component=null,this._roomSession=null,this.onRoomSessionEvent=this.onRoomSessionEvent.bind(this),this.registerMessages()}ngOnDestroy(){this.unregisterMessages()}registerMessages(){this._ngZone.runOutsideAngular(()=>{um.instance.roomSessionManager.events.addEventListener(Fe.CREATED,this.onRoomSessionEvent),um.instance.roomSessionManager.events.addEventListener(Fe.STARTED,this.onRoomSessionEvent),um.instance.roomSessionManager.events.addEventListener(Fe.ENDED,this.onRoomSessionEvent),this._messages=[new po(this.onWiredFurniActionEvent.bind(this)),new So(this.onWiredFurniConditionEvent.bind(this)),new Io(this.onWiredFurniTriggerEvent.bind(this)),new To(this.onWiredOpenEvent.bind(this)),new Ao(this.onWiredRewardResultMessageEvent.bind(this)),new Co(this.onWiredSaveSuccessEvent.bind(this)),new Do(this.onWiredValidationErrorEvent.bind(this)),new Es(this.onDesktopViewEvent.bind(this))];for(const t of this._messages)um.instance.communication.registerMessageEvent(t)})}unregisterMessages(){this._ngZone.runOutsideAngular(()=>{um.instance.roomSessionManager.events.removeEventListener(Fe.CREATED,this.onRoomSessionEvent),um.instance.roomSessionManager.events.removeEventListener(Fe.STARTED,this.onRoomSessionEvent),um.instance.roomSessionManager.events.removeEventListener(Fe.ENDED,this.onRoomSessionEvent);for(const t of this._messages)um.instance.communication.removeMessageEvent(t);this._messages=[]})}onRoomSessionEvent(t){if(t)switch(t.type){case Fe.CREATED:case Fe.STARTED:return void(this._roomSession=t.session);case Fe.ENDED:return this._roomSession=null,void this._ngZone.run(()=>this._component&&this._component.close())}}onWiredFurniActionEvent(t){if(!t)return;const e=t.getParser();e&&this._ngZone.run(()=>this._component.setupTrigger(e.definition))}onWiredFurniConditionEvent(t){if(!t)return;const e=t.getParser();e&&this._ngZone.run(()=>this._component.setupTrigger(e.definition))}onWiredFurniTriggerEvent(t){if(!t||!this._component)return;const e=t.getParser();e&&this._ngZone.run(()=>this._component.setupTrigger(e.definition))}onWiredOpenEvent(t){if(!t)return;const e=t.getParser();e&&console.log(e)}onWiredRewardResultMessageEvent(t){if(!t)return;const e=t.getParser();e&&console.log(e)}onWiredSaveSuccessEvent(t){t&&t.getParser()&&this._ngZone.run(()=>this._component&&this._component.close())}onWiredValidationErrorEvent(t){if(!t)return;const e=t.getParser();e&&console.log(e)}onDesktopViewEvent(t){t&&this._ngZone.run(()=>this._component&&this._component.close())}selectFurniture(t,e){const s=um.instance.roomEngine,i=s.getSelectedRoomObjectData(this.roomId);i&&i.id===-t?s.setPlacedRoomObjectData(this.roomId,null):this._component&&this._component.toggleFurniSelected(t,e)}get component(){return this._component}set component(t){this._component=t}get roomId(){return this._roomSession?this._roomSession.roomId:0}}return t.\u0275fac=function(e){return new(e||t)(i.gc(gm),i.gc(i.E))},t.\u0275prov=i.Qb({token:t,factory:t.\u0275fac}),t})(),iR=(()=>{class t{constructor(t,e){this._wiredService=t,this._formBuilder=e}get code(){return-1}get negativeCode(){return-1}get requiresFurni(){return Iv._Str_5431}get hasStateSnapshot(){return!1}readIntegerParamsFromForm(){return[]}readStringParamFromForm(){return""}onInitStart(){}onEditStart(t){}get hasSpecialInputs(){return!1}validate(){return null}static getLocaleName(t){const e=Math.floor(t/2);return t%2?(e+.5).toString():e.toString()}}return t.\u0275fac=function(e){return new(e||t)(i.Ub(sR),i.Ub(c.c))},t.\u0275dir=i.Pb({type:t}),t})(),rR=(()=>{class t extends iR{constructor(){super(...arguments),this.updateCount=0,this.delay=0}onEditStart(t){this.delay=t.delayInPulses,this.updateLocaleParameter()}onSliderChange(){this.updateLocaleParameter()}decreaseDelay(){this.delay-=1,this.delay<t.DELAY_MINIMUM_VALUE&&(this.delay=t.DELAY_MINIMUM_VALUE)}increaseDelay(){this.delay+=1,this.delay>t.DELAY_MAXIMUM_VALUE&&(this.delay=t.DELAY_MAXIMUM_VALUE)}updateLocaleParameter(){um.instance.localization.registerParameter("wiredfurni.params.delay","seconds",iR.getLocaleName(this.delay)),this.updateCount++}get delaySliderOptions(){return{floor:t.DELAY_MINIMUM_VALUE,ceil:t.DELAY_MAXIMUM_VALUE,step:t.DELAY_STEPPER_VALUE,hidePointerLabels:!0,hideLimitLabels:!0}}}return t.DELAY_MINIMUM_VALUE=0,t.DELAY_MAXIMUM_VALUE=20,t.DELAY_STEPPER_VALUE=1,t})();class nR extends iR{constructor(){super(...arguments),this.updateCount=0}}let aR=(()=>{class t{}return t.STATES_MATCH=0,t.FURNIS_HAVE_AVATARS=1,t.TRIGGERER_IS_ON_FURNI=2,t.TIME_ELAPSED_MORE=3,t.TIME_ELAPSED_LESS=4,t.USER_COUNT_IN=5,t.ACTOR_IS_IN_TEAM=6,t.HAS_STACKED_FURNIS=7,t.STUFF_TYPE_MATCHES=8,t.STUFFS_IN_FORMATION=9,t.ACTOR_IS_GROUP_MEMBER=10,t.ACTOR_IS_WEARING_BADGE=11,t.ACTOR_IS_WEARING_EFFECT=12,t.NOT_STATES_MATCH=13,t.FURNI_NOT_HAVE_HABBO=14,t.NOT_ACTOR_ON_FURNI=15,t.NOT_USER_COUNT_IN=16,t.NOT_ACTOR_IN_TEAM=17,t.NOT_HAS_STACKED_FURNIS=18,t.NOT_FURNI_IS_OF_TYPE=19,t.NOT_STUFFS_IN_FORMATION=20,t.NOT_ACTOR_IN_GROUP=21,t.NOT_ACTOR_WEARS_BADGE=22,t.NOT_ACTOR_WEARING_EFFECT=23,t.DATE_RANGE_ACTIVE=24,t.ACTOR_HAS_HANDITEM=25,t})(),oR=(()=>{class t extends nR{constructor(){super(...arguments),this.allowedHanditemIds=["2","5","7","8","9","10","27"],this.handitemId="0"}get code(){return t.CODE}onEditStart(t){this.handitemId=t.intData.length>0&&this.allowedHanditemIds.includes(t.intData[0].toString())?t.intData[0].toString():"0"}readIntegerParamsFromForm(){return[Number.parseInt(this.handitemId)]}get hasSpecialInputs(){return!0}}return t.CODE=aR.ACTOR_HAS_HANDITEM,t.\u0275fac=function(e){return cR(e||t)},t.\u0275cmp=i.Ob({type:t,selectors:[["ng-component"]],features:[i.Db],decls:30,vars:36,consts:[[1,"form-group"],[1,"form-control","form-control-sm",3,"ngModel","ngModelChange"],["value","0",3,"selected"],["value","2",3,"selected"],["value","5",3,"selected"],["value","7",3,"selected"],["value","8",3,"selected"],["value","9",3,"selected"],["value","10",3,"selected"],["value","27",3,"selected"]],template:function(t,e){1&t&&(i.Zb(0,"nitro-wired-base-component"),i.Zb(1,"div",0),i.Zb(2,"label"),i.Rc(3),i.mc(4,"translate"),i.Yb(),i.Zb(5,"select",1),i.jc("ngModelChange",(function(t){return e.handitemId=t})),i.Zb(6,"option",2),i.Rc(7),i.mc(8,"translate"),i.Yb(),i.Zb(9,"option",3),i.Rc(10),i.mc(11,"translate"),i.Yb(),i.Zb(12,"option",4),i.Rc(13),i.mc(14,"translate"),i.Yb(),i.Zb(15,"option",5),i.Rc(16),i.mc(17,"translate"),i.Yb(),i.Zb(18,"option",6),i.Rc(19),i.mc(20,"translate"),i.Yb(),i.Zb(21,"option",7),i.Rc(22),i.mc(23,"translate"),i.Yb(),i.Zb(24,"option",8),i.Rc(25),i.mc(26,"translate"),i.Yb(),i.Zb(27,"option",9),i.Rc(28),i.mc(29,"translate"),i.Yb(),i.Yb(),i.Yb(),i.Yb()),2&t&&(i.Gb(3),i.Sc(i.nc(4,18,"wiredfurni.params.handitem")),i.Gb(2),i.sc("ngModel",e.handitemId),i.Gb(1),i.sc("selected","0"==e.handitemId),i.Gb(1),i.Sc(i.nc(8,20,"wiredfurni.tooltip.handitem")),i.Gb(2),i.sc("selected","2"==e.handitemId),i.Gb(1),i.Sc(i.nc(11,22,"handitem2")),i.Gb(2),i.sc("selected","5"==e.handitemId),i.Gb(1),i.Sc(i.nc(14,24,"handitem5")),i.Gb(2),i.sc("selected","7"==e.handitemId),i.Gb(1),i.Sc(i.nc(17,26,"handitem7")),i.Gb(2),i.sc("selected","8"==e.handitemId),i.Gb(1),i.Sc(i.nc(20,28,"handitem8")),i.Gb(2),i.sc("selected","9"==e.handitemId),i.Gb(1),i.Sc(i.nc(23,30,"handitem9")),i.Gb(2),i.sc("selected","10"==e.handitemId),i.Gb(1),i.Sc(i.nc(26,32,"handitem10")),i.Gb(2),i.sc("selected","27"==e.handitemId),i.Gb(1),i.Sc(i.nc(29,34,"handitem27")))},encapsulation:2}),t})();const cR=i.bc(oR);let _R=(()=>{class t extends nR{get code(){return t.CODE}get negativeCode(){return t.NEGATIVE_CODE}}return t.CODE=aR.ACTOR_IS_GROUP_MEMBER,t.NEGATIVE_CODE=aR.NOT_ACTOR_IN_GROUP,t.\u0275fac=function(e){return hR(e||t)},t.\u0275cmp=i.Ob({type:t,selectors:[["ng-component"]],features:[i.Db],decls:1,vars:0,template:function(t,e){1&t&&i.Vb(0,"nitro-wired-base-component")},encapsulation:2}),t})();const hR=i.bc(_R);let lR=(()=>{class t extends nR{constructor(){super(...arguments),this.team="1"}get code(){return t.CODE}get negativeCode(){return t.NEGATIVE_CODE}onEditStart(t){this.team=t.intData[0].toString()}readIntegerParamsFromForm(){return[Number.parseInt(this.team)]}get hasSpecialInputs(){return!0}}return t.CODE=aR.ACTOR_IS_IN_TEAM,t.NEGATIVE_CODE=aR.NOT_ACTOR_IN_TEAM,t.\u0275fac=function(e){return uR(e||t)},t.\u0275cmp=i.Ob({type:t,selectors:[["ng-component"]],features:[i.Db],decls:23,vars:19,consts:[[1,"form-check"],["type","radio","name","radio","value","1",1,"form-check-input",3,"ngModel","ngModelChange"],[1,"form-check-label"],["type","radio","name","radio","value","2",1,"form-check-input",3,"ngModel","ngModelChange"],["type","radio","name","radio","value","3",1,"form-check-input",3,"ngModel","ngModelChange"],["type","radio","name","radio","value","4",1,"form-check-input",3,"ngModel","ngModelChange"]],template:function(t,e){1&t&&(i.Zb(0,"nitro-wired-base-component"),i.Rc(1),i.mc(2,"translate"),i.Zb(3,"div",0),i.Zb(4,"input",1),i.jc("ngModelChange",(function(t){return e.team=t})),i.Yb(),i.Zb(5,"label",2),i.Rc(6),i.mc(7,"translate"),i.Yb(),i.Yb(),i.Zb(8,"div",0),i.Zb(9,"input",3),i.jc("ngModelChange",(function(t){return e.team=t})),i.Yb(),i.Zb(10,"label",2),i.Rc(11),i.mc(12,"translate"),i.Yb(),i.Yb(),i.Zb(13,"div",0),i.Zb(14,"input",4),i.jc("ngModelChange",(function(t){return e.team=t})),i.Yb(),i.Zb(15,"label",2),i.Rc(16),i.mc(17,"translate"),i.Yb(),i.Yb(),i.Zb(18,"div",0),i.Zb(19,"input",5),i.jc("ngModelChange",(function(t){return e.team=t})),i.Yb(),i.Zb(20,"label",2),i.Rc(21),i.mc(22,"translate"),i.Yb(),i.Yb(),i.Yb()),2&t&&(i.Gb(1),i.Tc(" ",i.nc(2,9,"wiredfurni.params.team")," "),i.Gb(3),i.sc("ngModel",e.team),i.Gb(2),i.Sc(i.nc(7,11,"wiredfurni.params.team.1")),i.Gb(3),i.sc("ngModel",e.team),i.Gb(2),i.Sc(i.nc(12,13,"wiredfurni.params.team.2")),i.Gb(3),i.sc("ngModel",e.team),i.Gb(2),i.Sc(i.nc(17,15,"wiredfurni.params.team.3")),i.Gb(3),i.sc("ngModel",e.team),i.Gb(2),i.Sc(i.nc(22,17,"wiredfurni.params.team.4")))},encapsulation:2}),t})();const uR=i.bc(lR);let dR=(()=>{class t extends nR{get code(){return t.CODE}get negativeCode(){return t.NEGATIVE_CODE}readIntegerParamsFromForm(){const t=parseInt(this.effectId);return isNaN(t)?[]:[t]}onEditStart(t){this.effectId=t.stringData.length>0?t.stringData:"0"}get hasSpecialInputs(){return!0}}return t.CODE=aR.ACTOR_IS_WEARING_EFFECT,t.NEGATIVE_CODE=aR.NOT_ACTOR_WEARING_EFFECT,t.\u0275fac=function(e){return gR(e||t)},t.\u0275cmp=i.Ob({type:t,selectors:[["ng-component"]],features:[i.Db],decls:6,vars:4,consts:[[1,"form-group"],["type","text",1,"form-control","form-control-sm",3,"ngModel","ngModelChange"]],template:function(t,e){1&t&&(i.Zb(0,"nitro-wired-base-component"),i.Zb(1,"div",0),i.Zb(2,"label"),i.Rc(3),i.mc(4,"translate"),i.Yb(),i.Zb(5,"input",1),i.jc("ngModelChange",(function(t){return e.effectId=t})),i.Yb(),i.Yb(),i.Yb()),2&t&&(i.Gb(3),i.Sc(i.nc(4,2,"wiredfurni.params.effectid")),i.Gb(2),i.sc("ngModel",e.effectId))},encapsulation:2}),t})();const gR=i.bc(dR);let mR=(()=>{class t extends nR{get code(){return t.CODE}get negativeCode(){return t.NEGATIVE_CODE}get requiresFurni(){return Iv._Str_4873}}return t.CODE=aR.TRIGGERER_IS_ON_FURNI,t.NEGATIVE_CODE=aR.NOT_ACTOR_ON_FURNI,t.\u0275fac=function(e){return pR(e||t)},t.\u0275cmp=i.Ob({type:t,selectors:[["ng-component"]],features:[i.Db],decls:1,vars:0,template:function(t,e){1&t&&i.Vb(0,"nitro-wired-base-component")},encapsulation:2}),t})();const pR=i.bc(mR);let ER=(()=>{class t extends nR{get code(){return t.CODE}get negativeCode(){return t.NEGATIVE_CODE}readStringParamFromForm(){return this.botName}onEditStart(t){this.botName=t.stringData}get hasSpecialInputs(){return!0}}return t.CODE=aR.ACTOR_IS_WEARING_BADGE,t.NEGATIVE_CODE=aR.NOT_ACTOR_WEARS_BADGE,t.\u0275fac=function(e){return fR(e||t)},t.\u0275cmp=i.Ob({type:t,selectors:[["ng-component"]],features:[i.Db],decls:6,vars:4,consts:[[1,"form-group"],["type","text",1,"form-control","form-control-sm",3,"ngModel","ngModelChange"]],template:function(t,e){1&t&&(i.Zb(0,"nitro-wired-base-component"),i.Zb(1,"div",0),i.Zb(2,"label"),i.Rc(3),i.mc(4,"translate"),i.Yb(),i.Zb(5,"input",1),i.jc("ngModelChange",(function(t){return e.botName=t})),i.Yb(),i.Yb(),i.Yb()),2&t&&(i.Gb(3),i.Sc(i.nc(4,2,"wiredfurni.params.badgecode")),i.Gb(2),i.sc("ngModel",e.botName))},encapsulation:2}),t})();const fR=i.bc(ER);let SR=(()=>{class t extends nR{get code(){return t.CODE}test(){return t.CODE}readIntegerParamsFromForm(){const t=[],e=new Date(this.startDate).getTime();if(!isNaN(e)){t.push(e/1e3);const s=new Date(this.endDate).getTime();isNaN(s)||t.push(s/1e3)}return t}onEditStart(t){let e,s;e=t.intData.length>0?new Date(1e3*t.intData[0]):new Date(0),s=t.intData.length>1?new Date(1e3*t.intData[1]):new Date(0),this.startDate=this.dateToString(e),this.endDate=this.dateToString(s)}get hasSpecialInputs(){return!0}dateToString(t){return`${t.getFullYear()}/${("0"+(t.getMonth()+1)).slice(-2)}/${("0"+t.getDate()).slice(-2)} ${("0"+t.getHours()).slice(-2)}:${("0"+t.getMinutes()).slice(-2)}`}}return t.CODE=aR.DATE_RANGE_ACTIVE,t.\u0275fac=function(e){return bR(e||t)},t.\u0275cmp=i.Ob({type:t,selectors:[["ng-component"]],features:[i.Db],decls:11,vars:8,consts:[[1,"form-group"],["type","text",1,"form-control","form-control-sm",3,"ngModel","ngModelChange"]],template:function(t,e){1&t&&(i.Zb(0,"nitro-wired-base-component"),i.Zb(1,"div",0),i.Zb(2,"label"),i.Rc(3),i.mc(4,"translate"),i.Yb(),i.Zb(5,"input",1),i.jc("ngModelChange",(function(t){return e.startDate=t})),i.Yb(),i.Yb(),i.Zb(6,"div",0),i.Zb(7,"label"),i.Rc(8),i.mc(9,"translate"),i.Yb(),i.Zb(10,"input",1),i.jc("ngModelChange",(function(t){return e.endDate=t})),i.Yb(),i.Yb(),i.Yb()),2&t&&(i.Gb(3),i.Sc(i.nc(4,4,"wiredfurni.params.startdate")),i.Gb(2),i.sc("ngModel",e.startDate),i.Gb(3),i.Sc(i.nc(9,6,"wiredfurni.params.enddate")),i.Gb(2),i.sc("ngModel",e.endDate))},encapsulation:2}),t})();const bR=i.bc(SR);let RR=(()=>{class t extends nR{constructor(){super(...arguments),this.requireAll="0"}get code(){return t.CODE}get requiresFurni(){return Iv._Str_4873}onEditStart(t){this.requireAll=t.intData.length>0&&1===t.intData[0]?"1":"0"}readIntegerParamsFromForm(){return["1"===this.requireAll?1:0]}get hasSpecialInputs(){return!0}}return t.CODE=aR.NOT_HAS_STACKED_FURNIS,t.\u0275fac=function(e){return IR(e||t)},t.\u0275cmp=i.Ob({type:t,selectors:[["ng-component"]],features:[i.Db],decls:13,vars:11,consts:[[1,"form-check"],["type","radio","name","radio","value","0",1,"form-check-input",3,"ngModel","ngModelChange"],[1,"form-check-label"],["type","radio","name","radio","value","1",1,"form-check-input",3,"ngModel","ngModelChange"]],template:function(t,e){1&t&&(i.Zb(0,"nitro-wired-base-component"),i.Rc(1),i.mc(2,"translate"),i.Zb(3,"div",0),i.Zb(4,"input",1),i.jc("ngModelChange",(function(t){return e.requireAll=t})),i.Yb(),i.Zb(5,"label",2),i.Rc(6),i.mc(7,"translate"),i.Yb(),i.Yb(),i.Zb(8,"div",0),i.Zb(9,"input",3),i.jc("ngModelChange",(function(t){return e.requireAll=t})),i.Yb(),i.Zb(10,"label",2),i.Rc(11),i.mc(12,"translate"),i.Yb(),i.Yb(),i.Yb()),2&t&&(i.Gb(1),i.Tc(" ",i.nc(2,5,"wiredfurni.params.not_requireall")," "),i.Gb(3),i.sc("ngModel",e.requireAll),i.Gb(2),i.Sc(i.nc(7,7,"wiredfurni.params.not_requireall.0")),i.Gb(3),i.sc("ngModel",e.requireAll),i.Gb(2),i.Sc(i.nc(12,9,"wiredfurni.params.not_requireall.1")))},encapsulation:2}),t})();const IR=i.bc(RR);let vR=(()=>{class t extends nR{get code(){return t.CODE}get negativeCode(){return t.NEGATIVE_CODE}get requiresFurni(){return Iv._Str_4873}}return t.CODE=aR.FURNIS_HAVE_AVATARS,t.NEGATIVE_CODE=aR.FURNI_NOT_HAVE_HABBO,t.\u0275fac=function(e){return TR(e||t)},t.\u0275cmp=i.Ob({type:t,selectors:[["ng-component"]],features:[i.Db],decls:1,vars:0,template:function(t,e){1&t&&i.Vb(0,"nitro-wired-base-component")},encapsulation:2}),t})();const TR=i.bc(vR);let OR=(()=>{class t extends nR{get code(){return t.CODE}get negativeCode(){return t.NEGATIVE_CODE}get requiresFurni(){return Iv._Str_4991}}return t.CODE=aR.STUFF_TYPE_MATCHES,t.NEGATIVE_CODE=aR.NOT_FURNI_IS_OF_TYPE,t.\u0275fac=function(e){return AR(e||t)},t.\u0275cmp=i.Ob({type:t,selectors:[["ng-component"]],features:[i.Db],decls:1,vars:0,template:function(t,e){1&t&&i.Vb(0,"nitro-wired-base-component")},encapsulation:2}),t})();const AR=i.bc(OR);let yR=(()=>{class t extends nR{constructor(){super(...arguments),this.requireAll="0"}get code(){return t.CODE}get requiresFurni(){return Iv._Str_4873}onEditStart(t){this.requireAll=t.intData.length>0&&1===t.intData[0]?"1":"0"}readIntegerParamsFromForm(){return["1"===this.requireAll?1:0]}get hasSpecialInputs(){return!0}}return t.CODE=aR.HAS_STACKED_FURNIS,t.\u0275fac=function(e){return CR(e||t)},t.\u0275cmp=i.Ob({type:t,selectors:[["ng-component"]],features:[i.Db],decls:13,vars:11,consts:[[1,"form-check"],["type","radio","name","radio","value","0",1,"form-check-input",3,"ngModel","ngModelChange"],[1,"form-check-label"],["type","radio","name","radio","value","1",1,"form-check-input",3,"ngModel","ngModelChange"]],template:function(t,e){1&t&&(i.Zb(0,"nitro-wired-base-component"),i.Rc(1),i.mc(2,"translate"),i.Zb(3,"div",0),i.Zb(4,"input",1),i.jc("ngModelChange",(function(t){return e.requireAll=t})),i.Yb(),i.Zb(5,"label",2),i.Rc(6),i.mc(7,"translate"),i.Yb(),i.Yb(),i.Zb(8,"div",0),i.Zb(9,"input",3),i.jc("ngModelChange",(function(t){return e.requireAll=t})),i.Yb(),i.Zb(10,"label",2),i.Rc(11),i.mc(12,"translate"),i.Yb(),i.Yb(),i.Yb()),2&t&&(i.Gb(1),i.Tc(" ",i.nc(2,5,"wiredfurni.params.requireall")," "),i.Gb(3),i.sc("ngModel",e.requireAll),i.Gb(2),i.Sc(i.nc(7,7,"wiredfurni.params.requireall.0")),i.Gb(3),i.sc("ngModel",e.requireAll),i.Gb(2),i.Sc(i.nc(12,9,"wiredfurni.params.requireall.1")))},encapsulation:2}),t})();const CR=i.bc(yR);let MR=(()=>{class t extends nR{get code(){return t.CODE}get negativeCode(){return t.NEGATIVE_CODE}get requiresFurni(){return Iv._Str_4873}get hasStateSnapshot(){return!0}onEditStart(t){this.state=t.getBoolean(0),this.direction=t.getBoolean(1),this.position=t.getBoolean(2)}readIntegerParamsFromForm(){return[this.state?1:0,this.direction?1:0,this.position?1:0]}get hasSpecialInputs(){return!0}}return t.CODE=aR.STATES_MATCH,t.NEGATIVE_CODE=aR.NOT_STATES_MATCH,t.\u0275fac=function(e){return DR(e||t)},t.\u0275cmp=i.Ob({type:t,selectors:[["ng-component"]],features:[i.Db],decls:18,vars:15,consts:[[1,"form-check"],["type","checkbox",1,"form-check-input",3,"ngModel","ngModelChange"],[1,"form-check-label"]],template:function(t,e){1&t&&(i.Zb(0,"nitro-wired-base-component"),i.Rc(1),i.mc(2,"translate"),i.Zb(3,"div",0),i.Zb(4,"input",1),i.jc("ngModelChange",(function(t){return e.state=t})),i.Yb(),i.Zb(5,"label",2),i.Rc(6),i.mc(7,"translate"),i.Yb(),i.Yb(),i.Zb(8,"div",0),i.Zb(9,"input",1),i.jc("ngModelChange",(function(t){return e.direction=t})),i.Yb(),i.Zb(10,"label",2),i.Rc(11),i.mc(12,"translate"),i.Yb(),i.Yb(),i.Zb(13,"div",0),i.Zb(14,"input",1),i.jc("ngModelChange",(function(t){return e.position=t})),i.Yb(),i.Zb(15,"label",2),i.Rc(16),i.mc(17,"translate"),i.Yb(),i.Yb(),i.Yb()),2&t&&(i.Gb(1),i.Tc(" ",i.nc(2,7,"wiredfurni.params.conditions")," "),i.Gb(3),i.sc("ngModel",e.state),i.Gb(2),i.Sc(i.nc(7,9,"wiredfurni.params.condition.state")),i.Gb(3),i.sc("ngModel",e.direction),i.Gb(2),i.Sc(i.nc(12,11,"wiredfurni.params.condition.direction")),i.Gb(3),i.sc("ngModel",e.position),i.Gb(2),i.Sc(i.nc(17,13,"wiredfurni.params.condition.position")))},encapsulation:2}),t})();const DR=i.bc(MR);let NR=(()=>{class t extends nR{get code(){return t.CODE}get negativeCode(){return t.NEGATIVE_CODE}get requiresFurni(){return Iv._Str_4873}onInit(){}onEditStart(t){}get hasSpecialInputs(){return!0}}return t.CODE=aR.STUFFS_IN_FORMATION,t.NEGATIVE_CODE=aR.NOT_STUFFS_IN_FORMATION,t.\u0275fac=function(e){return wR(e||t)},t.\u0275cmp=i.Ob({type:t,selectors:[["ng-component"]],features:[i.Db],decls:2,vars:0,template:function(t,e){1&t&&(i.Zb(0,"nitro-wired-base-component"),i.Rc(1,"STUFFS_IN_FORMATION"),i.Yb())},encapsulation:2}),t})();const wR=i.bc(NR);let UR=(()=>{class t extends nR{constructor(){super(...arguments),this.time=0}get code(){return t.CODE}onEditStart(t){this.time=t.intData[0]||1,this.updateLocaleParameter()}readIntegerParamsFromForm(){return[this.time]}onSliderChange(){this.updateLocaleParameter()}decrease(){this.time-=1,this.time<t.MINIMUM_VALUE&&(this.time=t.MINIMUM_VALUE)}increase(){this.time+=1,this.time>t.MAXIMUM_VALUE&&(this.time=t.MAXIMUM_VALUE)}updateLocaleParameter(){um.instance.localization.registerParameter("wiredfurni.params.allowbefore","seconds",iR.getLocaleName(this.time)),this.updateCount++}get hasSpecialInputs(){return!0}get sliderOptions(){return{floor:t.MINIMUM_VALUE,ceil:t.MAXIMUM_VALUE,step:t.STEPPER_VALUE,hidePointerLabels:!0,hideLimitLabels:!0}}}return t.CODE=aR.TIME_ELAPSED_LESS,t.MINIMUM_VALUE=1,t.MAXIMUM_VALUE=1200,t.STEPPER_VALUE=1,t.\u0275fac=function(e){return LR(e||t)},t.\u0275cmp=i.Ob({type:t,selectors:[["ng-component"]],features:[i.Db],decls:10,vars:6,consts:[[1,"w-100","text-center","mb-1"],[1,"d-flex","align-items-center","justify-content-center","my-2","custom-slider"],["type","button",1,"btn","btn-primary","btn-sm",3,"click"],[1,"fas","fa-arrow-left"],["name","time",3,"options","value","valueChange"],[1,"fas","fa-arrow-right"]],template:function(t,e){1&t&&(i.Zb(0,"nitro-wired-base-component"),i.Zb(1,"p",0),i.Rc(2),i.mc(3,"translate"),i.Yb(),i.Zb(4,"div",1),i.Zb(5,"button",2),i.jc("click",(function(){return e.decrease()})),i.Vb(6,"i",3),i.Yb(),i.Zb(7,"ngx-slider",4),i.jc("valueChange",(function(t){return e.time=t}))("valueChange",(function(){return e.onSliderChange()})),i.Yb(),i.Zb(8,"button",2),i.jc("click",(function(){return e.increase()})),i.Vb(9,"i",5),i.Yb(),i.Yb(),i.Yb()),2&t&&(i.Gb(2),i.Sc(i.oc(3,3,"wiredfurni.params.allowbefore",e.updateCount)),i.Gb(5),i.sc("options",e.sliderOptions)("value",e.time))},encapsulation:2}),t})();const LR=i.bc(UR);let PR=(()=>{class t extends nR{constructor(){super(...arguments),this.time=0}get code(){return t.CODE}onEditStart(t){this.time=t.intData[0]||1,this.updateLocaleParameter()}readIntegerParamsFromForm(){return[this.time]}onSliderChange(){this.updateLocaleParameter()}decrease(){this.time-=1,this.time<t.MINIMUM_VALUE&&(this.time=t.MINIMUM_VALUE)}increase(){this.time+=1,this.time>t.MAXIMUM_VALUE&&(this.time=t.MAXIMUM_VALUE)}updateLocaleParameter(){um.instance.localization.registerParameter("wiredfurni.params.allowafter","seconds",iR.getLocaleName(this.time)),this.updateCount++}get hasSpecialInputs(){return!0}get sliderOptions(){return{floor:t.MINIMUM_VALUE,ceil:t.MAXIMUM_VALUE,step:t.STEPPER_VALUE,hidePointerLabels:!0,hideLimitLabels:!0}}}return t.CODE=aR.TIME_ELAPSED_MORE,t.MINIMUM_VALUE=1,t.MAXIMUM_VALUE=1200,t.STEPPER_VALUE=1,t.\u0275fac=function(e){return xR(e||t)},t.\u0275cmp=i.Ob({type:t,selectors:[["ng-component"]],features:[i.Db],decls:10,vars:6,consts:[[1,"w-100","text-center","mb-1"],[1,"d-flex","align-items-center","justify-content-center","my-2","custom-slider"],["type","button",1,"btn","btn-primary","btn-sm",3,"click"],[1,"fas","fa-arrow-left"],["name","time",3,"options","value","valueChange"],[1,"fas","fa-arrow-right"]],template:function(t,e){1&t&&(i.Zb(0,"nitro-wired-base-component"),i.Zb(1,"p",0),i.Rc(2),i.mc(3,"translate"),i.Yb(),i.Zb(4,"div",1),i.Zb(5,"button",2),i.jc("click",(function(){return e.decrease()})),i.Vb(6,"i",3),i.Yb(),i.Zb(7,"ngx-slider",4),i.jc("valueChange",(function(t){return e.time=t}))("valueChange",(function(){return e.onSliderChange()})),i.Yb(),i.Zb(8,"button",2),i.jc("click",(function(){return e.increase()})),i.Vb(9,"i",5),i.Yb(),i.Yb(),i.Yb()),2&t&&(i.Gb(2),i.Sc(i.oc(3,3,"wiredfurni.params.allowafter",e.updateCount)),i.Gb(5),i.sc("options",e.sliderOptions)("value",e.time))},encapsulation:2}),t})();const xR=i.bc(PR);let FR=(()=>{class t extends nR{constructor(){super(...arguments),this.minUsers=0,this.maxUsers=0}get code(){return t.CODE}get negativeCode(){return t.NEGATIVE_CODE}onEditStart(t){this.minUsers=t.intData[0]||1,this.maxUsers=t.intData[1]||50,this.updateLocaleParameter()}readIntegerParamsFromForm(){return[this.minUsers,this.maxUsers]}onSliderChange(){this.updateLocaleParameter()}decreaseMin(){this.minUsers-=1,this.minUsers<t.MINIMUM_VALUE&&(this.minUsers=t.MINIMUM_VALUE)}decreaseMax(){this.maxUsers-=1,this.maxUsers<t.MINIMUM_VALUE&&(this.maxUsers=t.MINIMUM_VALUE)}increaseMin(){this.minUsers+=1,this.minUsers>t.MAXIMUM_VALUE&&(this.minUsers=t.MAXIMUM_VALUE)}increaseMax(){this.maxUsers+=1,this.maxUsers>t.MAXIMUM_VALUE&&(this.maxUsers=t.MAXIMUM_VALUE)}updateLocaleParameter(){um.instance.localization.registerParameter("wiredfurni.params.usercountmin","value",this.minUsers.toString()),um.instance.localization.registerParameter("wiredfurni.params.usercountmax","value",this.maxUsers.toString()),this.updateCount++}get hasSpecialInputs(){return!0}get sliderOptions(){return{floor:t.MINIMUM_VALUE,ceil:t.MAXIMUM_VALUE,step:t.STEPPER_VALUE,hidePointerLabels:!0,hideLimitLabels:!0}}}return t.CODE=aR.USER_COUNT_IN,t.NEGATIVE_CODE=aR.NOT_USER_COUNT_IN,t.MINIMUM_VALUE=1,t.MAXIMUM_VALUE=50,t.STEPPER_VALUE=1,t.\u0275fac=function(e){return GR(e||t)},t.\u0275cmp=i.Ob({type:t,selectors:[["ng-component"]],features:[i.Db],decls:19,vars:12,consts:[[1,"w-100","text-center","mb-1"],[1,"d-flex","align-items-center","justify-content-center","my-2","custom-slider"],["type","button",1,"btn","btn-primary","btn-sm",3,"click"],[1,"fas","fa-arrow-left"],["name","minUsers",3,"options","value","valueChange"],[1,"fas","fa-arrow-right"],["name","maxUsers",3,"options","value","valueChange"]],template:function(t,e){1&t&&(i.Zb(0,"nitro-wired-base-component"),i.Zb(1,"p",0),i.Rc(2),i.mc(3,"translate"),i.Yb(),i.Zb(4,"div",1),i.Zb(5,"button",2),i.jc("click",(function(){return e.decreaseMin()})),i.Vb(6,"i",3),i.Yb(),i.Zb(7,"ngx-slider",4),i.jc("valueChange",(function(t){return e.minUsers=t}))("valueChange",(function(){return e.onSliderChange()})),i.Yb(),i.Zb(8,"button",2),i.jc("click",(function(){return e.increaseMin()})),i.Vb(9,"i",5),i.Yb(),i.Yb(),i.Zb(10,"p",0),i.Rc(11),i.mc(12,"translate"),i.Yb(),i.Zb(13,"div",1),i.Zb(14,"button",2),i.jc("click",(function(){return e.decreaseMax()})),i.Vb(15,"i",3),i.Yb(),i.Zb(16,"ngx-slider",6),i.jc("valueChange",(function(t){return e.maxUsers=t}))("valueChange",(function(){return e.onSliderChange()})),i.Yb(),i.Zb(17,"button",2),i.jc("click",(function(){return e.increaseMax()})),i.Vb(18,"i",5),i.Yb(),i.Yb(),i.Yb()),2&t&&(i.Gb(2),i.Sc(i.oc(3,6,"wiredfurni.params.usercountmin",e.updateCount)),i.Gb(5),i.sc("options",e.sliderOptions)("value",e.minUsers),i.Gb(4),i.Sc(i.oc(12,9,"wiredfurni.params.usercountmax",e.updateCount)),i.Gb(5),i.sc("options",e.sliderOptions)("value",e.maxUsers))},encapsulation:2}),t})();const GR=i.bc(FR);class VR{_Str_9781(t){switch(t){case mR.CODE:case mR.NEGATIVE_CODE:return mR;case vR.CODE:case vR.NEGATIVE_CODE:return vR;case MR.CODE:case MR.NEGATIVE_CODE:return MR;case PR.CODE:return PR;case UR.CODE:return UR;case FR.CODE:case FR.NEGATIVE_CODE:return FR;case lR.CODE:case lR.NEGATIVE_CODE:return lR;case yR.CODE:return yR;case OR.CODE:case OR.NEGATIVE_CODE:return OR;case NR.CODE:case NR.NEGATIVE_CODE:return NR;case _R.CODE:case _R.NEGATIVE_CODE:return _R;case ER.CODE:case ER.NEGATIVE_CODE:return ER;case dR.CODE:case dR.NEGATIVE_CODE:return dR;case RR.CODE:return RR;case SR.CODE:return SR;case oR.CODE:return oR}return null}_Str_15652(t){return this._Str_9781(t)}_Str_14545(t){return t instanceof Eo}_Str_1196(){return"condition"}}class YR extends iR{constructor(){super(...arguments),this.updateCount=0}}let kR=(()=>{class t{}return t.AVATAR_SAYS_SOMETHING=0,t.AVATAR_WALKS_ON_FURNI=1,t.AVATAR_WALKS_OFF_FURNI=2,t.TRIGGER_ONCE=3,t.TOGGLE_FURNI=4,t.TRIGGER_PERIODICALLY=6,t.AVATAR_ENTERS_ROOM=7,t.GAME_STARTS=8,t.GAME_ENDS=9,t.SCORE_ACHIEVED=10,t.COLLISION=11,t.TRIGGER_PERIODICALLY_LONG=12,t.BOT_REACHED_STUFF=13,t.BOT_REACHED_AVATAR=14,t})();function jR(t,e){if(1&t){const t=i.ac();i.Zb(0,"div",5),i.Zb(1,"input",6),i.jc("ngModelChange",(function(e){return i.Ec(t),i.lc().keyword=e})),i.Yb(),i.Yb()}if(2&t){const t=i.lc();i.Gb(1),i.sc("ngModel",t.keyword)}}let BR=(()=>{class t extends YR{constructor(){super(...arguments),this.keyword="",this.avatar="0"}get code(){return t.CODE}onEditStart(t){this.keyword=t.stringData||"",this.avatar=this.keyword.length>0?"1":"0"}readStringParamFromForm(){return"1"===this.avatar&&this.keyword.length>0?this.keyword:""}get hasSpecialInputs(){return!0}}return t.CODE=kR.AVATAR_ENTERS_ROOM,t.\u0275fac=function(e){return HR(e||t)},t.\u0275cmp=i.Ob({type:t,selectors:[["ng-component"]],features:[i.Db],decls:14,vars:12,consts:[[1,"form-check"],["type","radio","name","radio","value","0",1,"form-check-input",3,"ngModel","ngModelChange"],[1,"form-check-label"],["type","radio","name","radio","value","1",1,"form-check-input",3,"ngModel","ngModelChange"],["class","form-group",4,"ngIf"],[1,"form-group"],["type","text",1,"form-control","form-control-sm",3,"ngModel","ngModelChange"]],template:function(t,e){1&t&&(i.Zb(0,"nitro-wired-base-component"),i.Rc(1),i.mc(2,"translate"),i.Zb(3,"div",0),i.Zb(4,"input",1),i.jc("ngModelChange",(function(t){return e.avatar=t})),i.Yb(),i.Zb(5,"label",2),i.Rc(6),i.mc(7,"translate"),i.Yb(),i.Yb(),i.Zb(8,"div",0),i.Zb(9,"input",3),i.jc("ngModelChange",(function(t){return e.avatar=t})),i.Yb(),i.Zb(10,"label",2),i.Rc(11),i.mc(12,"translate"),i.Yb(),i.Yb(),i.Pc(13,jR,2,1,"div",4),i.Yb()),2&t&&(i.Gb(1),i.Tc(" ",i.nc(2,6,"wiredfurni.params.picktriggerer")," "),i.Gb(3),i.sc("ngModel",e.avatar),i.Gb(2),i.Sc(i.nc(7,8,"wiredfurni.params.anyavatar")),i.Gb(3),i.sc("ngModel",e.avatar),i.Gb(2),i.Sc(i.nc(12,10,"wiredfurni.params.certainavatar")),i.Gb(2),i.sc("ngIf","1"===e.avatar))},encapsulation:2}),t})();const HR=i.bc(BR);let WR=(()=>{class t extends YR{constructor(){super(...arguments),this.keyword="",this.avatar="0"}get code(){return t.CODE}onEditStart(t){this.keyword=t.stringData||"",this.avatar=t.intData.length>0&&1===t.intData[0]?"1":"0"}readIntegerParamsFromForm(){return["1"===this.avatar?1:0]}readStringParamFromForm(){return this.keyword}get hasSpecialInputs(){return!0}get username(){return um.instance.sessionDataManager.userName}}return t.CODE=kR.AVATAR_SAYS_SOMETHING,t.\u0275fac=function(e){return ZR(e||t)},t.\u0275cmp=i.Ob({type:t,selectors:[["ng-component"]],features:[i.Db],decls:17,vars:13,consts:[[1,"form-group"],["type","text",1,"form-control","form-control-sm",3,"ngModel","ngModelChange"],[1,"form-check"],["type","radio","name","radio","value","0",1,"form-check-input",3,"ngModel","ngModelChange"],[1,"form-check-label"],["type","radio","name","radio","value","1",1,"form-check-input",3,"ngModel","ngModelChange"]],template:function(t,e){1&t&&(i.Zb(0,"nitro-wired-base-component"),i.Zb(1,"div",0),i.Zb(2,"label"),i.Rc(3),i.mc(4,"translate"),i.Yb(),i.Zb(5,"input",1),i.jc("ngModelChange",(function(t){return e.keyword=t})),i.Yb(),i.Yb(),i.Rc(6),i.mc(7,"translate"),i.Zb(8,"div",2),i.Zb(9,"input",3),i.jc("ngModelChange",(function(t){return e.avatar=t})),i.Yb(),i.Zb(10,"label",4),i.Rc(11),i.mc(12,"translate"),i.Yb(),i.Yb(),i.Zb(13,"div",2),i.Zb(14,"input",5),i.jc("ngModelChange",(function(t){return e.avatar=t})),i.Yb(),i.Zb(15,"label",4),i.Rc(16),i.Yb(),i.Yb(),i.Yb()),2&t&&(i.Gb(3),i.Sc(i.nc(4,7,"wiredfurni.params.whatissaid")),i.Gb(2),i.sc("ngModel",e.keyword),i.Gb(1),i.Tc(" ",i.nc(7,9,"wiredfurni.params.picktriggerer")," "),i.Gb(3),i.sc("ngModel",e.avatar),i.Gb(2),i.Sc(i.nc(12,11,"wiredfurni.params.anyavatar")),i.Gb(3),i.sc("ngModel",e.avatar),i.Gb(2),i.Sc(e.username))},encapsulation:2}),t})();const ZR=i.bc(WR);let zR=(()=>{class t extends YR{get code(){return t.CODE}get requiresFurni(){return Iv._Str_4991}}return t.CODE=kR.AVATAR_WALKS_OFF_FURNI,t.\u0275fac=function(e){return XR(e||t)},t.\u0275cmp=i.Ob({type:t,selectors:[["ng-component"]],features:[i.Db],decls:1,vars:0,template:function(t,e){1&t&&i.Vb(0,"nitro-wired-base-component")},encapsulation:2}),t})();const XR=i.bc(zR);let KR=(()=>{class t extends YR{get code(){return t.CODE}get requiresFurni(){return Iv._Str_4991}}return t.CODE=kR.AVATAR_WALKS_ON_FURNI,t.\u0275fac=function(e){return qR(e||t)},t.\u0275cmp=i.Ob({type:t,selectors:[["ng-component"]],features:[i.Db],decls:1,vars:0,template:function(t,e){1&t&&i.Vb(0,"nitro-wired-base-component")},encapsulation:2}),t})();const qR=i.bc(KR);let JR=(()=>{class t extends YR{constructor(){super(...arguments),this.keyword=""}get code(){return t.CODE}get requiresFurni(){return Iv._Str_5431}onEditStart(t){this.keyword=t.stringData}readStringParamFromForm(){return this.keyword}get hasSpecialInputs(){return!0}}return t.CODE=kR.BOT_REACHED_AVATAR,t.\u0275fac=function(e){return QR(e||t)},t.\u0275cmp=i.Ob({type:t,selectors:[["ng-component"]],features:[i.Db],decls:6,vars:4,consts:[[1,"form-group"],["type","text",1,"form-control","form-control-sm",3,"ngModel","ngModelChange"]],template:function(t,e){1&t&&(i.Zb(0,"nitro-wired-base-component"),i.Zb(1,"div",0),i.Zb(2,"label"),i.Rc(3),i.mc(4,"translate"),i.Yb(),i.Zb(5,"input",1),i.jc("ngModelChange",(function(t){return e.keyword=t})),i.Yb(),i.Yb(),i.Yb()),2&t&&(i.Gb(3),i.Sc(i.nc(4,2,"wiredfurni.params.bot.name")),i.Gb(2),i.sc("ngModel",e.keyword))},encapsulation:2}),t})();const QR=i.bc(JR);let $R=(()=>{class t extends YR{constructor(){super(...arguments),this.keyword=""}get code(){return t.CODE}get requiresFurni(){return Iv._Str_4991}onEditStart(t){this.keyword=t.stringData}readStringParamFromForm(){return this.keyword}get hasSpecialInputs(){return!0}}return t.CODE=kR.BOT_REACHED_STUFF,t.\u0275fac=function(e){return tI(e||t)},t.\u0275cmp=i.Ob({type:t,selectors:[["ng-component"]],features:[i.Db],decls:6,vars:4,consts:[[1,"form-group"],["type","text",1,"form-control","form-control-sm",3,"ngModel","ngModelChange"]],template:function(t,e){1&t&&(i.Zb(0,"nitro-wired-base-component"),i.Zb(1,"div",0),i.Zb(2,"label"),i.Rc(3),i.mc(4,"translate"),i.Yb(),i.Zb(5,"input",1),i.jc("ngModelChange",(function(t){return e.keyword=t})),i.Yb(),i.Yb(),i.Yb()),2&t&&(i.Gb(3),i.Sc(i.nc(4,2,"wiredfurni.params.bot.name")),i.Gb(2),i.sc("ngModel",e.keyword))},encapsulation:2}),t})();const tI=i.bc($R);let eI=(()=>{class t extends YR{get code(){return t.CODE}}return t.CODE=kR.COLLISION,t.\u0275fac=function(e){return sI(e||t)},t.\u0275cmp=i.Ob({type:t,selectors:[["ng-component"]],features:[i.Db],decls:1,vars:0,template:function(t,e){1&t&&i.Vb(0,"nitro-wired-base-component")},encapsulation:2}),t})();const sI=i.bc(eI);let iI=(()=>{class t extends YR{get code(){return t.CODE}}return t.CODE=kR.GAME_ENDS,t.\u0275fac=function(e){return rI(e||t)},t.\u0275cmp=i.Ob({type:t,selectors:[["ng-component"]],features:[i.Db],decls:1,vars:0,template:function(t,e){1&t&&i.Vb(0,"nitro-wired-base-component")},encapsulation:2}),t})();const rI=i.bc(iI);let nI=(()=>{class t extends YR{get code(){return t.CODE}}return t.CODE=kR.GAME_STARTS,t.\u0275fac=function(e){return aI(e||t)},t.\u0275cmp=i.Ob({type:t,selectors:[["ng-component"]],features:[i.Db],decls:1,vars:0,template:function(t,e){1&t&&i.Vb(0,"nitro-wired-base-component")},encapsulation:2}),t})();const aI=i.bc(nI);let oI=(()=>{class t extends YR{constructor(){super(...arguments),this.score=0}get code(){return t.CODE}onEditStart(t){this.score=t.intData[0]||0,this.updateLocaleParameter()}readIntegerParamsFromForm(){return[this.score]}onSliderChange(){this.updateLocaleParameter()}decrease(){this.score-=1,this.score<t.MINIMUM_VALUE&&(this.score=t.MINIMUM_VALUE)}increase(){this.score+=1,this.score>t.MAXIMUM_VALUE&&(this.score=t.MAXIMUM_VALUE)}updateLocaleParameter(){um.instance.localization.registerParameter("wiredfurni.params.setscore","points",this.score.toString()),this.updateCount++}get hasSpecialInputs(){return!0}get sliderOptions(){return{floor:t.MINIMUM_VALUE,ceil:t.MAXIMUM_VALUE,step:t.STEPPER_VALUE,hidePointerLabels:!0,hideLimitLabels:!0}}}return t.MINIMUM_VALUE=1,t.MAXIMUM_VALUE=1e3,t.STEPPER_VALUE=1,t.CODE=kR.SCORE_ACHIEVED,t.\u0275fac=function(e){return cI(e||t)},t.\u0275cmp=i.Ob({type:t,selectors:[["ng-component"]],features:[i.Db],decls:10,vars:6,consts:[[1,"w-100","text-center","mb-1"],[1,"d-flex","align-items-center","justify-content-center","my-2","custom-slider"],["type","button",1,"btn","btn-primary","btn-sm",3,"click"],[1,"fas","fa-arrow-left"],["name","time",3,"options","value","valueChange"],[1,"fas","fa-arrow-right"]],template:function(t,e){1&t&&(i.Zb(0,"nitro-wired-base-component"),i.Zb(1,"p",0),i.Rc(2),i.mc(3,"translate"),i.Yb(),i.Zb(4,"div",1),i.Zb(5,"button",2),i.jc("click",(function(){return e.decrease()})),i.Vb(6,"i",3),i.Yb(),i.Zb(7,"ngx-slider",4),i.jc("valueChange",(function(t){return e.score=t}))("valueChange",(function(){return e.onSliderChange()})),i.Yb(),i.Zb(8,"button",2),i.jc("click",(function(){return e.increase()})),i.Vb(9,"i",5),i.Yb(),i.Yb(),i.Yb()),2&t&&(i.Gb(2),i.Sc(i.oc(3,3,"wiredfurni.params.setscore",e.updateCount)),i.Gb(5),i.sc("options",e.sliderOptions)("value",e.score))},encapsulation:2}),t})();const cI=i.bc(oI);let _I=(()=>{class t extends YR{get code(){return t.CODE}get requiresFurni(){return Iv._Str_4991}}return t.CODE=kR.TOGGLE_FURNI,t.\u0275fac=function(e){return hI(e||t)},t.\u0275cmp=i.Ob({type:t,selectors:[["ng-component"]],features:[i.Db],decls:1,vars:0,template:function(t,e){1&t&&i.Vb(0,"nitro-wired-base-component")},encapsulation:2}),t})();const hI=i.bc(_I);let lI=(()=>{class t extends YR{constructor(){super(...arguments),this.time=0}get code(){return t.CODE}onEditStart(t){this.time=t.intData[0]||1,this.updateLocaleParameter()}readIntegerParamsFromForm(){return[this.time]}onSliderChange(){this.updateLocaleParameter()}decrease(){this.time-=1,this.time<t.MINIMUM_VALUE&&(this.time=t.MINIMUM_VALUE)}increase(){this.time+=1,this.time>t.MAXIMUM_VALUE&&(this.time=t.MAXIMUM_VALUE)}updateLocaleParameter(){um.instance.localization.registerParameter("wiredfurni.params.settime","seconds",iR.getLocaleName(this.time)),this.updateCount++}get hasSpecialInputs(){return!0}get sliderOptions(){return{floor:t.MINIMUM_VALUE,ceil:t.MAXIMUM_VALUE,step:t.STEPPER_VALUE,hidePointerLabels:!0,hideLimitLabels:!0}}}return t.MINIMUM_VALUE=1,t.MAXIMUM_VALUE=1200,t.STEPPER_VALUE=1,t.CODE=kR.TRIGGER_ONCE,t.\u0275fac=function(e){return uI(e||t)},t.\u0275cmp=i.Ob({type:t,selectors:[["ng-component"]],features:[i.Db],decls:10,vars:6,consts:[[1,"w-100","text-center","mb-1"],[1,"d-flex","align-items-center","justify-content-center","my-2","custom-slider"],["type","button",1,"btn","btn-primary","btn-sm",3,"click"],[1,"fas","fa-arrow-left"],["name","time",3,"options","value","valueChange"],[1,"fas","fa-arrow-right"]],template:function(t,e){1&t&&(i.Zb(0,"nitro-wired-base-component"),i.Zb(1,"p",0),i.Rc(2),i.mc(3,"translate"),i.Yb(),i.Zb(4,"div",1),i.Zb(5,"button",2),i.jc("click",(function(){return e.decrease()})),i.Vb(6,"i",3),i.Yb(),i.Zb(7,"ngx-slider",4),i.jc("valueChange",(function(t){return e.time=t}))("valueChange",(function(){return e.onSliderChange()})),i.Yb(),i.Zb(8,"button",2),i.jc("click",(function(){return e.increase()})),i.Vb(9,"i",5),i.Yb(),i.Yb(),i.Yb()),2&t&&(i.Gb(2),i.Sc(i.oc(3,3,"wiredfurni.params.settime",e.updateCount)),i.Gb(5),i.sc("options",e.sliderOptions)("value",e.time))},encapsulation:2}),t})();const uI=i.bc(lI);let dI=(()=>{class t{static format(e,s="",i=3){return e>i*t.YEAR?t.getLocalization("friendlytime.years"+s,Math.round(e/t.YEAR)):e>i*t.MONTH?t.getLocalization("friendlytime.months"+s,Math.round(e/t.MONTH)):e>i*t.DAY?t.getLocalization("friendlytime.days"+s,Math.round(e/t.DAY)):e>i*t.HOUR?t.getLocalization("friendlytime.hours"+s,Math.round(e/t.HOUR)):e>i*t.MINUTE?t.getLocalization("friendlytime.minutes"+s,Math.round(e/t.MINUTE)):t.getLocalization("friendlytime.seconds"+s,Math.round(e))}static shortFormat(e,s="",i=3){return e>i*t.YEAR?t.getLocalization("friendlytime.years.short"+s,Math.round(e/t.YEAR)):e>i*t.MONTH?t.getLocalization("friendlytime.months.short"+s,Math.round(e/t.MONTH)):e>i*t.DAY?t.getLocalization("friendlytime.days.short"+s,Math.round(e/t.DAY)):e>i*t.HOUR?t.getLocalization("friendlytime.hours.short"+s,Math.round(e/t.HOUR)):e>i*t.MINUTE?t.getLocalization("friendlytime.minutes.short"+s,Math.round(e/t.MINUTE)):t.getLocalization("friendlytime.seconds.short"+s,Math.round(e))}static getLocalization(t,e){return um.instance.getLocalizationWithParameter(t,"amount",e.toString())}}return t.MINUTE=60,t.HOUR=60*t.MINUTE,t.DAY=24*t.HOUR,t.WEEK=7*t.DAY,t.MONTH=30*t.DAY,t.YEAR=365*t.DAY,t})(),gI=(()=>{class t extends YR{constructor(){super(...arguments),this.time=0}get code(){return t.CODE}onEditStart(t){this.time=t.intData[0]||1,this.updateLocaleParameter()}readIntegerParamsFromForm(){return[this.time]}onSliderChange(){this.updateLocaleParameter()}decrease(){this.time-=1,this.time<t.MINIMUM_VALUE&&(this.time=t.MINIMUM_VALUE)}increase(){this.time+=1,this.time>t.MAXIMUM_VALUE&&(this.time=t.MAXIMUM_VALUE)}updateLocaleParameter(){um.instance.localization.registerParameter("wiredfurni.params.settime","seconds",iR.getLocaleName(this.time)),this.updateCount++}get hasSpecialInputs(){return!0}get sliderOptions(){return{floor:t.MINIMUM_VALUE,ceil:t.MAXIMUM_VALUE,step:t.STEPPER_VALUE,hidePointerLabels:!0,hideLimitLabels:!0}}}return t.MINIMUM_VALUE=1,t.MAXIMUM_VALUE=120,t.STEPPER_VALUE=1,t.CODE=kR.TRIGGER_PERIODICALLY,t.\u0275fac=function(e){return mI(e||t)},t.\u0275cmp=i.Ob({type:t,selectors:[["ng-component"]],features:[i.Db],decls:10,vars:6,consts:[[1,"w-100","text-center","mb-1"],[1,"d-flex","align-items-center","justify-content-center","my-2","custom-slider"],["type","button",1,"btn","btn-primary","btn-sm",3,"click"],[1,"fas","fa-arrow-left"],["name","time",3,"options","value","valueChange"],[1,"fas","fa-arrow-right"]],template:function(t,e){1&t&&(i.Zb(0,"nitro-wired-base-component"),i.Zb(1,"p",0),i.Rc(2),i.mc(3,"translate"),i.Yb(),i.Zb(4,"div",1),i.Zb(5,"button",2),i.jc("click",(function(){return e.decrease()})),i.Vb(6,"i",3),i.Yb(),i.Zb(7,"ngx-slider",4),i.jc("valueChange",(function(t){return e.time=t}))("valueChange",(function(){return e.onSliderChange()})),i.Yb(),i.Zb(8,"button",2),i.jc("click",(function(){return e.increase()})),i.Vb(9,"i",5),i.Yb(),i.Yb(),i.Yb()),2&t&&(i.Gb(2),i.Sc(i.oc(3,3,"wiredfurni.params.settime",e.updateCount)),i.Gb(5),i.sc("options",e.sliderOptions)("value",e.time))},encapsulation:2}),t})();const mI=i.bc(gI);let pI=(()=>{class t extends gI{get code(){return t.CODE}updateLocaleParameter(){um.instance.localization.registerParameter("wiredfurni.params.setlongtime","time",dI.format(5*this.time)),this.updateCount++}}return t.CODE=kR.TRIGGER_PERIODICALLY_LONG,t.\u0275fac=function(e){return EI(e||t)},t.\u0275cmp=i.Ob({type:t,selectors:[["ng-component"]],features:[i.Db],decls:10,vars:6,consts:[[1,"w-100","text-center","mb-1"],[1,"d-flex","align-items-center","justify-content-center","my-2","custom-slider"],["type","button",1,"btn","btn-primary","btn-sm",3,"click"],[1,"fas","fa-arrow-left"],["name","time",3,"options","value","valueChange"],[1,"fas","fa-arrow-right"]],template:function(t,e){1&t&&(i.Zb(0,"nitro-wired-base-component"),i.Zb(1,"p",0),i.Rc(2),i.mc(3,"translate"),i.Yb(),i.Zb(4,"div",1),i.Zb(5,"button",2),i.jc("click",(function(){return e.decrease()})),i.Vb(6,"i",3),i.Yb(),i.Zb(7,"ngx-slider",4),i.jc("valueChange",(function(t){return e.time=t}))("valueChange",(function(){return e.onSliderChange()})),i.Yb(),i.Zb(8,"button",2),i.jc("click",(function(){return e.increase()})),i.Vb(9,"i",5),i.Yb(),i.Yb(),i.Yb()),2&t&&(i.Gb(2),i.Sc(i.oc(3,3,"wiredfurni.params.setlongtime",e.updateCount)),i.Gb(5),i.sc("options",e.sliderOptions)("value",e.time))},encapsulation:2}),t})();const EI=i.bc(pI);class fI{_Str_9781(t){switch(t){case WR.CODE:return WR;case KR.CODE:return KR;case zR.CODE:return zR;case lI.CODE:return lI;case _I.CODE:return _I;case gI.CODE:return gI;case BR.CODE:return BR;case nI.CODE:return nI;case iI.CODE:return iI;case oI.CODE:return oI;case eI.CODE:return eI;case pI.CODE:return pI;case $R.CODE:return $R;case JR.CODE:return JR}return null}_Str_15652(t){return this._Str_9781(t)}_Str_14545(t){return t instanceof bo}_Str_1196(){return"trigger"}}let SI=(()=>{class t{}return t.TOGGLE_FURNI_STATE=0,t.RESET=1,t.SET_FURNI_STATE=3,t.MOVE_FURNI=4,t.GIVE_SCORE=6,t.CHAT=7,t.TELEPORT=8,t.JOIN_TEAM=9,t.LEAVE_TEAM=10,t.CHASE=11,t.FLEE=12,t.MOVE_TO_DIRECTION=13,t.GIVE_SCORE_TO_PREDEFINED_TEAM=14,t.TOGGLE_TO_RANDOM_STATE=15,t.MOVE_FURNI_TO=16,t.GIVE_REWARD=17,t.CALL_ANOTHER_STACK=18,t.KICK_FROM_ROOM=19,t.MUTE_USER=20,t.BOT_TELEPORT=21,t.BOT_MOVE=22,t.BOT_TALK=23,t.BOT_GIVE_HAND_ITEM=24,t.BOT_FOLLOW_AVATAR=25,t.BOT_CHANGE_FIGURE=26,t.BOT_TALK_DIRECT_TO_AVTR=27,t})(),bI=(()=>{class t extends rR{constructor(){super(...arguments),this.followMode="0"}get code(){return t.CODE}onEditStart(t){this.botName=t.stringData,this.followMode=t.intData.length>0?t.intData[0].toString():"0",super.onEditStart(t)}readStringParamFromForm(){return this.botName}readIntegerParamsFromForm(){return[Number.parseInt(this.followMode)]}get hasSpecialInputs(){return!0}}return t.CODE=SI.BOT_FOLLOW_AVATAR,t.\u0275fac=function(e){return RI(e||t)},t.\u0275cmp=i.Ob({type:t,selectors:[["ng-component"]],features:[i.Db],decls:25,vars:18,consts:[[1,"form-group"],["type","text","maxlength","32",1,"form-control","form-control-sm",3,"ngModel","ngModelChange"],[1,"form-check"],["type","radio","name","radio","value","1",1,"form-check-input",3,"ngModel","ngModelChange"],[1,"form-check-label"],["type","radio","name","radio","value","0",1,"form-check-input",3,"ngModel","ngModelChange"],[1,"w-100","text-center","mb-1"],[1,"d-flex","align-items-center","justify-content-center","my-2","custom-slider"],["type","button",1,"btn","btn-primary","btn-sm",3,"click"],[1,"fas","fa-arrow-left"],["name","delay",3,"options","value","valueChange"],[1,"fas","fa-arrow-right"]],template:function(t,e){1&t&&(i.Zb(0,"nitro-wired-base-component"),i.Zb(1,"div",0),i.Zb(2,"label"),i.Rc(3),i.mc(4,"translate"),i.Yb(),i.Zb(5,"input",1),i.jc("ngModelChange",(function(t){return e.botName=t})),i.Yb(),i.Yb(),i.Zb(6,"div",2),i.Zb(7,"input",3),i.jc("ngModelChange",(function(t){return e.followMode=t})),i.Yb(),i.Zb(8,"label",4),i.Rc(9),i.mc(10,"translate"),i.Yb(),i.Yb(),i.Zb(11,"div",2),i.Zb(12,"input",5),i.jc("ngModelChange",(function(t){return e.followMode=t})),i.Yb(),i.Zb(13,"label",4),i.Rc(14),i.mc(15,"translate"),i.Yb(),i.Yb(),i.Zb(16,"p",6),i.Rc(17),i.mc(18,"translate"),i.Yb(),i.Zb(19,"div",7),i.Zb(20,"button",8),i.jc("click",(function(){return e.decreaseDelay()})),i.Vb(21,"i",9),i.Yb(),i.Zb(22,"ngx-slider",10),i.jc("valueChange",(function(t){return e.delay=t}))("valueChange",(function(){return e.onSliderChange()})),i.Yb(),i.Zb(23,"button",8),i.jc("click",(function(){return e.increaseDelay()})),i.Vb(24,"i",11),i.Yb(),i.Yb(),i.Yb()),2&t&&(i.Gb(3),i.Sc(i.nc(4,9,"wiredfurni.params.bot.name")),i.Gb(2),i.sc("ngModel",e.botName),i.Gb(2),i.sc("ngModel",e.followMode),i.Gb(2),i.Sc(i.nc(10,11,"wiredfurni.params.start.following")),i.Gb(3),i.sc("ngModel",e.followMode),i.Gb(2),i.Sc(i.nc(15,13,"wiredfurni.params.stop.following")),i.Gb(3),i.Sc(i.oc(18,15,"wiredfurni.params.delay",e.updateCount)),i.Gb(5),i.sc("options",e.delaySliderOptions)("value",e.delay))},encapsulation:2}),t})();const RI=i.bc(bI);let II=(()=>{class t extends rR{constructor(){super(...arguments),this.allowedHanditemIds=["2","5","7","8","9","10","27"],this.handitemId="0"}get code(){return t.CODE}onEditStart(t){this.botName=t.stringData,this.handitemId=t.intData.length>0&&this.allowedHanditemIds.includes(t.intData[0].toString())?t.intData[0].toString():"0",super.onEditStart(t)}readStringParamFromForm(){return this.botName}readIntegerParamsFromForm(){return[Number.parseInt(this.handitemId)]}get hasSpecialInputs(){return!0}}return t.CODE=SI.BOT_GIVE_HAND_ITEM,t.\u0275fac=function(e){return vI(e||t)},t.\u0275cmp=i.Ob({type:t,selectors:[["ng-component"]],features:[i.Db],decls:44,vars:46,consts:[[1,"form-group"],["type","text","maxlength","32",1,"form-control","form-control-sm",3,"ngModel","ngModelChange"],[1,"form-control","form-control-sm",3,"ngModel","ngModelChange"],["value","0",3,"selected"],["value","2",3,"selected"],["value","5",3,"selected"],["value","7",3,"selected"],["value","8",3,"selected"],["value","9",3,"selected"],["value","10",3,"selected"],["value","27",3,"selected"],[1,"w-100","text-center","mb-1"],[1,"d-flex","align-items-center","justify-content-center","my-2","custom-slider"],["type","button",1,"btn","btn-primary","btn-sm",3,"click"],[1,"fas","fa-arrow-left"],["name","delay",3,"options","value","valueChange"],[1,"fas","fa-arrow-right"]],template:function(t,e){1&t&&(i.Zb(0,"nitro-wired-base-component"),i.Zb(1,"div",0),i.Zb(2,"label"),i.Rc(3),i.mc(4,"translate"),i.Yb(),i.Zb(5,"input",1),i.jc("ngModelChange",(function(t){return e.botName=t})),i.Yb(),i.Yb(),i.Zb(6,"div",0),i.Zb(7,"label"),i.Rc(8),i.mc(9,"translate"),i.Yb(),i.Zb(10,"select",2),i.jc("ngModelChange",(function(t){return e.handitemId=t})),i.Zb(11,"option",3),i.Rc(12),i.mc(13,"translate"),i.Yb(),i.Zb(14,"option",4),i.Rc(15),i.mc(16,"translate"),i.Yb(),i.Zb(17,"option",5),i.Rc(18),i.mc(19,"translate"),i.Yb(),i.Zb(20,"option",6),i.Rc(21),i.mc(22,"translate"),i.Yb(),i.Zb(23,"option",7),i.Rc(24),i.mc(25,"translate"),i.Yb(),i.Zb(26,"option",8),i.Rc(27),i.mc(28,"translate"),i.Yb(),i.Zb(29,"option",9),i.Rc(30),i.mc(31,"translate"),i.Yb(),i.Zb(32,"option",10),i.Rc(33),i.mc(34,"translate"),i.Yb(),i.Yb(),i.Yb(),i.Zb(35,"p",11),i.Rc(36),i.mc(37,"translate"),i.Yb(),i.Zb(38,"div",12),i.Zb(39,"button",13),i.jc("click",(function(){return e.decreaseDelay()})),i.Vb(40,"i",14),i.Yb(),i.Zb(41,"ngx-slider",15),i.jc("valueChange",(function(t){return e.delay=t}))("valueChange",(function(){return e.onSliderChange()})),i.Yb(),i.Zb(42,"button",13),i.jc("click",(function(){return e.increaseDelay()})),i.Vb(43,"i",16),i.Yb(),i.Yb(),i.Yb()),2&t&&(i.Gb(3),i.Sc(i.nc(4,23,"wiredfurni.params.bot.name")),i.Gb(2),i.sc("ngModel",e.botName),i.Gb(3),i.Sc(i.nc(9,25,"wiredfurni.params.handitem")),i.Gb(2),i.sc("ngModel",e.handitemId),i.Gb(1),i.sc("selected","0"==e.handitemId),i.Gb(1),i.Sc(i.nc(13,27,"wiredfurni.tooltip.handitem")),i.Gb(2),i.sc("selected","2"==e.handitemId),i.Gb(1),i.Sc(i.nc(16,29,"handitem2")),i.Gb(2),i.sc("selected","5"==e.handitemId),i.Gb(1),i.Sc(i.nc(19,31,"handitem5")),i.Gb(2),i.sc("selected","7"==e.handitemId),i.Gb(1),i.Sc(i.nc(22,33,"handitem7")),i.Gb(2),i.sc("selected","8"==e.handitemId),i.Gb(1),i.Sc(i.nc(25,35,"handitem8")),i.Gb(2),i.sc("selected","9"==e.handitemId),i.Gb(1),i.Sc(i.nc(28,37,"handitem9")),i.Gb(2),i.sc("selected","10"==e.handitemId),i.Gb(1),i.Sc(i.nc(31,39,"handitem10")),i.Gb(2),i.sc("selected","27"==e.handitemId),i.Gb(1),i.Sc(i.nc(34,41,"handitem27")),i.Gb(3),i.Sc(i.oc(37,43,"wiredfurni.params.delay",e.updateCount)),i.Gb(5),i.sc("options",e.delaySliderOptions)("value",e.delay))},encapsulation:2}),t})();const vI=i.bc(II);let TI=(()=>{class t extends rR{get code(){return t.CODE}onEditStart(t){this.botName=t.stringData,super.onEditStart(t)}readStringParamFromForm(){return this.botName}get hasSpecialInputs(){return!0}get requiresFurni(){return Iv._Str_4873}}return t.CODE=SI.BOT_MOVE,t.\u0275fac=function(e){return OI(e||t)},t.\u0275cmp=i.Ob({type:t,selectors:[["ng-component"]],features:[i.Db],decls:15,vars:10,consts:[[1,"form-group"],["type","text","maxlength","32",1,"form-control","form-control-sm",3,"ngModel","ngModelChange"],[1,"w-100","text-center","mb-1"],[1,"d-flex","align-items-center","justify-content-center","my-2","custom-slider"],["type","button",1,"btn","btn-primary","btn-sm",3,"click"],[1,"fas","fa-arrow-left"],["name","delay",3,"options","value","valueChange"],[1,"fas","fa-arrow-right"]],template:function(t,e){1&t&&(i.Zb(0,"nitro-wired-base-component"),i.Zb(1,"div",0),i.Zb(2,"label"),i.Rc(3),i.mc(4,"translate"),i.Yb(),i.Zb(5,"input",1),i.jc("ngModelChange",(function(t){return e.botName=t})),i.Yb(),i.Yb(),i.Zb(6,"p",2),i.Rc(7),i.mc(8,"translate"),i.Yb(),i.Zb(9,"div",3),i.Zb(10,"button",4),i.jc("click",(function(){return e.decreaseDelay()})),i.Vb(11,"i",5),i.Yb(),i.Zb(12,"ngx-slider",6),i.jc("valueChange",(function(t){return e.delay=t}))("valueChange",(function(){return e.onSliderChange()})),i.Yb(),i.Zb(13,"button",4),i.jc("click",(function(){return e.increaseDelay()})),i.Vb(14,"i",7),i.Yb(),i.Yb(),i.Yb()),2&t&&(i.Gb(3),i.Sc(i.nc(4,5,"wiredfurni.params.bot.name")),i.Gb(2),i.sc("ngModel",e.botName),i.Gb(2),i.Sc(i.oc(8,7,"wiredfurni.params.delay",e.updateCount)),i.Gb(5),i.sc("options",e.delaySliderOptions)("value",e.delay))},encapsulation:2}),t})();const OI=i.bc(TI);let AI=(()=>{class t extends rR{get code(){return t.CODE}onEditStart(e){const s=e.stringData.split(t.DELIMETER);this.botName=s.length>=1?s[0]:"",this.message=2==s.length?s[1]:"",this.mode=e.intData.length>0?e.intData[0].toString():"0",super.onEditStart(e)}get hasSpecialInputs(){return!0}get requiresFurni(){return Iv._Str_5431}readStringParamFromForm(){return this.botName+t.DELIMETER+this.message}readIntegerParamsFromForm(){return[Number.parseInt(this.mode)]}}return t.CODE=SI.BOT_TALK_DIRECT_TO_AVTR,t.DELIMETER="\t",t.\u0275fac=function(e){return yI(e||t)},t.\u0275cmp=i.Ob({type:t,selectors:[["ng-component"]],features:[i.Db],decls:30,vars:22,consts:[[1,"form-group"],["type","text","maxlength","32",1,"form-control","form-control-sm",3,"ngModel","ngModelChange"],["type","text","maxlength","64",1,"form-control","form-control-sm",3,"ngModel","ngModelChange"],[1,"form-check"],["type","radio","name","radio","value","1",1,"form-check-input",3,"ngModel","ngModelChange"],[1,"form-check-label"],["type","radio","name","radio","value","0",1,"form-check-input",3,"ngModel","ngModelChange"],[1,"w-100","text-center","mb-1"],[1,"d-flex","align-items-center","justify-content-center","my-2","custom-slider"],["type","button",1,"btn","btn-primary","btn-sm",3,"click"],[1,"fas","fa-arrow-left"],["name","delay",3,"options","value","valueChange"],[1,"fas","fa-arrow-right"]],template:function(t,e){1&t&&(i.Zb(0,"nitro-wired-base-component"),i.Zb(1,"div",0),i.Zb(2,"label"),i.Rc(3),i.mc(4,"translate"),i.Yb(),i.Zb(5,"input",1),i.jc("ngModelChange",(function(t){return e.botName=t})),i.Yb(),i.Yb(),i.Zb(6,"div",0),i.Zb(7,"label"),i.Rc(8),i.mc(9,"translate"),i.Yb(),i.Zb(10,"input",2),i.jc("ngModelChange",(function(t){return e.message=t})),i.Yb(),i.Yb(),i.Zb(11,"div",3),i.Zb(12,"input",4),i.jc("ngModelChange",(function(t){return e.mode=t})),i.Yb(),i.Zb(13,"label",5),i.Rc(14),i.mc(15,"translate"),i.Yb(),i.Yb(),i.Zb(16,"div",3),i.Zb(17,"input",6),i.jc("ngModelChange",(function(t){return e.mode=t})),i.Yb(),i.Zb(18,"label",5),i.Rc(19),i.mc(20,"translate"),i.Yb(),i.Yb(),i.Zb(21,"p",7),i.Rc(22),i.mc(23,"translate"),i.Yb(),i.Zb(24,"div",8),i.Zb(25,"button",9),i.jc("click",(function(){return e.decreaseDelay()})),i.Vb(26,"i",10),i.Yb(),i.Zb(27,"ngx-slider",11),i.jc("valueChange",(function(t){return e.delay=t}))("valueChange",(function(){return e.onSliderChange()})),i.Yb(),i.Zb(28,"button",9),i.jc("click",(function(){return e.increaseDelay()})),i.Vb(29,"i",12),i.Yb(),i.Yb(),i.Yb()),2&t&&(i.Gb(3),i.Sc(i.nc(4,11,"wiredfurni.params.bot.name")),i.Gb(2),i.sc("ngModel",e.botName),i.Gb(3),i.Sc(i.nc(9,13,"wiredfurni.params.message")),i.Gb(2),i.sc("ngModel",e.message),i.Gb(2),i.sc("ngModel",e.mode),i.Gb(2),i.Sc(i.nc(15,15,"wiredfurni.params.whisper")),i.Gb(3),i.sc("ngModel",e.mode),i.Gb(2),i.Sc(i.nc(20,17,"wiredfurni.params.talk")),i.Gb(3),i.Sc(i.oc(23,19,"wiredfurni.params.delay",e.updateCount)),i.Gb(5),i.sc("options",e.delaySliderOptions)("value",e.delay))},encapsulation:2}),t})();const yI=i.bc(AI);let CI=(()=>{class t extends rR{get code(){return t.CODE}onEditStart(e){const s=e.stringData.split(t.DELIMETER);this.botName=s.length>=1?s[0]:"",this.message=2==s.length?s[1]:"",this.mode=e.intData.length>0?e.intData[0].toString():"0",super.onEditStart(e)}get hasSpecialInputs(){return!0}get requiresFurni(){return Iv._Str_5431}readStringParamFromForm(){return this.botName+t.DELIMETER+this.message}readIntegerParamsFromForm(){return[Number.parseInt(this.mode)]}}return t.CODE=SI.BOT_TALK,t.DELIMETER="\t",t.\u0275fac=function(e){return MI(e||t)},t.\u0275cmp=i.Ob({type:t,selectors:[["ng-component"]],features:[i.Db],decls:30,vars:22,consts:[[1,"form-group"],["type","text","maxlength","32",1,"form-control","form-control-sm",3,"ngModel","ngModelChange"],["type","text","maxlength","64",1,"form-control","form-control-sm",3,"ngModel","ngModelChange"],[1,"form-check"],["type","radio","name","radio","value","0",1,"form-check-input",3,"ngModel","ngModelChange"],[1,"form-check-label"],["type","radio","name","radio","value","1",1,"form-check-input",3,"ngModel","ngModelChange"],[1,"w-100","text-center","mb-1"],[1,"d-flex","align-items-center","justify-content-center","my-2","custom-slider"],["type","button",1,"btn","btn-primary","btn-sm",3,"click"],[1,"fas","fa-arrow-left"],["name","delay",3,"options","value","valueChange"],[1,"fas","fa-arrow-right"]],template:function(t,e){1&t&&(i.Zb(0,"nitro-wired-base-component"),i.Zb(1,"div",0),i.Zb(2,"label"),i.Rc(3),i.mc(4,"translate"),i.Yb(),i.Zb(5,"input",1),i.jc("ngModelChange",(function(t){return e.botName=t})),i.Yb(),i.Yb(),i.Zb(6,"div",0),i.Zb(7,"label"),i.Rc(8),i.mc(9,"translate"),i.Yb(),i.Zb(10,"input",2),i.jc("ngModelChange",(function(t){return e.message=t})),i.Yb(),i.Yb(),i.Zb(11,"div",3),i.Zb(12,"input",4),i.jc("ngModelChange",(function(t){return e.mode=t})),i.Yb(),i.Zb(13,"label",5),i.Rc(14),i.mc(15,"translate"),i.Yb(),i.Yb(),i.Zb(16,"div",3),i.Zb(17,"input",6),i.jc("ngModelChange",(function(t){return e.mode=t})),i.Yb(),i.Zb(18,"label",5),i.Rc(19),i.mc(20,"translate"),i.Yb(),i.Yb(),i.Zb(21,"p",7),i.Rc(22),i.mc(23,"translate"),i.Yb(),i.Zb(24,"div",8),i.Zb(25,"button",9),i.jc("click",(function(){return e.decreaseDelay()})),i.Vb(26,"i",10),i.Yb(),i.Zb(27,"ngx-slider",11),i.jc("valueChange",(function(t){return e.delay=t}))("valueChange",(function(){return e.onSliderChange()})),i.Yb(),i.Zb(28,"button",9),i.jc("click",(function(){return e.increaseDelay()})),i.Vb(29,"i",12),i.Yb(),i.Yb(),i.Yb()),2&t&&(i.Gb(3),i.Sc(i.nc(4,11,"wiredfurni.params.bot.name")),i.Gb(2),i.sc("ngModel",e.botName),i.Gb(3),i.Sc(i.nc(9,13,"wiredfurni.params.message")),i.Gb(2),i.sc("ngModel",e.message),i.Gb(2),i.sc("ngModel",e.mode),i.Gb(2),i.Sc(i.nc(15,15,"wiredfurni.params.talk")),i.Gb(3),i.sc("ngModel",e.mode),i.Gb(2),i.Sc(i.nc(20,17,"wiredfurni.params.shout")),i.Gb(3),i.Sc(i.oc(23,19,"wiredfurni.params.delay",e.updateCount)),i.Gb(5),i.sc("options",e.delaySliderOptions)("value",e.delay))},encapsulation:2}),t})();const MI=i.bc(CI);let DI=(()=>{class t extends rR{get code(){return t.CODE}onEditStart(t){this.botName=t.stringData,super.onEditStart(t)}readStringParamFromForm(){return this.botName}get hasSpecialInputs(){return!0}get requiresFurni(){return Iv._Str_4873}}return t.CODE=SI.BOT_TELEPORT,t.\u0275fac=function(e){return NI(e||t)},t.\u0275cmp=i.Ob({type:t,selectors:[["ng-component"]],features:[i.Db],decls:15,vars:10,consts:[[1,"form-group"],["type","text","maxlength","32",1,"form-control","form-control-sm",3,"ngModel","ngModelChange"],[1,"w-100","text-center","mb-1"],[1,"d-flex","align-items-center","justify-content-center","my-2","custom-slider"],["type","button",1,"btn","btn-primary","btn-sm",3,"click"],[1,"fas","fa-arrow-left"],["name","delay",3,"options","value","valueChange"],[1,"fas","fa-arrow-right"]],template:function(t,e){1&t&&(i.Zb(0,"nitro-wired-base-component"),i.Zb(1,"div",0),i.Zb(2,"label"),i.Rc(3),i.mc(4,"translate"),i.Yb(),i.Zb(5,"input",1),i.jc("ngModelChange",(function(t){return e.botName=t})),i.Yb(),i.Yb(),i.Zb(6,"p",2),i.Rc(7),i.mc(8,"translate"),i.Yb(),i.Zb(9,"div",3),i.Zb(10,"button",4),i.jc("click",(function(){return e.decreaseDelay()})),i.Vb(11,"i",5),i.Yb(),i.Zb(12,"ngx-slider",6),i.jc("valueChange",(function(t){return e.delay=t}))("valueChange",(function(){return e.onSliderChange()})),i.Yb(),i.Zb(13,"button",4),i.jc("click",(function(){return e.increaseDelay()})),i.Vb(14,"i",7),i.Yb(),i.Yb(),i.Yb()),2&t&&(i.Gb(3),i.Sc(i.nc(4,5,"wiredfurni.params.bot.name")),i.Gb(2),i.sc("ngModel",e.botName),i.Gb(2),i.Sc(i.oc(8,7,"wiredfurni.params.delay",e.updateCount)),i.Gb(5),i.sc("options",e.delaySliderOptions)("value",e.delay))},encapsulation:2}),t})();const NI=i.bc(DI);let wI=(()=>{class t extends rR{get code(){return t.CODE}get requiresFurni(){return Iv._Str_5430}}return t.CODE=SI.CALL_ANOTHER_STACK,t.\u0275fac=function(e){return UI(e||t)},t.\u0275cmp=i.Ob({type:t,selectors:[["ng-component"]],features:[i.Db],decls:10,vars:6,consts:[[1,"w-100","text-center","mb-1"],[1,"d-flex","align-items-center","justify-content-center","my-2","custom-slider"],["type","button",1,"btn","btn-primary","btn-sm",3,"click"],[1,"fas","fa-arrow-left"],["name","delay",3,"options","value","valueChange"],[1,"fas","fa-arrow-right"]],template:function(t,e){1&t&&(i.Zb(0,"nitro-wired-base-component"),i.Zb(1,"p",0),i.Rc(2),i.mc(3,"translate"),i.Yb(),i.Zb(4,"div",1),i.Zb(5,"button",2),i.jc("click",(function(){return e.decreaseDelay()})),i.Vb(6,"i",3),i.Yb(),i.Zb(7,"ngx-slider",4),i.jc("valueChange",(function(t){return e.delay=t}))("valueChange",(function(){return e.onSliderChange()})),i.Yb(),i.Zb(8,"button",2),i.jc("click",(function(){return e.increaseDelay()})),i.Vb(9,"i",5),i.Yb(),i.Yb(),i.Yb()),2&t&&(i.Gb(2),i.Sc(i.oc(3,3,"wiredfurni.params.delay",e.updateCount)),i.Gb(5),i.sc("options",e.delaySliderOptions)("value",e.delay))},encapsulation:2}),t})();const UI=i.bc(wI);let LI=(()=>{class t extends rR{get code(){return t.CODE}get requiresFurni(){return Iv._Str_5430}}return t.CODE=SI.CHASE,t.\u0275fac=function(e){return PI(e||t)},t.\u0275cmp=i.Ob({type:t,selectors:[["ng-component"]],features:[i.Db],decls:10,vars:6,consts:[[1,"w-100","text-center","mb-1"],[1,"d-flex","align-items-center","justify-content-center","my-2","custom-slider"],["type","button",1,"btn","btn-primary","btn-sm",3,"click"],[1,"fas","fa-arrow-left"],["name","delay",3,"options","value","valueChange"],[1,"fas","fa-arrow-right"]],template:function(t,e){1&t&&(i.Zb(0,"nitro-wired-base-component"),i.Zb(1,"p",0),i.Rc(2),i.mc(3,"translate"),i.Yb(),i.Zb(4,"div",1),i.Zb(5,"button",2),i.jc("click",(function(){return e.decreaseDelay()})),i.Vb(6,"i",3),i.Yb(),i.Zb(7,"ngx-slider",4),i.jc("valueChange",(function(t){return e.delay=t}))("valueChange",(function(){return e.onSliderChange()})),i.Yb(),i.Zb(8,"button",2),i.jc("click",(function(){return e.increaseDelay()})),i.Vb(9,"i",5),i.Yb(),i.Yb(),i.Yb()),2&t&&(i.Gb(2),i.Sc(i.oc(3,3,"wiredfurni.params.delay",e.updateCount)),i.Gb(5),i.sc("options",e.delaySliderOptions)("value",e.delay))},encapsulation:2}),t})();const PI=i.bc(LI);let xI=(()=>{class t extends rR{get code(){return t.CODE}get hasSpecialInputs(){return!0}readStringParamFromForm(){return this.message}onEditStart(t){this.message=t.stringData,super.onEditStart(t)}validate(){return this.message.length>100?um.instance.localization.getValue("wiredfurni.chatmsgtoolong",!1):null}}return t.CODE=SI.CHAT,t.\u0275fac=function(e){return FI(e||t)},t.\u0275cmp=i.Ob({type:t,selectors:[["ng-component"]],features:[i.Db],decls:15,vars:10,consts:[[1,"form-group"],["type","text",1,"form-control","form-control-sm",3,"ngModel","ngModelChange"],[1,"w-100","text-center","mb-1"],[1,"d-flex","align-items-center","justify-content-center","my-2","custom-slider"],["type","button",1,"btn","btn-primary","btn-sm",3,"click"],[1,"fas","fa-arrow-left"],["name","delay",3,"options","value","valueChange"],[1,"fas","fa-arrow-right"]],template:function(t,e){1&t&&(i.Zb(0,"nitro-wired-base-component"),i.Zb(1,"div",0),i.Zb(2,"label"),i.Rc(3),i.mc(4,"translate"),i.Yb(),i.Zb(5,"input",1),i.jc("ngModelChange",(function(t){return e.message=t})),i.Yb(),i.Yb(),i.Zb(6,"p",2),i.Rc(7),i.mc(8,"translate"),i.Yb(),i.Zb(9,"div",3),i.Zb(10,"button",4),i.jc("click",(function(){return e.decreaseDelay()})),i.Vb(11,"i",5),i.Yb(),i.Zb(12,"ngx-slider",6),i.jc("valueChange",(function(t){return e.delay=t}))("valueChange",(function(){return e.onSliderChange()})),i.Yb(),i.Zb(13,"button",4),i.jc("click",(function(){return e.increaseDelay()})),i.Vb(14,"i",7),i.Yb(),i.Yb(),i.Yb()),2&t&&(i.Gb(3),i.Sc(i.nc(4,5,"wiredfurni.params.message")),i.Gb(2),i.sc("ngModel",e.message),i.Gb(2),i.Sc(i.oc(8,7,"wiredfurni.params.delay",e.updateCount)),i.Gb(5),i.sc("options",e.delaySliderOptions)("value",e.delay))},encapsulation:2}),t})();const FI=i.bc(xI);let GI=(()=>{class t extends rR{get code(){return t.CODE}get requiresFurni(){return Iv._Str_5430}}return t.CODE=SI.FLEE,t.\u0275fac=function(e){return VI(e||t)},t.\u0275cmp=i.Ob({type:t,selectors:[["ng-component"]],features:[i.Db],decls:10,vars:6,consts:[[1,"w-100","text-center","mb-1"],[1,"d-flex","align-items-center","justify-content-center","my-2","custom-slider"],["type","button",1,"btn","btn-primary","btn-sm",3,"click"],[1,"fas","fa-arrow-left"],["name","delay",3,"options","value","valueChange"],[1,"fas","fa-arrow-right"]],template:function(t,e){1&t&&(i.Zb(0,"nitro-wired-base-component"),i.Zb(1,"p",0),i.Rc(2),i.mc(3,"translate"),i.Yb(),i.Zb(4,"div",1),i.Zb(5,"button",2),i.jc("click",(function(){return e.decreaseDelay()})),i.Vb(6,"i",3),i.Yb(),i.Zb(7,"ngx-slider",4),i.jc("valueChange",(function(t){return e.delay=t}))("valueChange",(function(){return e.onSliderChange()})),i.Yb(),i.Zb(8,"button",2),i.jc("click",(function(){return e.increaseDelay()})),i.Vb(9,"i",5),i.Yb(),i.Yb(),i.Yb()),2&t&&(i.Gb(2),i.Sc(i.oc(3,3,"wiredfurni.params.delay",e.updateCount)),i.Gb(5),i.sc("options",e.delaySliderOptions)("value",e.delay))},encapsulation:2}),t})();const VI=i.bc(GI);function YI(t,e){if(1&t){const t=i.ac();i.Zb(0,"div",21),i.Zb(1,"button",17),i.jc("click",(function(){return i.Ec(t),i.lc().decreaseLimit()})),i.Vb(2,"i",18),i.Yb(),i.Zb(3,"ngx-slider",22),i.jc("valueChange",(function(e){return i.Ec(t),i.lc().rewardsLimit=e}))("valueChange",(function(){return i.Ec(t),i.lc().onSliderChange()})),i.Yb(),i.Zb(4,"button",17),i.jc("click",(function(){return i.Ec(t),i.lc().increaseLimit()})),i.Vb(5,"i",20),i.Yb(),i.Yb()}if(2&t){const t=i.lc();i.Gb(3),i.sc("options",t.limitSliderOptions)("value",t.rewardsLimit)}}function kI(t,e){if(1&t){const t=i.ac();i.Zb(0,"div",23),i.Zb(1,"label"),i.Rc(2,"Interval value"),i.Yb(),i.Zb(3,"input",24),i.jc("ngModelChange",(function(e){return i.Ec(t),i.lc().limitationInterval=e})),i.Yb(),i.Yb()}if(2&t){const t=i.lc();i.Gb(3),i.sc("ngModel",t.limitationInterval)}}function jI(t,e){1&t&&(i.Zb(0,"td"),i.Zb(1,"small"),i.Rc(2,"Probability"),i.Yb(),i.Yb())}function BI(t,e){if(1&t){const t=i.ac();i.Zb(0,"td"),i.Zb(1,"input",24),i.jc("ngModelChange",(function(e){i.Ec(t);const s=i.lc().index;return i.lc().rewardRows[s].probability=e})),i.Yb(),i.Yb()}if(2&t){const t=i.lc().index,e=i.lc();i.Gb(1),i.sc("ngModel",e.rewardRows[t].probability)}}function HI(t,e){if(1&t){const t=i.ac();i.Zb(0,"tr"),i.Zb(1,"td"),i.Zb(2,"input",25),i.jc("ngModelChange",(function(s){i.Ec(t);const r=e.index;return i.lc().rewardRows[r].badge=s})),i.Yb(),i.Yb(),i.Zb(3,"td"),i.Zb(4,"input",24),i.jc("ngModelChange",(function(s){i.Ec(t);const r=e.index;return i.lc().rewardRows[r].itemCode=s})),i.Yb(),i.Yb(),i.Pc(5,BI,2,1,"td",11),i.Yb()}if(2&t){const t=e.index,s=i.lc();i.Gb(2),i.sc("ngModel",s.rewardRows[t].badge),i.Gb(2),i.sc("ngModel",s.rewardRows[t].itemCode),i.Gb(1),i.sc("ngIf",0==s.uniqueRewards)}}let WI=(()=>{class t extends rR{constructor(){super(...arguments),this.SETTING_ONCE="0",this.SETTING_N_MINS="3",this.SETTING_N_HOURS="2",this.SETTING_N_DAYS="1",this.limitationInterval="1",this.uniqueRewards=!1,this.rewardRows=[]}get code(){return t.CODE}onEditStart(t){if(this.rewardTime=(t.intData.length>0?t.intData[0]:0).toString(),this.uniqueRewards=t.intData.length>1&&1==t.intData[1],this.rewardsLimit=t.intData.length>2?t.intData[2]:0,this.limitationInterval=t.intData.length>3?t.intData[3].toString():"",this.limitEnabled=this.limitationInterval.length>0,t.stringData.length>0&&t.stringData.includes(";")&&t.stringData.split(";").forEach(t=>{if(t.length>0&&t.includes(",")){const e=t.split(",");3==e.length&&this.rewardRows.push({badge:"0"==e[0],itemCode:e[1],probability:e[2]})}}),this.rewardRows.length<4)for(let e=this.rewardRows.length;e<4;e++)this.rewardRows.push({badge:!1,itemCode:"",probability:""});super.onEditStart(t)}readIntegerParamsFromForm(){return[Number.parseInt(this.rewardTime),this.uniqueRewards?1:0,this.rewardsLimit,Number.parseInt(this.limitationInterval)]}readStringParamFromForm(){let t="";for(let e=0;e<this.rewardRows.length;e++){const s=this.rewardRows[e];""!=s.itemCode&&(t=t+(""==t?"":";")+[s.badge?0:1,s.itemCode,s.probability.toString()].join(","))}return t}decreaseLimit(){this.rewardsLimit-=1,this.rewardsLimit<t.LIMIT_MINIMUM_VALUE&&(this.rewardsLimit=t.LIMIT_MINIMUM_VALUE)}increaseLimit(){this.rewardsLimit+=1,this.rewardsLimit>t.LIMIT_MAXIMUM_VALUE&&(this.rewardsLimit=t.LIMIT_MAXIMUM_VALUE)}increaseRewardsCount(){this.rewardRows.push({badge:!1,itemCode:"",probability:""})}updateLocaleParameter(){um.instance.localization.registerParameter("wiredfurni.params.prizelimit","amount",this.rewardsLimit>0?this.rewardsLimit.toString():""),super.updateLocaleParameter()}get limitSliderOptions(){return{floor:t.LIMIT_MINIMUM_VALUE,ceil:t.LIMIT_MAXIMUM_VALUE,step:t.LIMIT_STEPPER_VALUE,hidePointerLabels:!0,hideLimitLabels:!0}}get hasIntervalValue(){return this.rewardTime==this.SETTING_N_DAYS||this.rewardTime==this.SETTING_N_HOURS||this.rewardTime==this.SETTING_N_MINS}validate(){let t=0;if(this.limitationInterval.trim().length>0&&isNaN(Number.parseInt(this.limitationInterval)))return"The interval value has to be a number.";for(let e=0;e<this.rewardRows.length;e++){const s=this.rewardRows[e];if(0!=s.itemCode.trim().length||0!=s.probability.trim().length){if(s.itemCode.includes(","))return"Product/badge codes must not contain ',' characters.";if(s.itemCode.includes(";"))return"Product/badge codes must not contain ';' characters.";if(s.itemCode.length>100)return"Product/badge codes cannot contain more than 100 characters.";if(""==s.itemCode)return"Remember to define product/badge codes for all rewards (fill all fields or leave all fields empty).";if(!this.uniqueRewards){if(""==s.probability)return"Remember to define probabilities for all rewards (fill all fields or leave all fields empty).";const e=Number.parseInt(s.probability);if(isNaN(e))return"Make sure all probabilities are numbers.";if(e<1||e>100)return"Make sure all probabilities are numbers between 1 and 100.";t+=e}}}return t>100?`The sum of probabilities cannot exceed 100. You now have ${t}.`:null}}return t.LIMIT_MINIMUM_VALUE=1,t.LIMIT_MAXIMUM_VALUE=1e3,t.LIMIT_STEPPER_VALUE=1,t.CODE=SI.GIVE_REWARD,t.\u0275fac=function(e){return ZI(e||t)},t.\u0275cmp=i.Ob({type:t,selectors:[["ng-component"]],features:[i.Db],decls:49,vars:27,consts:[[1,"form-check"],["type","checkbox",1,"form-check-input",3,"ngModel","ngModelChange"],[1,"form-check-label"],["class","d-flex align-items-center justify-content-center my-2 custom-slider mb-2",4,"ngIf"],[1,"form-group"],[1,"form-control","form-control-sm",3,"ngModel","ngModelChange"],[3,"value","selected"],["class","form-group mb-2",4,"ngIf"],[1,"w-100","text-center","mb-2"],[1,"form-row","mb-2"],[2,"min-height","200px","max-height","200px"],[4,"ngIf"],[4,"ngFor","ngForOf"],["type","button",1,"btn","btn-primary","btn-sm","mb-2",3,"click"],[1,"fas","fa-plus"],[1,"w-100","text-center","mb-1"],[1,"d-flex","align-items-center","justify-content-center","my-2","custom-slider"],["type","button",1,"btn","btn-primary","btn-sm",3,"click"],[1,"fas","fa-arrow-left"],["name","delay",3,"options","value","valueChange"],[1,"fas","fa-arrow-right"],[1,"d-flex","align-items-center","justify-content-center","my-2","custom-slider","mb-2"],["name","limit",3,"options","value","valueChange"],[1,"form-group","mb-2"],["type","text",1,"form-control","form-control-sm",3,"ngModel","ngModelChange"],["type","checkbox",3,"ngModel","ngModelChange"]],template:function(t,e){1&t&&(i.Zb(0,"nitro-wired-base-component"),i.Zb(1,"div",0),i.Zb(2,"input",1),i.jc("ngModelChange",(function(t){return e.limitEnabled=t})),i.Yb(),i.Zb(3,"label",2),i.Rc(4),i.mc(5,"translate"),i.Yb(),i.Yb(),i.Pc(6,YI,6,2,"div",3),i.Zb(7,"div",4),i.Zb(8,"label"),i.Rc(9,"How often can a user be rewarded"),i.Yb(),i.Zb(10,"select",5),i.jc("ngModelChange",(function(t){return e.rewardTime=t})),i.Zb(11,"option",6),i.Rc(12,"Once"),i.Yb(),i.Zb(13,"option",6),i.Rc(14,"1/n minutes"),i.Yb(),i.Zb(15,"option",6),i.Rc(16,"1/n hours"),i.Yb(),i.Zb(17,"option",6),i.Rc(18,"1/n days"),i.Yb(),i.Yb(),i.Yb(),i.Pc(19,kI,4,1,"div",7),i.Zb(20,"div",0),i.Zb(21,"input",1),i.jc("ngModelChange",(function(t){return e.uniqueRewards=t})),i.Yb(),i.Zb(22,"label",2),i.Rc(23,"Unique Rewards"),i.Yb(),i.Yb(),i.Zb(24,"p",8),i.Rc(25,"If checked each reward will be given once to each user. This will disable the probabilities option."),i.Yb(),i.Zb(26,"div",9),i.Zb(27,"perfect-scrollbar",10),i.Zb(28,"table"),i.Zb(29,"tr"),i.Zb(30,"td"),i.Zb(31,"small"),i.Rc(32,"Badge"),i.Yb(),i.Yb(),i.Zb(33,"td"),i.Zb(34,"small"),i.Rc(35,"Item code"),i.Yb(),i.Yb(),i.Pc(36,jI,3,0,"td",11),i.Yb(),i.Pc(37,HI,6,3,"tr",12),i.Yb(),i.Yb(),i.Yb(),i.Zb(38,"button",13),i.jc("click",(function(){return e.increaseRewardsCount()})),i.Vb(39,"i",14),i.Yb(),i.Zb(40,"p",15),i.Rc(41),i.mc(42,"translate"),i.Yb(),i.Zb(43,"div",16),i.Zb(44,"button",17),i.jc("click",(function(){return e.decreaseDelay()})),i.Vb(45,"i",18),i.Yb(),i.Zb(46,"ngx-slider",19),i.jc("valueChange",(function(t){return e.delay=t}))("valueChange",(function(){return e.onSliderChange()})),i.Yb(),i.Zb(47,"button",17),i.jc("click",(function(){return e.increaseDelay()})),i.Vb(48,"i",20),i.Yb(),i.Yb(),i.Yb()),2&t&&(i.Gb(2),i.sc("ngModel",e.limitEnabled),i.Gb(2),i.Sc(i.oc(5,21,"wiredfurni.params.prizelimit",e.updateCount)),i.Gb(2),i.sc("ngIf",e.limitEnabled),i.Gb(4),i.Mb("mb-2",!e.hasIntervalValue),i.sc("ngModel",e.rewardTime),i.Gb(1),i.sc("value",e.SETTING_ONCE)("selected",e.rewardTime==e.SETTING_ONCE),i.Gb(2),i.sc("value",e.SETTING_N_MINS)("selected",e.rewardTime==e.SETTING_N_MINS),i.Gb(2),i.sc("value",e.SETTING_N_HOURS)("selected",e.rewardTime==e.SETTING_N_HOURS),i.Gb(2),i.sc("value",e.SETTING_N_DAYS)("selected",e.rewardTime==e.SETTING_N_DAYS),i.Gb(2),i.sc("ngIf",e.hasIntervalValue),i.Gb(2),i.sc("ngModel",e.uniqueRewards),i.Gb(15),i.sc("ngIf",0==e.uniqueRewards),i.Gb(1),i.sc("ngForOf",e.rewardRows),i.Gb(4),i.Sc(i.oc(42,24,"wiredfurni.params.delay",e.updateCount)),i.Gb(5),i.sc("options",e.delaySliderOptions)("value",e.delay))},encapsulation:2}),t})();const ZI=i.bc(WI);let zI=(()=>{class t extends rR{constructor(){super(...arguments),this.points=1,this.times=1}get code(){return t.CODE}onEditStart(t){this.points=t.intData.length>0?t.intData[0]:1,this.times=t.intData.length>1?t.intData[1]:1,this.team=(t.intData.length>2?t.intData[2]:1).toString(),super.onEditStart(t)}readIntegerParamsFromForm(){return[this.points,this.times,Number.parseInt(this.team)]}get hasSpecialInputs(){return!0}decreasePoints(){this.points-=1,this.points<t.MINIMUM_VALUE&&(this.points=t.MINIMUM_VALUE)}increasePoints(){this.points+=1,this.points>t.POINTS_MAXIMUM_VALUE&&(this.points=t.POINTS_MAXIMUM_VALUE)}decreaseTimes(){this.times-=1,this.times<t.MINIMUM_VALUE&&(this.times=t.MINIMUM_VALUE)}increaseTimes(){this.times+=1,this.times>t.TIMES_MAXIMUM_VALUE&&(this.times=t.TIMES_MAXIMUM_VALUE)}updateLocaleParameter(){um.instance.localization.registerParameter("wiredfurni.params.setpoints","points",this.points.toString()),um.instance.localization.registerParameter("wiredfurni.params.settimesingame","times",this.times.toString()),super.updateLocaleParameter()}get pointsSliderOptions(){return{floor:t.MINIMUM_VALUE,ceil:t.POINTS_MAXIMUM_VALUE,step:t.STEPPER_VALUE,hidePointerLabels:!0,hideLimitLabels:!0}}get timesSliderOptions(){return{floor:t.MINIMUM_VALUE,ceil:t.TIMES_MAXIMUM_VALUE,step:t.STEPPER_VALUE,hidePointerLabels:!0,hideLimitLabels:!0}}}return t.MINIMUM_VALUE=1,t.STEPPER_VALUE=1,t.POINTS_MAXIMUM_VALUE=100,t.TIMES_MAXIMUM_VALUE=10,t.CODE=SI.GIVE_SCORE_TO_PREDEFINED_TEAM,t.\u0275fac=function(e){return XI(e||t)},t.\u0275cmp=i.Ob({type:t,selectors:[["ng-component"]],features:[i.Db],decls:45,vars:38,consts:[[1,"w-100","text-center","mb-1"],[1,"d-flex","align-items-center","justify-content-center","my-2","custom-slider"],["type","button",1,"btn","btn-primary","btn-sm",3,"click"],[1,"fas","fa-arrow-left"],["name","points",3,"options","value","valueChange"],[1,"fas","fa-arrow-right"],["name","times",3,"options","value","valueChange"],[1,"form-group"],[1,"form-control","form-control-sm",3,"ngModel","ngModelChange"],["value","1",3,"selected"],["value","2",3,"selected"],["value","3",3,"selected"],["value","4",3,"selected"],["name","delay",3,"options","value","valueChange"]],template:function(t,e){1&t&&(i.Zb(0,"nitro-wired-base-component"),i.Zb(1,"p",0),i.Rc(2),i.mc(3,"translate"),i.Yb(),i.Zb(4,"div",1),i.Zb(5,"button",2),i.jc("click",(function(){return e.decreasePoints()})),i.Vb(6,"i",3),i.Yb(),i.Zb(7,"ngx-slider",4),i.jc("valueChange",(function(t){return e.points=t}))("valueChange",(function(){return e.onSliderChange()})),i.Yb(),i.Zb(8,"button",2),i.jc("click",(function(){return e.increasePoints()})),i.Vb(9,"i",5),i.Yb(),i.Yb(),i.Zb(10,"p",0),i.Rc(11),i.mc(12,"translate"),i.Yb(),i.Zb(13,"div",1),i.Zb(14,"button",2),i.jc("click",(function(){return e.decreaseTimes()})),i.Vb(15,"i",3),i.Yb(),i.Zb(16,"ngx-slider",6),i.jc("valueChange",(function(t){return e.times=t}))("valueChange",(function(){return e.onSliderChange()})),i.Yb(),i.Zb(17,"button",2),i.jc("click",(function(){return e.increaseTimes()})),i.Vb(18,"i",5),i.Yb(),i.Yb(),i.Zb(19,"div",7),i.Zb(20,"label"),i.Rc(21),i.mc(22,"translate"),i.Yb(),i.Zb(23,"select",8),i.jc("ngModelChange",(function(t){return e.team=t})),i.Zb(24,"option",9),i.Rc(25),i.mc(26,"translate"),i.Yb(),i.Zb(27,"option",10),i.Rc(28),i.mc(29,"translate"),i.Yb(),i.Zb(30,"option",11),i.Rc(31),i.mc(32,"translate"),i.Yb(),i.Zb(33,"option",12),i.Rc(34),i.mc(35,"translate"),i.Yb(),i.Yb(),i.Yb(),i.Zb(36,"p",0),i.Rc(37),i.mc(38,"translate"),i.Yb(),i.Zb(39,"div",1),i.Zb(40,"button",2),i.jc("click",(function(){return e.decreaseDelay()})),i.Vb(41,"i",3),i.Yb(),i.Zb(42,"ngx-slider",13),i.jc("valueChange",(function(t){return e.delay=t}))("valueChange",(function(){return e.onSliderChange()})),i.Yb(),i.Zb(43,"button",2),i.jc("click",(function(){return e.increaseDelay()})),i.Vb(44,"i",5),i.Yb(),i.Yb(),i.Yb()),2&t&&(i.Gb(2),i.Sc(i.oc(3,19,"wiredfurni.params.setpoints",e.updateCount)),i.Gb(5),i.sc("options",e.pointsSliderOptions)("value",e.points),i.Gb(4),i.Sc(i.oc(12,22,"wiredfurni.params.settimesingame",e.updateCount)),i.Gb(5),i.sc("options",e.timesSliderOptions)("value",e.times),i.Gb(5),i.Sc(i.nc(22,25,"wiredfurni.params.team")),i.Gb(2),i.sc("ngModel",e.team),i.Gb(1),i.sc("selected","1"==e.team),i.Gb(1),i.Sc(i.nc(26,27,"wiredfurni.params.team.1")),i.Gb(2),i.sc("selected","2"==e.team),i.Gb(1),i.Sc(i.nc(29,29,"wiredfurni.params.team.2")),i.Gb(2),i.sc("selected","3"==e.team),i.Gb(1),i.Sc(i.nc(32,31,"wiredfurni.params.team.3")),i.Gb(2),i.sc("selected","4"==e.team),i.Gb(1),i.Sc(i.nc(35,33,"wiredfurni.params.team.4")),i.Gb(3),i.Sc(i.oc(38,35,"wiredfurni.params.delay",e.updateCount)),i.Gb(5),i.sc("options",e.delaySliderOptions)("value",e.delay))},encapsulation:2}),t})();const XI=i.bc(zI);let KI=(()=>{class t extends rR{constructor(){super(...arguments),this.points=1,this.times=1}get code(){return t.CODE}onEditStart(t){this.points=t.intData.length>0?t.intData[0]:1,this.times=t.intData.length>1?t.intData[1]:1,super.onEditStart(t)}readIntegerParamsFromForm(){return[this.points,this.times]}get hasSpecialInputs(){return!0}decreasePoints(){this.points-=1,this.points<t.MINIMUM_VALUE&&(this.points=t.MINIMUM_VALUE)}increasePoints(){this.points+=1,this.points>t.POINTS_MAXIMUM_VALUE&&(this.points=t.POINTS_MAXIMUM_VALUE)}decreaseTimes(){this.times-=1,this.times<t.MINIMUM_VALUE&&(this.times=t.MINIMUM_VALUE)}increaseTimes(){this.times+=1,this.times>t.TIMES_MAXIMUM_VALUE&&(this.times=t.TIMES_MAXIMUM_VALUE)}updateLocaleParameter(){um.instance.localization.registerParameter("wiredfurni.params.setpoints","points",this.points.toString()),um.instance.localization.registerParameter("wiredfurni.params.settimesingame","times",this.times.toString()),super.updateLocaleParameter()}get pointsSliderOptions(){return{floor:t.MINIMUM_VALUE,ceil:t.POINTS_MAXIMUM_VALUE,step:t.STEPPER_VALUE,hidePointerLabels:!0,hideLimitLabels:!0}}get timesSliderOptions(){return{floor:t.MINIMUM_VALUE,ceil:t.TIMES_MAXIMUM_VALUE,step:t.STEPPER_VALUE,hidePointerLabels:!0,hideLimitLabels:!0}}}return t.MINIMUM_VALUE=1,t.STEPPER_VALUE=1,t.POINTS_MAXIMUM_VALUE=100,t.TIMES_MAXIMUM_VALUE=10,t.CODE=SI.GIVE_SCORE,t.\u0275fac=function(e){return qI(e||t)},t.\u0275cmp=i.Ob({type:t,selectors:[["ng-component"]],features:[i.Db],decls:28,vars:18,consts:[[1,"w-100","text-center","mb-1"],[1,"d-flex","align-items-center","justify-content-center","my-2","custom-slider"],["type","button",1,"btn","btn-primary","btn-sm",3,"click"],[1,"fas","fa-arrow-left"],["name","points",3,"options","value","valueChange"],[1,"fas","fa-arrow-right"],["name","times",3,"options","value","valueChange"],["name","delay",3,"options","value","valueChange"]],template:function(t,e){1&t&&(i.Zb(0,"nitro-wired-base-component"),i.Zb(1,"p",0),i.Rc(2),i.mc(3,"translate"),i.Yb(),i.Zb(4,"div",1),i.Zb(5,"button",2),i.jc("click",(function(){return e.decreasePoints()})),i.Vb(6,"i",3),i.Yb(),i.Zb(7,"ngx-slider",4),i.jc("valueChange",(function(t){return e.points=t}))("valueChange",(function(){return e.onSliderChange()})),i.Yb(),i.Zb(8,"button",2),i.jc("click",(function(){return e.increasePoints()})),i.Vb(9,"i",5),i.Yb(),i.Yb(),i.Zb(10,"p",0),i.Rc(11),i.mc(12,"translate"),i.Yb(),i.Zb(13,"div",1),i.Zb(14,"button",2),i.jc("click",(function(){return e.decreaseTimes()})),i.Vb(15,"i",3),i.Yb(),i.Zb(16,"ngx-slider",6),i.jc("valueChange",(function(t){return e.times=t}))("valueChange",(function(){return e.onSliderChange()})),i.Yb(),i.Zb(17,"button",2),i.jc("click",(function(){return e.increaseTimes()})),i.Vb(18,"i",5),i.Yb(),i.Yb(),i.Zb(19,"p",0),i.Rc(20),i.mc(21,"translate"),i.Yb(),i.Zb(22,"div",1),i.Zb(23,"button",2),i.jc("click",(function(){return e.decreaseDelay()})),i.Vb(24,"i",3),i.Yb(),i.Zb(25,"ngx-slider",7),i.jc("valueChange",(function(t){return e.delay=t}))("valueChange",(function(){return e.onSliderChange()})),i.Yb(),i.Zb(26,"button",2),i.jc("click",(function(){return e.increaseDelay()})),i.Vb(27,"i",5),i.Yb(),i.Yb(),i.Yb()),2&t&&(i.Gb(2),i.Sc(i.oc(3,9,"wiredfurni.params.setpoints",e.updateCount)),i.Gb(5),i.sc("options",e.pointsSliderOptions)("value",e.points),i.Gb(4),i.Sc(i.oc(12,12,"wiredfurni.params.settimesingame",e.updateCount)),i.Gb(5),i.sc("options",e.timesSliderOptions)("value",e.times),i.Gb(4),i.Sc(i.oc(21,15,"wiredfurni.params.delay",e.updateCount)),i.Gb(5),i.sc("options",e.delaySliderOptions)("value",e.delay))},encapsulation:2}),t})();const qI=i.bc(KI);let JI=(()=>{class t extends rR{get code(){return t.CODE}onEditStart(t){this.team=(t.intData.length>0?t.intData[0]:1).toString(),super.onEditStart(t)}readIntegerParamsFromForm(){return[Number.parseInt(this.team)]}get hasSpecialInputs(){return!0}}return t.CODE=SI.JOIN_TEAM,t.\u0275fac=function(e){return QI(e||t)},t.\u0275cmp=i.Ob({type:t,selectors:[["ng-component"]],features:[i.Db],decls:27,vars:26,consts:[[1,"form-group"],[1,"form-control","form-control-sm",3,"ngModel","ngModelChange"],["value","1",3,"selected"],["value","2",3,"selected"],["value","3",3,"selected"],["value","4",3,"selected"],[1,"w-100","text-center","mb-1"],[1,"d-flex","align-items-center","justify-content-center","my-2","custom-slider"],["type","button",1,"btn","btn-primary","btn-sm",3,"click"],[1,"fas","fa-arrow-left"],["name","delay",3,"options","value","valueChange"],[1,"fas","fa-arrow-right"]],template:function(t,e){1&t&&(i.Zb(0,"nitro-wired-base-component"),i.Zb(1,"div",0),i.Zb(2,"label"),i.Rc(3),i.mc(4,"translate"),i.Yb(),i.Zb(5,"select",1),i.jc("ngModelChange",(function(t){return e.team=t})),i.Zb(6,"option",2),i.Rc(7),i.mc(8,"translate"),i.Yb(),i.Zb(9,"option",3),i.Rc(10),i.mc(11,"translate"),i.Yb(),i.Zb(12,"option",4),i.Rc(13),i.mc(14,"translate"),i.Yb(),i.Zb(15,"option",5),i.Rc(16),i.mc(17,"translate"),i.Yb(),i.Yb(),i.Yb(),i.Zb(18,"p",6),i.Rc(19),i.mc(20,"translate"),i.Yb(),i.Zb(21,"div",7),i.Zb(22,"button",8),i.jc("click",(function(){return e.decreaseDelay()})),i.Vb(23,"i",9),i.Yb(),i.Zb(24,"ngx-slider",10),i.jc("valueChange",(function(t){return e.delay=t}))("valueChange",(function(){return e.onSliderChange()})),i.Yb(),i.Zb(25,"button",8),i.jc("click",(function(){return e.increaseDelay()})),i.Vb(26,"i",11),i.Yb(),i.Yb(),i.Yb()),2&t&&(i.Gb(3),i.Sc(i.nc(4,13,"wiredfurni.params.team")),i.Gb(2),i.sc("ngModel",e.team),i.Gb(1),i.sc("selected","1"==e.team),i.Gb(1),i.Sc(i.nc(8,15,"wiredfurni.params.team.1")),i.Gb(2),i.sc("selected","2"==e.team),i.Gb(1),i.Sc(i.nc(11,17,"wiredfurni.params.team.2")),i.Gb(2),i.sc("selected","3"==e.team),i.Gb(1),i.Sc(i.nc(14,19,"wiredfurni.params.team.3")),i.Gb(2),i.sc("selected","4"==e.team),i.Gb(1),i.Sc(i.nc(17,21,"wiredfurni.params.team.4")),i.Gb(3),i.Sc(i.oc(20,23,"wiredfurni.params.delay",e.updateCount)),i.Gb(5),i.sc("options",e.delaySliderOptions)("value",e.delay))},encapsulation:2}),t})();const QI=i.bc(JI);let $I=(()=>{class t extends rR{get code(){return t.CODE}get hasSpecialInputs(){return!0}readStringParamFromForm(){return this.message}onEditStart(t){this.message=t.stringData,super.onEditStart(t)}validate(){return this.message.length>100?um.instance.localization.getValue("wiredfurni.chatmsgtoolong",!1):null}}return t.CODE=SI.KICK_FROM_ROOM,t.\u0275fac=function(e){return tv(e||t)},t.\u0275cmp=i.Ob({type:t,selectors:[["ng-component"]],features:[i.Db],decls:15,vars:10,consts:[[1,"form-group"],["type","text",1,"form-control","form-control-sm",3,"ngModel","ngModelChange"],[1,"w-100","text-center","mb-1"],[1,"d-flex","align-items-center","justify-content-center","my-2","custom-slider"],["type","button",1,"btn","btn-primary","btn-sm",3,"click"],[1,"fas","fa-arrow-left"],["name","delay",3,"options","value","valueChange"],[1,"fas","fa-arrow-right"]],template:function(t,e){1&t&&(i.Zb(0,"nitro-wired-base-component"),i.Zb(1,"div",0),i.Zb(2,"label"),i.Rc(3),i.mc(4,"translate"),i.Yb(),i.Zb(5,"input",1),i.jc("ngModelChange",(function(t){return e.message=t})),i.Yb(),i.Yb(),i.Zb(6,"p",2),i.Rc(7),i.mc(8,"translate"),i.Yb(),i.Zb(9,"div",3),i.Zb(10,"button",4),i.jc("click",(function(){return e.decreaseDelay()})),i.Vb(11,"i",5),i.Yb(),i.Zb(12,"ngx-slider",6),i.jc("valueChange",(function(t){return e.delay=t}))("valueChange",(function(){return e.onSliderChange()})),i.Yb(),i.Zb(13,"button",4),i.jc("click",(function(){return e.increaseDelay()})),i.Vb(14,"i",7),i.Yb(),i.Yb(),i.Yb()),2&t&&(i.Gb(3),i.Sc(i.nc(4,5,"wiredfurni.params.message")),i.Gb(2),i.sc("ngModel",e.message),i.Gb(2),i.Sc(i.oc(8,7,"wiredfurni.params.delay",e.updateCount)),i.Gb(5),i.sc("options",e.delaySliderOptions)("value",e.delay))},encapsulation:2}),t})();const tv=i.bc($I);let ev=(()=>{class t extends rR{get code(){return t.CODE}}return t.CODE=SI.LEAVE_TEAM,t.\u0275fac=function(e){return sv(e||t)},t.\u0275cmp=i.Ob({type:t,selectors:[["ng-component"]],features:[i.Db],decls:10,vars:6,consts:[[1,"w-100","text-center","mb-1"],[1,"d-flex","align-items-center","justify-content-center","my-2","custom-slider"],["type","button",1,"btn","btn-primary","btn-sm",3,"click"],[1,"fas","fa-arrow-left"],["name","delay",3,"options","value","valueChange"],[1,"fas","fa-arrow-right"]],template:function(t,e){1&t&&(i.Zb(0,"nitro-wired-base-component"),i.Zb(1,"p",0),i.Rc(2),i.mc(3,"translate"),i.Yb(),i.Zb(4,"div",1),i.Zb(5,"button",2),i.jc("click",(function(){return e.decreaseDelay()})),i.Vb(6,"i",3),i.Yb(),i.Zb(7,"ngx-slider",4),i.jc("valueChange",(function(t){return e.delay=t}))("valueChange",(function(){return e.onSliderChange()})),i.Yb(),i.Zb(8,"button",2),i.jc("click",(function(){return e.increaseDelay()})),i.Vb(9,"i",5),i.Yb(),i.Yb(),i.Yb()),2&t&&(i.Gb(2),i.Sc(i.oc(3,3,"wiredfurni.params.delay",e.updateCount)),i.Gb(5),i.sc("options",e.delaySliderOptions)("value",e.delay))},encapsulation:2}),t})();const sv=i.bc(ev);let iv=(()=>{class t extends rR{get code(){return t.CODE}onEditStart(t){this.movement=(t.intData.length>0?t.intData[0]:0).toString(),this.spacing=t.intData.length>1?t.intData[1]:1,super.onEditStart(t)}readIntegerParamsFromForm(){return[Number.parseInt(this.movement),this.spacing]}get hasSpecialInputs(){return!0}get requiresFurni(){return Iv._Str_4991}decreaseSpacing(){this.spacing-=1,this.spacing<t.SPACING_MINIMUM_VALUE&&(this.spacing=t.SPACING_MINIMUM_VALUE)}increaseSpacing(){this.spacing+=1,this.spacing>t.SPACING_MAXIMUM_VALUE&&(this.spacing=t.SPACING_MAXIMUM_VALUE)}updateLocaleParameter(){um.instance.localization.registerParameter("wiredfurni.params.emptytiles","tiles",this.spacing.toString()),super.updateLocaleParameter()}get spacingSliderOptions(){return{floor:t.SPACING_MINIMUM_VALUE,ceil:t.SPACING_MAXIMUM_VALUE,step:t.SPACING_STEPPER_VALUE,hidePointerLabels:!0,hideLimitLabels:!0}}}return t.SPACING_MINIMUM_VALUE=1,t.SPACING_MAXIMUM_VALUE=5,t.SPACING_STEPPER_VALUE=1,t.CODE=SI.MOVE_FURNI_TO,t.\u0275fac=function(e){return rv(e||t)},t.\u0275cmp=i.Ob({type:t,selectors:[["ng-component"]],features:[i.Db],decls:38,vars:19,consts:[[1,"w-100","text-center","mb-1"],[1,"d-flex","align-items-center","justify-content-center","my-2","custom-slider"],["type","button",1,"btn","btn-primary","btn-sm",3,"click"],[1,"fas","fa-arrow-left"],["name","spacing",3,"options","value","valueChange"],[1,"fas","fa-arrow-right"],[1,"form-row","mb-2"],[1,"form-check"],["type","radio","name","movement","value","0",1,"form-check-input",3,"ngModel","ngModelChange"],[1,"form-check-label"],[1,"icon","icon-ne"],["type","radio","name","movement","value","2",1,"form-check-input",3,"ngModel","ngModelChange"],[1,"icon","icon-se"],["type","radio","name","movement","value","4",1,"form-check-input",3,"ngModel","ngModelChange"],[1,"icon","icon-sw"],["type","radio","name","movement","value","6",1,"form-check-input",3,"ngModel","ngModelChange"],[1,"icon","icon-nw"],[1,"w-100","text-center","mt-2","mb-1"],["name","delay",3,"options","value","valueChange"]],template:function(t,e){1&t&&(i.Zb(0,"nitro-wired-base-component"),i.Zb(1,"p",0),i.Rc(2),i.mc(3,"translate"),i.Yb(),i.Zb(4,"div",1),i.Zb(5,"button",2),i.jc("click",(function(){return e.decreaseSpacing()})),i.Vb(6,"i",3),i.Yb(),i.Zb(7,"ngx-slider",4),i.jc("valueChange",(function(t){return e.spacing=t}))("valueChange",(function(){return e.onSliderChange()})),i.Yb(),i.Zb(8,"button",2),i.jc("click",(function(){return e.increaseSpacing()})),i.Vb(9,"i",5),i.Yb(),i.Yb(),i.Rc(10),i.mc(11,"translate"),i.Zb(12,"div",6),i.Zb(13,"div",7),i.Zb(14,"input",8),i.jc("ngModelChange",(function(t){return e.movement=t})),i.Yb(),i.Zb(15,"label",9),i.Vb(16,"i",10),i.Yb(),i.Yb(),i.Zb(17,"div",7),i.Zb(18,"input",11),i.jc("ngModelChange",(function(t){return e.movement=t})),i.Yb(),i.Zb(19,"label",9),i.Vb(20,"i",12),i.Yb(),i.Yb(),i.Zb(21,"div",7),i.Zb(22,"input",13),i.jc("ngModelChange",(function(t){return e.movement=t})),i.Yb(),i.Zb(23,"label",9),i.Vb(24,"i",14),i.Yb(),i.Yb(),i.Zb(25,"div",7),i.Zb(26,"input",15),i.jc("ngModelChange",(function(t){return e.movement=t})),i.Yb(),i.Zb(27,"label",9),i.Vb(28,"i",16),i.Yb(),i.Yb(),i.Yb(),i.Zb(29,"p",17),i.Rc(30),i.mc(31,"translate"),i.Yb(),i.Zb(32,"div",1),i.Zb(33,"button",2),i.jc("click",(function(){return e.decreaseDelay()})),i.Vb(34,"i",3),i.Yb(),i.Zb(35,"ngx-slider",18),i.jc("valueChange",(function(t){return e.delay=t}))("valueChange",(function(){return e.onSliderChange()})),i.Yb(),i.Zb(36,"button",2),i.jc("click",(function(){return e.increaseDelay()})),i.Vb(37,"i",5),i.Yb(),i.Yb(),i.Yb()),2&t&&(i.Gb(2),i.Sc(i.oc(3,11,"wiredfurni.params.emptytiles",e.updateCount)),i.Gb(5),i.sc("options",e.spacingSliderOptions)("value",e.spacing),i.Gb(3),i.Tc(" ",i.nc(11,14,"wiredfurni.params.startdir")," "),i.Gb(4),i.sc("ngModel",e.movement),i.Gb(4),i.sc("ngModel",e.movement),i.Gb(4),i.sc("ngModel",e.movement),i.Gb(4),i.sc("ngModel",e.movement),i.Gb(4),i.Sc(i.oc(31,16,"wiredfurni.params.delay",e.updateCount)),i.Gb(5),i.sc("options",e.delaySliderOptions)("value",e.delay))},encapsulation:2}),t})();const rv=i.bc(iv);let nv=(()=>{class t extends rR{get code(){return t.CODE}onEditStart(t){this.movement=(t.intData.length>0?t.intData[0]:0).toString(),this.rotation=(t.intData.length>1?t.intData[1]:0).toString(),super.onEditStart(t)}readIntegerParamsFromForm(){return[Number.parseInt(this.movement),Number.parseInt(this.rotation)]}get hasSpecialInputs(){return!0}get requiresFurni(){return Iv._Str_5430}}return t.CODE=SI.MOVE_FURNI,t.\u0275fac=function(e){return av(e||t)},t.\u0275cmp=i.Ob({type:t,selectors:[["ng-component"]],features:[i.Db],decls:71,vars:39,consts:[[1,"form-row"],[1,"form-check"],["type","radio","name","movement","value","0",1,"form-check-input",3,"ngModel","ngModelChange"],[1,"form-check-label"],[1,"form-row","mb-2"],["type","radio","name","movement","value","4",1,"form-check-input",3,"ngModel","ngModelChange"],[1,"icon","icon-ne"],["type","radio","name","movement","value","5",1,"form-check-input",3,"ngModel","ngModelChange"],[1,"icon","icon-se"],["type","radio","name","movement","value","6",1,"form-check-input",3,"ngModel","ngModelChange"],[1,"icon","icon-sw"],["type","radio","name","movement","value","7",1,"form-check-input",3,"ngModel","ngModelChange"],[1,"icon","icon-mv-7"],["type","radio","name","movement","value","2",1,"form-check-input",3,"ngModel","ngModelChange"],[1,"icon","icon-mv-2"],["type","radio","name","movement","value","3",1,"form-check-input",3,"ngModel","ngModelChange"],[1,"icon","icon-mv-3"],["type","radio","name","movement","value","1",1,"form-check-input",3,"ngModel","ngModelChange"],[1,"icon","icon-mv-1"],["type","radio","name","rotation","value","0",1,"form-check-input",3,"ngModel","ngModelChange"],["type","radio","name","rotation","value","1",1,"form-check-input",3,"ngModel","ngModelChange"],[1,"icon","icon-rot-1"],["type","radio","name","rotation","value","2",1,"form-check-input",3,"ngModel","ngModelChange"],[1,"icon","icon-rot-2"],["type","radio","name","rotation","value","3",1,"form-check-input",3,"ngModel","ngModelChange"],[1,"w-100","text-center","mt-2","mb-1"],[1,"d-flex","align-items-center","justify-content-center","my-2","custom-slider"],["type","button",1,"btn","btn-primary","btn-sm",3,"click"],[1,"fas","fa-arrow-left"],["name","delay",3,"options","value","valueChange"],[1,"fas","fa-arrow-right"]],template:function(t,e){1&t&&(i.Zb(0,"nitro-wired-base-component"),i.Rc(1),i.mc(2,"translate"),i.Zb(3,"div",0),i.Zb(4,"div",1),i.Zb(5,"input",2),i.jc("ngModelChange",(function(t){return e.movement=t})),i.Yb(),i.Zb(6,"label",3),i.Rc(7),i.mc(8,"translate"),i.Yb(),i.Yb(),i.Yb(),i.Zb(9,"div",4),i.Zb(10,"div",1),i.Zb(11,"input",5),i.jc("ngModelChange",(function(t){return e.movement=t})),i.Yb(),i.Zb(12,"label",3),i.Vb(13,"i",6),i.Yb(),i.Yb(),i.Zb(14,"div",1),i.Zb(15,"input",7),i.jc("ngModelChange",(function(t){return e.movement=t})),i.Yb(),i.Zb(16,"label",3),i.Vb(17,"i",8),i.Yb(),i.Yb(),i.Zb(18,"div",1),i.Zb(19,"input",9),i.jc("ngModelChange",(function(t){return e.movement=t})),i.Yb(),i.Zb(20,"label",3),i.Vb(21,"i",10),i.Yb(),i.Yb(),i.Zb(22,"div",1),i.Zb(23,"input",11),i.jc("ngModelChange",(function(t){return e.movement=t})),i.Yb(),i.Zb(24,"label",3),i.Vb(25,"i",12),i.Yb(),i.Yb(),i.Zb(26,"div",1),i.Zb(27,"input",13),i.jc("ngModelChange",(function(t){return e.movement=t})),i.Yb(),i.Zb(28,"label",3),i.Vb(29,"i",14),i.Yb(),i.Yb(),i.Zb(30,"div",1),i.Zb(31,"input",15),i.jc("ngModelChange",(function(t){return e.movement=t})),i.Yb(),i.Zb(32,"label",3),i.Vb(33,"i",16),i.Yb(),i.Yb(),i.Zb(34,"div",1),i.Zb(35,"input",17),i.jc("ngModelChange",(function(t){return e.movement=t})),i.Yb(),i.Zb(36,"label",3),i.Vb(37,"i",18),i.Yb(),i.Yb(),i.Yb(),i.Rc(38),i.mc(39,"translate"),i.Zb(40,"div",1),i.Zb(41,"input",19),i.jc("ngModelChange",(function(t){return e.rotation=t})),i.Yb(),i.Zb(42,"label",3),i.Rc(43),i.mc(44,"translate"),i.Yb(),i.Yb(),i.Zb(45,"div",1),i.Zb(46,"input",20),i.jc("ngModelChange",(function(t){return e.rotation=t})),i.Yb(),i.Zb(47,"label",3),i.Vb(48,"i",21),i.Rc(49),i.mc(50,"translate"),i.Yb(),i.Yb(),i.Zb(51,"div",1),i.Zb(52,"input",22),i.jc("ngModelChange",(function(t){return e.rotation=t})),i.Yb(),i.Zb(53,"label",3),i.Vb(54,"i",23),i.Rc(55),i.mc(56,"translate"),i.Yb(),i.Yb(),i.Zb(57,"div",1),i.Zb(58,"input",24),i.jc("ngModelChange",(function(t){return e.rotation=t})),i.Yb(),i.Zb(59,"label",3),i.Rc(60),i.mc(61,"translate"),i.Yb(),i.Yb(),i.Zb(62,"p",25),i.Rc(63),i.mc(64,"translate"),i.Yb(),i.Zb(65,"div",26),i.Zb(66,"button",27),i.jc("click",(function(){return e.decreaseDelay()})),i.Vb(67,"i",28),i.Yb(),i.Zb(68,"ngx-slider",29),i.jc("valueChange",(function(t){return e.delay=t}))("valueChange",(function(){return e.onSliderChange()})),i.Yb(),i.Zb(69,"button",27),i.jc("click",(function(){return e.increaseDelay()})),i.Vb(70,"i",30),i.Yb(),i.Yb(),i.Yb()),2&t&&(i.Gb(1),i.Tc(" ",i.nc(2,22,"wiredfurni.params.movefurni")," "),i.Gb(4),i.sc("ngModel",e.movement),i.Gb(2),i.Sc(i.nc(8,24,"wiredfurni.params.movefurni.0")),i.Gb(4),i.sc("ngModel",e.movement),i.Gb(4),i.sc("ngModel",e.movement),i.Gb(4),i.sc("ngModel",e.movement),i.Gb(4),i.sc("ngModel",e.movement),i.Gb(4),i.sc("ngModel",e.movement),i.Gb(4),i.sc("ngModel",e.movement),i.Gb(4),i.sc("ngModel",e.movement),i.Gb(3),i.Tc(" ",i.nc(39,26,"wiredfurni.params.rotatefurni")," "),i.Gb(3),i.sc("ngModel",e.rotation),i.Gb(2),i.Sc(i.nc(44,28,"wiredfurni.params.rotatefurni.0")),i.Gb(3),i.sc("ngModel",e.rotation),i.Gb(3),i.Tc(" ",i.nc(50,30,"wiredfurni.params.rotatefurni.1"),""),i.Gb(3),i.sc("ngModel",e.rotation),i.Gb(3),i.Tc(" ",i.nc(56,32,"wiredfurni.params.rotatefurni.2"),""),i.Gb(3),i.sc("ngModel",e.rotation),i.Gb(2),i.Sc(i.nc(61,34,"wiredfurni.params.rotatefurni.3")),i.Gb(3),i.Sc(i.oc(64,36,"wiredfurni.params.delay",e.updateCount)),i.Gb(5),i.sc("options",e.delaySliderOptions)("value",e.delay))},encapsulation:2}),t})();const av=i.bc(nv);let ov=(()=>{class t extends rR{get code(){return t.CODE}onEditStart(t){this.movement=(t.intData.length>0?t.intData[0]:0).toString(),this.rotation=(t.intData.length>1?t.intData[1]:0).toString(),super.onEditStart(t)}readIntegerParamsFromForm(){return[Number.parseInt(this.movement),Number.parseInt(this.rotation)]}get hasSpecialInputs(){return!0}get requiresFurni(){return Iv._Str_5430}}return t.CODE=SI.MOVE_TO_DIRECTION,t.\u0275fac=function(e){return cv(e||t)},t.\u0275cmp=i.Ob({type:t,selectors:[["ng-component"]],features:[i.Db],decls:66,vars:44,consts:[[1,"form-row","mb-2"],[1,"form-check"],["type","radio","name","movement","value","0",1,"form-check-input",3,"ngModel","ngModelChange"],[1,"form-check-label"],[1,"icon","icon-ne"],["type","radio","name","movement","value","2",1,"form-check-input",3,"ngModel","ngModelChange"],[1,"icon","icon-se"],["type","radio","name","movement","value","4",1,"form-check-input",3,"ngModel","ngModelChange"],[1,"icon","icon-sw"],["type","radio","name","movement","value","6",1,"form-check-input",3,"ngModel","ngModelChange"],[1,"icon","icon-nw"],["type","radio","name","rotation","value","0",1,"form-check-input",3,"ngModel","ngModelChange"],["type","radio","name","rotation","value","1",1,"form-check-input",3,"ngModel","ngModelChange"],["type","radio","name","rotation","value","2",1,"form-check-input",3,"ngModel","ngModelChange"],["type","radio","name","rotation","value","3",1,"form-check-input",3,"ngModel","ngModelChange"],["type","radio","name","rotation","value","4",1,"form-check-input",3,"ngModel","ngModelChange"],["type","radio","name","rotation","value","5",1,"form-check-input",3,"ngModel","ngModelChange"],["type","radio","name","rotation","value","6",1,"form-check-input",3,"ngModel","ngModelChange"],[1,"w-100","text-center","mt-2","mb-1"],[1,"d-flex","align-items-center","justify-content-center","my-2","custom-slider"],["type","button",1,"btn","btn-primary","btn-sm",3,"click"],[1,"fas","fa-arrow-left"],["name","delay",3,"options","value","valueChange"],[1,"fas","fa-arrow-right"]],template:function(t,e){1&t&&(i.Zb(0,"nitro-wired-base-component"),i.Rc(1),i.mc(2,"translate"),i.Zb(3,"div",0),i.Zb(4,"div",1),i.Zb(5,"input",2),i.jc("ngModelChange",(function(t){return e.movement=t})),i.Yb(),i.Zb(6,"label",3),i.Vb(7,"i",4),i.Yb(),i.Yb(),i.Zb(8,"div",1),i.Zb(9,"input",5),i.jc("ngModelChange",(function(t){return e.movement=t})),i.Yb(),i.Zb(10,"label",3),i.Vb(11,"i",6),i.Yb(),i.Yb(),i.Zb(12,"div",1),i.Zb(13,"input",7),i.jc("ngModelChange",(function(t){return e.movement=t})),i.Yb(),i.Zb(14,"label",3),i.Vb(15,"i",8),i.Yb(),i.Yb(),i.Zb(16,"div",1),i.Zb(17,"input",9),i.jc("ngModelChange",(function(t){return e.movement=t})),i.Yb(),i.Zb(18,"label",3),i.Vb(19,"i",10),i.Yb(),i.Yb(),i.Yb(),i.Rc(20),i.mc(21,"translate"),i.Zb(22,"div",1),i.Zb(23,"input",11),i.jc("ngModelChange",(function(t){return e.rotation=t})),i.Yb(),i.Zb(24,"label",3),i.Rc(25),i.mc(26,"translate"),i.Yb(),i.Yb(),i.Zb(27,"div",1),i.Zb(28,"input",12),i.jc("ngModelChange",(function(t){return e.rotation=t})),i.Yb(),i.Zb(29,"label",3),i.Rc(30),i.mc(31,"translate"),i.Yb(),i.Yb(),i.Zb(32,"div",1),i.Zb(33,"input",13),i.jc("ngModelChange",(function(t){return e.rotation=t})),i.Yb(),i.Zb(34,"label",3),i.Rc(35),i.mc(36,"translate"),i.Yb(),i.Yb(),i.Zb(37,"div",1),i.Zb(38,"input",14),i.jc("ngModelChange",(function(t){return e.rotation=t})),i.Yb(),i.Zb(39,"label",3),i.Rc(40),i.mc(41,"translate"),i.Yb(),i.Yb(),i.Zb(42,"div",1),i.Zb(43,"input",15),i.jc("ngModelChange",(function(t){return e.rotation=t})),i.Yb(),i.Zb(44,"label",3),i.Rc(45),i.mc(46,"translate"),i.Yb(),i.Yb(),i.Zb(47,"div",1),i.Zb(48,"input",16),i.jc("ngModelChange",(function(t){return e.rotation=t})),i.Yb(),i.Zb(49,"label",3),i.Rc(50),i.mc(51,"translate"),i.Yb(),i.Yb(),i.Zb(52,"div",1),i.Zb(53,"input",17),i.jc("ngModelChange",(function(t){return e.rotation=t})),i.Yb(),i.Zb(54,"label",3),i.Rc(55),i.mc(56,"translate"),i.Yb(),i.Yb(),i.Zb(57,"p",18),i.Rc(58),i.mc(59,"translate"),i.Yb(),i.Zb(60,"div",19),i.Zb(61,"button",20),i.jc("click",(function(){return e.decreaseDelay()})),i.Vb(62,"i",21),i.Yb(),i.Zb(63,"ngx-slider",22),i.jc("valueChange",(function(t){return e.delay=t}))("valueChange",(function(){return e.onSliderChange()})),i.Yb(),i.Zb(64,"button",20),i.jc("click",(function(){return e.increaseDelay()})),i.Vb(65,"i",23),i.Yb(),i.Yb(),i.Yb()),2&t&&(i.Gb(1),i.Tc(" ",i.nc(2,23,"wiredfurni.params.startdir")," "),i.Gb(4),i.sc("ngModel",e.movement),i.Gb(4),i.sc("ngModel",e.movement),i.Gb(4),i.sc("ngModel",e.movement),i.Gb(4),i.sc("ngModel",e.movement),i.Gb(3),i.Tc(" ",i.nc(21,25,"wiredfurni.params.turn")," "),i.Gb(3),i.sc("ngModel",e.rotation),i.Gb(2),i.Sc(i.nc(26,27,"wiredfurni.params.turn.0")),i.Gb(3),i.sc("ngModel",e.rotation),i.Gb(2),i.Sc(i.nc(31,29,"wiredfurni.params.turn.1")),i.Gb(3),i.sc("ngModel",e.rotation),i.Gb(2),i.Sc(i.nc(36,31,"wiredfurni.params.turn.2")),i.Gb(3),i.sc("ngModel",e.rotation),i.Gb(2),i.Sc(i.nc(41,33,"wiredfurni.params.turn.3")),i.Gb(3),i.sc("ngModel",e.rotation),i.Gb(2),i.Sc(i.nc(46,35,"wiredfurni.params.turn.4")),i.Gb(3),i.sc("ngModel",e.rotation),i.Gb(2),i.Sc(i.nc(51,37,"wiredfurni.params.turn.5")),i.Gb(3),i.sc("ngModel",e.rotation),i.Gb(2),i.Sc(i.nc(56,39,"wiredfurni.params.turn.6")),i.Gb(3),i.Sc(i.oc(59,41,"wiredfurni.params.delay",e.updateCount)),i.Gb(5),i.sc("options",e.delaySliderOptions)("value",e.delay))},encapsulation:2}),t})();const cv=i.bc(ov);let _v=(()=>{class t extends rR{constructor(){super(...arguments),this.length=0}get code(){return t.CODE}get hasSpecialInputs(){return!0}readStringParamFromForm(){return this.message}readIntegerParamsFromForm(){return[this.length]}onEditStart(t){this.message=t.stringData,this.length=t.intData.length>0?t.intData[0]:10,super.onEditStart(t)}validate(){return this.message.length>100?um.instance.localization.getValue("wiredfurni.chatmsgtoolong",!1):null}decreaseLength(){this.length-=1,this.length<t.LENGTH_MINIMUM_VALUE&&(this.length=t.LENGTH_MINIMUM_VALUE)}increaseLength(){this.length+=1,this.length>t.LENGTH_MAXIMUM_VALUE&&(this.length=t.LENGTH_MAXIMUM_VALUE)}updateLocaleParameter(){um.instance.localization.registerParameter("wiredfurni.params.length.minutes","minutes",this.length.toString()),super.updateLocaleParameter()}get lengthSliderOptions(){return{floor:t.LENGTH_MINIMUM_VALUE,ceil:t.LENGTH_MAXIMUM_VALUE,step:t.LENGTH_STEPPER_VALUE,hidePointerLabels:!0,hideLimitLabels:!0}}}return t.LENGTH_MINIMUM_VALUE=1,t.LENGTH_MAXIMUM_VALUE=10,t.LENGTH_STEPPER_VALUE=1,t.CODE=SI.MUTE_USER,t.\u0275fac=function(e){return hv(e||t)},t.\u0275cmp=i.Ob({type:t,selectors:[["ng-component"]],features:[i.Db],decls:24,vars:16,consts:[[1,"w-100","text-center","mb-1"],[1,"d-flex","align-items-center","justify-content-center","my-2","custom-slider"],["type","button",1,"btn","btn-primary","btn-sm",3,"click"],[1,"fas","fa-arrow-left"],["name","length",3,"options","value","valueChange"],[1,"fas","fa-arrow-right"],[1,"form-group"],["type","text",1,"form-control","form-control-sm",3,"ngModel","ngModelChange"],["name","delay",3,"options","value","valueChange"]],template:function(t,e){1&t&&(i.Zb(0,"nitro-wired-base-component"),i.Zb(1,"p",0),i.Rc(2),i.mc(3,"translate"),i.Yb(),i.Zb(4,"div",1),i.Zb(5,"button",2),i.jc("click",(function(){return e.decreaseLength()})),i.Vb(6,"i",3),i.Yb(),i.Zb(7,"ngx-slider",4),i.jc("valueChange",(function(t){return e.length=t}))("valueChange",(function(){return e.onSliderChange()})),i.Yb(),i.Zb(8,"button",2),i.jc("click",(function(){return e.increaseLength()})),i.Vb(9,"i",5),i.Yb(),i.Yb(),i.Zb(10,"div",6),i.Zb(11,"label"),i.Rc(12),i.mc(13,"translate"),i.Yb(),i.Zb(14,"input",7),i.jc("ngModelChange",(function(t){return e.message=t})),i.Yb(),i.Yb(),i.Zb(15,"p",0),i.Rc(16),i.mc(17,"translate"),i.Yb(),i.Zb(18,"div",1),i.Zb(19,"button",2),i.jc("click",(function(){return e.decreaseDelay()})),i.Vb(20,"i",3),i.Yb(),i.Zb(21,"ngx-slider",8),i.jc("valueChange",(function(t){return e.delay=t}))("valueChange",(function(){return e.onSliderChange()})),i.Yb(),i.Zb(22,"button",2),i.jc("click",(function(){return e.increaseDelay()})),i.Vb(23,"i",5),i.Yb(),i.Yb(),i.Yb()),2&t&&(i.Gb(2),i.Sc(i.oc(3,8,"wiredfurni.params.length.minutes",e.updateCount)),i.Gb(5),i.sc("options",e.lengthSliderOptions)("value",e.length),i.Gb(5),i.Sc(i.nc(13,11,"wiredfurni.params.message")),i.Gb(2),i.sc("ngModel",e.message),i.Gb(2),i.Sc(i.oc(17,13,"wiredfurni.params.delay",e.updateCount)),i.Gb(5),i.sc("options",e.delaySliderOptions)("value",e.delay))},encapsulation:2}),t})();const hv=i.bc(_v);let lv=(()=>{class t extends rR{get code(){return t.CODE}}return t.CODE=SI.RESET,t.\u0275fac=function(e){return uv(e||t)},t.\u0275cmp=i.Ob({type:t,selectors:[["ng-component"]],features:[i.Db],decls:10,vars:6,consts:[[1,"w-100","text-center","mb-1"],[1,"d-flex","align-items-center","justify-content-center","my-2","custom-slider"],["type","button",1,"btn","btn-primary","btn-sm",3,"click"],[1,"fas","fa-arrow-left"],["name","delay",3,"options","value","valueChange"],[1,"fas","fa-arrow-right"]],template:function(t,e){1&t&&(i.Zb(0,"nitro-wired-base-component"),i.Zb(1,"p",0),i.Rc(2),i.mc(3,"translate"),i.Yb(),i.Zb(4,"div",1),i.Zb(5,"button",2),i.jc("click",(function(){return e.decreaseDelay()})),i.Vb(6,"i",3),i.Yb(),i.Zb(7,"ngx-slider",4),i.jc("valueChange",(function(t){return e.delay=t}))("valueChange",(function(){return e.onSliderChange()})),i.Yb(),i.Zb(8,"button",2),i.jc("click",(function(){return e.increaseDelay()})),i.Vb(9,"i",5),i.Yb(),i.Yb(),i.Yb()),2&t&&(i.Gb(2),i.Sc(i.oc(3,3,"wiredfurni.params.delay",e.updateCount)),i.Gb(5),i.sc("options",e.delaySliderOptions)("value",e.delay))},encapsulation:2}),t})();const uv=i.bc(lv);let dv=(()=>{class t extends rR{get code(){return t.CODE}onEditStart(t){this.state=t.getBoolean(0),this.direction=t.getBoolean(1),this.position=t.getBoolean(2),super.onEditStart(t)}readIntegerParamsFromForm(){return[this.state?1:0,this.direction?1:0,this.position?1:0]}get requiresFurni(){return Iv._Str_4873}get hasStateSnapshot(){return!0}}return t.CODE=SI.SET_FURNI_STATE,t.\u0275fac=function(e){return gv(e||t)},t.\u0275cmp=i.Ob({type:t,selectors:[["ng-component"]],features:[i.Db],decls:27,vars:21,consts:[[1,"form-check"],["type","checkbox",1,"form-check-input",3,"ngModel","ngModelChange"],[1,"form-check-label"],[1,"w-100","text-center","mb-1"],[1,"d-flex","align-items-center","justify-content-center","my-2","custom-slider"],["type","button",1,"btn","btn-primary","btn-sm",3,"click"],[1,"fas","fa-arrow-left"],["name","delay",3,"options","value","valueChange"],[1,"fas","fa-arrow-right"]],template:function(t,e){1&t&&(i.Zb(0,"nitro-wired-base-component"),i.Rc(1),i.mc(2,"translate"),i.Zb(3,"div",0),i.Zb(4,"input",1),i.jc("ngModelChange",(function(t){return e.state=t})),i.Yb(),i.Zb(5,"label",2),i.Rc(6),i.mc(7,"translate"),i.Yb(),i.Yb(),i.Zb(8,"div",0),i.Zb(9,"input",1),i.jc("ngModelChange",(function(t){return e.direction=t})),i.Yb(),i.Zb(10,"label",2),i.Rc(11),i.mc(12,"translate"),i.Yb(),i.Yb(),i.Zb(13,"div",0),i.Zb(14,"input",1),i.jc("ngModelChange",(function(t){return e.position=t})),i.Yb(),i.Zb(15,"label",2),i.Rc(16),i.mc(17,"translate"),i.Yb(),i.Yb(),i.Zb(18,"p",3),i.Rc(19),i.mc(20,"translate"),i.Yb(),i.Zb(21,"div",4),i.Zb(22,"button",5),i.jc("click",(function(){return e.decreaseDelay()})),i.Vb(23,"i",6),i.Yb(),i.Zb(24,"ngx-slider",7),i.jc("valueChange",(function(t){return e.delay=t}))("valueChange",(function(){return e.onSliderChange()})),i.Yb(),i.Zb(25,"button",5),i.jc("click",(function(){return e.increaseDelay()})),i.Vb(26,"i",8),i.Yb(),i.Yb(),i.Yb()),2&t&&(i.Gb(1),i.Tc(" ",i.nc(2,10,"wiredfurni.params.conditions")," "),i.Gb(3),i.sc("ngModel",e.state),i.Gb(2),i.Sc(i.nc(7,12,"wiredfurni.params.condition.state")),i.Gb(3),i.sc("ngModel",e.direction),i.Gb(2),i.Sc(i.nc(12,14,"wiredfurni.params.condition.direction")),i.Gb(3),i.sc("ngModel",e.position),i.Gb(2),i.Sc(i.nc(17,16,"wiredfurni.params.condition.position")),i.Gb(3),i.Sc(i.oc(20,18,"wiredfurni.params.delay",e.updateCount)),i.Gb(5),i.sc("options",e.delaySliderOptions)("value",e.delay))},encapsulation:2}),t})();const gv=i.bc(dv);let mv=(()=>{class t extends rR{get code(){return t.CODE}get requiresFurni(){return Iv._Str_5430}}return t.CODE=SI.TELEPORT,t.\u0275fac=function(e){return pv(e||t)},t.\u0275cmp=i.Ob({type:t,selectors:[["ng-component"]],features:[i.Db],decls:10,vars:6,consts:[[1,"w-100","text-center","mb-1"],[1,"d-flex","align-items-center","justify-content-center","my-2","custom-slider"],["type","button",1,"btn","btn-primary","btn-sm",3,"click"],[1,"fas","fa-arrow-left"],["name","delay",3,"options","value","valueChange"],[1,"fas","fa-arrow-right"]],template:function(t,e){1&t&&(i.Zb(0,"nitro-wired-base-component"),i.Zb(1,"p",0),i.Rc(2),i.mc(3,"translate"),i.Yb(),i.Zb(4,"div",1),i.Zb(5,"button",2),i.jc("click",(function(){return e.decreaseDelay()})),i.Vb(6,"i",3),i.Yb(),i.Zb(7,"ngx-slider",4),i.jc("valueChange",(function(t){return e.delay=t}))("valueChange",(function(){return e.onSliderChange()})),i.Yb(),i.Zb(8,"button",2),i.jc("click",(function(){return e.increaseDelay()})),i.Vb(9,"i",5),i.Yb(),i.Yb(),i.Yb()),2&t&&(i.Gb(2),i.Sc(i.oc(3,3,"wiredfurni.params.delay",e.updateCount)),i.Gb(5),i.sc("options",e.delaySliderOptions)("value",e.delay))},encapsulation:2}),t})();const pv=i.bc(mv);let Ev=(()=>{class t extends rR{get code(){return t.CODE}get requiresFurni(){return Iv._Str_5430}}return t.CODE=SI.TOGGLE_FURNI_STATE,t.\u0275fac=function(e){return fv(e||t)},t.\u0275cmp=i.Ob({type:t,selectors:[["ng-component"]],features:[i.Db],decls:10,vars:6,consts:[[1,"w-100","text-center","mb-1"],[1,"d-flex","align-items-center","justify-content-center","my-2","custom-slider"],["type","button",1,"btn","btn-primary","btn-sm",3,"click"],[1,"fas","fa-arrow-left"],["name","delay",3,"options","value","valueChange"],[1,"fas","fa-arrow-right"]],template:function(t,e){1&t&&(i.Zb(0,"nitro-wired-base-component"),i.Zb(1,"p",0),i.Rc(2),i.mc(3,"translate"),i.Yb(),i.Zb(4,"div",1),i.Zb(5,"button",2),i.jc("click",(function(){return e.decreaseDelay()})),i.Vb(6,"i",3),i.Yb(),i.Zb(7,"ngx-slider",4),i.jc("valueChange",(function(t){return e.delay=t}))("valueChange",(function(){return e.onSliderChange()})),i.Yb(),i.Zb(8,"button",2),i.jc("click",(function(){return e.increaseDelay()})),i.Vb(9,"i",5),i.Yb(),i.Yb(),i.Yb()),2&t&&(i.Gb(2),i.Sc(i.oc(3,3,"wiredfurni.params.delay",e.updateCount)),i.Gb(5),i.sc("options",e.delaySliderOptions)("value",e.delay))},encapsulation:2}),t})();const fv=i.bc(Ev);class Sv{_Str_9781(t){switch(t){case Ev.CODE:return Ev;case mv.CODE:return mv;case LI.CODE:return LI;case GI.CODE:return GI;case wI.CODE:return wI;case xI.CODE:return xI;case II.CODE:return II;case bI.CODE:return bI;case ev.CODE:return ev;case lv.CODE:return lv;case $I.CODE:return $I;case DI.CODE:return DI;case dv.CODE:return dv;case TI.CODE:return TI;case _v.CODE:return _v;case vv.CODE:return vv;case AI.CODE:return AI;case CI.CODE:return CI;case nv.CODE:return nv;case ov.CODE:return ov;case JI.CODE:return JI;case zI.CODE:return zI;case KI.CODE:return KI;case iv.CODE:return iv;case WI.CODE:return WI}return null}_Str_15652(t){return this._Str_9781(t)}_Str_14545(t){return t instanceof go}_Str_1196(){return"action"}}const bv=["inputsContainer"];function Rv(t,e){}let Iv=(()=>{class t{constructor(t,e,s,i,r){this._settingsService=t,this._notificationService=e,this._wiredService=s,this._componentFactoryResolver=i,this._ngZone=r,this._updated=null,this._lastComponent=null,this._furniSelectedIds=[]}ngOnInit(){this._wiredService.component=this,this._triggerConfs=new fI,this._actionTypes=new Sv,this._conditionTypes=new VR,this._selectionVisualizer=new eR(this)}ngOnDestroy(){this._wiredService.component=null}setupTrigger(t){this._updated=t;const e=this._Str_3959();this._selectionVisualizer.clearSelectionShaderFromFurni(this._furniSelectedIds),this._furniSelectedIds=[...this._updated.selectedItems],e.onEditStart(this._updated),this._selectionVisualizer.applySelectionShaderToFurni(this._furniSelectedIds)}_Str_19071(){return this._updated instanceof bo?this._triggerConfs:this._updated instanceof go?this._actionTypes:this._updated instanceof Eo?this._conditionTypes:null}_Str_3959(){const t=this._Str_19071()._Str_15652(this._updated.code);if(!t)return null;if(this._lastComponent&&this._lastComponent.instance instanceof t)return this._lastComponent.instance;this.inputsContainer.length&&this.inputsContainer.remove();const e=this._componentFactoryResolver.resolveComponentFactory(t);let s=null;return e&&(s=this.inputsContainer.createComponent(e)),this._lastComponent=s,s?(s.instance.onInitStart(),s.instance):null}close(){this.inputsContainer.length&&this.inputsContainer.remove(),this._selectionVisualizer.clearSelectionShaderFromFurni(this._furniSelectedIds),this._updated=null,this._lastComponent=null,this._furniSelectedIds=[]}save(){this.isOwnerOfFurniture(this._updated.id)?this.update():this._notificationService.alertWithConfirm("${wiredfurni.nonowner.change.confirm.body}","${wiredfurni.nonowner.change.confirm.title}",()=>{this.update()})}update(){const t=this._Str_3959().validate();t?this._notificationService.alert(t,"Update failed"):this._updated instanceof bo?um.instance.communication.connection.send(new F_(this._updated.id,this.readIntegerParams(),this.readStringParam(),this.readFurniSelectionIds(),this.readFurniSelectionCode())):this._updated instanceof go?um.instance.communication.connection.send(new P_(this._updated.id,this.readIntegerParams(),this.readStringParam(),this.readFurniSelectionIds(),this.getActionDelay(),this.readFurniSelectionCode())):this._updated instanceof Eo&&um.instance.communication.connection.send(new x_(this._updated.id,this.readIntegerParams(),this.readStringParam(),this.readFurniSelectionIds(),this.readFurniSelectionCode()))}getActionDelay(){const t=this._Str_3959();return t&&t instanceof rR?t.delay:0}readIntegerParams(){const t=this._Str_3959();return t?t.readIntegerParamsFromForm():[]}readStringParam(){const t=this._Str_3959();return t?t.readStringParamFromForm():""}readFurniSelectionIds(){return[...this._furniSelectedIds]}readFurniSelectionCode(){if(!this._updated._Str_21824)return 0;const e=this._Str_3959();return!e||e.requiresFurni!==t._Str_4991&&e.requiresFurni!==t._Str_5430?0:this._updated._Str_6040}getFurniName(){const t=this._updated&&this._updated.spriteId||-1,e=um.instance.sessionDataManager.getFloorItemData(t);return e?e.name:"NAME: "+t}getFurniDescription(){const t=this._updated&&this._updated.spriteId||-1,e=um.instance.sessionDataManager.getFloorItemData(t);return e?e.description:"NAME: "+t}_Str_19885(){return this._Str_3959().requiresFurni!==t._Str_5431}toggleFurniSelected(t,e){if(!this._updated||!this._Str_19885())return;const s=this._furniSelectedIds.indexOf(t);s>=0?(this._furniSelectedIds.splice(s,1),this._selectionVisualizer.hide(t)):this._furniSelectedIds.length<this._updated.maximumItemSelectionCount&&(this._furniSelectedIds.push(t),this._selectionVisualizer.show(t)),um.instance.localization.registerParameter("wiredfurni.pickfurnis.caption","count",this._furniSelectedIds.length.toString())}isOwnerOfFurniture(t){const e=um.instance.roomEngine.getRoomObject(this._wiredService.roomId,t,tt.FLOOR);return!!e&&e.model.getValue(st.FURNITURE_OWNER_ID)===um.instance.sessionDataManager.userId}get roomId(){return this._wiredService.roomId}get furniSelectedIds(){return this._furniSelectedIds}get maximumItemSelectionCount(){return this._updated.maximumItemSelectionCount}}return t._Str_5431=0,t._Str_4873=1,t._Str_4991=2,t._Str_5430=3,t.\u0275fac=function(e){return new(e||t)(i.Ub(gm),i.Ub(Nm),i.Ub(sR),i.Ub(i.l),i.Ub(i.E))},t.\u0275cmp=i.Ob({type:t,selectors:[["nitro-wired-main-component"]],viewQuery:function(t,e){if(1&t&&i.Wc(bv,!0,i.W),2&t){let t;i.Ac(t=i.kc())&&(e.inputsContainer=t.first)}},decls:2,vars:0,consts:[["inputsContainer",""]],template:function(t,e){1&t&&i.Pc(0,Rv,0,0,"ng-template",null,0,i.Qc)},encapsulation:2}),t})(),vv=(()=>{class t extends rR{constructor(){super(...arguments),this.defaultFigure="hd-180-1.ch-210-66.lg-270-82.sh-290-81"}get code(){return t.CODE}onEditStart(e){const s=e.stringData.split(t.DELIMETER);s.length>0&&(this.botName=s[0]),s.length>1&&(this.figure=s[1].length>0?s[1]:this.defaultFigure),super.onEditStart(e)}readStringParamFromForm(){return this.botName+t.DELIMETER+this.figure}get hasSpecialInputs(){return!0}get requiresFurni(){return Iv._Str_5431}copyLook(){this.figure=um.instance.sessionDataManager.figure}}return t.CODE=SI.BOT_CHANGE_FIGURE,t.DELIMETER="\t",t.\u0275fac=function(e){return Tv(e||t)},t.\u0275cmp=i.Ob({type:t,selectors:[["ng-component"]],features:[i.Db],decls:22,vars:15,consts:[[1,"form-group"],["type","text","maxlength","32",1,"form-control","form-control-sm",3,"ngModel","ngModelChange"],[1,"row","mb-1"],[1,"col-md-6"],["nitro-avatar-image","",3,"figure","direction"],["type","button",1,"btn","btn-primary","btn-sm",3,"click"],[1,"w-100","text-center","mb-1"],[1,"d-flex","align-items-center","justify-content-center","my-2","custom-slider"],[1,"fas","fa-arrow-left"],["name","delay",3,"options","value","valueChange"],[1,"fas","fa-arrow-right"]],template:function(t,e){1&t&&(i.Zb(0,"nitro-wired-base-component"),i.Zb(1,"div",0),i.Zb(2,"label"),i.Rc(3),i.mc(4,"translate"),i.Yb(),i.Zb(5,"input",1),i.jc("ngModelChange",(function(t){return e.botName=t})),i.Yb(),i.Yb(),i.Zb(6,"div",2),i.Zb(7,"div",3),i.Vb(8,"div",4),i.Yb(),i.Zb(9,"div",3),i.Zb(10,"button",5),i.jc("click",(function(){return e.copyLook()})),i.Rc(11),i.mc(12,"translate"),i.Yb(),i.Yb(),i.Yb(),i.Zb(13,"p",6),i.Rc(14),i.mc(15,"translate"),i.Yb(),i.Zb(16,"div",7),i.Zb(17,"button",5),i.jc("click",(function(){return e.decreaseDelay()})),i.Vb(18,"i",8),i.Yb(),i.Zb(19,"ngx-slider",9),i.jc("valueChange",(function(t){return e.delay=t}))("valueChange",(function(){return e.onSliderChange()})),i.Yb(),i.Zb(20,"button",5),i.jc("click",(function(){return e.increaseDelay()})),i.Vb(21,"i",10),i.Yb(),i.Yb(),i.Yb()),2&t&&(i.Gb(3),i.Sc(i.nc(4,8,"wiredfurni.params.bot.name")),i.Gb(2),i.sc("ngModel",e.botName),i.Gb(3),i.sc("figure",e.figure)("direction",2),i.Gb(3),i.Sc(i.nc(12,10,"wiredfurni.params.capture.figure")),i.Gb(3),i.Sc(i.oc(15,12,"wiredfurni.params.delay",e.updateCount)),i.Gb(5),i.sc("options",e.delaySliderOptions)("value",e.delay))},encapsulation:2}),t})();const Tv=i.bc(vv);function Ov(t,e){if(1&t&&(i.Zb(0,"div",11),i.Zb(1,"p",12),i.Rc(2),i.mc(3,"translate"),i.Yb(),i.Zb(4,"p",13),i.Rc(5),i.mc(6,"translate"),i.Yb(),i.Yb()),2&t){const t=i.lc();i.Gb(2),i.Sc(i.oc(3,2,"wiredfurni.pickfurnis.caption",t.furniSelectionCount)),i.Gb(3),i.Sc(i.nc(6,5,"wiredfurni.pickfurnis.desc"))}}const Av=["*"];let yv=(()=>{class t{constructor(t){this._wiredService=t}ngOnInit(){um.instance.localization.registerParameter("wiredfurni.pickfurnis.caption","count",this.furniSelectionCount.toString()),um.instance.localization.registerParameter("wiredfurni.pickfurnis.caption","limit",this.maximumFurniSelectionCount.toString())}save(){this._wiredService.component.save()}cancel(){this._wiredService.component.close()}get furniName(){return this._wiredService.component.getFurniName()}get furniDescription(){return this._wiredService.component.getFurniDescription()}get requiresFurni(){return this._wiredService.component._Str_19885()}get furniSelectionCount(){return this._wiredService.component.furniSelectedIds.length}get maximumFurniSelectionCount(){return this._wiredService.component.maximumItemSelectionCount}get wiredType(){const t=this._wiredService.component._Str_19071();return t?t._Str_1196():""}}return t.\u0275fac=function(e){return new(e||t)(i.Ub(sR))},t.\u0275cmp=i.Ob({type:t,selectors:[["nitro-wired-base-component"]],ngContentSelectors:Av,decls:22,vars:15,consts:[["dragHandle",".card-header",1,"card","nitro-wired-component",3,"bringToTop","draggable"],[1,"card-header"],["type","button",1,"close",3,"click"],[1,"fas","fa-times"],[1,"card-body"],[1,"wired-info","mb-2"],[1,"d-flex","align-items-center","mb-2"],["class","select-furni mt-2 pt-2",4,"ngIf"],[1,"btn-group","w-100","mt-2"],["type","button",1,"btn","btn-success",3,"click"],["type","button",1,"btn","btn-secondary",3,"click"],[1,"select-furni","mt-2","pt-2"],[1,"font-weight-bold","mb-0"],[1,"mb-0"]],template:function(t,e){1&t&&(i.rc(),i.Zb(0,"div",0),i.Zb(1,"div",1),i.Rc(2),i.mc(3,"translate"),i.Zb(4,"button",2),i.jc("click",(function(){return e.cancel()})),i.Vb(5,"i",3),i.Yb(),i.Yb(),i.Zb(6,"div",4),i.Zb(7,"div",5),i.Zb(8,"p",6),i.Vb(9,"i"),i.Rc(10),i.Vb(11,"br"),i.Rc(12),i.Yb(),i.Yb(),i.qc(13),i.Pc(14,Ov,7,7,"div",7),i.Zb(15,"div",8),i.Zb(16,"button",9),i.jc("click",(function(){return e.save()})),i.Rc(17),i.mc(18,"translate"),i.Yb(),i.Zb(19,"button",10),i.jc("click",(function(){return e.cancel()})),i.Rc(20),i.mc(21,"translate"),i.Yb(),i.Yb(),i.Yb(),i.Yb()),2&t&&(i.Gb(2),i.Tc(" ",i.nc(3,9,"wiredfurni.title")," "),i.Gb(7),i.Jb("icon icon-wired-",e.wiredType," mr-2"),i.Gb(1),i.Tc(" ",e.furniName,""),i.Gb(2),i.Sc(e.furniDescription),i.Gb(2),i.sc("ngIf",e.requiresFurni),i.Gb(3),i.Sc(i.nc(18,11,"wiredfurni.ready")),i.Gb(3),i.Sc(i.nc(21,13,"cancel")))},directives:[op,dp,o.m],pipes:[Ep],encapsulation:2}),t})(),Cv=(()=>{class t{}return t.\u0275mod=i.Sb({type:t}),t.\u0275inj=i.Rb({factory:function(e){return new(e||t)},providers:[sR],imports:[[p,o.b]]}),t})();i.Hc(oR,[yv,c.q,c.j,c.l,c.m,c.s],[Ep]),i.Hc(_R,[yv],[]),i.Hc(lR,[yv,c.o,c.b,c.j,c.l],[Ep]),i.Hc(dR,[yv,c.b,c.j,c.l],[Ep]),i.Hc(mR,[yv],[]),i.Hc(ER,[yv,c.b,c.j,c.l],[Ep]),i.Hc(SR,[yv,c.b,c.j,c.l],[Ep]),i.Hc(RR,[yv,c.o,c.b,c.j,c.l],[Ep]),i.Hc(vR,[yv],[]),i.Hc(OR,[yv],[]),i.Hc(yR,[yv,c.o,c.b,c.j,c.l],[Ep]),i.Hc(MR,[yv,c.a,c.j,c.l],[Ep]),i.Hc(NR,[yv],[]),i.Hc(UR,[yv,a.b],[Ep]),i.Hc(PR,[yv,a.b],[Ep]),i.Hc(FR,[yv,a.b],[Ep]),i.Hc(BR,[yv,c.o,c.b,c.j,c.l,o.m],[Ep]),i.Hc(WR,[yv,c.b,c.j,c.l,c.o],[Ep]),i.Hc(zR,[yv],[]),i.Hc(KR,[yv],[]),i.Hc(JR,[yv,c.b,c.j,c.l],[Ep]),i.Hc($R,[yv,c.b,c.j,c.l],[Ep]),i.Hc(eI,[yv],[]),i.Hc(iI,[yv],[]),i.Hc(nI,[yv],[]),i.Hc(oI,[yv,a.b],[Ep]),i.Hc(_I,[yv],[]),i.Hc(lI,[yv,a.b],[Ep]),i.Hc(gI,[yv,a.b],[Ep]),i.Hc(pI,[yv,a.b],[Ep]),i.Hc(Ev,[yv,a.b],[Ep]),i.Hc(mv,[yv,a.b],[Ep]),i.Hc(LI,[yv,a.b],[Ep]),i.Hc(GI,[yv,a.b],[Ep]),i.Hc(wI,[yv,a.b],[Ep]),i.Hc(xI,[yv,c.b,c.j,c.l,a.b],[Ep]),i.Hc(II,[yv,c.b,c.g,c.j,c.l,c.q,c.m,c.s,a.b],[Ep]),i.Hc(bI,[yv,c.b,c.g,c.j,c.l,c.o,a.b],[Ep]),i.Hc(ev,[yv,a.b],[Ep]),i.Hc(lv,[yv,a.b],[Ep]),i.Hc($I,[yv,c.b,c.j,c.l,a.b],[Ep]),i.Hc(DI,[yv,c.b,c.g,c.j,c.l,a.b],[Ep]),i.Hc(dv,[yv,c.a,c.j,c.l,a.b],[Ep]),i.Hc(TI,[yv,c.b,c.g,c.j,c.l,a.b],[Ep]),i.Hc(_v,[yv,a.b,c.b,c.j,c.l],[Ep]),i.Hc(vv,[yv,c.b,c.g,c.j,c.l,pp,a.b],[Ep]),i.Hc(AI,[yv,c.b,c.g,c.j,c.l,c.o,a.b],[Ep]),i.Hc(CI,[yv,c.b,c.g,c.j,c.l,c.o,a.b],[Ep]),i.Hc(nv,[yv,c.o,c.b,c.j,c.l,a.b],[Ep]),i.Hc(ov,[yv,c.o,c.b,c.j,c.l,a.b],[Ep]),i.Hc(JI,[yv,c.q,c.j,c.l,c.m,c.s,a.b],[Ep]),i.Hc(zI,[yv,a.b,c.q,c.j,c.l,c.m,c.s],[Ep]),i.Hc(KI,[yv,a.b],[Ep]),i.Hc(iv,[yv,a.b,c.o,c.b,c.j,c.l],[Ep]),i.Hc(WI,[yv,c.a,c.j,c.l,o.m,a.b,c.q,c.m,c.s,c.b,u.b,o.l],[Ep]);let Mv=(()=>{class t{}return t.\u0275mod=i.Sb({type:t}),t.\u0275inj=i.Rb({factory:function(e){return new(e||t)},imports:[[p,Kb,fp,bp,lf,qf,Qf,$f,KS,Xb,qb,Jb,Qb,Cv,pm]]}),t})();function Dv(t,e){if(1&t&&(i.Zb(0,"div",5),i.Rc(1),i.Yb()),2&t){const t=i.lc();i.Gb(1),i.Sc(t.message)}}const Nv=function(t){return{width:t}};function wv(t,e){if(1&t&&(i.Zb(0,"div",6),i.Zb(1,"div",7),i.Vb(2,"div",8),i.Yb(),i.Zb(3,"div",9),i.Rc(4),i.Yb(),i.Yb()),2&t){const t=i.lc();i.Gb(2),i.sc("ngStyle",i.vc(2,Nv,(t.percentage||0)+"%")),i.Gb(2),i.Tc("",t.percentage||0,"%")}}let Uv=(()=>{class t{constructor(){this.message="",this.percentage=0,this.hideProgress=!1}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275cmp=i.Ob({type:t,selectors:[["nitro-loading"]],inputs:{message:"message",percentage:"percentage",hideProgress:"hideProgress"},decls:5,vars:2,consts:[[1,"nitro-loading-component"],[1,"logo"],[1,"container"],["class","text",4,"ngIf"],["class","progress-container",4,"ngIf"],[1,"text"],[1,"progress-container"],[1,"loading-bar"],[1,"bar",3,"ngStyle"],[1,"percent"]],template:function(t,e){1&t&&(i.Zb(0,"div",0),i.Vb(1,"div",1),i.Zb(2,"div",2),i.Pc(3,Dv,2,1,"div",3),i.Pc(4,wv,5,4,"div",4),i.Yb(),i.Yb()),2&t&&(i.Gb(3),i.sc("ngIf",e.message&&e.message.length&&e.hideProgress),i.Gb(1),i.sc("ngIf",!e.hideProgress))},directives:[o.m,o.n],encapsulation:2}),t})();var Lv=s("R0Ic");let Pv=(()=>{class t extends ih{constructor(e,s,i=!1,r=!1){super(t.ROOM_ZOOM,e),this._level=s,this._forceFlip=i,this._asDelta=r}get level(){return this._level}get forceFlip(){return this._forceFlip}get asDelta(){return this._asDelta}}return t.ROOM_ZOOM="REE_ROOM_ZOOM",t})();var xv=s("Vvah");class Fv extends y{constructor(t){super(t)}}let Gv=(()=>{class t extends Fv{constructor(t,e){super(t),this._roomId=0,this._roomId=e}get roomId(){return this._roomId}}return t.RWREUE_GAME_MODE="RWREUE_GAME_MODE",t.RWREUE_NORMAL_MODE="RWREUE_NORMAL_MODE",t})(),Vv=(()=>{class t extends Fv{constructor(t,e,s,i){super(t),this._id=e,this._category=s,this._roomId=i}get id(){return this._id}get category(){return this._category}get roomId(){return this._roomId}}return t.OBJECT_SELECTED="RWROUE_OBJECT_SELECTED",t.OBJECT_DESELECTED="RWROUE_OBJECT_DESELECTED",t.USER_REMOVED="RWROUE_USER_REMOVED",t.FURNI_REMOVED="RWROUE_FURNI_REMOVED",t.FURNI_ADDED="RWROUE_FURNI_ADDED",t.USER_ADDED="RWROUE_USER_ADDED",t.OBJECT_ROLL_OVER="RWROUE_OBJECT_ROLL_OVER",t.OBJECT_ROLL_OUT="RWROUE_OBJECT_ROLL_OUT",t})(),Yv=(()=>{class t extends Fv{constructor(t,e=null,s=null,i=0){super(t),this._roomViewRectangle=e,this._positionDelta=s,this._scale=i}get roomViewRectangle(){return this._roomViewRectangle?this._roomViewRectangle.clone():null}get positionDelta(){return this._positionDelta?this._positionDelta.clone():null}get scale(){return this._scale}}return t.SIZE_CHANGED="RWRVUE_ROOM_VIEW_SIZE_CHANGED",t.SCALE_CHANGED="RWRVUE_ROOM_VIEW_SCALE_CHANGED",t.POSITION_CHANGED="RWRVUE_ROOM_VIEW_POSITION_CHANGED",t})(),kv=(()=>{class t extends Fv{constructor(e,s,i,r,n){super(t.RWAIE_AVATAR_INFO),this._userId=e,this._userName=s,this._Str_3021=i,this._Str_2775=r,this._Str_3947=n}get userId(){return this._userId}get userName(){return this._userName}get _Str_2908(){return this._Str_3021}get _Str_2707(){return this._Str_2775}get _Str_4330(){return this._Str_3947}}return t.RWAIE_AVATAR_INFO="RWAIE_AVATAR_INFO",t})(),jv=(()=>{class t extends Fv{constructor(){super(t.RWUDUE_USER_DATA_UPDATED)}}return t.RWUDUE_USER_DATA_UPDATED="rwudue_user_data_updated",t})();class Bv{constructor(t){this._type=t}get type(){return this._type}}let Hv=(()=>{class t extends Bv{constructor(e){super(t.RWCM_MESSAGE_AVATAR_EXPRESSION),this._animation=e}get animation(){return this._animation}}return t.RWCM_MESSAGE_AVATAR_EXPRESSION="RWCM_MESSAGE_AVATAR_EXPRESSION",t})(),Wv=(()=>{class t extends Bv{constructor(e){super(t.RWCPM_MESSAGE_CHANGE_POSTURE),this._posture=e}get posture(){return this._posture}}return t.RWCPM_MESSAGE_CHANGE_POSTURE="RWCPM_MESSAGE_CHANGE_POSTURE",t._Str_1553=0,t._Str_2016=1,t})(),Zv=(()=>{class t extends Bv{constructor(e){super(t.RWCM_MESSAGE_DANCE),this._style=0,this._style=e}get style(){return this._style}}return t.RWCM_MESSAGE_DANCE="RWCM_MESSAGE_DANCE",t._Str_13814=0,t._Str_17699=[2,3,4],t})(),zv=(()=>{class t extends Bv{constructor(t,e,s){super(t),this._id=e,this._category=s}get id(){return this._id}get category(){return this._category}}return t.GET_OBJECT_INFO="RWROM_GET_OBJECT_INFO",t.GET_OBJECT_NAME="RWROM_GET_OBJECT_NAME",t.SELECT_OBJECT="RWROM_SELECT_OBJECT",t.GET_OWN_CHARACTER_INFO="RWROM_GET_OWN_CHARACTER_INFO",t.GET_AVATAR_LIST="RWROM_GET_AVATAR_LIST",t})(),Xv=(()=>{class t extends Bv{constructor(t,e=0){super(t),this._userId=e}get userId(){return this._userId}}return t.RWUAM_WHISPER_USER="RWUAM_WHISPER_USER",t.RWUAM_IGNORE_USER="RWUAM_IGNORE_USER",t.RWUAM_IGNORE_USER_BUBBLE="RWUAM_IGNORE_USER_BUBBLE",t.RWUAM_UNIGNORE_USER="RWUAM_UNIGNORE_USER",t.RWUAM_KICK_USER="RWUAM_KICK_USER",t.RWUAM_BAN_USER_HOUR="RWUAM_BAN_USER_HOUR",t.RWUAM_BAN_USER_DAY="RWUAM_BAN_USER_DAY",t.RWUAM_BAN_USER_PERM="RWUAM_BAN_USER_PERM",t.MUTE_USER_2MIN="RWUAM_MUTE_USER_2MIN",t.MUTE_USER_5MIN="RWUAM_MUTE_USER_5MIN",t.MUTE_USER_10MIN="RWUAM_MUTE_USER_10MIN",t.RWUAM_SEND_FRIEND_REQUEST="RWUAM_SEND_FRIEND_REQUEST",t.RWUAM_RESPECT_USER="RWUAM_RESPECT_USER",t.RWUAM_GIVE_RIGHTS="RWUAM_GIVE_RIGHTS",t.RWUAM_TAKE_RIGHTS="RWUAM_TAKE_RIGHTS",t.RWUAM_START_TRADING="RWUAM_START_TRADING",t.RWUAM_OPEN_HOME_PAGE="RWUAM_OPEN_HOME_PAGE",t.RWUAM_REPORT="RWUAM_REPORT",t.RWUAM_PICKUP_PET="RWUAM_PICKUP_PET",t.RWUAM_MOUNT_PET="RWUAM_MOUNT_PET",t.RWUAM_TOGGLE_PET_RIDING_PERMISSION="RWUAM_TOGGLE_PET_RIDING_PERMISSION",t.RWUAM_TOGGLE_PET_BREEDING_PERMISSION="RWUAM_TOGGLE_PET_BREEDING_PERMISSION",t.RWUAM_DISMOUNT_PET="RWUAM_DISMOUNT_PET",t.RWUAM_SADDLE_OFF="RWUAM_SADDLE_OFF",t.RWUAM_TRAIN_PET="RWUAM_TRAIN_PET",t.RWUAM_RESPECT_PET=" RWUAM_RESPECT_PET",t.RWUAM_TREAT_PET="RWUAM_TREAT_PET",t.RWUAM_REQUEST_PET_UPDATE="RWUAM_REQUEST_PET_UPDATE",t.RWUAM_START_NAME_CHANGE="RWUAM_START_NAME_CHANGE",t.RWUAM_PASS_CARRY_ITEM="RWUAM_PASS_CARRY_ITEM",t.RWUAM_DROP_CARRY_ITEM="RWUAM_DROP_CARRY_ITEM",t.RWUAM_GIVE_CARRY_ITEM_TO_PET="RWUAM_GIVE_CARRY_ITEM_TO_PET",t.RWUAM_GIVE_WATER_TO_PET="RWUAM_GIVE_WATER_TO_PET",t.RWUAM_GIVE_LIGHT_TO_PET="RWUAM_GIVE_LIGHT_TO_PET",t.RWUAM_REQUEST_BREED_PET="RWUAM_REQUEST_BREED_PET",t.RWUAM_HARVEST_PET="RWUAM_HARVEST_PET",t.RWUAM_REVIVE_PET="RWUAM_REVIVE_PET",t.RWUAM_COMPOST_PLANT="RWUAM_COMPOST_PLANT",t.RWUAM_GET_BOT_INFO="RWUAM_GET_BOT_INFO",t.RWUAM_REPORT_CFH_OTHER="RWUAM_REPORT_CFH_OTHER",t.RWUAM_AMBASSADOR_ALERT_USER="RWUAM_AMBASSADOR_ALERT_USER",t.RWUAM_AMBASSADOR_KICK_USER="RWUAM_AMBASSADOR_KICK_USER",t.AMBASSADOR_MUTE_USER_2MIN="RWUAM_AMBASSADOR_MUTE_2MIN",t.AMBASSADOR_MUTE_USER_10MIN="RWUAM_AMBASSADOR_MUTE_10MIN",t.AMBASSADOR_MUTE_USER_60MIN="RWUAM_AMBASSADOR_MUTE_60MIN",t.AMBASSADOR_MUTE_USER_18HOUR="RWUAM_AMBASSADOR_MUTE_18HOUR",t})();class Kv{constructor(){this._container=null,this._container=null,this._widget=null,this._disposed=!1,this.onUserNameUpdateEvent=this.onUserNameUpdateEvent.bind(this),this.onNitroToolbarEvent=this.onNitroToolbarEvent.bind(this)}dispose(){this.disposed||(this.container=null,this._widget=null,this._disposed=!0)}update(){}processWidgetMessage(t){if(!t)return null;switch(t.type){case zv.GET_OWN_CHARACTER_INFO:this.getOwnCharacterInfo();break;case Zv.RWCM_MESSAGE_DANCE:{const e=t;this._container&&this._container.roomSession&&this._container.roomSession.sendDanceMessage(e.style);break}case Hv.RWCM_MESSAGE_AVATAR_EXPRESSION:{const e=t;this._container&&this._container.roomSession&&this._container.roomSession.sendExpressionMessage(e.animation._Str_6677);break}case Wv.RWCPM_MESSAGE_CHANGE_POSTURE:{const e=t;this._container&&this._container.roomSession&&this._container.roomSession.sendPostureMessage(e.posture);break}}return null}processEvent(t){if(t)switch(t.type){case Jg.USER_DATA_UPDATED:return void this._container.events.dispatchEvent(new jv);case Kg.RSDE_DANCE:{const e=t;if(this._widget&&this._container&&this._container.roomSession&&this._container.roomSession.userDataManager){const t=this._container.roomSession.userDataManager.getUserData(this._container.sessionDataManager.userId);t&&t.roomIndex===e.roomIndex&&(this.widget.isDancing=0!==e.danceId)}return}}}getOwnCharacterInfo(){const t=this._container.sessionDataManager.userId,e=this._container.sessionDataManager.userName,s=this._container.roomSession.userDataManager.getUserData(t);s&&this._container.events.dispatchEvent(new kv(t,e,s.type,s.roomIndex,!1))}getObjectFurnitureData(t){if(!t)return null;const e=t.model.getValue(st.FURNITURE_TYPE_ID);return this._container.sessionDataManager.getFloorItemData(e)}getPetUserData(t){const e=this._container.roomSession.roomId,s=this._container.roomEngine.getTotalObjectsForManager(e,tt.UNIT);let i=0;for(;i<s;){const s=this._container.roomEngine.getRoomObjectByIndex(e,i,tt.UNIT),r=this._container.roomSession.userDataManager.getUserDataByIndex(s.id);if(r&&r.type===Za.PET&&r.webID===t)return r;i++}return null}onUserNameUpdateEvent(t){this.widget.close()}onNitroToolbarEvent(t){switch(t.type){case Ah.SELECT_OWN_AVATAR:return void this.getOwnCharacterInfo()}}get type(){return kd.AVATAR_INFO}get messageTypes(){return[zv.GET_OWN_CHARACTER_INFO,Zv.RWCM_MESSAGE_DANCE,Hv.RWCM_MESSAGE_AVATAR_EXPRESSION,Wv.RWCPM_MESSAGE_CHANGE_POSTURE]}get eventTypes(){return[Jg.USER_DATA_UPDATED,Kg.RSDE_DANCE]}get container(){return this._container}set container(t){this._container&&this._container.sessionDataManager&&this._container.sessionDataManager.events&&(this._container.sessionDataManager.events.removeEventListener(cm.UNUE_NAME_UPDATED,this.onUserNameUpdateEvent),this._container.roomEngine.events.removeEventListener(Ah.SELECT_OWN_AVATAR,this.onNitroToolbarEvent)),this._container=t,t&&this._container.sessionDataManager&&this._container.sessionDataManager.events&&(this._container.sessionDataManager.events.addEventListener(cm.UNUE_NAME_UPDATED,this.onUserNameUpdateEvent),this._container.roomEngine.events.addEventListener(Ah.SELECT_OWN_AVATAR,this.onNitroToolbarEvent))}get widget(){return this._widget}set widget(t){this._widget=t}get roomEngine(){return this._container&&this._container.roomEngine||null}get roomSession(){return this._container&&this._container.roomSession||null}get disposed(){return this._disposed}}let qv=(()=>{class t{constructor(t){this._ordinal=t}get _Str_6677(){return this._ordinal}_Str_1451(t){return t&&t._ordinal==this._ordinal}}return t.NONE=new t(0),t._Str_6268=new t(1),t._Str_5579=new t(2),t._Str_7336=new t(3),t._Str_10353=new t(4),t._Str_6989=new t(5),t._Str_16682=new t(6),t._Str_6325=new t(7),t})(),Jv=(()=>{class t extends Bv{constructor(t,e,s,i,r){super(t),this._text=e,this._chatType=s,this._recipientName=i,this._styleId=r}get text(){return this._text}get chatType(){return this._chatType}get recipientName(){return this._recipientName}get styleId(){return this._styleId}}return t.MESSAGE_CHAT="RWCM_MESSAGE_CHAT",t.CHAT_DEFAULT=0,t.CHAT_WHISPER=1,t.CHAT_SHOUT=2,t})(),Qv=(()=>{class t extends Bv{constructor(t,e,s,i){super(t),this._objectId=e,this._userName=s,this._roomId=i}get objectId(){return this._objectId}get userName(){return this._userName}get roomId(){return this._roomId}}return t.MESSAGE_SELECT_AVATAR="RWCSAM_MESSAGE_SELECT_AVATAR",t})(),$v=(()=>{class t extends Bv{constructor(e){super(t.TYPING_STATUS),this._isTyping=e}get isTyping(){return this._isTyping}}return t.TYPING_STATUS="RWCTM_TYPING_STATUS",t})(),tT=(()=>{class t extends Bv{constructor(t){super(t)}}return t.RWRWM_USER_CHOOSER="RWRWM_USER_CHOOSER",t.RWRWM_FURNI_CHOOSER="RWRWM_FURNI_CHOOSER",t.RWRWM_ME_MENU="RWRWM_ME_MENU",t.RWRWM_EFFECTS="RWRWM_EFFECTS",t})();class eT{constructor(){this._container=null,this._widget=null,this._disposed=!1}dispose(){this._disposed||(this._container=null,this._widget=null,this._disposed=!0)}update(){}processWidgetMessage(t){if(!t||this.disposed)return null;let e=null;switch(t.type){case $v.TYPING_STATUS:this._container.roomSession.sendChatTypingMessage(t.isTyping);break;case Jv.MESSAGE_CHAT:{const e=t;if(""===e.text)return null;let s=e.text;const i=e.text.split(" ");if(i.length>0){const t=i[0];let r="";if(i.length>1&&(r=i[1]),":"===t.charAt(0)&&"x"===r){const t=this._container.roomEngine.selectedAvatarId;if(t>-1){const i=this._container.roomSession.userDataManager.getUserDataByIndex(t);i&&(r=i.name,s=e.text.replace(" x"," "+i.name))}}switch(t.toLowerCase()){case":d":case";d":this._container.sessionDataManager.clubLevel===qS._Str_2575&&this._container.roomSession.sendExpressionMessage(qv._Str_7336._Str_6677);break;case"o/":case"_o/":return this._container.roomSession.sendExpressionMessage(qv._Str_6268._Str_6677),null;case":kiss":if(this._container.sessionDataManager.clubLevel==qS._Str_2575)return this._container.roomSession.sendExpressionMessage(qv._Str_5579._Str_6677),null;break;case":jump":if(this._container.sessionDataManager.clubLevel==qS._Str_2575)return this._container.roomSession.sendExpressionMessage(qv._Str_16682._Str_6677),null;break;case":idle":return this._container.roomSession.sendExpressionMessage(qv._Str_6989._Str_6677),null;case"_b":return this._container.roomSession.sendExpressionMessage(qv._Str_6325._Str_6677),null;case":sign":return this._container.roomSession.sendSignMessage(parseInt(r)),null;case":iddqd":return this._container.roomEngine.events.dispatchEvent(new Pv(this._container.roomEngine.activeRoomId,-1,!0)),null;case":zoom":return this._container.roomEngine.events.dispatchEvent(new Pv(this._container.roomEngine.activeRoomId,parseInt(r),!1)),null;case":screenshot":return this._container.roomEngine.createRoomScreenshot(this._container.roomSession.roomId,this._container.getFirstCanvasId()),null;case":pickall":return this._container.notificationService.alertWithConfirm("${room.confirm.pick_all}","${generic.alert.title}",()=>{this._container.sessionDataManager.sendSpecialCommandMessage(":pickall")}),null;case":furni":return this._container.processWidgetMessage(new tT(tT.RWRWM_FURNI_CHOOSER)),null;case":chooser":return this._container.processWidgetMessage(new tT(tT.RWRWM_USER_CHOOSER)),null;case":client":case":nitro":case":billsonnn":return this._container.notificationService.alertWithScrollableMessages(['<div class="d-flex flex-column justify-content-center align-items-center"><div style="width: 350px; height: 120px; margin: 10px; background: transparent url(\'https://assets-1.nitrots.co/nitro-dark.svg\') no-repeat center; filter: drop-shadow(2px 1px 0 white) drop-shadow(-2px 1px 0 white) drop-shadow(0 -2px 0 white);"></div><b>Version: '+um.RELEASE_VERSION+'</b><br />This client is powered by Nitro HTML5<br /><br /><div class="d-flex"><a class="btn btn-primary" href="https://discord.gg/66UR68FPgy" target="_blank">Discord</a><a class="btn btn-primary" href="https://git.krews.org/nitro" target="_blank">Git</a></div><br /></div>'],"Nitro HTML5"),null}}const r=e.styleId;if(this._container&&this._container.roomSession)switch(e.chatType){case Jv.CHAT_DEFAULT:this._container.roomSession.sendChatMessage(s,r);break;case Jv.CHAT_SHOUT:this._container.roomSession.sendShoutMessage(s,r);break;case Jv.CHAT_WHISPER:this._container.roomSession.sendWhisperMessage(e.recipientName,s,r)}break}case Qv.MESSAGE_SELECT_AVATAR:e=t}return null}processEvent(t){}get type(){return kd.CHAT_INPUT_WIDGET}get messageTypes(){return[$v.TYPING_STATUS,Jv.MESSAGE_CHAT,Qv.MESSAGE_SELECT_AVATAR]}get eventTypes(){return[]}get container(){return this._container}set container(t){this._container=t}get widget(){return this._widget}set widget(t){this._widget=t}get disposed(){return this._disposed}}class sT{static sum(t,e){return new A.j(t.x+e.x,t.y+e.y)}static _Str_15193(t,e){return new A.j(t.x-e.x,t.y-e.y)}static _Str_6038(t,e){return new A.j(t.x*e,t.y*e)}}let iT=(()=>{class t extends Fv{constructor(t,e,s,i,r,n,a,o,c,_,h,l,u=0,d=0,g=null){super(t),this._userId=e,this._text=s,this._chatType=u,this._userName=i,this._userCategory=r,this._userType=n,this._petType=a,this._links=g,this._userX=o,this._userY=c,this._userImage=_,this._userColor=h,this._roomId=l,this._styleId=d}get userId(){return this._userId}get text(){return this._text}get chatType(){return this._chatType}get userName(){return this._userName}get userCategory(){return this._userCategory}get userType(){return this._userType}get petType(){return this._petType}get links(){return this._links}get userX(){return this._userX}get userY(){return this._userY}get userImage(){return this._userImage}get userColor(){return this._userColor}get roomId(){return this._roomId}get styleId(){return this._styleId}}return t.RWCUE_EVENT_CHAT="RWCUE_EVENT_CHAT",t.CHAT_TYPE_SPEAK=0,t.CHAT_TYPE_WHISPER=1,t.CHAT_TYPE_SHOUT=2,t.CHAT_TYPE_RESPECT=3,t.CHAT_TYPE_PETRESPECT=4,t.CHAT_TYPE_NOTIFY=5,t.CHAT_TYPE_PETTREAT=6,t.CHAT_TYPE_PETREVIVE=7,t.CHAT_TYPE_PET_REBREED_FERTILIZE=8,t.CHAT_TYPE_PET_SPEED_FERTILIZE=9,t.CHAT_TYPE_BOT_SPEAK=10,t.CHAT_TYPE_BOT_SHOUT=11,t.CHAT_TYPE_BOT_WHISPER=12,t})();class rT{constructor(){this._container=null,this._widget=null,this._connection=null,this._avatarColorCache=new Map,this._avatarImageCache=new Map,this._petImageCache=new Map,this._primaryCanvasScale=0,this._primaryCanvasOriginPos=null,this._tempScreenPosVector=new ot,this._disposed=!1}dispose(){this._disposed||(this._container=null,this._widget=null,this._disposed=!0)}update(){this._Str_20006()}_Str_20006(){if(!(this._container&&this._container.roomSession&&this._container.roomEngine&&this._container.events))return;const t=this._container.getFirstCanvasId(),e=this._container.roomSession.roomId,s=this._container.roomEngine.getRoomInstanceRenderingCanvas(e,t);if(!s)return;const i=s.geometry;if(!i)return;let r=1;this._primaryCanvasScale>0&&(r=i.scale/this._primaryCanvasScale),this._primaryCanvasOriginPos||(this._tempScreenPosVector.x=0,this._tempScreenPosVector.y=0,this._tempScreenPosVector.z=0,this._primaryCanvasOriginPos=i.getScreenPoint(this._tempScreenPosVector),this._primaryCanvasScale=i.scale-10);let n="",a=null;this._tempScreenPosVector.x=0,this._tempScreenPosVector.y=0,this._tempScreenPosVector.z=0;const o=i.getScreenPoint(this._tempScreenPosVector);if(o){const s=this._container.roomEngine.getRoomInstanceRenderingCanvasOffset(e,t);if(s&&o.set(o.x+s.x,o.y+s.y),o.x!=this._primaryCanvasOriginPos.x||o.y!=this._primaryCanvasOriginPos.y){const t=sT._Str_15193(o,sT._Str_6038(this._primaryCanvasOriginPos,r));0==t.x&&0==t.y||(n=Yv.POSITION_CHANGED,a=new Yv(n,null,t),this._container.events.dispatchEvent(a)),this._primaryCanvasOriginPos=o}}i.scale!==this._primaryCanvasScale&&(n=Yv.SCALE_CHANGED,a=new Yv(n,null,null,i.scale),this._container.events.dispatchEvent(a),this._primaryCanvasScale=i.scale)}processWidgetMessage(t){return null}processEvent(t){if(t&&!this._disposed)switch(t.type){case Fg.CHAT_EVENT:{const e=t,s=this._container.roomEngine.getRoomObject(e.session.roomId,e.objectId,tt.UNIT);if(s){const t=this._container.roomEngine.getRoomInstanceGeometry(e.session.roomId,this._container.getFirstCanvasId());if(t){this._Str_20006();let i=0,r=0;const n=s.getLocation(),a=t.getScreenPoint(n);if(a){i=a.x,r=a.y;const t=this._container.roomEngine.getRoomInstanceRenderingCanvasOffset(e.session.roomId,this._container.getFirstCanvasId());t&&(i+=t.x,r+=t.y)}const o=this._container.roomSession.userDataManager.getUserDataByIndex(e.objectId);let c="",_=0,h=null;const l=e.chatType;let u=e.style,d=0,g=-1;if(o){d=o.type;const t=o.figure;switch(d){case Za.PET:h=this.getPetImage(t,2,!0,64,s.model.getValue(st.FIGURE_POSTURE)),g=new Th(t).typeId;break;case Za.USER:h=this.getUserImage(t);break;case Za.RENTABLE_BOT:case Za.BOT:u=xg.BOT}_=this._avatarColorCache.get(t),c=o.name}let m=e.message;switch(l){case Fg._Str_5821:m=um.instance.localization.getValueWithParameter("widgets.chatbubble.respect","username",c)}this._container&&this._container.events&&this._container.events.dispatchEvent(new iT(iT.RWCUE_EVENT_CHAT,o.roomIndex,m,c,tt.UNIT,d,g,i,r,h,_,e.session.roomId,l,u,[]))}}return}}}getUserImage(t){let e=this._avatarImageCache.get(t);return e||(e=this.setFigureImage(t)),e}setFigureImage(t){const e=this._container.avatarRenderManager.createAvatarImage(t,yt.LARGE,null,this);if(!e)return;const s=e.getCroppedImage(Pt.HEAD),i=e.getPartColor(At.CHEST);return this._avatarColorCache.set(t,i&&i._Str_915||16777215),e.dispose(),this._avatarImageCache.set(t,s),s}getPetImage(t,e,s,i=64,r=null){let n=this._petImageCache.get(t+r);if(n)return n;const a=new Th(t),o=this._container.roomEngine.getRoomObjectPetImage(a.typeId,a.paletteId,a.color,new ot(45*e),i,null,!1,0,a.customParts,r);return o&&(n=um.instance.renderer.extract.image(o.data),this._petImageCache.set(t+r,n)),n}resetFigure(t){this.setFigureImage(t)}get type(){return kd.CHAT_WIDGET}get messageTypes(){return[]}get eventTypes(){return[Fg.CHAT_EVENT]}get container(){return this._container}set container(t){this._container=t}get widget(){return this._widget}set widget(t){this._widget=t}get connection(){return this._connection}set connection(t){this._connection=t}get disposed(){return this._disposed}}function nT(t){let e=1;return"-"===t[0]&&(e=-1,t=t.substr(1)),function(s,i){return(s[t]<i[t]?-1:s[t]>i[t]?1:0)*e}}class aT{constructor(t,e,s){this._id=t,this._category=e,this._name=s}get id(){return this._id}get category(){return this._category}get name(){return this._name}}let oT=(()=>{class t extends Fv{constructor(t,e,s=!1){super(t),this._items=e.slice(),this._Str_10043=s}get items(){return this._items}get _Str_2799(){return this._Str_10043}}return t.RWCCE_USER_CHOOSER_CONTENT="RWCCE_USER_CHOOSER_CONTENT",t.RWCCE_FURNI_CHOOSER_CONTENT="RWCCE_FURNI_CHOOSER_CONTENT",t})();class cT{constructor(){this._isDisposed=!1,this._container=null}dispose(){this._isDisposed=!0,this._container=null}processWidgetMessage(t){if(!t)return null;switch(t.type){case tT.RWRWM_FURNI_CHOOSER:this.processFurniChooser();break;case zv.SELECT_OBJECT:this.selectFurni(t)}return null}selectFurni(t){null!=t&&(t.category!=tt.WALL&&t.category!=tt.FLOOR||this._container.roomEngine.selectRoomObject(this._container.roomSession.roomId,t.id,t.category))}processFurniChooser(){if(null==this._container||null==this._container.roomSession||null==this._container.roomEngine||null==this._container.roomSession.userDataManager)return;const t=this._container.roomSession.roomId,e=[];this.processFloorFurni(t,e),this.processWallFurni(t,e),e.sort(nT("name")),this._container.events.dispatchEvent(new oT(oT.RWCCE_FURNI_CHOOSER_CONTENT,e,!1))}processWallFurni(t,e){const s=this._container.roomEngine.getRoomObjectCount(t,tt.WALL);for(let i=0;i<s;i++){const s=this._container.roomEngine.getRoomObjectByIndex(t,i,tt.WALL);if(null==s)continue;const r=s.type;let n=null;if(r.startsWith("poster")){const t=Number.parseInt(r.replace("poster",""));n=um.instance.localization.getValue("poster_"+t+"_name")}else{const t=Number.parseInt(s.model.getValue(st.FURNITURE_TYPE_ID)),e=this._container.sessionDataManager.getWallItemData(t);n=null!=e&&e.name.length>0?e.name:r}e.push(new aT(s.id,tt.WALL,n))}}processFloorFurni(t,e){const s=this._container.roomEngine.getRoomObjectCount(t,tt.FLOOR);for(let i=0;i<s;i++){const s=this._container.roomEngine.getRoomObjectByIndex(t,i,tt.FLOOR);if(null==s)continue;const r=Number.parseInt(s.model.getValue(st.FURNITURE_TYPE_ID)),n=this._container.sessionDataManager.getFloorItemData(r);e.push(new aT(s.id,tt.FLOOR,null!=n?n.name:s.type))}}processEvent(t){}update(){}get disposed(){return this._isDisposed}get type(){return kd.FURNI_CHOOSER}set container(t){this._container=t}get messageTypes(){return[tT.RWRWM_FURNI_CHOOSER,zv.SELECT_OBJECT]}get eventTypes(){return[]}}class _T{constructor(){this._container=null,this._widget=null,this._lastFurniId=-1,this._messages=[]}dispose(){this.container=null,this._widget=null}processWidgetMessage(t){return null}processEvent(t){if(!t)return;let e=null;switch(t.type){case md.OPEN_WIDGET:if(e=t,e&&this._container.roomEngine&&this._widget){this._lastFurniId=e.objectId;const t=this._container.roomEngine.getRoomObject(e.roomId,e.objectId,e.category);t&&this.canManipulateRoomObject(t)&&this._widget.open(this._lastFurniId,t.getLocation().z)}return;case md.CLOSE_WIDGET:return e=t,void(e&&this._container.roomEngine&&this._widget&&this._lastFurniId===e.objectId&&this._widget.hide())}}update(){}get disposed(){return!!this._container}get type(){return kd.CUSTOM_STACK_HEIGHT}get container(){return this._container}set container(t){if(t!==this._container&&this._container){for(const t of this._messages)this._container.connection.removeMessageEvent(t);this._messages=[]}if(this._container=t,this._container){this._messages=[new Jn(this.onFurnitureStackHeightEvent.bind(this))];for(const e of this._messages)t.connection.addMessageEvent(e)}}get messageTypes(){return[]}get eventTypes(){return[]}get widget(){return this._widget}set widget(t){this._widget=t}onFurnitureStackHeightEvent(t){if(!t)return;const e=t.getParser();e&&this._widget&&this.canManipulateRoomObject()&&this._widget.update(e.furniId,e.height)}canManipulateRoomObject(t=null){const e=this._container.roomSession.isRoomOwner,s=this._container.roomSession.controllerLevel>=en.GUEST,i=this._container.sessionDataManager.isModerator,r=t&&this._container.isOwnerOfFurniture(t);return e||i||s||r}}let hT=(()=>{class t extends Fv{constructor(e,s,i,r,n){super(t.RWDSUE_DIMMER_STATE),this._state=e,this._presetId=s,this._effectId=i,this._color=r,this._brightness=n}get state(){return this._state}get _Str_14686(){return this._presetId}get _Str_6815(){return this._effectId}get color(){return this._color}get _Str_5123(){return this._brightness}}return t.RWDSUE_DIMMER_STATE="RWDSUE_DIMMER_STATE",t})();class lT{constructor(t,e,s,i){this._id=0,this._type=0,this._color=0,this._Str_3576=0,this._id=t,this._type=e,this._color=s,this._Str_3576=i}get id(){return this._id}get type(){return this._type}get color(){return this._color}get _Str_4272(){return this._Str_3576}}let uT=(()=>{class t extends Fv{constructor(t){super(t),this._selectedPresetId=0,this._presets=[]}get _Str_10888(){return this._presets.length}get _Str_8447(){return this._presets}get _Str_6226(){return this._selectedPresetId}set _Str_6226(t){this._selectedPresetId=t}_Str_17287(t,e,s,i){const r=new lT(t,e,s,i);this._presets[t-1]=r}_Str_14989(t){return t<0||t>=this._presets.length?null:this._presets[t]}}return t.RWDUE_PRESETS="RWDUE_PRESETS",t.RWDUE_HIDE="RWDUE_HIDE",t})(),dT=(()=>{class t extends Bv{constructor(){super(t.RWCDSM_CHANGE_STATE)}}return t.RWCDSM_CHANGE_STATE="RWCDSM_CHANGE_STATE",t})(),gT=(()=>{class t extends Bv{constructor(e,s,i){super(t.RWDPM_PREVIEW_DIMMER_PRESET),this._color=e,this._brightness=s,this._bgOnly=i}get color(){return this._color}get _Str_5123(){return this._brightness}get _Str_11464(){return this._bgOnly}}return t.RWDPM_PREVIEW_DIMMER_PRESET="RWDPM_PREVIEW_DIMMER_PRESET",t})(),mT=(()=>{class t extends Bv{constructor(e,s,i,r,n){super(t.RWSDPM_SAVE_PRESET),this._presetNumber=e,this._effectTypeId=s,this._color=i,this._brightness=r,this._apply=n}get _Str_25037(){return this._presetNumber}get _Str_24446(){return this._effectTypeId}get color(){return this._color}get _Str_5123(){return this._brightness}get apply(){return this._apply}}return t.RWSDPM_SAVE_PRESET="RWSDPM_SAVE_PRESET",t})(),pT=(()=>{class t extends Bv{constructor(t,e,s,i){super(t),this._objectId=e,this._category=s,this._roomId=i}get objectId(){return this._objectId}get category(){return this._category}get roomId(){return this._roomId}}return t.REQUEST_CREDITFURNI="RWFWM_MESSAGE_REQUEST_CREDITFURNI",t.REQUEST_STICKIE="RWFWM_MESSAGE_REQUEST_STICKIE",t.REQUEST_PRESENT="RWFWM_MESSAGE_REQUEST_PRESENT",t.REQUEST_TROPHY="RWFWM_MESSAGE_REQUEST_TROPHY",t.REQUEST_TEASER="RWFWM_MESSAGE_REQUEST_TEASER",t.REQUEST_ECOTRONBOX="RWFWM_MESSAGE_REQUEST_ECOTRONBOX",t.REQUEST_DIMMER="RWFWM_MESSAGE_REQUEST_DIMMER",t.REQUEST_PLACEHOLDER="RWFWM_MESSAGE_REQUEST_PLACEHOLDER",t.REQUEST_CLOTHING_CHANGE="RWFWM_MESSAGE_REQUEST_CLOTHING_CHANGE",t.REQUEST_PLAYLIST_EDITOR="RWFWM_MESSAGE_REQUEST_PLAYLIST_EDITOR",t.REQUEST_ACHIEVEMENT_RESOLUTION_ENGRAVING="RWFWM_WIDGET_MESSAGE_REQUEST_ACHIEVEMENT_RESOLUTION_ENGRAVING",t.REQUEST_ACHIEVEMENT_RESOLUTION_FAILED="RWFWM_WIDGET_MESSAGE_REQUEST_ACHIEVEMENT_RESOLUTION_FAILED",t.REQUEST_BADGE_DISPLAY_ENGRAVING="RWFWM_WIDGET_MESSAGE_REQUEST_BADGE_DISPLAY_ENGRAVING",t})();class ET{constructor(){this._isDisposed=!1,this._container=null}dispose(){this._isDisposed=!0,this._container=null}processWidgetMessage(t){switch(t.type){case pT.REQUEST_DIMMER:case mT.RWSDPM_SAVE_PRESET:case dT.RWCDSM_CHANGE_STATE:this._Str_6826();break;case gT.RWDPM_PREVIEW_DIMMER_PRESET:if(!t||!this._container.roomEngine)return null;this._container.roomEngine._Str_17804(this._container.roomSession.roomId,t.color,t._Str_5123,t._Str_11464)}return null}processEvent(t){switch(t.type){case Ge.RSDPE_PRESETS:{const e=t,s=new uT(uT.RWDUE_PRESETS);s._Str_6226=e._Str_6226;let i=0;for(;i<e._Str_10888;){const t=e._Str_14989(i);t&&s._Str_17287(t.id,t.type,t.color,t._Str_4272),i++}return void this._container.events.dispatchEvent(s)}case ud.ROOM_COLOR:return void this._container.events.dispatchEvent(new hT(t.state,t._Str_14686,t._Str_6815,t.color,t._Str_5123));case md.REMOVE_DIMMER:return void this._container.events.dispatchEvent(new uT(uT.RWDUE_HIDE))}}update(){}_Str_6826(){return this._container.roomSession.isRoomOwner||this._container.roomSession.controllerLevel>=en.GUEST||this._container.sessionDataManager.isModerator}get disposed(){return this._isDisposed}get type(){return kd.ROOM_DIMMER}set container(t){this._container=t}get messageTypes(){return[pT.REQUEST_DIMMER,mT.RWSDPM_SAVE_PRESET,dT.RWCDSM_CHANGE_STATE,gT.RWDPM_PREVIEW_DIMMER_PRESET]}get eventTypes(){return[Ge.RSDPE_PRESETS,ud.ROOM_COLOR,md.REMOVE_DIMMER]}}let fT=(()=>{class t{constructor(){this._container=null}dispose(){this._container=null}processWidgetMessage(t){return null}processEvent(e){if(!e)return;let s=null;switch(e.type){case md.REQUEST_INTERNAL_LINK:if(s=e,s&&this._container.roomEngine){const e=this._container.roomEngine.getRoomObject(s.roomId,s.objectId,s.category);if(e&&e.model){let s=e.model.getValue(st.FURNITURE_DATA)[t.INTERNALLINK];if(s&&""!==s&&0!==s.length||(s=e.model.getValue(st.FURNITURE_INTERNAL_LINK)),!s||0===s.length)return;um.instance.createLinkEvent(s)}}return}}update(){}get disposed(){return!!this._container}get type(){return kd.INTERNAL_LINK}get container(){return this._container}set container(t){this._container=t}get messageTypes(){return[]}get eventTypes(){return[md.REQUEST_INTERNAL_LINK]}}return t.INTERNALLINK="internalLink",t})(),ST=(()=>{class t{constructor(){this._container=null,this._messages=[],this._link=null,this._roomIdToEnter=0,this._confirmDialog=null}dispose(){this.container=null,this._link=null,this._roomIdToEnter=0,this.closeConfirmDialog()}processWidgetMessage(t){return null}processEvent(e){if(!e)return;let s=null;switch(e.type){case md.REQUEST_ROOM_LINK:if(s=e,s&&this._container.roomEngine){const e=this._container.roomEngine.getRoomObject(s.roomId,s.objectId,s.category);if(e&&e.model){let s=e.model.getValue(st.FURNITURE_DATA)[t.INTERNALLINK];if(s&&""!==s&&0!==s.length||(s=e.model.getValue(st.FURNITURE_INTERNAL_LINK)),!s||0===s.length)return;this.closeConfirmDialog(),this._link=s,this._roomIdToEnter=parseInt(s,10),this._container&&this._container.connection&&this._container.connection.send(new qc(this._roomIdToEnter,!1,!1))}}return}}onRoomInfoEvent(t){if(!t)return;const e=t.getParser();if(!e)return;const s=e.data;if(!s)return;if(s.roomId!==this._roomIdToEnter)return;this._roomIdToEnter=0;const i=s.roomName,r=s.ownerName;let n=um.instance.getLocalization("room.link.confirmation.message");n&&n.indexOf("%%room_name%%")>-1&&(n=n.replace("%%room_name%%",i)),n&&n.indexOf("%%owner_name%%")>-1&&(n=n.replace("%%owner_name%%",r)),this.closeConfirmDialog(),this._container&&this._container.notificationService&&(this._confirmDialog=this._container.notificationService.alertWithConfirm(n,null,()=>{um.instance.createLinkEvent("navigator/goto/"+this._link)}))}closeConfirmDialog(){this._confirmDialog&&(this._confirmDialog.close(),this._confirmDialog=null)}update(){}get disposed(){return!!this._container}get type(){return kd.ROOM_LINK}get container(){return this._container}set container(t){if(t!==this._container&&this._container){for(const t of this._messages)this._container.connection.removeMessageEvent(t);this._messages=[]}if(this._container=t,this._container){this._messages=[new fn(this.onRoomInfoEvent.bind(this))];for(const e of this._messages)t.connection.addMessageEvent(e)}}get messageTypes(){return[]}get eventTypes(){return[md.REQUEST_ROOM_LINK]}}return t.INTERNALLINK="internalLink",t})(),bT=(()=>{class t extends Fv{constructor(e,s,i,r,n){super(t.RWONE_TYPE),this._userId=e,this._category=s,this._userName=i,this._userType=r,this._roomIndex=n}get userId(){return this._userId}get category(){return this._category}get userName(){return this._userName}get userType(){return this._userType}get roomIndex(){return this._roomIndex}}return t.RWONE_TYPE="RWONE_TYPE",t})(),RT=(()=>{class t extends Fv{constructor(e,s){super(t.RWWCIDE_CHAT_INPUT_CONTENT),this._Str_21134="",this._userName="",this._Str_21134=e,this._userName=s}get _Str_23621(){return this._Str_21134}get userName(){return this._userName}}return t.RWWCIDE_CHAT_INPUT_CONTENT="RWWCIDE_CHAT_INPUT_CONTENT",t.WHISPER="whisper",t.SHOUT="shout",t})(),IT=(()=>{class t extends Fv{constructor(t){super(t),this._id=0,this._category=0,this._name="",this._description="",this._image=null,this._isWallItem=!1,this._isStickie=!1,this._isRoomOwner=!1,this._roomControllerLevel=0,this._isAnyRoomController=!1,this._expiration=-1,this._purchaseCatalogPageId=-1,this._purchaseOfferId=-1,this._extraParam="",this._isOwner=!1,this._stuffData=null,this._groupId=0,this._ownerId=0,this._ownerName="",this._usagePolicy=0,this._rentCatalogPageId=-1,this._rentOfferId=-1,this._purchaseCouldBeUsedForBuyout=!1,this._rentCouldBeUsedForBuyout=!1,this._availableForBuildersClub=!1}set id(t){this._id=t}get id(){return this._id}set category(t){this._category=t}get category(){return this._category}set name(t){this._name=t}get name(){return this._name}set description(t){this._description=t}get description(){return this._description}set image(t){this._image=t}get image(){return this._image}set isWallItem(t){this._isWallItem=t}get isWallItem(){return this._isWallItem}set isStickie(t){this._isStickie=t}get isStickie(){return this._isStickie}set isRoomOwner(t){this._isRoomOwner=t}get isRoomOwner(){return this._isRoomOwner}set roomControllerLevel(t){this._roomControllerLevel=t}get roomControllerLevel(){return this._roomControllerLevel}set isAnyRoomOwner(t){this._isAnyRoomController=t}get isAnyRoomOwner(){return this._isAnyRoomController}set expiration(t){this._expiration=t}get expiration(){return this._expiration}set purchaseOfferId(t){this._purchaseOfferId=t}get purchaseOfferId(){return this._purchaseOfferId}set extraParam(t){this._extraParam=t}get extraParam(){return this._extraParam}set isOwner(t){this._isOwner=t}get isOwner(){return this._isOwner}set stuffData(t){this._stuffData=t}get stuffData(){return this._stuffData}set groupId(t){this._groupId=t}get groupId(){return this._groupId}set ownerId(t){this._ownerId=t}get ownerId(){return this._ownerId}set ownerName(t){this._ownerName=t}get ownerName(){return this._ownerName}set usagePolicy(t){this._usagePolicy=t}get usagePolicy(){return this._usagePolicy}set rentOfferId(t){this._rentOfferId=t}get rentOfferId(){return this._rentOfferId}get purchaseCouldBeUsedForBuyout(){return this._purchaseCouldBeUsedForBuyout}set purchaseCouldBeUsedForBuyout(t){this._purchaseCouldBeUsedForBuyout=t}get rentCouldBeUsedForBuyout(){return this._rentCouldBeUsedForBuyout}set rentCouldBeUsedForBuyout(t){this._rentCouldBeUsedForBuyout=t}get availableForBuildersClub(){return this._availableForBuildersClub}set availableForBuildersClub(t){this._availableForBuildersClub=t}}return t.FURNI="RWFIUE_FURNI",t})(),vT=(()=>{class t extends Fv{constructor(){super(t.RENTABLE_BOT),this._name="",this._motto="",this._Str_4900=0,this._figure="",this._caryId=0,this._Str_5131=0,this._Str_4026=!1,this._Str_4028=!1,this._roomControllerLevel=0,this._badges=[]}set name(t){this._name=t}get name(){return this._name}set motto(t){this._motto=t}get motto(){return this._motto}set id(t){this._Str_4900=t}get id(){return this._Str_4900}set figure(t){this._figure=t}get figure(){return this._figure}set badges(t){this._badges=t}get badges(){return this._badges}get ownerId(){return this._ownerId}set ownerId(t){this._ownerId=t}get ownerName(){return this._ownerName}set ownerName(t){this._ownerName=t}set _Str_3246(t){this._Str_4026=t}get _Str_3246(){return this._Str_4026}set roomControllerLevel(t){this._roomControllerLevel=t}get roomControllerLevel(){return this._roomControllerLevel}set _Str_3529(t){this._Str_4028=t}get _Str_3529(){return this._Str_4028}set carryId(t){this._caryId=t}get carryId(){return this._caryId}set roomIndex(t){this._Str_5131=t}get roomIndex(){return this._Str_5131}get botSkills(){return this._Str_3986}set botSkills(t){this._Str_3986=t}}return t.RENTABLE_BOT="RWRBIUE_RENTABLE_BOT",t._Str_7492="RENTABLE_BOT",t})(),TT=(()=>{class t extends Fv{constructor(t){super(t),this._name="",this._motto="",this._Str_4900=0,this._xp=0,this._figure="",this._groupId=0,this._groupName="",this._Str_11289="",this._Str_5228=0,this._Str_5131=0,this._Str_8522=!1,this._realName="",this._Str_3947=!1,this._Str_4026=!1,this._Str_4028=!1,this._roomControllerLevel=0,this._canBeAskedForAFriend=!1,this._Str_9070=!1,this._Str_8457=!1,this._Str_8831=!1,this._Str_3437=0,this._Str_6028=!1,this._Str_6139=!1,this._Str_8973=!1,this._Str_8910=0,this._Str_8858=0,this._isFriend=!1,this._Str_4890=!1,this._badges=[]}set name(t){this._name=t}get name(){return this._name}set motto(t){this._motto=t}get motto(){return this._motto}set activityPoints(t){this._activityPoints=t}get activityPoints(){return this._activityPoints}set webID(t){this._Str_4900=t}get webID(){return this._Str_4900}set xp(t){this._xp=t}get xp(){return this._xp}set userType(t){this._Str_3021=t}get userType(){return this._Str_3021}set figure(t){this._figure=t}get figure(){return this._figure}set badges(t){this._badges=t}get badges(){return this._badges}set groupId(t){this._groupId=t}get groupId(){return this._groupId}set groupName(t){this._groupName=t}get groupName(){return this._groupName}set groupBadgeId(t){this._Str_11289=t}get groupBadgeId(){return this._Str_11289}set canBeAskedForAFriend(t){this._canBeAskedForAFriend=t}get canBeAskedForAFriend(){return this._canBeAskedForAFriend}set respectLeft(t){this._Str_3437=t}get respectLeft(){return this._Str_3437}set isIgnored(t){this._Str_6028=t}get isIgnored(){return this._Str_6028}set isRoomOwner(t){this._Str_4026=t}get isRoomOwner(){return this._Str_4026}set isGuildRoom(t){this._Str_6139=t}get isGuildRoom(){return this._Str_6139}set roomControllerLevel(t){this._roomControllerLevel=t}get roomControllerLevel(){return this._roomControllerLevel}set isModerator(t){this._Str_4028=t}get isModerator(){return this._Str_4028}set canTrade(t){this._Str_8973=t}get canTrade(){return this._Str_8973}set _Str_6622(t){this._Str_8910=t}get _Str_6622(){return this._Str_8910}set _Str_5990(t){this._Str_9070=t}get _Str_5990(){return this._Str_9070}set _Str_6701(t){this._Str_8457=t}get _Str_6701(){return this._Str_8457}get _Str_6394(){return this._Str_8831}set _Str_6394(t){this._Str_8831=t}set flatControl(t){this._Str_8858=t}get flatControl(){return this._Str_8858}set carryId(t){this._Str_5228=t}get carryId(){return this._Str_5228}set roomIndex(t){this._Str_5131=t}get roomIndex(){return this._Str_5131}set isSpectator(t){this._Str_8522=t}get isSpectator(){return this._Str_8522}set realName(t){this._realName=t}get realName(){return this._realName}set _Str_4330(t){this._Str_3947=t}get _Str_4330(){return this._Str_3947}get isFriend(){return this._isFriend}set isFriend(t){this._isFriend=t}get isAmbassador(){return this._Str_4890}set isAmbassador(t){this._Str_4890=t}}return t.OWN_USER="RWUIUE_OWN_USER",t.BOT="RWUIUE_BOT",t.PEER="RWUIUE_PEER",t._Str_18400=0,t._Str_14161=2,t._Str_13798=3,t._Str_7492="BOT",t})(),OT=(()=>{class t extends Bv{constructor(e){super(t.RWVM_CHANGE_MOTTO_MESSAGE),this._motto=e}get motto(){return this._motto}}return t.RWVM_CHANGE_MOTTO_MESSAGE="RWVM_CHANGE_MOTTO_MESSAGE",t})(),AT=(()=>{class t extends Bv{constructor(t,e,s,i=-1,r=null){super(t),this._furniId=e,this._furniCategory=s,this._offerId=i,this._objectData=r}get furniId(){return this._furniId}get furniCategory(){return this._furniCategory}get objectData(){return this._objectData}get _Str_2451(){return this._offerId}}return t.RWFUAM_ROTATE="RWFUAM_ROTATE",t.RWFAM_MOVE="RWFAM_MOVE",t.RWFAM_PICKUP="RWFAM_PICKUP",t.RWFAM_EJECT="RWFAM_EJECT",t.RWFAM_USE="RWFAM_USE",t.RWFAM_OPEN_WELCOME_GIFT="RWFAM_OPEN_WELCOME_GIFT",t.RWFAM_SAVE_STUFF_DATA="RWFAM_SAVE_STUFF_DATA",t})(),yT=(()=>{class t{constructor(){this._container=null,this._widget=null,this._disposed=!1}dispose(){this.disposed||(this.container=null,this._disposed=!0)}update(){}processWidgetMessage(t){if(!t||!this._container)return null;let e=0,s=null;if(t instanceof Xv&&(e=t.userId,s=[Xv.RWUAM_REQUEST_PET_UPDATE,Xv.RWUAM_RESPECT_PET,Xv.RWUAM_PICKUP_PET,Xv.RWUAM_MOUNT_PET,Xv.RWUAM_TOGGLE_PET_RIDING_PERMISSION,Xv.RWUAM_TOGGLE_PET_BREEDING_PERMISSION,Xv.RWUAM_DISMOUNT_PET,Xv.RWUAM_SADDLE_OFF,Xv.RWUAM_GIVE_CARRY_ITEM_TO_PET,Xv.RWUAM_GIVE_WATER_TO_PET,Xv.RWUAM_GIVE_LIGHT_TO_PET,Xv.RWUAM_TREAT_PET].indexOf(t.type)>=0?this._container.roomSession.userDataManager.getPetData(e):this._container.roomSession.userDataManager.getUserData(e),!s))return null;let i=0,r=0;switch(t instanceof AT&&(i=t.furniId,r=t.furniCategory),t.type){case zv.GET_OBJECT_INFO:return this.processObjectInfoMessage(t);case zv.GET_OBJECT_NAME:return this.processObjectNameMessage(t);case Xv.RWUAM_SEND_FRIEND_REQUEST:this._container.friendService.sendFriendRequest(e,s.name);break;case Xv.RWUAM_RESPECT_USER:this._container.sessionDataManager.giveRespect(e);break;case Xv.RWUAM_RESPECT_PET:this._container.sessionDataManager.givePetRespect(e);break;case Xv.RWUAM_WHISPER_USER:this._container.events.dispatchEvent(new RT(RT.WHISPER,s.name));break;case Xv.RWUAM_IGNORE_USER:case Xv.RWUAM_UNIGNORE_USER:break;case Xv.RWUAM_KICK_USER:this._container.roomSession.sendKickMessage(t.userId);break;case Xv.RWUAM_BAN_USER_DAY:case Xv.RWUAM_BAN_USER_HOUR:case Xv.RWUAM_BAN_USER_PERM:this._container.roomSession.sendBanMessage(t.userId,t.type);break;case Xv.MUTE_USER_2MIN:this._container.roomSession.sendMuteMessage(t.userId,2);break;case Xv.MUTE_USER_5MIN:this._container.roomSession.sendMuteMessage(t.userId,5);break;case Xv.MUTE_USER_10MIN:this._container.roomSession.sendMuteMessage(t.userId,10);break;case Xv.RWUAM_GIVE_RIGHTS:this._container.roomSession.sendGiveRightsMessage(t.userId);break;case Xv.RWUAM_TAKE_RIGHTS:this._container.roomSession.sendTakeRightsMessage(t.userId);break;case Xv.RWUAM_START_TRADING:s&&this._widget.inventoryTrading.startTrade(s.roomIndex,s.name);break;case Xv.RWUAM_PASS_CARRY_ITEM:this._container.connection.send(new C_(e));break;case Xv.RWUAM_GIVE_CARRY_ITEM_TO_PET:case Xv.RWUAM_GIVE_WATER_TO_PET:case Xv.RWUAM_GIVE_LIGHT_TO_PET:case Xv.RWUAM_TREAT_PET:break;case Xv.RWUAM_DROP_CARRY_ITEM:this._container.connection.send(new y_);break;case AT.RWFUAM_ROTATE:this._container.roomEngine.processRoomObjectOperation(i,r,Dd.OBJECT_ROTATE_POSITIVE);break;case AT.RWFAM_MOVE:this._container.roomEngine.processRoomObjectOperation(i,r,Dd.OBJECT_MOVE);break;case AT.RWFAM_PICKUP:this._container.roomEngine.processRoomObjectOperation(i,r,Dd.OBJECT_PICKUP);break;case AT.RWFAM_EJECT:this._container.roomEngine.processRoomObjectOperation(i,r,Dd.OBJECT_EJECT);break;case AT.RWFAM_USE:this._container.roomEngine.useRoomObject(i,r);break;case OT.RWVM_CHANGE_MOTTO_MESSAGE:return void this._container.roomSession.sendMottoMessage(t.motto);case AT.RWFAM_SAVE_STUFF_DATA:{const e=t.objectData;if(e){const t=new Map,s=e.split("\t");if(s)for(const e of s){const s=e.split("=",2);s&&2===s.length&&t.set(s[0],s[1])}this._container.roomEngine.processRoomObjectWallOperation(i,r,Dd.OBJECT_SAVE_STUFF_DATA,t),this._Str_23922(t),t.clear()}break}case Xv.RWUAM_REQUEST_PET_UPDATE:case Xv.RWUAM_REPORT:case Xv.RWUAM_REPORT_CFH_OTHER:break;case Xv.RWUAM_AMBASSADOR_ALERT_USER:this._container.roomSession.sendAmbassadorAlertMessage(t.userId);break;case Xv.RWUAM_AMBASSADOR_KICK_USER:this._container.roomSession.sendKickMessage(t.userId);break;case Xv.AMBASSADOR_MUTE_USER_2MIN:this._container.roomSession.sendMuteMessage(t.userId,2);break;case Xv.AMBASSADOR_MUTE_USER_10MIN:this._container.roomSession.sendMuteMessage(t.userId,10);break;case Xv.AMBASSADOR_MUTE_USER_60MIN:this._container.roomSession.sendMuteMessage(t.userId,60);break;case Xv.AMBASSADOR_MUTE_USER_18HOUR:this._container.roomSession.sendMuteMessage(t.userId,1080)}return null}processEvent(t){if(event)switch(t.type){case qg.RSUBE_BADGES:return void this.widget.updateUserBadges(t.userId,t.badges)}}processObjectInfoMessage(t){const e=this._container.roomSession.roomId;switch(t.category){case tt.FLOOR:case tt.WALL:this._Str_23142(t,e);break;case tt.UNIT:{if(!(this._container.roomSession&&this._container.sessionDataManager&&this._container.events&&this._container.roomEngine))return null;const s=this._container.roomSession.userDataManager.getUserDataByIndex(t.id);if(!s)return null;switch(s.type){case Za.PET:break;case Za.USER:this._Str_22722(e,t.id,t.category,s);break;case Za.BOT:this._Str_22312(e,t.id,t.category,s);break;case Za.RENTABLE_BOT:this._Str_23115(e,t.id,t.category,s)}break}}return null}processObjectNameMessage(t){const e=this._container.roomSession.roomId;let s=0,i=null,r=0,n=0;switch(t.category){case tt.FLOOR:case tt.WALL:{if(!this._container.events||!this._container.roomEngine)return null;const r=this._container.roomEngine.getRoomObject(e,t.id,t.category),a=r.type;if(0===a.indexOf("poster"))s=-1,i="${poster_"+parseInt(a.replace("poster",""))+"_name}",n=r.id;else{let e=null;const a=r.model.getValue(st.FURNITURE_TYPE_ID);if(t.category===tt.FLOOR?e=this._container.sessionDataManager.getFloorItemData(a):t.category===tt.WALL&&(e=this._container.sessionDataManager.getWallItemData(a)),!e)return null;s=e.id,i=e.name,n=r.id}break}case tt.UNIT:{if(!this._container.roomSession||!this._container.roomSession.userDataManager)return null;const e=this._container.roomSession.userDataManager.getUserDataByIndex(t.id);if(!e)return null;s=e.webID,i=e.name,r=e.type,n=e.roomIndex;break}}return i&&this._container.events.dispatchEvent(new bT(s,t.category,i,r,n)),null}_Str_23142(t,e){if(!this._container||!this._container.events||!this._container.roomEngine)return;if(t.id<0)return;const s=new IT(IT.FURNI);s.id=t.id,s.category=t.category;const i=this._container.roomEngine.getRoomObject(e,t.id,t.category);if(!i)return;const r=i.model;r.getValue(cg.INFOSTAND_EXTRA_PARAM)&&(s.extraParam=r.getValue(cg.INFOSTAND_EXTRA_PARAM));const n=r.getValue(st.FURNITURE_DATA_FORMAT),a=yi.getData(n);a.initializeFromRoomObjectModel(r),s.stuffData=a;const o=i.type;if(0===o.indexOf("poster")){const t=parseInt(o.replace("poster",""));s.name="${poster_"+t+"_name}",s.description="${poster_"+t+"_desc}"}else{const e=r.getValue(st.FURNITURE_TYPE_ID);let n=null;t.category===tt.FLOOR?n=this._container.sessionDataManager.getFloorItemData(e):t.category==tt.WALL&&(n=this._container.sessionDataManager.getWallItemData(e)),n&&(s.name=n.name,s.description=n.description,s.purchaseOfferId=n.offerId,this._container.wiredService&&t.category===tt.FLOOR&&this._container.wiredService.selectFurniture(i.id,n.name))}o.indexOf("post_it")>-1&&(s.isStickie=!0);const c=r.getValue(st.FURNITURE_EXPIRY_TIME),_=r.getValue(st.FURNITURE_EXPIRTY_TIMESTAMP);s.expiration=c<0?c:Math.max(0,c-(um.instance.time-_)/1e3);let h=this._container.roomEngine.getRoomObjectImage(e,t.id,t.category,new ot(180),64,null);if((!h.data||h.data.width>140||h.data.height>200)&&(h=this._container.roomEngine.getRoomObjectImage(e,t.id,t.category,new ot(180),1,null)),h&&h.data){const t=um.instance.renderer.extract.image(h.data);t&&(s.image=t)}s.isWallItem=t.category===tt.WALL,s.isRoomOwner=this._container.roomSession.isRoomOwner,s.roomControllerLevel=this._container.roomSession.controllerLevel,s.isAnyRoomOwner=this._container.sessionDataManager.isModerator,s.ownerId=r.getValue(st.FURNITURE_OWNER_ID),s.ownerName=r.getValue(st.FURNITURE_OWNER_NAME),s.usagePolicy=r.getValue(st.FURNITURE_USAGE_POLICY);const l=r.getValue(st.FURNITURE_GUILD_CUSTOMIZED_GUILD_ID);0!==l&&(s.groupId=l),this._container.isOwnerOfFurniture(i)&&(s.isOwner=!0),this._container.events.dispatchEvent(s)}_Str_22722(e,s,i,r){let n=TT.OWN_USER;r.webID!==this._container.sessionDataManager.userId&&(n=TT.PEER);const a=new TT(n);a.isSpectator=this._container.roomSession.isSpectator,a.name=r.name,a.motto=r.custom,t.ACTIVITY_POINTS_DISPLAY_ENABLED&&(a.activityPoints=r.activityPoints),a.webID=r.webID,a.roomIndex=s,a.userType=Za.USER;const o=this._container.roomEngine.getRoomObject(e,s,i);if(o&&(a.carryId=o.model.getValue(st.FIGURE_CARRY_OBJECT)),n==TT.OWN_USER&&(a.realName=this._container.sessionDataManager.realName,a._Str_4330=this._container.sessionDataManager.canChangeName),a.isRoomOwner=this._container.roomSession.isRoomOwner,a.isGuildRoom=this._container.roomSession.isGuildRoom,a.roomControllerLevel=this._container.roomSession.controllerLevel,a.isModerator=this._container.sessionDataManager.isModerator,a.isAmbassador=this._container.sessionDataManager.isAmbassador,n===TT.PEER){a.canBeAskedForAFriend=this._container.friendService.canBeAskedForAFriend(r.webID);const t=this._container.friendService.getFriend(r.webID);if(t&&(a.realName=t.realName,a.isFriend=!0),o){const t=o.model.getValue(st.FIGURE_FLAT_CONTROL);null!==t&&(a.flatControl=t),a._Str_6394=this._Str_23100(a),a._Str_5990=this._Str_22729(a),a._Str_6701=this._Str_23573(a)}a.isIgnored=this._container.sessionDataManager.isUserIgnored(r.name),a.respectLeft=this._container.sessionDataManager.respectsLeft;const e=this._container.sessionDataManager.isSystemShutdown,s=this._container.roomSession.tradeMode;if(e)switch(s){case tm._Str_14475:{const t=a.flatControl!==en.NONE&&a.flatControl!==en.GUILD_MEMBER;a.canTrade=a.roomControllerLevel!==en.NONE&&a.roomControllerLevel!==en.GUILD_MEMBER||t;break}case tm._Str_9173:a.canTrade=!0;break;default:a.canTrade=!1}else a.canTrade=!1;a._Str_6622=TT._Str_18400,e&&(a._Str_6622=TT._Str_14161),s!==tm._Str_9173&&(a._Str_6622=TT._Str_13798)}a.groupId=parseInt(r.guildId),a.groupName=r.groupName,a.badges=this._container.roomSession.userDataManager.getUserBadges(r.webID),a.figure=r.figure,this._container.events.dispatchEvent(a)}_Str_22312(t,e,s,i){const r=new TT(TT.BOT);r.name=i.name,r.motto=i.custom,r.webID=i.webID,r.roomIndex=e,r.userType=i.type;const n=this._container.roomEngine.getRoomObject(t,e,s);n&&(r.carryId=n.model.getValue(st.FIGURE_CARRY_OBJECT)),r.isRoomOwner=this._container.roomSession.isRoomOwner,r.isGuildRoom=this._container.roomSession.isGuildRoom,r.roomControllerLevel=this._container.roomSession.controllerLevel,r.isModerator=this._container.sessionDataManager.isModerator,r._Str_5990=this._container.roomSession.isRoomOwner,r.badges=[TT._Str_7492],r.figure=i.figure,this._container.events.dispatchEvent(r)}_Str_23115(t,e,s,i){const r=new vT;r.name=i.name,r.motto=i.custom,r.id=i.webID,r.roomIndex=e,r.ownerId=i.ownerId,r.ownerName=i.ownerName,r.botSkills=i.botSkills;const n=this._container.roomEngine.getRoomObject(t,e,s);n&&(r.carryId=n.model.getValue(st.FIGURE_CARRY_OBJECT)),r._Str_3246=this._container.roomSession.isRoomOwner,r.roomControllerLevel=this._container.roomSession.controllerLevel,r._Str_3529=this._container.sessionDataManager.isModerator,r.badges=[TT._Str_7492],r.figure=i.figure,this._container.events.dispatchEvent(r)}_Str_9213(t){return t.isGuildRoom?t.roomControllerLevel>=en.GUILD_ADMIN:t.roomControllerLevel>=en.GUEST}_Str_23100(t){const e=(function(t,e){switch(e.allowMute){case pn._Str_5047:return this._Str_9213(t);default:return t.roomControllerLevel>=en.ROOM_OWNER}}).bind(this);return this._Str_18027(t,e)}_Str_22729(t){const e=(function(t,e){switch(e.allowKick){case pn._Str_11537:return!0;case pn._Str_5047:return this._Str_9213(t);default:return t.roomControllerLevel>=en.ROOM_OWNER}}).bind(this);return this._Str_18027(t,e)}_Str_23573(t){const e=(function(t,e){switch(e.allowBan){case pn._Str_5047:return this._Str_9213(t);default:return t.roomControllerLevel>=en.ROOM_OWNER}}).bind(this);return this._Str_18027(t,e)}_Str_18027(t,e){if(!this._container.roomSession._Str_7411)return!1;const s=this._container.roomSession.moderationSettings;let i=!1;return s&&(i=e(t,s)),i&&t.flatControl<en.ROOM_OWNER}_Str_23922(t){this._widget&&this._container.sessionDataManager.hasSecurity(5)&&this._container.connection.send(new s_(this._widget.furniData.id,t))}get type(){return kd.INFOSTAND}get messageTypes(){return[zv.GET_OBJECT_INFO,zv.GET_OBJECT_NAME,Xv.RWUAM_SEND_FRIEND_REQUEST,Xv.RWUAM_RESPECT_USER,Xv.RWUAM_WHISPER_USER,Xv.RWUAM_IGNORE_USER,Xv.RWUAM_UNIGNORE_USER,Xv.RWUAM_KICK_USER,Xv.RWUAM_BAN_USER_DAY,Xv.RWUAM_BAN_USER_HOUR,Xv.RWUAM_BAN_USER_PERM,Xv.MUTE_USER_2MIN,Xv.MUTE_USER_5MIN,Xv.MUTE_USER_10MIN,Xv.RWUAM_GIVE_RIGHTS,Xv.RWUAM_TAKE_RIGHTS,Xv.RWUAM_START_TRADING,Xv.RWUAM_OPEN_HOME_PAGE,Xv.RWUAM_PASS_CARRY_ITEM,Xv.RWUAM_GIVE_CARRY_ITEM_TO_PET,Xv.RWUAM_DROP_CARRY_ITEM,AT.RWFAM_MOVE,AT.RWFUAM_ROTATE,AT.RWFAM_EJECT,AT.RWFAM_PICKUP,AT.RWFAM_USE,AT.RWFAM_SAVE_STUFF_DATA,Xv.RWUAM_REPORT,Xv.RWUAM_PICKUP_PET,Xv.RWUAM_MOUNT_PET,Xv.RWUAM_TOGGLE_PET_RIDING_PERMISSION,Xv.RWUAM_TOGGLE_PET_BREEDING_PERMISSION,Xv.RWUAM_DISMOUNT_PET,Xv.RWUAM_SADDLE_OFF,Xv.RWUAM_TRAIN_PET,Xv.RWUAM_RESPECT_PET,Xv.RWUAM_REQUEST_PET_UPDATE,OT.RWVM_CHANGE_MOTTO_MESSAGE,Xv.RWUAM_GIVE_LIGHT_TO_PET,Xv.RWUAM_GIVE_WATER_TO_PET,Xv.RWUAM_TREAT_PET,Xv.RWUAM_REPORT_CFH_OTHER,Xv.RWUAM_AMBASSADOR_ALERT_USER,Xv.RWUAM_AMBASSADOR_KICK_USER,Xv.AMBASSADOR_MUTE_USER_2MIN,Xv.AMBASSADOR_MUTE_USER_10MIN,Xv.AMBASSADOR_MUTE_USER_60MIN,Xv.AMBASSADOR_MUTE_USER_18HOUR]}get eventTypes(){return[qg.RSUBE_BADGES]}get container(){return this._container}set container(t){this._container=t}get widget(){return this._widget}set widget(t){this._widget=t}get disposed(){return this._disposed}}return t.ACTIVITY_POINTS_DISPLAY_ENABLED=!0,t})(),CT=(()=>{class t extends Fv{constructor(e,s,i){super(t.RWULUE_USER_LOCATION_UPDATE),this._userId=e,this._rectangle=s,this._Str_20775=i}get userId(){return this._userId}get rectangle(){return this._rectangle}get _Str_9337(){return this._Str_20775}}return t.RWULUE_USER_LOCATION_UPDATE="RWULUE_USER_LOCATION_UPDATE",t})(),MT=(()=>{class t extends Bv{constructor(t,e,s){super(t),this._objectId=e,this._objectType=s}get _Str_1577(){return this._objectId}get _Str_1723(){return this._objectType}}return t.RWGOI_MESSAGE_GET_OBJECT_LOCATION="RWGOI_MESSAGE_GET_OBJECT_LOCATION",t.RWGOI_MESSAGE_GET_GAME_OBJECT_LOCATION="RWGOI_MESSAGE_GET_GAME_OBJECT_LOCATION",t})();class DT{constructor(){this._disposed=!1,this._container=null}dispose(){this._disposed=!0,this._container=null}get disposed(){return this._disposed}get type(){return null}set container(t){this._container=t}get messageTypes(){return[MT.RWGOI_MESSAGE_GET_OBJECT_LOCATION,MT.RWGOI_MESSAGE_GET_GAME_OBJECT_LOCATION]}processWidgetMessage(t){if(!(t&&this._container&&t instanceof MT))return null;const e=this._container.roomSession;switch(t.type){case MT.RWGOI_MESSAGE_GET_OBJECT_LOCATION:{if(!e||!e.userDataManager)return null;const s=e.userDataManager.getDataByType(t._Str_1577,t._Str_1723);let i=null,r=null;if(s){i=this._container.roomEngine.getRoomObjectBoundingRectangle(e.roomId,s.roomIndex,tt.UNIT,this._container.getFirstCanvasId()),r=this._container.roomEngine.getRoomObjectScreenLocation(e.roomId,s.roomIndex,tt.UNIT,this._container.getFirstCanvasId());const t=this._container.getRoomViewRect();i&&r&&t&&(i.x+=t.x,i.y+=t.y,r.x+=t.x,r.y+=t.y)}return new CT(t._Str_1577,i,r)}}return null}get eventTypes(){return[]}processEvent(t){}update(){}}class NT{constructor(){this._isDisposed=!1,this._container=null}dispose(){this._isDisposed=!0,this._container=null}processWidgetMessage(t){if(!t)return null;switch(t.type){case tT.RWRWM_USER_CHOOSER:this.processUserChooser();break;case zv.SELECT_OBJECT:this.selectUnit(t)}return null}selectUnit(t){null!=t&&t.category==tt.UNIT&&this._container.roomEngine.selectRoomObject(this._container.roomSession.roomId,t.id,t.category)}processUserChooser(){if(null==this._container||null==this._container.roomSession||null==this._container.roomEngine||null==this._container.roomSession.userDataManager)return;const t=this._container.roomSession.roomId,e=tt.UNIT,s=[],i=this._container.roomEngine.getRoomObjectCount(t,e);for(let r=0;r<i;r++){const i=this._container.roomEngine.getRoomObjectByIndex(t,r,e);if(null==i)continue;const n=this._container.roomSession.userDataManager.getUserDataByIndex(i.id);null!=n&&s.push(new aT(n.roomIndex,e,n.name))}s.sort(nT("name")),this._container.events.dispatchEvent(new oT(oT.RWCCE_USER_CHOOSER_CONTENT,s))}processEvent(t){}update(){}get disposed(){return this._isDisposed}get type(){return kd.USER_CHOOSER}set container(t){this._container=t}get messageTypes(){return[tT.RWRWM_USER_CHOOSER,zv.SELECT_OBJECT]}get eventTypes(){return[]}}let wT=(()=>{class t extends Bv{constructor(e,s){super(t.RWLUIM_LET_USER_IN),this._userName=e,this._canEnter=s}get userName(){return this._userName}get _Str_23117(){return this._canEnter}}return t.RWLUIM_LET_USER_IN="RWLUIM_LET_USER_IN",t})(),UT=(()=>{class t extends Fv{constructor(t,e){super(t),this._userName="",this._userName=e}get userName(){return this._userName}}return t.RWDE_RINGING="RWDE_RINGING",t.REJECTED="RWDE_REJECTED",t.RWDE_ACCEPTED="RWDE_ACCEPTED",t})();class LT{constructor(){this._isDisposed=!1,this._container=null}dispose(){this._isDisposed=!0,this._container=null}processWidgetMessage(t){return t&&this._container&&t&&t.type==wT.RWLUIM_LET_USER_IN?(this._container.roomSession.sendDoorbellApprovalMessage(t.userName,t._Str_23117),null):null}processEvent(t){if(!t)return;const e=t;if(e)switch(t.type){case zg.RSDE_REJECTED:return void this._container.events.dispatchEvent(new UT(UT.REJECTED,e.userName));case zg.DOORBELL:return void this._container.events.dispatchEvent(new UT(UT.RWDE_RINGING,e.userName));case zg.RSDE_ACCEPTED:return void this._container.events.dispatchEvent(new UT(UT.RWDE_ACCEPTED,e.userName))}}update(){}get disposed(){return this._isDisposed}get type(){return kd.DOORBELL}set container(t){this._container=t}get messageTypes(){return[wT.RWLUIM_LET_USER_IN]}get eventTypes(){return[zg.DOORBELL,zg.RSDE_REJECTED,zg.RSDE_ACCEPTED]}}let PT=(()=>{class t extends Fv{constructor(t,e,s,i,r,n){super(t),this._name=e,this._date=s,this._message=i,this._color=r,this._viewType=n}get name(){return this._name}get date(){return this._date}get message(){return this._message}get color(){return this._color}get viewType(){return this._viewType}}return t.TROPHY_DATA="RWTDUE_TROPHY_DATA",t})();class xT{constructor(){this._container=null}dispose(){this._container=null}processWidgetMessage(t){if(!t||!this.container)return null;switch(t.type){case pT.REQUEST_TROPHY:{const e=this._container.roomEngine.getRoomObject(t.roomId,t.objectId,t.category);if(e){let t=e.model.getValue(st.FURNITURE_DATA),s=e.model.getValue(st.FURNITURE_EXTRAS);s||(s="0");const i=e.model.getValue(st.FURNITURE_COLOR),r=t.substring(0,t.indexOf("\t"));t=t.substring(r.length+1,t.length);const n=t.substring(0,t.indexOf("\t")),a=t.substr(n.length+1,t.length);this._container.events.dispatchEvent(new PT(PT.TROPHY_DATA,r,n,a,parseInt(i),parseInt(s)))}break}}return null}processEvent(t){}update(){}get disposed(){return!!this._container}get type(){return kd.FURNI_TROPHY_WIDGET}get container(){return this._container}set container(t){this._container=t}get messageTypes(){return[pT.REQUEST_TROPHY]}get eventTypes(){return[]}}const FT=["roomCanvas"],GT=["widgetContainer"];function VT(t,e){}let YT=(()=>{class t{constructor(t,e,s,i,r){this._notificationService=t,this._wiredService=e,this._friendService=s,this._componentFactoryResolver=i,this._ngZone=r,this._events=new N,this._handlers=[],this._widgets=new Map,this._widgetHandlerMessageMap=new Map,this._widgetHandlerEventMap=new Map,this._roomColorAdjustor=null,this._roomBackground=null,this._roomBackgroundColor=0,this._roomColorizerColor=0,this._resizeTimer=null,this._didMouseMove=!1,this._lastClick=0,this._clickCount=0,this._lastMouseMove=0,this._isMouseMove=!1}ngOnDestroy(){this.endRoom(),this._events.dispose()}prepareRoom(t){if(!t)return;const e=this.getFirstCanvasId(),s=um.instance.roomEngine.getRoomInstanceDisplay(t.roomId,e,um.instance.width,um.instance.height,lh.SCALE_ZOOMED_IN);if(!s)return;const i=um.instance.roomEngine.getRoomInstanceGeometry(t.roomId,e);if(i){let e=((um.instance.roomEngine.getRoomInstanceVariable(t.roomId,od.ROOM_MIN_X)||0)+(um.instance.roomEngine.getRoomInstanceVariable(t.roomId,od.ROOM_MAX_X)||0))/2,s=((um.instance.roomEngine.getRoomInstanceVariable(t.roomId,od.ROOM_MIN_Y)||0)+(um.instance.roomEngine.getRoomInstanceVariable(t.roomId,od.ROOM_MAX_Y)||0))/2;const r=20;e+=r-1,s+=r-1;const n=Math.sqrt(r*r+r*r)*Math.tan(30/180*Math.PI);i.location=new ot(e,s,n)}const r=um.instance.stage;r&&(r.addChild(s),this._roomSession=t,this.insertCanvas(),um.instance.ticker.add(this.update,this))}endRoom(){um.instance.ticker.remove(this.update,this),this._resizeTimer&&(clearTimeout(this._resizeTimer),this._resizeTimer=null);for(const t of this._widgets.values())t&&(t.instance&&t.instance.dispose(),this._ngZone.run(()=>t.destroy()));for(const t of this._handlers)t&&t.dispose();this._roomColorAdjustor=null,this._roomBackground=null,this._roomBackgroundColor=0,this._roomColorizerColor=0,t.COLOR_ADJUSTMENT.red=1,t.COLOR_ADJUSTMENT.green=1,t.COLOR_ADJUSTMENT.blue=1,this._handlers=[],this._widgets.clear(),this._widgetHandlerMessageMap.clear(),this._widgetHandlerEventMap.clear(),this._events.removeAllListeners(),this.removeCanvas(),Q_.call("logDebug","Navigator: exiting room")}insertCanvas(){const t=um.instance.renderer.view;t&&(t.onclick=this.onMouseEvent.bind(this),t.onmousemove=this.onMouseEvent.bind(this),t.onmousedown=this.onMouseEvent.bind(this),t.onmouseup=this.onMouseEvent.bind(this),window.onresize=this.onWindowResizeEvent.bind(this),this.roomCanvasReference.nativeElement.appendChild(t))}removeCanvas(){const t=um.instance.renderer.view;t&&(t.onclick=null,t.onmousemove=null,t.onmousedown=null,t.onmouseup=null,window.onresize=null,window.onmousewheel=null,t.parentElement&&t.parentElement.removeChild(t))}onMouseEvent(t){if(!t||!this._roomSession)return;const e=t.clientX,s=t.clientY;let i=t.type;switch(i===oh.MOUSE_CLICK&&(this._lastClick&&(this._clickCount=1,this._lastClick>=Date.now()-300&&this._clickCount++),this._lastClick=Date.now(),2===this._clickCount&&(this._didMouseMove||(i=oh.DOUBLE_CLICK),this._clickCount=0,this._lastClick=null)),i){case oh.MOUSE_CLICK:case oh.DOUBLE_CLICK:break;case oh.MOUSE_MOVE:this._didMouseMove=!0;break;case oh.MOUSE_DOWN:this._didMouseMove=!1;break;case oh.MOUSE_UP:break;default:return}um.instance.roomEngine.setActiveRoomId(this._roomSession.roomId),um.instance.roomEngine.dispatchMouseEvent(this.getFirstCanvasId(),e,s,i,t.altKey,t.ctrlKey||t.metaKey,t.shiftKey,!1)}onWindowResizeEvent(t){t&&this._roomSession&&(this._resizeTimer&&clearTimeout(this._resizeTimer),this._resizeTimer=setTimeout(()=>{um.instance.roomEngine.initializeRoomInstanceRenderingCanvas(this._roomSession.roomId,this.getFirstCanvasId(),um.instance.width,um.instance.height),this._events.dispatchEvent(new Yv(Yv.SIZE_CHANGED,this.getRoomViewRect())),this.setRoomBackground()},1))}onWindowMouseWheelEvent(t){t&&this._roomSession&&t.target===um.instance.renderer.view&&um.instance.roomEngine.events.dispatchEvent(new Pv(this._roomSession.roomId,1+.1*(-1/40*(t.wheelDeltaY||t.deltaY)<0?1:-1),!1,!0))}update(){for(const t of this._widgets.values())t.instance.widgetHandler&&t.instance.widgetHandler.update()}createWidget(t,e){if(this._widgets.get(t))return;let s=null,i=!1;switch(t){case kd.CHAT_WIDGET:{i=!0;const t=new rT;t.connection=um.instance.communication.connection,s=t;break}case kd.CHAT_INPUT_WIDGET:i=!0,s=new eT;break;case kd.AVATAR_INFO:s=new Kv;break;case kd.INFOSTAND:s=new yT;break;case kd.LOCATION_WIDGET:s=new DT;break;case kd.INTERNAL_LINK:s=new fT;break;case kd.ROOM_LINK:s=new ST;break;case kd.ROOM_DIMMER:s=new ET;break;case kd.CUSTOM_STACK_HEIGHT:s=new _T;break;case kd.FURNI_CHOOSER:s=new cT;break;case kd.USER_CHOOSER:s=new NT;break;case kd.DOORBELL:s=new LT;break;case kd.FURNI_TROPHY_WIDGET:s=new xT}if(s){const i=s.messageTypes;if(i&&i.length)for(const t of i){if(!t)continue;let e=this._widgetHandlerMessageMap.get(t);e||(e=[],this._widgetHandlerMessageMap.set(t,e)),e.push(s)}const r=s.eventTypes;if(r.push(md.OPEN_WIDGET,md.CLOSE_WIDGET),r&&r.length)for(const t of r){if(!t)continue;let e=this._widgetHandlerEventMap.get(t);e||(e=[],this._widgetHandlerEventMap.set(t,e)),e.push(s)}if(this._handlers.push(s),e){let i=null,r=null;if(this._ngZone.run(()=>{const t=this._componentFactoryResolver.resolveComponentFactory(e);i=this.widgetContainer.createComponent(t),r=i.instance}),!r)return;r.widgetHandler=s,r.messageListener=this,r.registerUpdateEvents(this._events),this._widgets.set(t,i)}s.container=this}i&&this._events.dispatchEvent(new Yv(Yv.SIZE_CHANGED,this.getRoomViewRect()))}processEvent(t){if(!t||!this._widgetHandlerEventMap)return;const e=this._widgetHandlerEventMap.get(t.type);if(!e)return;let s=!1;for(const i of e)i&&(s=!0,t.type!==md.OPEN_WIDGET&&t.type!==md.CLOSE_WIDGET||t instanceof md&&(s=i.type===t.widget),s&&i.processEvent(t))}processWidgetMessage(t){if(!t||!t.type)return null;const e=this._widgetHandlerMessageMap.get(t.type);if(!e||!e.length)return null;for(const s of e){if(!s)continue;const e=s.processWidgetMessage(t);if(e)return e}return null}onRoomEngineEvent(t){if(t)switch(t.type){case ih.NORMAL_MODE:return void this._events.dispatchEvent(new Gv(Gv.RWREUE_NORMAL_MODE,t.roomId));case ih.GAME_MODE:return void this._events.dispatchEvent(new Gv(Gv.RWREUE_GAME_MODE,t.roomId))}}onRoomEngineObjectEvent(t){if(!t)return;const e=t.objectId,s=t.category;let i=null;switch(t.type){case Nh.SELECTED:this.isFurnitureSelectionDisabled(t)||(i=new Vv(Vv.OBJECT_SELECTED,e,s,t.roomId));break;case Nh.DESELECTED:i=new Vv(Vv.OBJECT_DESELECTED,e,s,t.roomId);break;case Nh.ADDED:{let r=null;switch(s){case tt.FLOOR:case tt.WALL:r=Vv.FURNI_ADDED;break;case tt.UNIT:r=Vv.USER_ADDED}r&&(i=new Vv(r,e,s,t.roomId));break}case Nh.REMOVED:{let r=null;switch(s){case tt.FLOOR:case tt.WALL:r=Vv.FURNI_REMOVED;break;case tt.UNIT:r=Vv.USER_REMOVED}r&&(i=new Vv(r,e,s,t.roomId));break}case Nh.MOUSE_ENTER:i=new Vv(Vv.OBJECT_ROLL_OVER,e,s,t.roomId);break;case Nh.MOUSE_LEAVE:i=new Vv(Vv.OBJECT_ROLL_OUT,e,s,t.roomId);break;case Nh.REQUEST_MOVE:this.checkFurniManipulationRights(t.roomId,e,s)&&um.instance.roomEngine.processRoomObjectOperation(e,s,Dd.OBJECT_MOVE);break;case Nh.REQUEST_ROTATE:this.checkFurniManipulationRights(t.roomId,e,s)&&um.instance.roomEngine.processRoomObjectOperation(e,s,Dd.OBJECT_ROTATE_POSITIVE);break;case md.REQUEST_TROPHY:this.processWidgetMessage(new pT(pT.REQUEST_TROPHY,e,s,t.roomId));break;case md.OPEN_WIDGET:case md.CLOSE_WIDGET:case md.OPEN_FURNI_CONTEXT_MENU:case md.CLOSE_FURNI_CONTEXT_MENU:case md.REMOVE_DIMMER:case md.REQUEST_MANNEQUIN:case md.REQUEST_BACKGROUND_COLOR:case md.REQUEST_FRIEND_FURNITURE_ENGRAVING:case md.REQUEST_HIGH_SCORE_DISPLAY:case md.REQUEST_HIDE_HIGH_SCORE_DISPLAY:case md.REQUEST_INTERNAL_LINK:case md.REQUEST_ROOM_LINK:this.processEvent(t)}if(i){let t=!0;i instanceof Vv&&(t=!zp.isRoomPreviewerId(i.roomId)),t&&this._events.dispatchEvent(i)}}isFurnitureSelectionDisabled(t){let e=!1;const s=um.instance.roomEngine.getRoomObject(t.roomId,t.objectId,t.category);return s&&1===s.model.getValue(st.FURNITURE_SELECTION_DISABLED)&&(e=!0,um.instance.sessionDataManager.isModerator&&(e=!1)),e}checkFurniManipulationRights(t,e,s){return this._roomSession.controllerLevel>=en.GUEST||um.instance.sessionDataManager.isModerator||this.isOwnerOfFurniture(um.instance.roomEngine.getRoomObject(t,e,s))}isOwnerOfFurniture(t){return!(!t||!t.model)&&um.instance.sessionDataManager.userId===t.model.getValue(st.FURNITURE_OWNER_ID)}_Str_2485(t){if(!t||!this._widgetHandlerEventMap)return;const e=this._widgetHandlerEventMap.get(t.type);if(e&&e.length){let s=!0;for(const i of e)(t.type===md.OPEN_WIDGET||md.CLOSE_WIDGET)&&t instanceof md&&(s=i.type===t.widget),s&&i.processEvent(t)}}getRoomBackground(){if(this._roomBackground)return this._roomBackground;const t=this.roomEngine.getRoomInstanceRenderingCanvas(this.roomSession.roomId,this.getFirstCanvasId());if(!t)return null;const e=t.master,s=new A.n(A.p.WHITE);return e.addChildAt(s,0),this._roomBackground=s,this._roomBackground}getRoomColorizer(){if(this._roomColorAdjustor)return this._roomColorAdjustor;const e=this.roomEngine.getRoomInstanceRenderingCanvas(this.roomSession.roomId,this.getFirstCanvasId());if(!e)return null;const s=e.master;return s?(this._roomColorAdjustor=t.COLOR_ADJUSTMENT,s.filters=[this._roomColorAdjustor],this._roomColorAdjustor):null}setRoomBackgroundColor(t,e,s){this._roomBackgroundColor=Ig._Str_13949(((255&t)<<16)+((255&e)<<8)+(255&s));const i=this.getRoomBackground();i&&(t&&e&&s?(i.visible=!0,this.setRoomBackground()):i.visible=!1)}setRoomColorizerColor(t,e){this._roomColorizerColor=Ig._Str_13949((16776960&Ig._Str_22130(t))+e),this.setRoomColorizer()}setRoomBackground(){const t=this.getRoomBackground();t&&(t.tint=this._roomBackgroundColor,t.width=um.instance.width,t.height=um.instance.height)}setRoomColorizer(){const t=this.getRoomColorizer();if(!t)return;const e=this._roomColorizerColor>>8&255,s=255&this._roomColorizerColor;t.red=(this._roomColorizerColor>>16&255)/255,t.green=e/255,t.blue=s/255}getFirstCanvasId(){return 1}getRoomViewRect(){const t=this.roomCanvasReference.nativeElement.getBoundingClientRect();return new A.k(t.x||0,t.y||0,t.width||0,t.height||0)}get events(){return this._events}get connection(){return um.instance.communication.connection}get roomEngine(){return um.instance.roomEngine}get avatarRenderManager(){return um.instance.avatar}get roomSessionManager(){return um.instance.roomSessionManager}get sessionDataManager(){return um.instance.sessionDataManager}get roomSession(){return this._roomSession}get notificationService(){return this._notificationService}get wiredService(){return this._wiredService}get friendService(){return this._friendService}}return t.COLOR_ADJUSTMENT=new xv.a,t.\u0275fac=function(e){return new(e||t)(i.Ub(Nm),i.Ub(sR),i.Ub(Ef),i.Ub(i.l),i.Ub(i.E))},t.\u0275cmp=i.Ob({type:t,selectors:[["nitro-room-component"]],viewQuery:function(t,e){if(1&t&&(i.Wc(FT,!0),i.Wc(GT,!0,i.W)),2&t){let t;i.Ac(t=i.kc())&&(e.roomCanvasReference=t.first),i.Ac(t=i.kc())&&(e.widgetContainer=t.first)}},decls:5,vars:0,consts:[[1,"nitro-room-component"],[1,"room-view"],["roomCanvas",""],["widgetContainer",""]],template:function(t,e){1&t&&(i.Zb(0,"div",0),i.Vb(1,"div",1,2),i.Pc(3,VT,0,0,"ng-template",null,3,i.Qc),i.Yb())},encapsulation:2}),t})();class kT{constructor(){this._widgetHandler=null,this._messageListener=null,this._events=null,this._disposed=!1}initialize(t=0){}dispose(){this.disposed||(this._messageListener=null,this._events&&!this._events.disposed&&this.unregisterUpdateEvents(this._events),this._widgetHandler&&(this._widgetHandler.dispose(),this._widgetHandler=null),this._events=null,this._disposed=!0)}registerUpdateEvents(t){this._events=t}unregisterUpdateEvents(t){this._events=null}get disposed(){return this._disposed}get widgetHandler(){return this._widgetHandler}set widgetHandler(t){this._widgetHandler=t,this._widgetHandler.widget||(this._widgetHandler.widget=this)}get messageListener(){return this._messageListener}set messageListener(t){this._messageListener=t}}class jT{constructor(t){this._data=[],this._maxSize=t,this._index=0}reset(){this._data=[],this._index=0}_Str_22775(t){this._data.length<this._maxSize?this._data.push(t):this._data[this._index]=t,this._index=(this._index+1)%this._maxSize}_Str_25797(){let t=Number.MIN_VALUE,e=0;for(;e<this._maxSize;)this._data[e]>t&&(t=this._data[e]),e++;return t}_Str_26219(){let t=Number.MAX_VALUE,e=0;for(;e<this._maxSize;)this._data[e]<t&&(t=this._data[e]),e++;return t}}let BT=(()=>{class t{constructor(){this.parent=null,this.componentRef=null,this.activeView=null,this.stack=new jT(t.LOCATION_STACK_SIZE),this.opacity=0,this.currentDeltaY=-1e6,this.willFade=!1,this.firstFadeStarted=!1,this.fadeAfterDelay=!0,this.fadeLength=500,this.fadeTime=0,this.fadeStartDelay=3e3,this.fadingOut=!1,this.fadeStartTimer=null}completeSetup(){this.firstFadeStarted=!1,this.fadeLength=75,this.fadingOut=!1,this.opacity=1,this.onTimerComplete=this.onTimerComplete.bind(this),this.fadeAfterDelay&&this.willFade&&(this.fadeStartTimer&&(clearTimeout(this.fadeStartTimer),this.fadeStartTimer=null),this.fadeStartTimer=setTimeout(this.onTimerComplete,this.fadeStartDelay))}ngOnDestroy(){this.fadeStartTimer&&(clearTimeout(this.fadeStartTimer),this.fadeStartTimer=null)}update(e,s,i){if(!e)return;if(this.fadingOut?(this.fadeTime=this.fadeTime+i,this.opacity=(1-this.fadeTime/this.fadeLength)*this.maximumOpacity):this.opacity=this.maximumOpacity,this.opacity<=0)return void this.parent.removeView(this.componentRef,!1);const r=this.getOffset(e);this.stack._Str_22775(s.y-e.top);let n=this.stack._Str_25797();n<this.currentDeltaY-t.BUBBLE_DROP_SPEED&&(n=this.currentDeltaY-t.BUBBLE_DROP_SPEED);const a=s.y-n;this.currentDeltaY=n;let o=Math.round(s.x-this.activeViewElement.offsetWidth/2),c=Math.round(a+r);c<=0&&(c=t.SPACE_AROUND_EDGES),c>=um.instance.height-this.activeViewElement.offsetHeight&&(c=um.instance.height-this.activeViewElement.offsetHeight-t.SPACE_AROUND_EDGES),o>=um.instance.width-this.activeViewElement.offsetWidth&&(o=um.instance.width-this.activeViewElement.offsetWidth-t.SPACE_AROUND_EDGES),o<0&&(o=0+t.BUBBLE_DROP_SPEED),this.activeViewElement.style.left=o+"px",this.activeViewElement.style.top=c+"px",this.activeViewElement.style.opacity=this.opacity.toString()}hide(t){this.activeView&&(!this.firstFadeStarted&&t?(this.firstFadeStarted=!0,this.fadeStartTimer&&(clearTimeout(this.fadeStartTimer),this.fadeStartTimer=null),this.fadeStartTimer=setTimeout(this.onTimerComplete,this.fadeStartDelay)):this.parent.removeView(this.componentRef,!1))}onTimerComplete(){this.fadingOut=!0,this.hide(!0)}getOffset(t){let e=-this.activeViewElement.offsetHeight;return e-=4,e}get maximumOpacity(){return 1}get activeViewElement(){return this.activeView&&this.activeView.nativeElement||null}}return t.LOCATION_STACK_SIZE=25,t.BUBBLE_DROP_SPEED=3,t.SPACE_AROUND_EDGES=5,t.\u0275fac=function(e){return new(e||t)},t.\u0275dir=i.Pb({type:t}),t})();class HT extends BT{constructor(){super(...arguments),this.userId=-1,this.userName="",this.userType=-1,this.roomIndex=-1}static extendedSetup(t,e,s,i,r){t.userId=e,t.userName=s,t.userType=i,t.roomIndex=r,t.completeSetup()}getOffset(t){let e=-this.activeViewElement.offsetHeight;return this.userType===Za.USER||this.userType===Za.BOT||this.userType===Za.RENTABLE_BOT?e+=t.height>50?25:0:e-=4,e}}const WT=["activeView"];function ZT(t,e){if(1&t){const t=i.ac();i.Zb(0,"li",10),i.jc("click",(function(){i.Ec(t);const e=i.lc().$implicit;return i.lc(3).processAction(e.name)})),i.Rc(1),i.mc(2,"translate"),i.Yb()}if(2&t){const t=i.lc().$implicit,e=i.lc(3);i.Gb(1),i.Sc(i.oc(2,1,t.localization,e.fakeValue))}}function zT(t,e){if(1&t&&(i.Xb(0),i.Pc(1,ZT,3,4,"li",9),i.Wb()),2&t){const t=e.$implicit;i.Gb(1),i.sc("ngIf",t.visible)}}function XT(t,e){if(1&t&&(i.Zb(0,"ul",8),i.Pc(1,zT,2,1,"ng-container",5),i.Yb()),2&t){const t=i.lc().$implicit;i.Gb(1),i.sc("ngForOf",t.items)}}function KT(t,e){if(1&t&&(i.Xb(0),i.Pc(1,XT,2,1,"ul",7),i.Wb()),2&t){const t=e.$implicit,s=i.lc();i.Gb(1),i.sc("ngIf",s.mode===t.mode)}}let qT=(()=>{class t extends HT{constructor(t){super(),this._applicationRef=t,this.avatarData=null,this.mode=0,this.fakeValue=0,this.menu=[]}static setup(t,e,s,i,r,n){t.avatarData=n,HT.extendedSetup(t,e,s,i,r),t.setupButtons()}setupButtons(){let e=!1;const s=this.widget.handler,i=s.container.roomEngine.getRoomObject(s.roomSession.roomId,s.container.roomSession.ownRoomIndex,tt.UNIT);if(i){const t=i.model.getValue(st.FIGURE_CARRY_OBJECT);t>0&&t<999999&&(e=!0)}um.instance.localization.registerParameter("infostand.button.respect","count",this.avatarData._Str_3577.toString()),this.menu=[{mode:t.MODE_NORMAL,items:[{name:"friend",localization:"infostand.button.friend",visible:this.avatarData.canBeAskedForAFriend},{name:"trade",localization:"infostand.button.trade",visible:this.avatarData._Str_5751},{name:"whisper",localization:"infostand.button.whisper",visible:!0},{name:"respect",localization:"infostand.button.respect",visible:this.avatarData._Str_3577>0},{name:"ignore",localization:"infostand.button.ignore",visible:!this.avatarData._Str_3655},{name:"unignore",localization:"infostand.button.unignore",visible:this.avatarData._Str_3655},{name:"report",localization:"infostand.button.report",visible:!0},{name:"moderate",localization:"infostand.link.moderate",visible:this.moderateMenuHasContent()},{name:"ambassador",localization:"infostand.link.ambassador",visible:this.ambassadorMenuHasContent()},{name:"pass_handitem",localization:"avatar.widget.pass_hand_item",visible:e}]},{mode:t.MODE_MODERATE,items:[{name:"kick",localization:"infostand.button.kick",visible:!0},{name:"mute",localization:"infostand.button.mute",visible:!0},{name:"ban",localization:"infostand.button.ban",visible:!0},{name:"give_rights",localization:"infostand.button.giverights",visible:this.isShowGiveRights()},{name:"remove_rights",localization:"infostand.button.removerights",visible:this.isShowRemoveRights()},{name:"back",localization:"generic.back",visible:!0}]},{mode:t.MODE_MODERATE_BAN,items:[{name:"ban_hour",localization:"infostand.button.ban_hour",visible:!0},{name:"ban_day",localization:"infostand.button.ban_day",visible:!0},{name:"ban_perm",localization:"infostand.button.ban_perm",visible:!0},{name:"back_moderate",localization:"generic.back",visible:!0}]},{mode:t.MODE_MODERATE_MUTE,items:[{name:"mute_2min",localization:"infostand.button.mute_2min",visible:!0},{name:"mute_5min",localization:"infostand.button.mute_5min",visible:!0},{name:"mute_10min",localization:"infostand.button.mute_10min",visible:!0},{name:"back_moderate",localization:"generic.back",visible:!0}]},{mode:t.MODE_AMBASSADOR,items:[{name:"ambassador_alert",localization:"infostand.button.alert",visible:!0},{name:"ambassador_kick",localization:"infostand.button.kick",visible:!0},{name:"ambassador_mute",localization:"infostand.button.mute",visible:!0},{name:"back",localization:"generic.back",visible:!0}]},{mode:t.MODE_AMBASSADOR_MUTE,items:[{name:"ambassador_mute_2min",localization:"infostand.button.mute_2min",visible:!0},{name:"ambassador_mute_10min",localization:"infostand.button.mute_10min",visible:!0},{name:"ambassador_mute_60min",localization:"infostand.button.mute_60min",visible:!0},{name:"ambassador_mute_18hr",localization:"infostand.button.mute_18hr",visible:!0},{name:"back_ambassador",localization:"generic.back",visible:!0}]}]}processAction(e){let s=null,i=null,r=!0;if(e){switch(e){case"moderate":r=!1,this.setMode(t.MODE_MODERATE);break;case"ban":r=!1,this.setMode(t.MODE_MODERATE_BAN);break;case"mute":r=!1,this.setMode(t.MODE_MODERATE_MUTE);break;case"ambassador":r=!1,this.setMode(t.MODE_AMBASSADOR);break;case"ambassador_mute":r=!1,this.setMode(t.MODE_AMBASSADOR_MUTE);break;case"back_moderate":r=!1,this.setMode(t.MODE_MODERATE);break;case"back_ambassador":r=!1,this.setMode(t.MODE_AMBASSADOR);break;case"back":r=!1,this.setMode(t.MODE_NORMAL);break;case"whisper":s=Xv.RWUAM_WHISPER_USER;break;case"friend":this.avatarData.canBeAskedForAFriend=!1,s=Xv.RWUAM_SEND_FRIEND_REQUEST;break;case"respect":this.avatarData._Str_3577--,um.instance.localization.registerParameter("infostand.button.respect","count",this.avatarData._Str_3577.toString()),s=Xv.RWUAM_RESPECT_USER,this.avatarData._Str_3577>0&&(r=!1,this.fakeValue++);break;case"ignore":this.avatarData._Str_3655=!0,s=Xv.RWUAM_IGNORE_USER;break;case"unignore":this.avatarData._Str_3655=!1,s=Xv.RWUAM_UNIGNORE_USER;break;case"kick":s=Xv.RWUAM_KICK_USER;break;case"ban_hour":s=Xv.RWUAM_BAN_USER_HOUR;break;case"ban_day":s=Xv.RWUAM_BAN_USER_DAY;break;case"perm_ban":s=Xv.RWUAM_BAN_USER_PERM;break;case"mute_2min":s=Xv.MUTE_USER_2MIN;break;case"mute_5min":s=Xv.MUTE_USER_5MIN;break;case"mute_10min":s=Xv.MUTE_USER_10MIN;break;case"give_rights":this.avatarData.roomControllerLevel=en.GUEST,s=Xv.RWUAM_GIVE_RIGHTS;break;case"remove_rights":this.avatarData.roomControllerLevel=en.NONE,s=Xv.RWUAM_TAKE_RIGHTS;break;case"trade":s=Xv.RWUAM_START_TRADING;break;case"report":s=Xv.RWUAM_REPORT_CFH_OTHER;break;case"pass_handitem":s=Xv.RWUAM_PASS_CARRY_ITEM;break;case"ambassador_alert":s=Xv.RWUAM_AMBASSADOR_ALERT_USER;break;case"ambassador_kick":s=Xv.RWUAM_AMBASSADOR_KICK_USER;break;case"ambassador_mute_2min":s=Xv.AMBASSADOR_MUTE_USER_2MIN;break;case"ambassador_mute_10min":s=Xv.AMBASSADOR_MUTE_USER_10MIN;break;case"ambassador_mute_60min":s=Xv.AMBASSADOR_MUTE_USER_60MIN;break;case"ambassador_mute_18hour":s=Xv.AMBASSADOR_MUTE_USER_18HOUR}s&&(i=new Xv(s,this.userId)),i&&this.parent.messageListener.processWidgetMessage(i)}r&&this.parent.removeView(this.componentRef,!1)}setMode(t){t!==this.mode&&(this.mode=t)}ambassadorMenuHasContent(){return this.avatarData._Str_4050}moderateMenuHasContent(){return this.avatarData._Str_5990||this.avatarData._Str_6701||this.avatarData._Str_6394||this.isShowGiveRights()||this.isShowRemoveRights()}isShowGiveRights(){return this.avatarData._Str_3246&&this.avatarData._Str_5599<en.GUEST&&!this.avatarData._Str_3672}isShowRemoveRights(){return this.avatarData._Str_3246&&this.avatarData._Str_5599===en.GUEST&&!this.avatarData._Str_3672}get widget(){return this.parent}}return t.MODE_NORMAL=0,t.MODE_MODERATE=1,t.MODE_MODERATE_BAN=2,t.MODE_MODERATE_MUTE=3,t.MODE_AMBASSADOR=4,t.MODE_AMBASSADOR_MUTE=5,t.\u0275fac=function(e){return new(e||t)(i.Ub(i.g))},t.\u0275cmp=i.Ob({type:t,selectors:[["nitro-room-avatarinfo-avatar-component"]],viewQuery:function(t,e){if(1&t&&i.Wc(WT,!0),2&t){let t;i.Ac(t=i.kc())&&(e.activeView=t.first)}},features:[i.Db],decls:8,vars:2,consts:[[1,"nitro-room-avatarinfo-avatar-component","context-menu"],["activeView",""],[1,"card","align-items-center"],[1,"d-flex","card-header","align-items-center","w-100"],[1,"card-body"],[4,"ngFor","ngForOf"],[1,"card-pointer"],["class","list-group list-group-flush",4,"ngIf"],[1,"list-group","list-group-flush"],["class","list-group-item",3,"click",4,"ngIf"],[1,"list-group-item",3,"click"]],template:function(t,e){1&t&&(i.Zb(0,"div",0,1),i.Zb(2,"div",2),i.Zb(3,"div",3),i.Rc(4),i.Yb(),i.Zb(5,"div",4),i.Pc(6,KT,2,1,"ng-container",5),i.Yb(),i.Vb(7,"div",6),i.Yb(),i.Yb()),2&t&&(i.Gb(4),i.Sc(e.userName),i.Gb(2),i.sc("ngForOf",e.menu))},directives:[o.l,o.m],pipes:[Ep],encapsulation:2}),t})();class JT{constructor(){this._isIgnored=!1,this._canTrade=!1,this._canTradeReason=0,this._canBeKicked=!1,this._canBeBanned=!1,this._canBeMuted=!1,this._canBeAskedAsFriend=!1,this._amIOwner=!1,this._amIAnyRoomController=!1,this._respectLeft=0,this._isOwnUser=!1,this._allowNameChange=!1,this._isGuildRoom=!1,this._carryItemType=0,this._myRoomControllerLevel=0,this._targetRoomControllerLevel=0,this._isFriend=!1,this._isAmbassador=!1}get _Str_3655(){return this._isIgnored}set _Str_3655(t){this._isIgnored=t}get _Str_5751(){return this._canTrade}set _Str_5751(t){this._canTrade=t}get _Str_6622(){return this._canTradeReason}set _Str_6622(t){this._canTradeReason=t}get _Str_5990(){return this._canBeKicked}set _Str_5990(t){this._canBeKicked=t}get _Str_6701(){return this._canBeBanned}set _Str_6701(t){this._canBeBanned=t}get _Str_6394(){return this._canBeMuted}set _Str_6394(t){this._canBeMuted=t}get canBeAskedForAFriend(){return this._canBeAskedAsFriend}set canBeAskedForAFriend(t){this._canBeAskedAsFriend=t}get _Str_3246(){return this._amIOwner}set _Str_3246(t){this._amIOwner=t}get _Str_3529(){return this._amIAnyRoomController}set _Str_3529(t){this._amIAnyRoomController=t}get _Str_3577(){return this._respectLeft}set _Str_3577(t){this._respectLeft=t}get _Str_11453(){return this._isOwnUser}set _Str_11453(t){this._isOwnUser=t}get allowNameChange(){return this._allowNameChange}set allowNameChange(t){this._allowNameChange=t}get _Str_3672(){return this._isGuildRoom}set _Str_3672(t){this._isGuildRoom=t}get _Str_8826(){return this._carryItemType}set _Str_8826(t){this._carryItemType=t}get roomControllerLevel(){return this._myRoomControllerLevel}set roomControllerLevel(t){this._myRoomControllerLevel=t}get _Str_5599(){return this._targetRoomControllerLevel}set _Str_5599(t){this._targetRoomControllerLevel=t}get isFriend(){return this._isFriend}get _Str_4050(){return this._isAmbassador}populate(t){this._amIAnyRoomController=t.isModerator,this._myRoomControllerLevel=t.roomControllerLevel,this._amIOwner=t.isRoomOwner,this._canBeAskedAsFriend=t.canBeAskedForAFriend,this._canBeKicked=t._Str_5990,this._canBeBanned=t._Str_6701,this._canBeMuted=t._Str_6394,this._canTrade=t.canTrade,this._canTradeReason=t._Str_6622,this._isIgnored=t.isIgnored,this._respectLeft=t.respectLeft,this._isOwnUser=t.type===TT.OWN_USER,this._allowNameChange=t._Str_4330,this._isGuildRoom=t.isGuildRoom,this._targetRoomControllerLevel=t.flatControl,this._carryItemType=t.carryId,this._isFriend=t.isFriend,this._isAmbassador=t.isAmbassador}}const QT=["activeView"];let $T=(()=>{class t extends HT{static setup(t,e,s,i,r,n=!1){t.willFade=n,HT.extendedSetup(t,e,s,i,r)}}return t.\u0275fac=function(e){return tO(e||t)},t.\u0275cmp=i.Ob({type:t,selectors:[["nitro-room-avatarinfo-name-component"]],viewQuery:function(t,e){if(1&t&&i.Wc(QT,!0),2&t){let t;i.Ac(t=i.kc())&&(e.activeView=t.first)}},features:[i.Db],decls:6,vars:1,consts:[[1,"nitro-room-avatarinfo-name-component","context-menu"],["activeView",""],[1,"card","align-items-center"],[1,"d-flex","card-header","border-0","align-items-center","w-100"],[1,"card-pointer"]],template:function(t,e){1&t&&(i.Zb(0,"div",0,1),i.Zb(2,"div",2),i.Zb(3,"div",3),i.Rc(4),i.Yb(),i.Vb(5,"div",4),i.Yb(),i.Yb()),2&t&&(i.Gb(4),i.Sc(e.userName))},encapsulation:2}),t})();const tO=i.bc($T);let eO=(()=>{class t{constructor(t){this._sanitizer=t}transform(t){return this._sanitizer.bypassSecurityTrustHtml(t)}}return t.\u0275fac=function(e){return new(e||t)(i.Ub(r.b))},t.\u0275pipe=i.Tb({name:"keepHtml",type:t,pure:!1}),t})();const sO=["activeView"];function iO(t,e){if(1&t){const t=i.ac();i.Zb(0,"li",10),i.jc("click",(function(){i.Ec(t);const e=i.lc().$implicit;return i.lc(3).processAction(e.name)})),i.mc(1,"keepHtml"),i.mc(2,"translate"),i.Yb()}if(2&t){const t=i.lc().$implicit;i.sc("innerHTML","11"===t.name||"12"===t.name||"13"===t.name||"14"===t.name||"15"===t.name?i.nc(1,1,t.localization):i.nc(2,3,t.localization),i.Fc)}}function rO(t,e){if(1&t&&(i.Xb(0),i.Pc(1,iO,3,5,"li",9),i.Wb()),2&t){const t=e.$implicit;i.Gb(1),i.sc("ngIf",t.visible)}}const nO=function(t){return{"columns-3":t}};function aO(t,e){if(1&t&&(i.Zb(0,"ul",8),i.Pc(1,rO,2,1,"ng-container",5),i.Yb()),2&t){const t=i.lc().$implicit;i.sc("ngClass",i.vc(2,nO,4===t.mode)),i.Gb(1),i.sc("ngForOf",t.items)}}function oO(t,e){if(1&t&&(i.Xb(0),i.Pc(1,aO,2,4,"ul",7),i.Wb()),2&t){const t=e.$implicit,s=i.lc();i.Gb(1),i.sc("ngIf",s.mode===t.mode)}}let cO=(()=>{class t extends HT{constructor(){super(...arguments),this.avatarData=null,this.mode=0,this.menu=[]}static setup(e,s,i,r,n,a){e.avatarData=a,e.widget.isDancing&&e.widget.hasClub&&(e.mode=t.MODE_CLUB_DANCES),HT.extendedSetup(e,s,i,r,n),e.setupButtons()}setupButtons(){const e=this.widget._Str_25831;this.menu=[{mode:t.MODE_NORMAL,items:[{name:"decorate",localization:"widget.avatar.decorate",visible:this.widget.hasClub&&this.avatarData.roomControllerLevel>=en.GUEST||this.avatarData._Str_3246},{name:"change_looks",localization:"widget.memenu.myclothes",visible:!0},{name:"dance_menu",localization:"widget.memenu.dance",visible:this.widget.hasClub&&!e},{name:"dance",localization:"widget.memenu.dance",visible:!this.widget.isDancing&&!this.widget.hasClub&&!e},{name:"dance_stop",localization:"widget.memenu.dance.stop",visible:this.widget.isDancing&&!this.widget.hasClub&&!e},{name:"expressions",localization:"infostand.link.expressions",visible:!0},{name:"signs",localization:"infostand.show.signs",visible:!0},{name:"drop_hand_item",localization:"avatar.widget.drop_hand_item",visible:this.avatarData._Str_8826>0&&this.avatarData._Str_8826<999999}]},{mode:t.MODE_CLUB_DANCES,items:[{name:"dance_stop",localization:"widget.memenu.dance.stop",visible:this.widget.isDancing},{name:"dance_1",localization:"widget.memenu.dance1",visible:!0},{name:"dance_2",localization:"widget.memenu.dance2",visible:!0},{name:"dance_3",localization:"widget.memenu.dance3",visible:!0},{name:"dance_4",localization:"widget.memenu.dance4",visible:!0},{name:"back",localization:"generic.back",visible:!0}]},{mode:t.MODE_EXPRESSIONS,items:[{name:"sit",localization:"widget.memenu.sit",visible:this.widget.getOwnPosture===Lt.POSTURE_STAND},{name:"stand",localization:"widget.memenu.stand",visible:this.widget.getCanStandUp},{name:"wave",localization:"widget.memenu.wave",visible:!this.widget._Str_12708},{name:"laugh",localization:"widget.memenu.laugh",visible:!this.widget._Str_12708&&this.widget.hasVip},{name:"blow",localization:"widget.memenu.blow",visible:!this.widget._Str_12708&&this.widget.hasVip},{name:"idle",localization:"widget.memenu.idle",visible:!0},{name:"back",localization:"generic.back",visible:!0}]},{mode:t.MODE_SIGNS,items:[{name:"sign_1",localization:"1",visible:!0},{name:"sign_4",localization:"4",visible:!0},{name:"sign_7",localization:"7",visible:!0},{name:"sign_10",localization:"10",visible:!0},{name:"sign_0",localization:"0",visible:!0},{name:"sign_14",localization:'<i class="fas fa-futbol"></i>',visible:!0},{name:"sign_2",localization:"2",visible:!0},{name:"sign_5",localization:"5",visible:!0},{name:"sign_8",localization:"8",visible:!0},{name:"sign_11",localization:'<i class="fas fa-heart"></i>',visible:!0},{name:"sign_13",localization:'<i class="fas fa-exclamation"></i>',visible:!0},{name:"sign_17",localization:"17",visible:!0},{name:"sign_3",localization:"3",visible:!0},{name:"sign_6",localization:"6",visible:!0},{name:"sign_9",localization:"9",visible:!0},{name:"sign_12",localization:'<i class="fas fa-skull"></i>',visible:!0},{name:"sign_15",localization:'<i class="far fa-grin"></i>',visible:!0},{name:"sign_16",localization:"16",visible:!0}]}]}processAction(e){let s=null,i=!0;if(e){if(e.startsWith("sign_")){const t=parseInt(e.split("_")[1]);this.widget.useSign(t)}else switch(e){case"decorate":break;case"change_looks":this.widget.openAvatarEditor();break;case"expressions":i=!1,this.setMode(t.MODE_EXPRESSIONS);break;case"sit":s=new Wv(Wv._Str_2016);break;case"stand":s=new Wv(Wv._Str_1553);break;case"wave":s=new Hv(qv._Str_6268);break;case"blow":s=new Hv(qv._Str_5579);break;case"laugh":s=new Hv(qv._Str_7336);break;case"idle":s=new Hv(qv._Str_6989);break;case"dance_menu":i=!1,this.setMode(t.MODE_CLUB_DANCES);break;case"dance":s=new Zv(1);break;case"dance_stop":s=new Zv(0);break;case"dance_1":case"dance_2":case"dance_3":case"dance_4":s=new Zv(parseInt(e.charAt(e.length-1)));break;case"signs":i=!1,this.setMode(t.MODE_SIGNS);break;case"back":case"more":i=!1,this.setMode(t.MODE_NORMAL);break;case"drop_hand_item":s=new Xv(Xv.RWUAM_DROP_CARRY_ITEM,this.userId)}s&&this.parent.messageListener.processWidgetMessage(s)}i&&this.parent.removeView(this.componentRef,!1)}setMode(t){t!==this.mode&&(this.mode=t)}get widget(){return this.parent}}return t.MODE_NORMAL=0,t.MODE_CLUB_DANCES=1,t.MODE_NAME_CHANGE=2,t.MODE_EXPRESSIONS=3,t.MODE_SIGNS=4,t.MODE_CHANGE_LOOKS=5,t.\u0275fac=function(e){return _O(e||t)},t.\u0275cmp=i.Ob({type:t,selectors:[["nitro-room-avatarinfo-ownavatar-component"]],viewQuery:function(t,e){if(1&t&&i.Wc(sO,!0),2&t){let t;i.Ac(t=i.kc())&&(e.activeView=t.first)}},features:[i.Db],decls:8,vars:2,consts:[[1,"nitro-room-avatarinfo-ownavatar-component","context-menu"],["activeView",""],[1,"card","align-items-center"],[1,"d-flex","card-header","align-items-center","w-100"],[1,"card-body"],[4,"ngFor","ngForOf"],[1,"card-pointer"],["class","list-group list-group-flush",3,"ngClass",4,"ngIf"],[1,"list-group","list-group-flush",3,"ngClass"],["class","list-group-item",3,"innerHTML","click",4,"ngIf"],[1,"list-group-item",3,"innerHTML","click"]],template:function(t,e){1&t&&(i.Zb(0,"div",0,1),i.Zb(2,"div",2),i.Zb(3,"div",3),i.Rc(4),i.Yb(),i.Zb(5,"div",4),i.Pc(6,oO,2,1,"ng-container",5),i.Yb(),i.Vb(7,"div",6),i.Yb(),i.Yb()),2&t&&(i.Gb(4),i.Sc(e.userName),i.Gb(2),i.sc("ngForOf",e.menu))},directives:[o.l,o.m,o.k],pipes:[eO,Ep],encapsulation:2}),t})();const _O=i.bc(cO);class hO{constructor(){this.age=0,this.rarityLevel=0,this._Str_5114=!1,this.energy=0,this.maximumEnergy=0,this.experience=0,this.levelExperienceGoal=0,this.id=0,this._Str_5175=!1,this.level=0,this.maximumLevel=0,this.name="",this.happyness=0,this.maximumHappyness=0,this.ownerId=0,this.ownerName="",this._Str_14767=0,this.respect=0,this._Str_2985=0,this._Str_4355=0,this.saddle=!1,this.rider=!1,this.breedable=!1,this.fullyGrown=!1,this.dead=!1,this.publiclyRideable=0,this.maximumTimeToLive=0,this.remainingTimeToLive=0,this.remainingGrowTime=0,this.publiclyBreedable=!1,this._Str_3307=[]}populate(t){this.age=t.age,this.rarityLevel=t.rarityLevel,this._Str_5114=t._Str_5114,this.energy=t.energy,this.maximumEnergy=t.maximumEnergy,this.experience=t.experience,this.levelExperienceGoal=t.levelExperienceGoal,this.id=t.id,this._Str_5175=t._Str_5175,this.level=t.level,this.maximumLevel=t.maximumLevel,this.name=t.name,this.happyness=t.happyness,this.maximumHappyness=t.maximumHappyness,this.ownerId=t.ownerId,this.ownerName=t.ownerName,this._Str_14767=t._Str_14767,this.respect=t.respect,this._Str_2985=t._Str_2985,this._Str_4355=t._Str_4355,this.saddle=t.saddle,this.rider=t.rider,this.breedable=t.breedable,this.dead=t.dead,this.fullyGrown=t.fullyGrown,this._Str_3307=t._Str_3307,this.publiclyRideable=t.publiclyRideable,this.maximumTimeToLive=t.maximumTimeToLive,this.remainingTimeToLive=t.remainingTimeToLive,this.remainingGrowTime=t.remainingGrowTime,this.publiclyBreedable=t.publiclyBreedable}}const lO=["contextsContainer"];function uO(t,e){}let dO=(()=>{class t extends kT{constructor(t,e,s,i){super(),this._avatarEditorService=t,this._settingsService=e,this._componentFactoryResolver=s,this._ngZone=i,this.view=null,this.cachedNameView=null,this.cachedOwnAvatarMenuView=null,this.cachedAvatarMenuView=null,this.cachedNameBubbles=new Map,this.lastRollOverId=-1,this.userInfoData=new JT,this.petInfoData=new hO,this.isDancing=!1,this._isInitialized=!1,this._isRoomEnteredOwnAvatarHighlight=!1,this._isGameMode=!1,this._Str_2557=this._Str_2557.bind(this)}ngOnDestroy(){um.instance.ticker.remove(this.update,this)}registerUpdateEvents(t){t&&(t.addEventListener(kv.RWAIE_AVATAR_INFO,this._Str_2557),t.addEventListener(bT.RWONE_TYPE,this._Str_2557),t.addEventListener(TT.OWN_USER,this._Str_2557),t.addEventListener(TT.PEER,this._Str_2557),t.addEventListener(jv.RWUDUE_USER_DATA_UPDATED,this._Str_2557),t.addEventListener(Vv.USER_REMOVED,this._Str_2557),t.addEventListener(IT.FURNI,this._Str_2557),t.addEventListener(Vv.OBJECT_SELECTED,this._Str_2557),t.addEventListener(Vv.OBJECT_DESELECTED,this._Str_2557),t.addEventListener(Vv.OBJECT_ROLL_OVER,this._Str_2557),t.addEventListener(Vv.OBJECT_ROLL_OUT,this._Str_2557),t.addEventListener(Gv.RWREUE_NORMAL_MODE,this._Str_2557),t.addEventListener(Gv.RWREUE_GAME_MODE,this._Str_2557),super.registerUpdateEvents(t))}unregisterUpdateEvents(t){t&&(t.removeEventListener(kv.RWAIE_AVATAR_INFO,this._Str_2557),t.removeEventListener(bT.RWONE_TYPE,this._Str_2557),t.removeEventListener(TT.OWN_USER,this._Str_2557),t.removeEventListener(TT.PEER,this._Str_2557),t.removeEventListener(jv.RWUDUE_USER_DATA_UPDATED,this._Str_2557),t.removeEventListener(Vv.USER_REMOVED,this._Str_2557),t.removeEventListener(IT.FURNI,this._Str_2557),t.removeEventListener(Vv.OBJECT_SELECTED,this._Str_2557),t.removeEventListener(Vv.OBJECT_DESELECTED,this._Str_2557),t.removeEventListener(Vv.OBJECT_ROLL_OVER,this._Str_2557),t.removeEventListener(Vv.OBJECT_ROLL_OUT,this._Str_2557),t.removeEventListener(Gv.RWREUE_NORMAL_MODE,this._Str_2557),t.removeEventListener(Gv.RWREUE_GAME_MODE,this._Str_2557),super.unregisterUpdateEvents(t))}_Str_2557(t){const e=this.view&&this.view.instance||null;switch(t.type){case kv.RWAIE_AVATAR_INFO:{const e=t;this._isRoomEnteredOwnAvatarHighlight=!this._isInitialized&&this.handler.container.roomSession&&e._Str_2707===this.handler.container.roomSession.ownRoomIndex,this._Str_12674(e.userId,e.userName,e._Str_2908,e._Str_2707,e._Str_4330,null),this._isInitialized=!0;break}case bT.RWONE_TYPE:{const e=t;e.category===tt.UNIT&&this._Str_12674(e.userId,e.userName,e.userType,e.roomIndex,!1,null);break}case TT.OWN_USER:case TT.PEER:{const e=t;this.userInfoData.populate(e),this._Str_12674(e.webID,e.name,e.userType,e.roomIndex,!1,e.isSpectator?null:this.userInfoData);break}case jv.RWUDUE_USER_DATA_UPDATED:this._isInitialized||this._Str_25716();break;case Vv.USER_REMOVED:{const s=t;e&&e.roomIndex===s.id&&this.removeView(this.view,!1);for(const t of this.cachedNameBubbles.values())if(t.instance.roomIndex==s.id){this.removeView(t,!1);break}break}case IT.FURNI:case Vv.OBJECT_DESELECTED:this.view&&this.removeView(this.view,!1);break;case Vv.OBJECT_ROLL_OVER:{if(this._isRoomEnteredOwnAvatarHighlight)return;const s=t;e&&(e instanceof qT||e instanceof cO)||(this.lastRollOverId=s.id,this.messageListener.processWidgetMessage(new zv(zv.GET_OBJECT_NAME,s.id,s.category)));break}case Vv.OBJECT_ROLL_OUT:{if(this._isRoomEnteredOwnAvatarHighlight)return;const s=t;e&&(e instanceof qT||e instanceof cO)||s.id===this.lastRollOverId&&(this.removeView(this.view,!1),this.lastRollOverId=-1);break}case Gv.RWREUE_NORMAL_MODE:this._isGameMode=!1;break;case Gv.RWREUE_GAME_MODE:this._isGameMode=!0}this.toggleUpdateReceiver()}_Str_12674(t,e,s,i,r,n){const a=!!n;let o=this.view&&this.view.instance;if(a&&o&&(o instanceof qT||o instanceof cO||(this.removeView(this.view,!1),o=null)),o&&o.userId===t&&o.userName===e&&o.userType===s&&o.roomIndex===i)o&&(o instanceof qT||o instanceof cO)&&o.userId===t&&this.removeView(this.view,!1);else if(this.view&&this.removeView(this.view,!1),!this._isGameMode)if(a)if(n._Str_11453){if(this.isDecorting)return;if(hh.isRunning())return;this.cachedOwnAvatarMenuView||(this.cachedOwnAvatarMenuView=this.createView(cO)),this.view=this.cachedOwnAvatarMenuView,this._ngZone.run(()=>cO.setup(this.view.instance,t,e,s,i,n))}else{this.cachedAvatarMenuView||(this.cachedAvatarMenuView=this.createView(qT)),this.view=this.cachedAvatarMenuView,this._ngZone.run(()=>qT.setup(this.view.instance,t,e,s,i,n));for(const e of this.cachedNameBubbles.values())if(e.instance.userId===t){this.removeView(e,!1);break}}else this.handler.roomEngine.isDecorating||(this.cachedNameView||(this.cachedNameView=this.createView($T)),this.view=this.cachedNameView,this._ngZone.run(()=>{this.handler.container.sessionDataManager.userId===t?$T.setup(this.view.instance,t,e,s,i):$T.setup(this.view.instance,t,e,s,i,!0)}))}createView(t){if(!t)return null;let e=null,s=null;return this._ngZone.run(()=>{const i=this._componentFactoryResolver.resolveComponentFactory(t);e=this.contextsContainer.createComponent(i),s=e.instance}),s&&e?(s.parent=this,s.componentRef=e,e):null}close(){this.removeView(this.view,!1)}removeView(t,e){if(this._isRoomEnteredOwnAvatarHighlight=!1,!t)return;const s=this.contextsContainer.indexOf(t.hostView);-1!==s&&(this.cachedNameView=null,this.cachedOwnAvatarMenuView=null,this.cachedAvatarMenuView=null,t===this.view&&(this.view=null),t instanceof $T&&(this.cachedNameBubbles.delete(t.instance.userName),this.toggleUpdateReceiver()),this._ngZone.run(()=>this.contextsContainer.remove(s)))}toggleUpdateReceiver(){this.view||this.cachedNameBubbles.size>0?um.instance.ticker.add(this.update,this):um.instance.ticker.remove(this.update,this)}update(t){if(this.view){const e=this.view.instance,s=this.messageListener.processWidgetMessage(new MT(MT.RWGOI_MESSAGE_GET_OBJECT_LOCATION,e.userId,e.userType));s&&e.update(s.rectangle,s._Str_9337,t)}for(const e of this.cachedNameBubbles.values()){if(!e)continue;const s=e.instance,i=this.messageListener.processWidgetMessage(new MT(MT.RWGOI_MESSAGE_GET_OBJECT_LOCATION,s.userId,s.userType));i&&s.update(i.rectangle,i._Str_9337,t)}}getOwnRoomObject(){const t=this.handler.container.sessionDataManager.userId,e=this.handler.roomEngine.activeRoomId,s=tt.UNIT,i=this.handler.roomEngine.getTotalObjectsForManager(e,s);let r=0;for(;r<i;){const i=this.handler.roomEngine.getRoomObjectByIndex(e,r,s);if(i){const e=this.handler.roomSession.userDataManager.getUserDataByIndex(i.id);if(e&&e.webID===t)return i}r++}return null}_Str_25716(){this.messageListener.processWidgetMessage(new zv(zv.GET_OWN_CHARACTER_INFO,0,0))}openAvatarEditor(){this._avatarEditorService.loadOwnAvatarInEditor(),this._settingsService.showAvatarEditor()}useSign(t){this.widgetHandler.container.roomSession.sendSignMessage(t)}get getOwnPosture(){const t=this.getOwnRoomObject();if(t){const e=t.model;if(e)return e.getValue(st.FIGURE_POSTURE)}return Lt.POSTURE_STAND}get getCanStandUp(){const t=this.getOwnRoomObject();if(t){const e=t.model;if(e)return e.getValue(st.FIGURE_CAN_STAND_UP)}return!1}get _Str_12708(){const e=this.getOwnRoomObject();if(e){const s=e.model;if(s){const e=s.getValue(st.FIGURE_EFFECT);return e===t._Str_18968||e===t._Str_16970||e===t._Str_18857}}return!1}get _Str_25831(){const e=this.getOwnRoomObject();if(e){const s=e.model;if(s)return s.getValue(st.FIGURE_EFFECT)===t._Str_17951}return!1}get handler(){return this.widgetHandler}get isDecorting(){return this.handler.roomSession.isDecorating}get hasClub(){return this.handler.container.sessionDataManager.clubLevel>=qS._Str_2964}get hasVip(){return this.handler.container.sessionDataManager.clubLevel>=qS._Str_2575}}return t._Str_17951=77,t._Str_18968=29,t._Str_16970=30,t._Str_18857=185,t._Str_18641=5e3,t.\u0275fac=function(e){return new(e||t)(i.Ub(wm),i.Ub(gm),i.Ub(i.l),i.Ub(i.E))},t.\u0275cmp=i.Ob({type:t,selectors:[["nitro-room-avatarinfo-component"]],viewQuery:function(t,e){if(1&t&&i.Wc(lO,!0,i.W),2&t){let t;i.Ac(t=i.kc())&&(e.contextsContainer=t.first)}},features:[i.Db],decls:3,vars:0,consts:[[1,"nitro-room-avatarinfo-component"],["contextsContainer",""]],template:function(t,e){1&t&&(i.Zb(0,"div",0),i.Pc(1,uO,0,0,"ng-template",null,1,i.Qc),i.Yb())},encapsulation:2}),t})(),gO=(()=>{class t extends Fv{constructor(e){super(t.RWFCE_FLOOD_CONTROL),this._seconds=0,this._seconds=e}get seconds(){return this._seconds}}return t.RWFCE_FLOOD_CONTROL="RWFCE_FLOOD_CONTROL",t})();const mO=function(t){return[t]};function pO(t,e){if(1&t){const t=i.ac();i.Zb(0,"div",6),i.Zb(1,"div",7),i.Zb(2,"div",8),i.Zb(3,"div",9),i.jc("click",(function(){i.Ec(t);const s=e.$implicit;return i.lc().selectStyle(s)})),i.Rc(4,"\xa0"),i.Yb(),i.Yb(),i.Yb(),i.Yb()}if(2&t){const t=e.$implicit,s=i.lc();i.Gb(1),i.sc("ngClass",i.vc(4,mO,s.lastSelectedId===t?"bg-primary":"bg-secondary")),i.Gb(2),i.Jb("chat-bubble bubble-",t," w-100")}}const EO=function(t){return{active:t}};let fO=(()=>{class t{constructor(t,e){this.changeDetector=t,this.ngZone=e,this.styleSelected=new i.q,this.showStyles=!1,this.lastSelectedId=0,this.styleIds=[]}ngOnInit(){const t=um.instance.getConfiguration("chat.styles");for(const e of t)e&&(e.minRank>0?um.instance.sessionDataManager.hasSecurity(e.minRank)&&this.styleIds.push(e.styleId):e.isSystemStyle&&um.instance.sessionDataManager.hasSecurity(en.MODERATOR)?this.styleIds.push(e.styleId):um.instance.getConfiguration("chat.styles.disabled").indexOf(e.styleId)>=0||(e.isHcOnly&&um.instance.sessionDataManager.clubLevel>=qS._Str_2964||e.isAmbassadorOnly&&um.instance.sessionDataManager.isAmbassador?this.styleIds.push(e.styleId):e.isHcOnly||e.isAmbassadorOnly||this.styleIds.push(e.styleId)))}ngOnDestroy(){this.hideSelector()}showSelector(){this.showStyles=!0}hideSelector(){this.showStyles=!1}toggleSelector(){this.showStyles?this.hideSelector():this.showSelector()}selectStyle(t){this.lastSelectedId=t,this.styleSelected.emit(t),this.hideSelector()}}return t.\u0275fac=function(e){return new(e||t)(i.Ub(i.i),i.Ub(i.E))},t.\u0275cmp=i.Ob({type:t,selectors:[["nitro-room-chatinput-styleselector-component"]],outputs:{styleSelected:"styleSelected"},decls:6,vars:4,consts:[[1,"nitro-room-chatinput-styleselector-component"],[1,"icon","chatstyles-icon",3,"click"],[1,"nitro-chatstyle-selector","card","p-3",3,"bringToTop","ngClass"],[1,"grid-container","w-100"],[1,"grid-items","grid-3"],["class","d-flex flex-column item-detail justify-content-center align-items-center",4,"ngFor","ngForOf"],[1,"d-flex","flex-column","item-detail","justify-content-center","align-items-center"],[1,"d-flex","detail-info","rounded","justify-content-center","align-items-center",3,"ngClass"],[1,"bubble-container"],[3,"click"]],template:function(t,e){1&t&&(i.Zb(0,"div",0),i.Zb(1,"i",1),i.jc("click",(function(){return e.toggleSelector()})),i.Yb(),i.Zb(2,"div",2),i.Zb(3,"div",3),i.Zb(4,"div",4),i.Pc(5,pO,5,6,"div",5),i.Yb(),i.Yb(),i.Yb(),i.Yb()),2&t&&(i.Gb(2),i.sc("ngClass",i.vc(2,EO,e.showStyles)),i.Gb(3),i.sc("ngForOf",e.styleIds))},directives:[op,o.k,o.l],encapsulation:2}),t})();const SO=["chatInputView"];let bO=(()=>{class t extends kT{constructor(t){super(),this.ngZone=t,this.selectedUsername="",this.floodBlocked=!1,this.lastContent="",this.isTyping=!1,this.typingStartedSent=!1,this.typingTimer=null,this.idleTimer=null,this.currentStyle=-1,this.needsStyleUpdate=!1,this._chatModeIdWhisper=null,this._chatModeIdShout=null,this._chatModeIdSpeak=null,this._maxChatLength=0,this.onKeyDownEvent=this.onKeyDownEvent.bind(this),this.onInputMouseDownEvent=this.onInputMouseDownEvent.bind(this),this.onInputChangeEvent=this.onInputChangeEvent.bind(this),this.onRoomWidgetRoomObjectUpdateEvent=this.onRoomWidgetRoomObjectUpdateEvent.bind(this),this.onRoomWidgetUpdateInfostandUserEvent=this.onRoomWidgetUpdateInfostandUserEvent.bind(this),this.onRoomWidgetChatInputContentUpdateEvent=this.onRoomWidgetChatInputContentUpdateEvent.bind(this),this.onRoomWidgetFloodControlEvent=this.onRoomWidgetFloodControlEvent.bind(this),this.onIdleTimerComplete=this.onIdleTimerComplete.bind(this),this.onTypingTimerComplete=this.onTypingTimerComplete.bind(this)}ngOnInit(){this._chatModeIdWhisper=um.instance.getLocalization("widgets.chatinput.mode.whisper"),this._chatModeIdShout=um.instance.getLocalization("widgets.chatinput.mode.shout"),this._chatModeIdSpeak=um.instance.getLocalization("widgets.chatinput.mode.speak"),this._maxChatLength=um.instance.getConfiguration("chat.input.maxlength",100)}ngAfterViewInit(){this.ngZone.runOutsideAngular(()=>{document.body.addEventListener("keydown",this.onKeyDownEvent),this.inputView&&(this.inputView.addEventListener("mousedown",this.onInputMouseDownEvent),this.inputView.addEventListener("input",this.onInputChangeEvent))})}ngOnDestroy(){this.ngZone.runOutsideAngular(()=>{document.body.removeEventListener("keydown",this.onKeyDownEvent),this.inputView&&(this.inputView.removeEventListener("mousedown",this.onInputMouseDownEvent),this.inputView.removeEventListener("input",this.onInputChangeEvent))})}registerUpdateEvents(t){t&&(t.addEventListener(Vv.OBJECT_DESELECTED,this.onRoomWidgetRoomObjectUpdateEvent),t.addEventListener(TT.PEER,this.onRoomWidgetUpdateInfostandUserEvent),t.addEventListener(RT.RWWCIDE_CHAT_INPUT_CONTENT,this.onRoomWidgetChatInputContentUpdateEvent),t.addEventListener(gO.RWFCE_FLOOD_CONTROL,this.onRoomWidgetFloodControlEvent),super.registerUpdateEvents(t))}unregisterUpdateEvents(t){t&&(t.removeEventListener(Vv.OBJECT_DESELECTED,this.onRoomWidgetRoomObjectUpdateEvent),t.removeEventListener(TT.PEER,this.onRoomWidgetUpdateInfostandUserEvent),t.removeEventListener(RT.RWWCIDE_CHAT_INPUT_CONTENT,this.onRoomWidgetChatInputContentUpdateEvent),t.removeEventListener(gO.RWFCE_FLOOD_CONTROL,this.onRoomWidgetFloodControlEvent))}onRoomWidgetRoomObjectUpdateEvent(t){this.selectedUsername=""}onRoomWidgetUpdateInfostandUserEvent(t){t&&(this.selectedUsername=t.name)}onRoomWidgetChatInputContentUpdateEvent(t){if(t)switch(t._Str_23621){case RT.WHISPER:{const e=um.instance.getLocalization("widgets.chatinput.mode.whisper");return void(this.inputView.value=e+" "+t.userName+" ")}case RT.SHOUT:return}}onRoomWidgetFloodControlEvent(t){}sendChat(t,e,s="",i=0){!this.floodBlocked&&this.messageListener&&(this.chatInputView.nativeElement.parentElement.dataset.value=this.chatInputView.nativeElement.value="",this.messageListener.processWidgetMessage(new Jv(Jv.MESSAGE_CHAT,t,e,s,i)))}onChange(t){}onKeyDownEvent(t){if(!t)return;if(this.anotherInputHasFocus())return;document.activeElement!==(this.chatInputView&&this.chatInputView.nativeElement)&&this.setInputFocus();const e=t.shiftKey;switch(t.keyCode){case 32:return void this.checkSpecialKeywordForInput();case 13:return void this.sendChatFromInputField(e);case 8:if(this.inputView){const t=this.inputView.value.split(" ");t[0]===this._chatModeIdWhisper&&3===t.length&&""===t[2]&&(this.inputView.value="",this.lastContent="")}return;default:return}}onInputMouseDownEvent(t){this.setInputFocus()}onInputChangeEvent(t){const e=t.target;if(!e)return;const s=e.value;s.length?(this.lastContent=s,this.isTyping||(this.isTyping=!0,this.startTypingTimer()),this.startIdleTimer()):(this.isTyping=!1,this.startTypingTimer())}onStyleSelected(t){t!==this.currentStyle&&(this.currentStyle=t,this.needsStyleUpdate=!0)}sendChatFromInputField(t=!1){if(!this.inputView||""===this.inputView.value)return;let e=t?Jv.CHAT_SHOUT:Jv.CHAT_DEFAULT,s=this.inputView.value;const i=s.split(" ");let r="",n="";switch(i[0]){case this._chatModeIdWhisper:e=Jv.CHAT_WHISPER,r=i[1],n=this._chatModeIdWhisper+" "+r+" ",i.shift(),i.shift();break;case this._chatModeIdShout:e=Jv.CHAT_SHOUT,i.shift();break;case this._chatModeIdSpeak:e=Jv.CHAT_DEFAULT,i.shift()}s=i.join(" "),this.typingTimer&&this.resetTypingTimer(),this.idleTimer&&this.resetIdleTimer(),s.length<=this._maxChatLength&&this.sendChat(s,e,r,this.currentStyle),this.isTyping=!1,this.typingStartedSent&&this.sendTypingMessage(),this.typingStartedSent=!1,this.inputView.value=n,this.lastContent=n}sendTypingMessage(){!this.floodBlocked&&this.messageListener&&this.messageListener.processWidgetMessage(new $v(this.isTyping))}anotherInputHasFocus(){const t=document.activeElement;return!(!t||this.chatInputView&&this.chatInputView.nativeElement&&this.chatInputView.nativeElement===t||!(t instanceof HTMLInputElement||t instanceof HTMLTextAreaElement))}setInputFocus(){const t=this.chatInputView&&this.chatInputView.nativeElement;t&&(t.focus(),t.setSelectionRange(2*t.value.length,2*t.value.length))}checkSpecialKeywordForInput(){const t=this.chatInputView&&this.chatInputView.nativeElement||null;t&&""!==t.value&&t.value===this._chatModeIdWhisper&&0!==this.selectedUsername.length&&(t.value=`${t.value} ${this.selectedUsername}`)}startIdleTimer(){this.resetIdleTimer(),this.idleTimer=setTimeout(this.onIdleTimerComplete,1e4)}resetIdleTimer(){this.idleTimer&&(clearTimeout(this.idleTimer),this.idleTimer=null)}onIdleTimerComplete(){this.isTyping&&(this.typingStartedSent=!1),this.isTyping=!1,this.sendTypingMessage()}startTypingTimer(){this.resetTypingTimer(),this.typingTimer=setTimeout(this.onTypingTimerComplete,1e3)}resetTypingTimer(){this.typingTimer&&(clearTimeout(this.typingTimer),this.typingTimer=null)}onTypingTimerComplete(){this.isTyping&&(this.typingStartedSent=!0),this.sendTypingMessage()}get inputMaxLength(){return this._maxChatLength}get inputView(){return this.chatInputView&&this.chatInputView.nativeElement||null}get handler(){return this.widgetHandler}}return t.\u0275fac=function(e){return new(e||t)(i.Ub(i.E))},t.\u0275cmp=i.Ob({type:t,selectors:[["nitro-room-chatinput-component"]],viewQuery:function(t,e){if(1&t&&i.Wc(SO,!0),2&t){let t;i.Ac(t=i.kc())&&(e.chatInputView=t.first)}},features:[i.Db],decls:7,vars:4,consts:[[1,"nitro-room-chatinput-component"],[1,"chatinput-container"],[1,"input-sizer"],["type","text",1,"chat-input",3,"placeholder","maxLength","input"],["chatInputView",""],[3,"styleSelected"]],template:function(t,e){if(1&t){const t=i.ac();i.Zb(0,"div",0),i.Zb(1,"div",1),i.Zb(2,"div",2),i.Zb(3,"input",3,4),i.jc("input",(function(){i.Ec(t);const e=i.Bc(4);return e.parentElement.dataset.value=e.value})),i.mc(5,"translate"),i.Yb(),i.Yb(),i.Yb(),i.Zb(6,"nitro-room-chatinput-styleselector-component",5),i.jc("styleSelected",(function(t){return e.onStyleSelected(t)})),i.Yb(),i.Yb()}2&t&&(i.Gb(3),i.tc("placeholder",i.nc(5,2,"widgets.chatinput.default")),i.sc("maxLength",e.inputMaxLength))},directives:[fO],pipes:[Ep],encapsulation:2}),t})();function RO(t,e){if(1&t&&(i.Zb(0,"p",11),i.Rc(1),i.Yb()),2&t){const t=i.lc().$implicit;i.Gb(1),i.Sc(t.id)}}function IO(t,e){if(1&t){const t=i.ac();i.Zb(0,"li",10),i.jc("click",(function(){i.Ec(t);const s=e.$implicit;return i.lc(2).selectItem(s)})),i.Zb(1,"p",11),i.Rc(2),i.Yb(),i.Pc(3,RO,2,1,"p",12),i.Yb()}if(2&t){const t=e.$implicit,s=i.lc(2);i.Gb(2),i.Sc(t.name),i.Gb(1),i.sc("ngIf","widget.chooser.furni.title"===s.title)}}function vO(t,e){if(1&t){const t=i.ac();i.Zb(0,"div",1),i.Zb(1,"div",2),i.Zb(2,"h6",3),i.Rc(3),i.mc(4,"translate"),i.Yb(),i.Zb(5,"button",4),i.jc("click",(function(){return i.Ec(t),i.lc().hide()})),i.Vb(6,"i",5),i.Yb(),i.Yb(),i.Zb(7,"div",6),i.Zb(8,"perfect-scrollbar",7),i.Zb(9,"ul",8),i.Pc(10,IO,4,2,"li",9),i.Yb(),i.Yb(),i.Yb(),i.Yb()}if(2&t){const t=i.lc();i.Gb(3),i.Sc(i.nc(4,2,t.title)),i.Gb(7),i.sc("ngForOf",t.items)}}let TO=(()=>{class t extends kT{constructor(t){super(),this._ngZone=t,this._visible=!1,this._items=[],this._title=null,this._timeout=null}ngOnDestroy(){this.clearTimeout()}hide(){this._visible=!1}selectItem(t){t&&this.items&&this.items.length&&this._ngZone.runOutsideAngular(()=>this.messageListener.processWidgetMessage(new zv(zv.SELECT_OBJECT,t.id,t.category)))}clearTimeout(){this._timeout&&(clearTimeout(this._timeout),this._timeout=null)}get visible(){return this._visible}set visible(t){this._visible=t}get title(){return this._title}set title(t){this._title=t}get items(){return this._items}set items(t){this._items=t}}return t.\u0275fac=function(e){return new(e||t)(i.Ub(i.E))},t.\u0275cmp=i.Ob({type:t,selectors:[["nitro-room-chooser-base-component"]],features:[i.Db],decls:1,vars:1,consts:[["class","nitro-chooser-component card",3,"bringToTop","draggable",4,"ngIf"],[1,"nitro-chooser-component","card",3,"bringToTop","draggable"],[1,"drag-handler","d-flex","justify-content-between","align-items-center","px-3","pt-3"],[1,"m-0"],["type","button",1,"close",3,"click"],[1,"fas","fa-times"],[1,"d-flex","p-3"],[2,"min-height","180px","max-height","180px","height","180px"],[1,"list-group"],["class","d-flex justify-content-between align-items-center bg-secondary rounded mb-1 px-2 py-1 chooser-item",3,"click",4,"ngFor","ngForOf"],[1,"d-flex","justify-content-between","align-items-center","bg-secondary","rounded","mb-1","px-2","py-1","chooser-item",3,"click"],[1,"mb-0"],["class","mb-0",4,"ngIf"]],template:function(t,e){1&t&&i.Pc(0,vO,11,4,"div",0),2&t&&i.sc("ngIf",e.visible)},directives:[o.m,op,dp,u.b,o.l],pipes:[Ep],encapsulation:2}),t})();function OO(t,e){if(1&t&&(i.Zb(0,"p",11),i.Rc(1),i.Yb()),2&t){const t=i.lc().$implicit;i.Gb(1),i.Sc(t.id)}}function AO(t,e){if(1&t){const t=i.ac();i.Zb(0,"li",10),i.jc("click",(function(){i.Ec(t);const s=e.$implicit;return i.lc(2).selectItem(s)})),i.Zb(1,"p",11),i.Rc(2),i.Yb(),i.Pc(3,OO,2,1,"p",12),i.Yb()}if(2&t){const t=e.$implicit,s=i.lc(2);i.Gb(2),i.Sc(t.name),i.Gb(1),i.sc("ngIf","widget.chooser.furni.title"===s.title)}}function yO(t,e){if(1&t){const t=i.ac();i.Zb(0,"div",1),i.Zb(1,"div",2),i.Zb(2,"h6",3),i.Rc(3),i.mc(4,"translate"),i.Yb(),i.Zb(5,"button",4),i.jc("click",(function(){return i.Ec(t),i.lc().hide()})),i.Vb(6,"i",5),i.Yb(),i.Yb(),i.Zb(7,"div",6),i.Zb(8,"perfect-scrollbar",7),i.Zb(9,"ul",8),i.Pc(10,AO,4,2,"li",9),i.Yb(),i.Yb(),i.Yb(),i.Yb()}if(2&t){const t=i.lc();i.Gb(3),i.Sc(i.nc(4,2,t.title)),i.Gb(7),i.sc("ngForOf",t.items)}}let CO=(()=>{class t extends TO{constructor(t){super(t),this._ngZone=t,this._title="widget.chooser.furni.title",this.onRoomWidgetChooserContentEvent=this.onRoomWidgetChooserContentEvent.bind(this),this.onRoomWidgetRoomObjectUpdateEvent=this.onRoomWidgetRoomObjectUpdateEvent.bind(this)}registerUpdateEvents(t){t&&(t.addEventListener(oT.RWCCE_FURNI_CHOOSER_CONTENT,this.onRoomWidgetChooserContentEvent),t.addEventListener(Vv.FURNI_ADDED,this.onRoomWidgetRoomObjectUpdateEvent),t.addEventListener(Vv.FURNI_REMOVED,this.onRoomWidgetRoomObjectUpdateEvent),super.registerUpdateEvents(t))}unregisterUpdateEvents(t){t&&(t.removeEventListener(oT.RWCCE_FURNI_CHOOSER_CONTENT,this.onRoomWidgetChooserContentEvent),t.removeEventListener(Vv.FURNI_ADDED,this.onRoomWidgetRoomObjectUpdateEvent),t.removeEventListener(Vv.FURNI_REMOVED,this.onRoomWidgetRoomObjectUpdateEvent),super.unregisterUpdateEvents(t))}onRoomWidgetChooserContentEvent(t){t&&this._ngZone.run(()=>{this._items=t.items,this.visible=!0})}onRoomWidgetRoomObjectUpdateEvent(t){t&&this.visible&&(this.clearTimeout(),this._timeout=setTimeout(()=>{this.messageListener.processWidgetMessage(new tT(tT.RWRWM_FURNI_CHOOSER))},100))}}return t.\u0275fac=function(e){return new(e||t)(i.Ub(i.E))},t.\u0275cmp=i.Ob({type:t,selectors:[["nitro-room-chooser-furni"]],features:[i.Db],decls:1,vars:1,consts:[["class","nitro-chooser-component card",3,"bringToTop","draggable",4,"ngIf"],[1,"nitro-chooser-component","card",3,"bringToTop","draggable"],[1,"drag-handler","d-flex","justify-content-between","align-items-center","px-3","pt-3"],[1,"m-0"],["type","button",1,"close",3,"click"],[1,"fas","fa-times"],[1,"d-flex","p-3"],[2,"min-height","180px","max-height","180px","height","180px"],[1,"list-group"],["class","d-flex justify-content-between align-items-center bg-secondary rounded mb-1 px-2 py-1 chooser-item",3,"click",4,"ngFor","ngForOf"],[1,"d-flex","justify-content-between","align-items-center","bg-secondary","rounded","mb-1","px-2","py-1","chooser-item",3,"click"],[1,"mb-0"],["class","mb-0",4,"ngIf"]],template:function(t,e){1&t&&i.Pc(0,yO,11,4,"div",0),2&t&&i.sc("ngIf",e.visible)},directives:[o.m,op,dp,u.b,o.l],pipes:[Ep],encapsulation:2}),t})();function MO(t,e){if(1&t&&(i.Zb(0,"p",11),i.Rc(1),i.Yb()),2&t){const t=i.lc().$implicit;i.Gb(1),i.Sc(t.id)}}function DO(t,e){if(1&t){const t=i.ac();i.Zb(0,"li",10),i.jc("click",(function(){i.Ec(t);const s=e.$implicit;return i.lc(2).selectItem(s)})),i.Zb(1,"p",11),i.Rc(2),i.Yb(),i.Pc(3,MO,2,1,"p",12),i.Yb()}if(2&t){const t=e.$implicit,s=i.lc(2);i.Gb(2),i.Sc(t.name),i.Gb(1),i.sc("ngIf","widget.chooser.furni.title"===s.title)}}function NO(t,e){if(1&t){const t=i.ac();i.Zb(0,"div",1),i.Zb(1,"div",2),i.Zb(2,"h6",3),i.Rc(3),i.mc(4,"translate"),i.Yb(),i.Zb(5,"button",4),i.jc("click",(function(){return i.Ec(t),i.lc().hide()})),i.Vb(6,"i",5),i.Yb(),i.Yb(),i.Zb(7,"div",6),i.Zb(8,"perfect-scrollbar",7),i.Zb(9,"ul",8),i.Pc(10,DO,4,2,"li",9),i.Yb(),i.Yb(),i.Yb(),i.Yb()}if(2&t){const t=i.lc();i.Gb(3),i.Sc(i.nc(4,2,t.title)),i.Gb(7),i.sc("ngForOf",t.items)}}let wO=(()=>{class t extends TO{constructor(t){super(t),this._ngZone=t,this.title="widget.chooser.user.title",this.onRoomWidgetChooserContentEvent=this.onRoomWidgetChooserContentEvent.bind(this),this.onRoomWidgetRoomObjectUpdateEvent=this.onRoomWidgetRoomObjectUpdateEvent.bind(this)}registerUpdateEvents(t){null!=t&&(t.addEventListener(oT.RWCCE_USER_CHOOSER_CONTENT,this.onRoomWidgetChooserContentEvent),t.addEventListener(Vv.USER_REMOVED,this.onRoomWidgetRoomObjectUpdateEvent.bind(this)),t.addEventListener(Vv.USER_ADDED,this.onRoomWidgetRoomObjectUpdateEvent.bind(this)),super.registerUpdateEvents(t))}unregisterUpdateEvents(t){null!=t&&(t.removeEventListener(oT.RWCCE_USER_CHOOSER_CONTENT,this.onRoomWidgetChooserContentEvent),t.removeEventListener(Vv.USER_REMOVED,this.onRoomWidgetRoomObjectUpdateEvent.bind(this)),t.removeEventListener(Vv.USER_ADDED,this.onRoomWidgetRoomObjectUpdateEvent.bind(this)),super.unregisterUpdateEvents(t))}onRoomWidgetChooserContentEvent(t){t&&this._ngZone.run(()=>{this._items=t.items,this.visible=!0})}onRoomWidgetRoomObjectUpdateEvent(t){this.visible&&(this.clearTimeout(),this._timeout=setTimeout(()=>{this.messageListener.processWidgetMessage(new tT(tT.RWRWM_USER_CHOOSER))},100))}}return t.\u0275fac=function(e){return new(e||t)(i.Ub(i.E))},t.\u0275cmp=i.Ob({type:t,selectors:[["nitro-room-chooser-user"]],features:[i.Db],decls:1,vars:1,consts:[["class","nitro-chooser-component card",3,"bringToTop","draggable",4,"ngIf"],[1,"nitro-chooser-component","card",3,"bringToTop","draggable"],[1,"drag-handler","d-flex","justify-content-between","align-items-center","px-3","pt-3"],[1,"m-0"],["type","button",1,"close",3,"click"],[1,"fas","fa-times"],[1,"d-flex","p-3"],[2,"min-height","180px","max-height","180px","height","180px"],[1,"list-group"],["class","d-flex justify-content-between align-items-center bg-secondary rounded mb-1 px-2 py-1 chooser-item",3,"click",4,"ngFor","ngForOf"],[1,"d-flex","justify-content-between","align-items-center","bg-secondary","rounded","mb-1","px-2","py-1","chooser-item",3,"click"],[1,"mb-0"],["class","mb-0",4,"ngIf"]],template:function(t,e){1&t&&i.Pc(0,NO,11,4,"div",0),2&t&&i.sc("ngIf",e.visible)},directives:[o.m,op,dp,u.b,o.l],pipes:[Ep],encapsulation:2}),t})();function UO(t,e){1&t&&i.Vb(0,"div",17)}function LO(t,e){if(1&t){const t=i.ac();i.Zb(0,"div",1),i.Pc(1,UO,1,0,"div",2),i.Zb(2,"div",3),i.Vb(3,"div",4),i.Zb(4,"div",5),i.Zb(5,"div",6),i.Rc(6),i.mc(7,"translate"),i.Yb(),i.Zb(8,"div",7),i.jc("click",(function(){return i.Ec(t),i.lc().hide()})),i.Vb(9,"i",8),i.Yb(),i.Yb(),i.Yb(),i.Zb(10,"div",9),i.Zb(11,"div",10),i.Zb(12,"div",11),i.Zb(13,"ngx-slider",12),i.jc("ngModelChange",(function(e){return i.Ec(t),i.lc().heightRange=e}))("mouseup",(function(){return i.Ec(t),i.lc().onHeightChange()})),i.Yb(),i.Yb(),i.Zb(14,"div",13),i.Zb(15,"p",14),i.Rc(16),i.mc(17,"translate"),i.Yb(),i.Zb(18,"input",15),i.jc("ngModelChange",(function(e){return i.Ec(t),i.lc().heightInput=e}))("keydown.enter",(function(){return i.Ec(t),i.lc().onHeightChange()})),i.Yb(),i.Zb(19,"button",16),i.jc("click",(function(){return i.Ec(t),i.lc().placeAboveStack()})),i.Rc(20),i.mc(21,"translate"),i.Yb(),i.Zb(22,"button",16),i.jc("click",(function(){return i.Ec(t),i.lc().placeAtFloor()})),i.Rc(23),i.mc(24,"translate"),i.Yb(),i.Yb(),i.Yb(),i.Yb(),i.Yb()}if(2&t){const t=i.lc();i.Gb(1),i.sc("ngIf",t.isLoading),i.Gb(5),i.Sc(i.nc(7,10,"widget.custom.stack.height.title")),i.Gb(7),i.sc("options",t.sliderOptions)("ngModel",t.heightRange),i.Gb(3),i.Sc(i.nc(17,12,"widget.custom.stack.height.text")),i.Gb(2),i.sc("ngModel",t.heightInput)("min",t.minHeight)("max",t.maxHeight),i.Gb(2),i.Sc(i.nc(21,14,"furniture.above.stack")),i.Gb(3),i.Sc(i.nc(24,16,"furniture.floor.level"))}}let PO=(()=>{class t extends kT{constructor(t){super(),this._ngZone=t,this._visible=!1,this._furniId=-1,this._height=0,this._heightRange="0",this._heightInput="0"}open(t,e){this._ngZone.run(()=>{this._furniId=t,this._height=e,this._visible=!0,this.setHeight(e,!0)})}update(t,e){this._ngZone.run(()=>this._furniId===t&&this.setHeight(e,!0))}hide(){this._visible=!1,this._furniId=-1,this._height=0}onHeightChange(){const t=this._heightInput;let e=0;e=null===t||""===t?this._height:parseFloat(t),this.setHeight(e)}setHeight(e,s=!1){e=Math.abs(e),s||e>t.MAX_HEIGHT&&(e=t.MAX_HEIGHT),this._height=parseFloat(e.toFixed(2)),this._heightRange=this._height.toString(),this._heightInput=this._height.toString(),s||this.sendUpdate(100*this._height)}placeAboveStack(){this.sendUpdate(-100)}placeAtFloor(){this.sendUpdate(0)}sendUpdate(t){this.widgetHandler.container.connection.send(new m_(this._furniId,~~t))}get handler(){return this.widgetHandler}get visible(){return this._visible}set visible(t){this._visible=t}get furniId(){return this._furniId}get height(){return this._height}get heightInput(){return this._heightInput}set heightInput(t){null===t||""===t||isNaN(t)||(this._heightInput=t)}get heightRange(){return this._heightRange}set heightRange(t){this._heightRange=t,this.heightInput=this.heightRange}get minHeight(){return 0}get maxHeight(){return t.MAX_HEIGHT}get sliderOptions(){return{floor:0,ceil:t.MAX_RANGE_HEIGHT,step:t.STEP_VALUE,hidePointerLabels:!0,hideLimitLabels:!0,vertical:!0}}}return t.MAX_HEIGHT=40,t.MAX_RANGE_HEIGHT=10,t.STEP_VALUE=.01,t.\u0275fac=function(e){return new(e||t)(i.Ub(i.E))},t.\u0275cmp=i.Ob({type:t,selectors:[["nitro-room-furniture-customstackheight-component"]],features:[i.Db],decls:1,vars:1,consts:[["dragHandle",".card-header","class","card nitro-room-furniture-customstackheight-component",3,"bringToTop","draggable",4,"ngIf"],["dragHandle",".card-header",1,"card","nitro-room-furniture-customstackheight-component",3,"bringToTop","draggable"],["class","card-loading-overlay",4,"ngIf"],[1,"card-header-container"],[1,"card-header-overlay"],[1,"card-header"],[1,"header-title"],[1,"header-close",3,"click"],[1,"fas","fa-times"],[1,"card-body"],[1,"d-flex"],[1,"m-2","custom-slider"],["name","heightRange",3,"options","ngModel","ngModelChange","mouseup"],[1,"p-2","flex-grow-1"],[1,"text-justify"],["name","heightInput","type","number",1,"form-control","form-control-sm",3,"ngModel","min","max","ngModelChange","keydown.enter"],["type","button",1,"btn","btn-green",3,"click"],[1,"card-loading-overlay"]],template:function(t,e){1&t&&i.Pc(0,LO,25,18,"div",0),2&t&&i.sc("ngIf",e.visible)},directives:[o.m,op,dp,a.b,c.j,c.l,c.n,c.b],pipes:[Ep],encapsulation:2}),t})();function xO(t,e){1&t&&i.Vb(0,"div",14)}function FO(t,e){if(1&t){const t=i.ac();i.Zb(0,"div",1),i.Pc(1,xO,1,0,"div",2),i.Zb(2,"div",3),i.Vb(3,"div",4),i.Zb(4,"div",5),i.Zb(5,"div",6),i.Rc(6),i.mc(7,"translate"),i.Yb(),i.Zb(8,"div",7),i.jc("click",(function(){return i.Ec(t),i.lc().hide()})),i.Vb(9,"i",8),i.Yb(),i.Yb(),i.Yb(),i.Zb(10,"div",9),i.Zb(11,"div",10),i.Zb(12,"div",11),i.Rc(13," data "),i.Yb(),i.Yb(),i.Zb(14,"div",10),i.Zb(15,"div",12),i.Zb(16,"button",13),i.Rc(17),i.mc(18,"translate"),i.Yb(),i.Yb(),i.Yb(),i.Yb(),i.Yb()}if(2&t){const t=i.lc();i.Gb(1),i.sc("ngIf",t.isLoading),i.Gb(5),i.Sc(i.nc(7,3,"widget.dimmer.title")),i.Gb(11),i.Sc(i.nc(18,5,"widget.dimmer.button.apply"))}}let GO=(()=>{class t extends kT{constructor(t){super(),this._ngZone=t,this._visible=!1,this._dimmerState=0,this._effectId=0,this._color=16777215,this._brightness=255,this.onDimmerPresetsEvent=this.onDimmerPresetsEvent.bind(this),this.onDimmerHideEvent=this.onDimmerHideEvent.bind(this),this.onDimmerStateEvent=this.onDimmerStateEvent.bind(this)}registerUpdateEvents(t){t&&(t.addEventListener(uT.RWDUE_PRESETS,this.onDimmerPresetsEvent),t.addEventListener(uT.RWDUE_HIDE,this.onDimmerHideEvent),t.addEventListener(hT.RWDSUE_DIMMER_STATE,this.onDimmerStateEvent),super.registerUpdateEvents(t))}unregisterUpdateEvents(t){t&&(t.removeEventListener(uT.RWDUE_PRESETS,this.onDimmerPresetsEvent),t.removeEventListener(uT.RWDUE_HIDE,this.onDimmerHideEvent),t.removeEventListener(hT.RWDSUE_DIMMER_STATE,this.onDimmerStateEvent),super.unregisterUpdateEvents(t))}onDimmerPresetsEvent(t){}onDimmerHideEvent(t){}onDimmerStateEvent(t){this._dimmerState=t.state,this._effectId=t._Str_6815,this._color=t.color,this._brightness=t._Str_5123,this.messageListener.processWidgetMessage(new gT(this._color,this._brightness,2===this._effectId))}get handler(){return this.widgetHandler}get visible(){return this._visible}set visible(t){this._visible=t}}return t.\u0275fac=function(e){return new(e||t)(i.Ub(i.E))},t.\u0275cmp=i.Ob({type:t,selectors:[["nitro-room-furniture-dimmer-component"]],features:[i.Db],decls:1,vars:1,consts:[["dragHandle",".card-header","class","card nitro-room-furniture-dimmer-component",3,"bringToTop","draggable",4,"ngIf"],["dragHandle",".card-header",1,"card","nitro-room-furniture-dimmer-component",3,"bringToTop","draggable"],["class","card-loading-overlay",4,"ngIf"],[1,"card-header-container"],[1,"card-header-overlay"],[1,"card-header"],[1,"header-title"],[1,"header-close",3,"click"],[1,"fas","fa-times"],[1,"card-body"],[1,"row"],[1,"col-12"],[1,"col-12","justify-space-between"],["type","button",1,"btn","btn-primary"],[1,"card-loading-overlay"]],template:function(t,e){1&t&&i.Pc(0,FO,19,7,"div",0),2&t&&i.sc("ngIf",e.visible)},directives:[o.m,op,dp],pipes:[Ep],encapsulation:2}),t})();function VO(t,e){if(1&t){const t=i.ac();i.Zb(0,"div",1),i.Zb(1,"div",2),i.Zb(2,"h6",3),i.Rc(3),i.mc(4,"translate"),i.Yb(),i.Zb(5,"button",4),i.jc("click",(function(){return i.Ec(t),i.lc().hide()})),i.Vb(6,"i",5),i.Yb(),i.Yb(),i.Zb(7,"div",6),i.Zb(8,"p",7),i.Rc(9),i.Yb(),i.Zb(10,"div",8),i.Vb(11,"hr",9),i.Zb(12,"div",10),i.Zb(13,"p",11),i.Rc(14),i.Yb(),i.Zb(15,"p",11),i.Rc(16),i.Yb(),i.Yb(),i.Yb(),i.Yb(),i.Yb()}if(2&t){const t=i.lc();i.Jb("nitro-trophy card trophy-",t.color,""),i.Gb(3),i.Sc(i.nc(4,7,"widget.furni.trophy.title")),i.Gb(6),i.Sc(t.message),i.Gb(5),i.Sc(t.ownerName),i.Gb(2),i.Sc(t.date)}}let YO=(()=>{class t extends kT{constructor(t){super(),this._ngZone=t,this._visible=!1,this._color=null,this._ownerName=null,this._date=null,this._message=null,this._viewType=null,this.onRoomWidgetTrophyUpdateEvent=this.onRoomWidgetTrophyUpdateEvent.bind(this)}registerUpdateEvents(t){t&&(t.addEventListener(PT.TROPHY_DATA,this.onRoomWidgetTrophyUpdateEvent),super.registerUpdateEvents(t))}unregisterUpdateEvents(t){t&&(t.removeEventListener(PT.TROPHY_DATA,this.onRoomWidgetTrophyUpdateEvent),super.unregisterUpdateEvents(t))}onRoomWidgetTrophyUpdateEvent(t){t&&this._ngZone.run(()=>{this._visible=!0,this._color=t.color-1,this._ownerName=t.name,this._date=t.date,this._message=t.message,this._viewType=t.viewType,(this._color<0||this._color>2)&&(this._color=0)})}hide(){this._visible=!1}get handler(){return this.widgetHandler}get visible(){return this._visible}set visible(t){this._visible=t}get color(){return this._color}get ownerName(){return this._ownerName}get date(){return this._date}get message(){return this._message}}return t.\u0275fac=function(e){return new(e||t)(i.Ub(i.E))},t.\u0275cmp=i.Ob({type:t,selectors:[["nitro-room-furniture-trophy-compontent"]],features:[i.Db],decls:1,vars:1,consts:[["noMemory","true",3,"bringToTop","draggable","class",4,"ngIf"],["noMemory","true",3,"bringToTop","draggable"],[1,"drag-handler","d-flex","justify-content-between","align-items-center","px-3","pt-3"],[1,"m-0"],["type","button",1,"close",3,"click"],[1,"fas","fa-times"],[1,"p-3","d-flex","flex-column"],[1,"p-0","trophy-message"],[1,"mt-auto"],[1,"mb-1"],[1,"d-flex","justify-content-between","align-items-center"],[1,"p-0","mb-0"]],template:function(t,e){1&t&&i.Pc(0,VO,17,9,"div",0),2&t&&i.sc("ngIf",e.visible)},directives:[o.m,op,dp],pipes:[Ep],encapsulation:2}),t})(),kO=(()=>{class t extends Fv{constructor(e,s,i,r,n,a,o,c,_,h){super(t.PET_INFO),this._Str_6689=e,this._Str_20932=s,this._name=i,this._id=r,this._image=n,this._Str_10121=a,this._ownerId=o,this._ownerName=c,this._Str_2775=_,this._unknownRarityLevel=h}get name(){return this._name}get image(){return this._image}get id(){return this._id}get _Str_4355(){return this._Str_6689}get _Str_14767(){return this._Str_20932}get _Str_5175(){return this._Str_10121}get ownerId(){return this._ownerId}get ownerName(){return this._ownerName}get _Str_2707(){return this._Str_2775}get unknownRarityLevel(){return this._unknownRarityLevel}get level(){return this._level}set level(t){this._level=t}get maximumLevel(){return this._maximumLevel}set maximumLevel(t){this._maximumLevel=t}get experience(){return this._experience}set experience(t){this._experience=t}get levelExperienceGoal(){return this._levelExperienceGoal}set levelExperienceGoal(t){this._levelExperienceGoal=t}get energy(){return this._energy}set energy(t){this._energy=t}get maximumEnergy(){return this._maximumEnergy}set maximumEnergy(t){this._maximumEnergy=t}get happyness(){return this._happyness}set happyness(t){this._happyness=t}get maximumHappyness(){return this._maximumHappyness}set maximumHappyness(t){this._maximumHappyness=t}get _Str_2985(){return this._Str_3973}set _Str_2985(t){this._Str_3973=t}get _Str_5114(){return this._Str_11149}set _Str_5114(t){this._Str_11149=t}get respect(){return this._respect}set respect(t){this._respect=t}get age(){return this._age}set age(t){this._age=t}get saddle(){return this._saddle}set saddle(t){this._saddle=t}get rider(){return this._rider}set rider(t){this._rider=t}get breedable(){return this._breedable}set breedable(t){this._breedable=t}get _Str_3307(){return this._Str_4460}set _Str_3307(t){this._Str_4460=t}get publiclyRideable(){return this._publiclyRideable}set publiclyRideable(t){this._publiclyRideable=t}get fullyGrown(){return this._fullyGrown}set fullyGrown(t){this._fullyGrown=t}get dead(){return this._dead}set dead(t){this._dead=t}get rarityLevel(){return this._rarityLevel}set rarityLevel(t){this._rarityLevel=t}get maximumTimeToLive(){return this._maximumTimeToLive}set maximumTimeToLive(t){this._maximumTimeToLive=t}get remainingTimeToLive(){return this._remainingTimeToLive}set remainingTimeToLive(t){this._remainingTimeToLive=t}get remainingGrowTime(){return this._remainingGrowTime}set remainingGrowTime(t){this._remainingGrowTime=t}get publiclyBreedable(){return this._publiclyBreedable}set publiclyBreedable(t){this._publiclyBreedable=t}}return t.PET_INFO="RWPIUE_PET_INFO",t})();class jO{constructor(){this._id=0,this._category=0,this._name="",this._description="",this._imageUrl="",this._purchaseOfferId=-1,this._extraParam="",this._stuffData=null,this._ownerId=0,this._ownerName="",this._rentOfferId=-1,this._availableForBuildersClub=!1}get id(){return this._id}set id(t){this._id=t}get category(){return this._category}set category(t){this._category=t}get name(){return this._name}set name(t){this._name=t}get description(){return this._description}set description(t){this._description=t}get imageUrl(){return this._imageUrl}set imageUrl(t){this._imageUrl=t}get purchaseOfferId(){return this._purchaseOfferId}set purchaseOfferId(t){this._purchaseOfferId=t}get extraParam(){return this._extraParam}set extraParam(t){this._extraParam=t}get stuffData(){return this._stuffData}set stuffData(t){this._stuffData=t}set groupId(t){this._groupId=t}get groupId(){return this._groupId}get ownerId(){return this._ownerId}set ownerId(t){this._ownerId=t}get ownerName(){return this._ownerName}set ownerName(t){this._ownerName=t}get rentOfferId(){return this._rentOfferId}set rentOfferId(t){this._rentOfferId=t}get availableForBuildersClub(){return this._availableForBuildersClub}set availableForBuildersClub(t){this._availableForBuildersClub=t}populate(t){this.id=t.id,this.category=t.category,this.name=t.name,this.description=t.description,this.imageUrl=t.image.src,this.purchaseOfferId=t.purchaseOfferId,this.extraParam=t.extraParam,this.stuffData=t.stuffData,this.groupId=t.groupId,this.ownerName=t.ownerName,this.ownerId=t.ownerId,this.rentOfferId=t.rentOfferId,this.availableForBuildersClub=t.availableForBuildersClub}}class BO{constructor(){this._name="",this._petId=-1}get name(){return this._name}get id(){return this._petId}get type(){return this._type}get race(){return this._race}get image(){return this._image}get _Str_5175(){return this._isOwnPet}get _Str_2481(){return this._ownerId}get ownerName(){return this._ownerName}get _Str_5114(){return this._canRemovePet}get age(){return this._age}get unknownRarityLevel(){return this._breedId}get _Str_3307(){return this._skillTresholds}get publiclyRideable(){return this._accessRights}get level(){return this._level}get _Str_4276(){return this._levelMax}get experience(){return this._experience}get _Str_4095(){return this._experienceMax}get energy(){return this._energy}get _Str_3966(){return this._energyMax}get happyness(){return this._nutrition}get _Str_4448(){return this._nutritionMax}get _Str_6943(){return this._petRespect}get _Str_2707(){return this._roomIndex}get rarityLevel(){return this._rarityLevel}get maximumTimeToLive(){return this._maxWellBeingSeconds}get remainingTimeToLive(){return this._remainingWellBeingSeconds}get remainingGrowTime(){return this._remainingGrowingSeconds}get publiclyBreedable(){return this._hasBreedingPermission}populate(t){this._name=t.name,this._petId=t.id,this._type=t._Str_4355,this._race=t._Str_14767,this._image=t.image,this._isOwnPet=t._Str_5175,this._ownerId=t.ownerId,this._ownerName=t.ownerName,this._canRemovePet=t._Str_5114,this._level=t.level,this._levelMax=t.maximumLevel,this._experience=t.experience,this._experienceMax=t.levelExperienceGoal,this._energy=t.energy,this._energyMax=t.maximumEnergy,this._nutrition=t.happyness,this._nutritionMax=t.maximumHappyness,this._petRespect=t.respect,this._roomIndex=t._Str_2707,this._age=t.age,this._breedId=t.unknownRarityLevel,this._skillTresholds=t._Str_3307,this._accessRights=t.publiclyRideable,this._maxWellBeingSeconds=t.maximumTimeToLive,this._remainingWellBeingSeconds=t.remainingTimeToLive,this._remainingGrowingSeconds=t.remainingGrowTime,this._rarityLevel=t.rarityLevel,this._hasBreedingPermission=t.publiclyBreedable}}class HO{constructor(){this._id=0,this._name="",this._figure="",this._motto="",this._badges=[],this._carryItem=0,this._roomIndex=-1,this._ownerId=-1,this._ownerName="",this._amIOwner=!1,this._amIAnyRoomController=!1,this._botSkills=[]}get id(){return this._id}set id(t){this._id=t}get name(){return this._name}set name(t){this._name=t}get figure(){return this._figure}set figure(t){this._figure=t}get motto(){return this._motto}set motto(t){this._motto=t}get badges(){return this._badges.slice()}set badges(t){this._badges=t}get carryItem(){return this._carryItem}set carryItem(t){this._carryItem=t}get roomIndex(){return this._roomIndex}set roomIndex(t){this._roomIndex=t}get ownerId(){return this._ownerId}set ownerId(t){this._ownerId=t}get ownerName(){return this._ownerName}set ownerName(t){this._ownerName=t}get amIOwner(){return this._amIOwner}set amIOwner(t){this._amIOwner=t}get amIAnyRoomController(){return this._amIAnyRoomController}set amIAnyRoomController(t){this._amIAnyRoomController=t}get botSkills(){return this._botSkills.slice()}set botSkills(t){this._botSkills=t}populate(t){this.id=t.id,this.name=t.name,this.figure=t.figure,this.motto=t.motto,this.badges=t.badges,this.carryItem=t.carryId,this.roomIndex=t.roomIndex,this.ownerId=t.ownerId,this.ownerName=t.ownerName,this.amIOwner=t._Str_3246,this.amIAnyRoomController=t._Str_3529,this.botSkills=t.botSkills}}class WO{constructor(){this._id=0,this._name="",this._figure="",this._motto="",this._badges=[],this._groupId=0,this._groupName="",this._groupBadgeId="",this._activityPoints=0,this._respectLeft=0,this._petRespectLeft=0,this._carryItem=0,this._roomIndex=-1,this._type=""}get id(){return this._id}set id(t){this._id=t}get name(){return this._name}set name(t){this._name=t}get figure(){return this._figure}set figure(t){this._figure=t}get motto(){return this._motto}set motto(t){this._motto=t}get badges(){return this._badges.slice()}set badges(t){this._badges=t}get groupId(){return this._groupId}set groupId(t){this._groupId=t}get groupName(){return this._groupName}set groupName(t){this._groupName=t}get groupBadgeId(){return this._groupBadgeId}set groupBadgeId(t){this._groupBadgeId=t}get activityPoints(){return this._activityPoints}set activityPoints(t){this._activityPoints=t}get respectLeft(){return this._respectLeft}set respectLeft(t){this._respectLeft=t}get petRespectLeft(){return this._petRespectLeft}set petRespectLeft(t){this._petRespectLeft=t}get carryItem(){return this._carryItem}set carryItem(t){this._carryItem=t}get roomIndex(){return this._roomIndex}set roomIndex(t){this._roomIndex=t}get type(){return this._type}set type(t){this._type=t}getIsBot(){return this.type===TT.BOT}populate(t){this.id=t.webID,this.name=t.name,this.figure=t.figure,this.motto=t.motto,this.badges=t.badges,this.groupId=t.groupId,this.groupName=t.groupName,this.groupBadgeId=t.groupBadgeId,this.activityPoints=t.activityPoints,this.respectLeft=t.respectLeft,this.petRespectLeft=0,this.carryItem=t.carryId,this.roomIndex=t.roomIndex,this.type=t.type}}let ZO=(()=>{class t{}return t.USER=1,t.BOT=2,t.RENTABLE_BOT=3,t.PET=4,t.FURNI=5,t})();class zO{constructor(){this.widget=null}hide(){this.widget.close()}update(t){}get type(){return-1}}let XO=(()=>{class t{constructor(){this.badge="",this.hover=!0}get badgeUrl(){return um.instance.getConfiguration("badge.asset.url").replace("%badgename%",this.badge)}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275cmp=i.Ob({type:t,selectors:[["nitro-badge"]],inputs:{badge:"badge",hover:"hover"},decls:1,vars:1,consts:[[3,"src"]],template:function(t,e){1&t&&i.Vb(0,"img",0),2&t&&i.sc("src",e.badgeUrl,i.Gc)},encapsulation:2}),t})();function KO(t,e){if(1&t&&i.Vb(0,"nitro-badge",17),2&t){const t=i.lc().$implicit;i.sc("badge",t)}}function qO(t,e){if(1&t&&(i.Zb(0,"div",15),i.Pc(1,KO,1,1,"nitro-badge",16),i.Yb()),2&t){const t=e.$implicit;i.Gb(1),i.sc("ngIf",""!==t)}}function JO(t,e){if(1&t&&(i.Zb(0,"div",18),i.Zb(1,"span",19),i.Rc(2),i.Yb(),i.Yb()),2&t){const t=i.lc();i.Gb(2),i.Sc(t.userData.motto)}}function QO(t,e){1&t&&(i.Zb(0,"p",20),i.Rc(1),i.mc(2,"translate"),i.Yb()),2&t&&(i.Gb(1),i.Sc(i.nc(2,1,"infostand.text.handitem")))}let $O=(()=>{class t extends zO{constructor(){super(...arguments),this.userData=null}update(t){t&&t.carryId>0&&um.instance.localization.registerParameter("infostand.text.handitem","item",um.instance.getLocalization("handitem"+t.carryId))}get type(){return ZO.BOT}}return t.\u0275fac=function(e){return tA(e||t)},t.\u0275cmp=i.Ob({type:t,selectors:[["ng-component"]],features:[i.Db],decls:16,vars:6,consts:[[1,"infostand","d-flex","flex-column","btn","btn-primary","rounded","p-0","nohover"],[1,"d-flex","align-items-center","justify-content-between","pt-3","px-3","w-100"],["type","button",1,"close",3,"click"],[1,"fas","fa-times"],[1,"d-flex","flex-column","p-3","w-100"],[1,"d-flex","flex-nowrap"],[1,"body-image","bot"],["nitro-avatar-image","",3,"figure","direction"],[1,"flex-grow-1"],[1,"badge-container"],["class","badge-item",4,"ngFor","ngForOf"],[1,"d-flex","mt-2"],["class","motto-container",4,"ngIf"],[1,"d-flex","flex-column","mt-2"],["class","badge badge-secondary mb-0",4,"ngIf"],[1,"badge-item"],[3,"badge",4,"ngIf"],[3,"badge"],[1,"motto-container"],[1,"motto"],[1,"badge","badge-secondary","mb-0"]],template:function(t,e){1&t&&(i.Zb(0,"div",0),i.Zb(1,"div",1),i.Rc(2),i.Zb(3,"button",2),i.jc("click",(function(){return e.hide()})),i.Vb(4,"i",3),i.Yb(),i.Yb(),i.Zb(5,"div",4),i.Zb(6,"div",5),i.Zb(7,"div",6),i.Vb(8,"div",7),i.Yb(),i.Zb(9,"div",8),i.Zb(10,"div",9),i.Pc(11,qO,2,1,"div",10),i.Yb(),i.Yb(),i.Yb(),i.Zb(12,"div",11),i.Pc(13,JO,3,1,"div",12),i.Yb(),i.Zb(14,"div",13),i.Pc(15,QO,3,3,"p",14),i.Yb(),i.Yb(),i.Yb()),2&t&&(i.Gb(2),i.Tc(" ",e.userData.name," "),i.Gb(6),i.sc("figure",e.userData.figure)("direction",4),i.Gb(3),i.sc("ngForOf",e.userData.badges),i.Gb(2),i.sc("ngIf",""!==e.userData.motto),i.Gb(2),i.sc("ngIf",e.userData.carryItem>0))},directives:[pp,o.l,o.m,XO],pipes:[Ep],encapsulation:2}),t})();const tA=i.bc($O);let eA=(()=>{class t{}return t._Str_21805=0,t._Str_18194=1,t._Str_18353=2,t})();function sA(t,e){if(1&t){const t=i.ac();i.Xb(0),i.Zb(1,"p",17),i.Rc(2),i.Yb(),i.Zb(3,"input",18),i.jc("ngModelChange",(function(s){i.Ec(t);const r=e.index;return i.lc(2).furniSettingsValues[r]=s})),i.Yb(),i.Wb()}if(2&t){const t=e.index,s=i.lc(2);i.Gb(2),i.Sc(s.furniSettingsKeys[t]),i.Gb(1),i.sc("ngModel",s.furniSettingsValues[t])}}function iA(t,e){if(1&t&&(i.Zb(0,"div",15),i.Pc(1,sA,4,2,"ng-container",16),i.Yb()),2&t){const t=i.lc();i.Gb(1),i.sc("ngForOf",t.furniSettingsKeys)}}function rA(t,e){if(1&t){const t=i.ac();i.Zb(0,"button",19),i.jc("click",(function(){return i.Ec(t),i.lc().processButtonAction("move")})),i.Rc(1),i.mc(2,"translate"),i.Yb()}2&t&&(i.Gb(1),i.Sc(i.nc(2,1,"infostand.button.move")))}function nA(t,e){if(1&t){const t=i.ac();i.Zb(0,"button",19),i.jc("click",(function(){return i.Ec(t),i.lc().processButtonAction("rotate")})),i.Rc(1),i.mc(2,"translate"),i.Yb()}2&t&&(i.Gb(1),i.Sc(i.nc(2,1,"infostand.button.rotate")))}function aA(t,e){if(1&t){const t=i.ac();i.Zb(0,"button",19),i.jc("click",(function(){return i.Ec(t),i.lc().processButtonAction("pickup")})),i.Rc(1),i.mc(2,"translate"),i.Yb()}if(2&t){const t=i.lc();i.Gb(1),i.Sc(i.nc(2,1,1===t.pickupMode?"infostand.button.eject":"infostand.button.pickup"))}}function oA(t,e){if(1&t){const t=i.ac();i.Zb(0,"button",19),i.jc("click",(function(){return i.Ec(t),i.lc().processButtonAction("use")})),i.Rc(1),i.mc(2,"translate"),i.Yb()}2&t&&(i.Gb(1),i.Sc(i.nc(2,1,"infostand.button.use")))}function cA(t,e){if(1&t){const t=i.ac();i.Zb(0,"button",20),i.jc("click",(function(){return i.Ec(t),i.lc().processButtonAction("save_branding_configuration")})),i.Rc(1),i.mc(2,"translate"),i.Yb()}2&t&&(i.Gb(1),i.Sc(i.nc(2,1,"save")))}let _A=(()=>{class t extends zO{constructor(){super(...arguments),this.furniData=null,this.pickupMode=0,this.canMove=!1,this.canRotate=!1,this.canUse=!1,this.updateCount=0,this.furniSettingsKeys=[],this.furniSettingsValues=[]}update(t){this.furniSettingsKeys=[],this.furniSettingsValues=[];let e=!1,s=!1,i=!1,r=!1;const n=t.roomControllerLevel>=en.GUEST;if((n||t.isOwner||t.isRoomOwner||t.isAnyRoomOwner)&&(e=!0,s=!t.isWallItem,t.roomControllerLevel>=en.MODERATOR&&(r=!0)),(t.usagePolicy===eA._Str_18353||t.usagePolicy===eA._Str_18194&&n||t.extraParam===cg.JUKEBOX&&n||t.extraParam==cg.USABLE_PRODUCT&&n)&&(i=!0),r&&t.extraParam){const e=t.extraParam.substr(cg.BRANDING_OPTIONS.length);if(e){const t=e.split("\t");for(const e of t){const t=e.split("=");t&&2===t.length&&(this.furniSettingsKeys.push(t[0]),this.furniSettingsValues.push(t[1]))}}}this.canMove=e,this.canRotate=s,this.canUse=i,this.togglePickupButton(t),this.updateCount++}togglePickupButton(e){e&&(this.pickupMode=t.PICKUP_MODE_NONE,e.isOwner||e.isAnyRoomOwner?this.pickupMode=t.PICKUP_MODE_FULL:(e.isRoomOwner||e.roomControllerLevel>=en.GUILD_ADMIN)&&(this.pickupMode=t.PICKUP_MODE_EJECT),e.isStickie&&(this.pickupMode=t.PICKUP_MODE_NONE))}processButtonAction(e){if(!e||""===e)return;let s=null,i=null;switch(e){case"move":s=AT.RWFAM_MOVE;break;case"rotate":s=AT.RWFUAM_ROTATE;break;case"pickup":s=this.pickupMode===t.PICKUP_MODE_FULL?AT.RWFAM_PICKUP:AT.RWFAM_EJECT;break;case"use":s=AT.RWFAM_USE;break;case"save_branding_configuration":s=AT.RWFAM_SAVE_STUFF_DATA,i=this.getSettingsAsString()}s&&this.widget.messageListener.processWidgetMessage(new AT(s,this.furniData.id,this.furniData.category,this.furniData.purchaseOfferId,i))}getSettingsAsString(){if(!this.furniSettingsKeys.length||!this.furniSettingsValues.length)return"";let t="",e=0;for(;e<this.furniSettingsKeys.length;)t=t+(this.furniSettingsKeys[e]+"=")+this.furniSettingsValues[e]+"\t",e++;return t}get type(){return ZO.FURNI}}return t.PICKUP_MODE_NONE=0,t.PICKUP_MODE_EJECT=1,t.PICKUP_MODE_FULL=2,t.\u0275fac=function(e){return hA(e||t)},t.\u0275cmp=i.Ob({type:t,selectors:[["ng-component"]],features:[i.Db],decls:22,vars:14,consts:[[1,"d-flex","flex-column","align-items-end"],[1,"infostand","d-flex","flex-column","btn","btn-primary","rounded","p-0","nohover"],[1,"d-flex","align-items-center","justify-content-between","pt-3","px-3","w-100"],["type","button",1,"close",3,"click"],[1,"fas","fa-times"],[1,"d-flex","flex-column","p-3","w-100"],[1,"w-100"],[1,"d-block","mx-auto",3,"src"],[1,"d-flex","flex-column","mt-2"],[1,"badge","badge-secondary","mb-0"],[1,"badge","badge-secondary","mt-2","mb-0"],["class","mt-3",4,"ngIf"],[1,"button-container","btn-group","mt-2"],["type","button","class","btn btn-primary",3,"click",4,"ngIf"],["class","btn btn-primary",3,"click",4,"ngIf"],[1,"mt-3"],[4,"ngFor","ngForOf"],[1,"badge","badge-secondary","mb-2"],["type","text",1,"form-control","rounded","mb-2",3,"ngModel","ngModelChange"],["type","button",1,"btn","btn-primary",3,"click"],[1,"btn","btn-primary",3,"click"]],template:function(t,e){1&t&&(i.Zb(0,"div",0),i.Zb(1,"div",1),i.Zb(2,"div",2),i.Rc(3),i.Zb(4,"button",3),i.jc("click",(function(){return e.hide()})),i.Vb(5,"i",4),i.Yb(),i.Yb(),i.Zb(6,"div",5),i.Zb(7,"div",6),i.Vb(8,"img",7),i.Yb(),i.Zb(9,"div",8),i.Zb(10,"p",9),i.Rc(11),i.Yb(),i.Zb(12,"p",10),i.Rc(13),i.mc(14,"translate"),i.Yb(),i.Yb(),i.Pc(15,iA,2,1,"div",11),i.Yb(),i.Yb(),i.Zb(16,"div",12),i.Pc(17,rA,3,3,"button",13),i.Pc(18,nA,3,3,"button",13),i.Pc(19,aA,3,3,"button",13),i.Pc(20,oA,3,3,"button",13),i.Pc(21,cA,3,3,"button",14),i.Yb(),i.Yb()),2&t&&(i.Gb(3),i.Tc(" ",e.furniData.name," "),i.Gb(5),i.sc("src",e.furniData.imageUrl,i.Gc),i.Gb(3),i.Sc(e.furniData.description),i.Gb(2),i.Sc(i.pc(14,10,"furni.owner","name",e.furniData.ownerName)),i.Gb(2),i.sc("ngIf",e.furniSettingsKeys.length&&e.furniSettingsValues.length&&e.furniSettingsKeys.length===e.furniSettingsValues.length),i.Gb(2),i.sc("ngIf",e.canMove),i.Gb(1),i.sc("ngIf",e.canRotate),i.Gb(1),i.sc("ngIf",0!==e.pickupMode),i.Gb(1),i.sc("ngIf",e.canUse),i.Gb(1),i.sc("ngIf",e.furniSettingsKeys.length&&e.furniSettingsValues.length&&e.furniSettingsKeys.length===e.furniSettingsValues.length))},directives:[o.m,o.l,c.b,c.j,c.l],pipes:[Ep],encapsulation:2}),t})();const hA=i.bc(_A);let lA=(()=>{class t extends zO{get type(){return ZO.PET}}return t.\u0275fac=function(e){return uA(e||t)},t.\u0275cmp=i.Ob({type:t,selectors:[["nitro-room-infostand-pet-component"]],features:[i.Db],decls:2,vars:0,consts:[[1,"nitro-room-infostand-pet-component"]],template:function(t,e){1&t&&(i.Zb(0,"div",0),i.Rc(1," pet "),i.Yb())},encapsulation:2}),t})();const uA=i.bc(lA);function dA(t,e){if(1&t&&i.Vb(0,"nitro-badge",18),2&t){const t=i.lc().$implicit;i.sc("badge",t)}}function gA(t,e){if(1&t&&(i.Zb(0,"div",16),i.Pc(1,dA,1,1,"nitro-badge",17),i.Yb()),2&t){const t=e.$implicit;i.Gb(1),i.sc("ngIf",""!==t)}}function mA(t,e){if(1&t&&(i.Zb(0,"div",19),i.Zb(1,"span",20),i.Rc(2),i.Yb(),i.Yb()),2&t){const t=i.lc();i.Gb(2),i.Sc(t.botData.motto)}}function pA(t,e){1&t&&(i.Zb(0,"p",21),i.Rc(1),i.mc(2,"translate"),i.Yb()),2&t&&(i.Gb(1),i.Sc(i.nc(2,1,"infostand.text.botowner")))}function EA(t,e){1&t&&(i.Zb(0,"p",22),i.Rc(1),i.mc(2,"translate"),i.Yb()),2&t&&(i.Gb(1),i.Sc(i.nc(2,1,"infostand.text.handitem")))}let fA=(()=>{class t extends zO{constructor(){super(...arguments),this.botData=null}update(t){t&&(um.instance.localization.registerParameter("infostand.text.botowner","name",um.instance.getLocalization(this.botData.ownerName)),t.carryId>0&&um.instance.localization.registerParameter("infostand.text.handitem","item",um.instance.getLocalization("handitem"+t.carryId)))}get type(){return ZO.RENTABLE_BOT}}return t.\u0275fac=function(e){return SA(e||t)},t.\u0275cmp=i.Ob({type:t,selectors:[["ng-component"]],features:[i.Db],decls:17,vars:7,consts:[[1,"infostand","d-flex","flex-column","btn","btn-primary","rounded","p-0","nohover"],[1,"d-flex","align-items-center","justify-content-between","pt-3","px-3","w-100"],["type","button",1,"close",3,"click"],[1,"fas","fa-times"],[1,"d-flex","flex-column","p-3","w-100"],[1,"d-flex","flex-nowrap"],[1,"body-image","bot"],["nitro-avatar-image","",3,"figure","direction"],[1,"flex-grow-1"],[1,"badge-container"],["class","badge-item",4,"ngFor","ngForOf"],[1,"d-flex","mt-2"],["class","motto-container",4,"ngIf"],[1,"d-flex","flex-column","mt-2"],["class","badge badge-secondary mb-0",4,"ngIf"],["class","badge badge-secondary mt-0 mb-0",4,"ngIf"],[1,"badge-item"],[3,"badge",4,"ngIf"],[3,"badge"],[1,"motto-container"],[1,"motto"],[1,"badge","badge-secondary","mb-0"],[1,"badge","badge-secondary","mt-0","mb-0"]],template:function(t,e){1&t&&(i.Zb(0,"div",0),i.Zb(1,"div",1),i.Rc(2),i.Zb(3,"button",2),i.jc("click",(function(){return e.hide()})),i.Vb(4,"i",3),i.Yb(),i.Yb(),i.Zb(5,"div",4),i.Zb(6,"div",5),i.Zb(7,"div",6),i.Vb(8,"div",7),i.Yb(),i.Zb(9,"div",8),i.Zb(10,"div",9),i.Pc(11,gA,2,1,"div",10),i.Yb(),i.Yb(),i.Yb(),i.Zb(12,"div",11),i.Pc(13,mA,3,1,"div",12),i.Yb(),i.Zb(14,"div",13),i.Pc(15,pA,3,3,"p",14),i.Pc(16,EA,3,3,"p",15),i.Yb(),i.Yb(),i.Yb()),2&t&&(i.Gb(2),i.Tc(" ",e.botData.name," "),i.Gb(6),i.sc("figure",e.botData.figure)("direction",4),i.Gb(3),i.sc("ngForOf",e.botData.badges),i.Gb(2),i.sc("ngIf",""!==e.botData.motto),i.Gb(2),i.sc("ngIf",e.botData.ownerId>0),i.Gb(1),i.sc("ngIf",e.botData.carryItem>0))},directives:[pp,o.l,o.m,XO],pipes:[Ep],encapsulation:2}),t})();const SA=i.bc(fA);function bA(t,e){if(1&t&&i.Vb(0,"nitro-badge",18),2&t){const t=i.lc().$implicit;i.sc("badge",t)}}function RA(t,e){if(1&t&&(i.Zb(0,"div",16),i.Pc(1,bA,1,1,"nitro-badge",17),i.Yb()),2&t){const t=e.$implicit;i.Gb(1),i.sc("ngIf",""!==t)}}function IA(t,e){if(1&t){const t=i.ac();i.Zb(0,"div",19),i.Vb(1,"i",20),i.Zb(2,"textarea",21),i.jc("ngModelChange",(function(e){return i.Ec(t),i.lc().userData.motto=e}))("keyup",(function(e){return i.Ec(t),i.lc().resizeTextArea(e)}))("keydown.enter",(function(e){return i.Ec(t),i.lc().saveMotto(e)})),i.mc(3,"translate"),i.Yb(),i.Yb()}if(2&t){const t=i.lc();i.Gb(2),i.tc("placeholder",i.nc(3,2,"infostand.motto.change")),i.sc("ngModel",t.userData.motto)}}function vA(t,e){if(1&t&&(i.Zb(0,"div",19),i.Zb(1,"span",22),i.Rc(2),i.Yb(),i.Yb()),2&t){const t=i.lc();i.Gb(2),i.Sc(t.userData.motto)}}function TA(t,e){1&t&&(i.Zb(0,"p",23),i.Rc(1),i.mc(2,"translate"),i.Yb()),2&t&&(i.Gb(1),i.Sc(i.nc(2,1,"infostand.text.handitem")))}let OA=(()=>{class t extends zO{constructor(){super(...arguments),this.userData=null}update(t){t&&t.carryId>0&&um.instance.localization.registerParameter("infostand.text.handitem","item",um.instance.getLocalization("handitem"+t.carryId))}resizeTextArea(t){if(!t)return;const e=t.target;e&&(e.style.height="0px",e.style.height=e.scrollHeight+"px")}saveMotto(t){this.userData.motto.length>38||(t.target.blur(),this.widget.messageListener.processWidgetMessage(new OT(this.userData.motto)))}get isOwnProfile(){return this.userData.type===TT.OWN_USER}get type(){return ZO.USER}}return t.\u0275fac=function(e){return AA(e||t)},t.\u0275cmp=i.Ob({type:t,selectors:[["ng-component"]],features:[i.Db],decls:20,vars:11,consts:[[1,"infostand","d-flex","flex-column","btn","btn-primary","rounded","p-0","nohover"],[1,"d-flex","align-items-center","justify-content-between","pt-3","px-3","w-100"],["type","button",1,"close",3,"click"],[1,"fas","fa-times"],[1,"d-flex","flex-column","p-3","w-100"],[1,"d-flex","flex-nowrap"],[1,"body-image"],["nitro-avatar-image","",3,"figure","direction"],[1,"flex-grow-1"],[1,"badge-container"],["class","badge-item",4,"ngFor","ngForOf"],[1,"d-flex","mt-2"],["class","motto-container",4,"ngIf"],[1,"d-flex","flex-column","mt-2"],[1,"badge","badge-secondary","mb-0"],["class","badge badge-secondary mt-2 mb-0",4,"ngIf"],[1,"badge-item"],[3,"badge",4,"ngIf"],[3,"badge"],[1,"motto-container"],[1,"icon","pencil-icon"],["maxlength","38","wrap","soft","rows","1",1,"motto-input",3,"ngModel","placeholder","ngModelChange","keyup","keydown.enter"],[1,"motto"],[1,"badge","badge-secondary","mt-2","mb-0"]],template:function(t,e){1&t&&(i.Zb(0,"div",0),i.Zb(1,"div",1),i.Rc(2),i.Zb(3,"button",2),i.jc("click",(function(){return e.hide()})),i.Vb(4,"i",3),i.Yb(),i.Yb(),i.Zb(5,"div",4),i.Zb(6,"div",5),i.Zb(7,"div",6),i.Vb(8,"div",7),i.Yb(),i.Zb(9,"div",8),i.Zb(10,"div",9),i.Pc(11,RA,2,1,"div",10),i.Yb(),i.Yb(),i.Yb(),i.Zb(12,"div",11),i.Pc(13,IA,4,4,"div",12),i.Pc(14,vA,3,1,"div",12),i.Yb(),i.Zb(15,"div",13),i.Zb(16,"p",14),i.Rc(17),i.mc(18,"translate"),i.Yb(),i.Pc(19,TA,3,3,"p",15),i.Yb(),i.Yb(),i.Yb()),2&t&&(i.Gb(2),i.Tc(" ",e.userData.name," "),i.Gb(6),i.sc("figure",e.userData.figure)("direction",4),i.Gb(3),i.sc("ngForOf",e.userData.badges),i.Gb(2),i.sc("ngIf",e.isOwnProfile),i.Gb(1),i.sc("ngIf",!e.isOwnProfile),i.Gb(3),i.Uc("",i.nc(18,9,"extendedprofile.achievementscore")," ",e.userData.activityPoints,""),i.Gb(2),i.sc("ngIf",e.userData.carryItem>0))},directives:[pp,o.l,o.m,XO,c.b,c.g,c.j,c.l],pipes:[Ep],encapsulation:2}),t})();const AA=i.bc(OA),yA=["infostandsContainer"];let CA=(()=>{class t extends kT{constructor(t,e,s){super(),this._inventoryService=t,this._componentFactoryResolver=e,this._ngZone=s,this._lastComponent=null,this._furniData=new jO,this._userData=new WO,this._petData=new BO,this._botData=new HO,this.objectSelectedHandler=this.objectSelectedHandler.bind(this),this.objectDeselectedHandler=this.objectDeselectedHandler.bind(this),this.objectRemovedHandler=this.objectRemovedHandler.bind(this),this.userInfostandUpdateHandler=this.userInfostandUpdateHandler.bind(this),this.botInfostandUpdateHandler=this.botInfostandUpdateHandler.bind(this),this.furniInfostandUpdateHandler=this.furniInfostandUpdateHandler.bind(this),this.rentableBotInfostandUpdateHandler=this.rentableBotInfostandUpdateHandler.bind(this),this.petInfostandUpdateHandler=this.petInfostandUpdateHandler.bind(this)}registerUpdateEvents(t){t&&(t.addEventListener(Vv.OBJECT_SELECTED,this.objectSelectedHandler),t.addEventListener(Vv.OBJECT_DESELECTED,this.objectDeselectedHandler),t.addEventListener(Vv.USER_REMOVED,this.objectRemovedHandler),t.addEventListener(Vv.FURNI_REMOVED,this.objectRemovedHandler),t.addEventListener(TT.OWN_USER,this.userInfostandUpdateHandler),t.addEventListener(TT.PEER,this.userInfostandUpdateHandler),t.addEventListener(TT.BOT,this.botInfostandUpdateHandler),t.addEventListener(IT.FURNI,this.furniInfostandUpdateHandler),t.addEventListener(vT.RENTABLE_BOT,this.rentableBotInfostandUpdateHandler),t.addEventListener(kO.PET_INFO,this.petInfostandUpdateHandler),super.registerUpdateEvents(t))}unregisterUpdateEvents(t){t&&(t.removeEventListener(Vv.OBJECT_SELECTED,this.objectSelectedHandler),t.removeEventListener(Vv.OBJECT_DESELECTED,this.objectDeselectedHandler),t.removeEventListener(Vv.USER_REMOVED,this.objectRemovedHandler),t.removeEventListener(Vv.FURNI_REMOVED,this.objectRemovedHandler),t.removeEventListener(TT.OWN_USER,this.userInfostandUpdateHandler),t.removeEventListener(TT.PEER,this.userInfostandUpdateHandler),t.removeEventListener(TT.BOT,this.botInfostandUpdateHandler),t.removeEventListener(IT.FURNI,this.furniInfostandUpdateHandler),t.removeEventListener(vT.RENTABLE_BOT,this.rentableBotInfostandUpdateHandler),t.removeEventListener(kO.PET_INFO,this.petInfostandUpdateHandler),super.unregisterUpdateEvents(t))}close(){this.infostandsContainer.length&&this.infostandsContainer.remove(),this._lastComponent=null}objectSelectedHandler(t){this.messageListener.processWidgetMessage(new zv(zv.GET_OBJECT_INFO,t.id,t.category))}objectDeselectedHandler(t){this._ngZone.run(()=>this.close())}objectRemovedHandler(t){let e=!1;const s=this._lastComponent&&this._lastComponent.instance.type||-1;if(-1===s&&(e=!0),s>0)switch(t.type){case Vv.FURNI_REMOVED:s===ZO.FURNI&&t.id===this._furniData.id&&(e=!0);break;case Vv.USER_REMOVED:(s===ZO.USER&&t.id===this._userData.id||s===ZO.PET&&t.id===this._petData._Str_2707||s===ZO.BOT&&t.id===this._userData.id||s===ZO.RENTABLE_BOT&&t.id===this._botData.id)&&(e=!0)}e&&this._ngZone.run(()=>this.close())}userInfostandUpdateHandler(t){t&&this._ngZone.run(()=>{this._userData.populate(t);const e=this.getInfoStand(t);e&&(e.userData=this._userData,e.update(t))})}botInfostandUpdateHandler(t){t&&this._ngZone.run(()=>{this._userData.populate(t);const e=this.getInfoStand(t);e&&(e.userData=this._userData,e.update(t))})}furniInfostandUpdateHandler(t){t&&this._ngZone.run(()=>{this._furniData.populate(t);const e=this.getInfoStand(t);e&&(e.furniData=this._furniData,e.update(t))})}rentableBotInfostandUpdateHandler(t){t&&this._ngZone.run(()=>{this._botData.populate(t);const e=this.getInfoStand(t);e&&(e.botData=this._botData,e.update(t))})}petInfostandUpdateHandler(t){t&&this._ngZone.run(()=>{this._petData.populate(t);const e=this.getInfoStand(t);e&&(e.petData=this._petData,e.update(t))})}updateUserBadges(t,e){t===this._userData.id&&(this._userData.getIsBot()||this._ngZone.run(()=>this._userData.badges=e))}getInfoStand(t){const e=this.getInfoStandComponentType(t);if(!e)return null;if(this._lastComponent&&this._lastComponent.instance instanceof e)return this._lastComponent.instance;this.infostandsContainer.length&&this.infostandsContainer.remove();const s=this._componentFactoryResolver.resolveComponentFactory(e);let i=null;return s&&(i=this.infostandsContainer.createComponent(s)),this._lastComponent=i,i?(i.instance.widget=this,i.instance):null}get furniData(){return this._furniData}getInfoStandComponentType(t){if(!t)return null;switch(t.type){case TT.BOT:return $O;case IT.FURNI:return _A;case kO.PET_INFO:return lA;case vT.RENTABLE_BOT:return fA;case TT.OWN_USER:case TT.PEER:return OA}return null}get handler(){return this.widgetHandler}get inventoryTrading(){return this._inventoryService.controller.tradeService}}return t.\u0275fac=function(e){return new(e||t)(i.Ub(Dm),i.Ub(i.l),i.Ub(i.E))},t.\u0275cmp=i.Ob({type:t,selectors:[["ng-component"]],viewQuery:function(t,e){if(1&t&&i.Wc(yA,!0,i.W),2&t){let t;i.Ac(t=i.kc())&&(e.infostandsContainer=t.first)}},features:[i.Db],decls:3,vars:0,consts:[[1,"nitro-room-infostand-component"],["infostandsContainer",""]],template:function(t,e){1&t&&(i.Zb(0,"div",0),i.Vb(1,"div",null,1),i.Yb())},encapsulation:2}),t})();function MA(t,e){if(1&t){const t=i.ac();i.Xb(0),i.Zb(1,"div",9),i.Zb(2,"button",10),i.Rc(3),i.Yb(),i.Zb(4,"button",11),i.jc("click",(function(){i.Ec(t);const s=e.$implicit;return i.lc(2).accept(s)})),i.Vb(5,"i",12),i.Yb(),i.Zb(6,"button",13),i.jc("click",(function(){i.Ec(t);const s=e.$implicit;return i.lc(2).deny(s)})),i.Vb(7,"i",5),i.Yb(),i.Yb(),i.Wb()}if(2&t){const t=e.$implicit;i.Gb(3),i.Sc(t)}}function DA(t,e){if(1&t){const t=i.ac();i.Zb(0,"div",1),i.Zb(1,"div",2),i.Zb(2,"h6",3),i.Rc(3),i.mc(4,"translate"),i.Yb(),i.Zb(5,"button",4),i.jc("click",(function(){return i.Ec(t),i.lc().hide()})),i.Vb(6,"i",5),i.Yb(),i.Yb(),i.Zb(7,"div",6),i.Zb(8,"perfect-scrollbar",7),i.Pc(9,MA,8,1,"ng-container",8),i.Yb(),i.Yb(),i.Yb()}if(2&t){const t=i.lc();i.Gb(3),i.Sc(i.nc(4,2,"widgets.doorbell.title")),i.Gb(6),i.sc("ngForOf",t.users)}}let NA=(()=>{class t extends kT{constructor(t){super(),this._ngZone=t,this._visible=!1,this._users=[],this.onRoomRinging=this.onRoomRinging.bind(this),this.onRoomAcceptedAndRejected=this.onRoomAcceptedAndRejected.bind(this)}registerUpdateEvents(t){t&&(t.addEventListener(UT.RWDE_RINGING,this.onRoomRinging),t.addEventListener(UT.REJECTED,this.onRoomAcceptedAndRejected),t.addEventListener(UT.RWDE_ACCEPTED,this.onRoomAcceptedAndRejected),super.registerUpdateEvents(t))}unregisterUpdateEvents(t){t&&(t.removeEventListener(UT.RWDE_RINGING,this.onRoomRinging),t.removeEventListener(UT.REJECTED,this.onRoomAcceptedAndRejected),t.removeEventListener(UT.RWDE_ACCEPTED,this.onRoomAcceptedAndRejected),super.unregisterUpdateEvents(t))}onRoomRinging(t){t&&this._ngZone.run(()=>this.addUser(t.userName))}onRoomAcceptedAndRejected(t){t&&this._ngZone.run(()=>this.removeUser(t.userName))}addUser(t){this._users.indexOf(t)>=0||(this._users.length>=50?this.deny(t):(this._visible=!0,this._users.push(t)))}removeUser(t){const e=this._users.indexOf(t);-1!==e&&(this._users.splice(e,1),this._users.length||(this._visible=!1))}deny(t){this.messageListener.processWidgetMessage(new wT(t,!1)),this.removeUser(t)}accept(t){this.messageListener.processWidgetMessage(new wT(t,!0)),this.removeUser(t)}hide(){this._visible=!1}get visible(){return this._visible}get users(){return this._users}}return t.\u0275fac=function(e){return new(e||t)(i.Ub(i.E))},t.\u0275cmp=i.Ob({type:t,selectors:[["nitro-room-doorbell-component"]],features:[i.Db],decls:1,vars:1,consts:[["class","nitro-room-doorbell card","noMemory","true",3,"bringToTop","draggable",4,"ngIf"],["noMemory","true",1,"nitro-room-doorbell","card",3,"bringToTop","draggable"],[1,"drag-handler","d-flex","justify-content-between","align-items-center","px-3","pt-3"],[1,"m-0"],["type","button",1,"close",3,"click"],[1,"fas","fa-times"],[1,"d-flex","flex-column","p-3"],[1,"position-relative","w-100",2,"min-height","200px","max-height","200px","height","200px"],[4,"ngFor","ngForOf"],[1,"btn-group","w-100","mb-1"],["type","button",1,"btn","btn-secondary","w-100"],["type","button",1,"btn","btn-success",3,"click"],[1,"fas","fa-check"],["type","button",1,"btn","btn-danger",3,"click"]],template:function(t,e){1&t&&i.Pc(0,DA,10,4,"div",0),2&t&&i.sc("ngIf",e.visible)},directives:[o.m,op,dp,u.b,o.l],pipes:[Ep],encapsulation:2}),t})();const wA=["chatContainer"],UA=function(t){return{"background-color":t}};function LA(t,e){if(1&t&&i.Vb(0,"div",10),2&t){const t=i.lc();i.sc("ngStyle",i.vc(1,UA,t.senderColorString))}}const PA=function(t){return{"background-image":t,transform:"scale(1)",top:"-53px"}},xA=function(t){return{"background-image":t}};function FA(t,e){if(1&t&&i.Vb(0,"div",11),2&t){const t=i.lc();i.sc("ngStyle",t.petType>=0?i.vc(1,PA,"url("+t.senderImageUrl+")"):i.vc(3,xA,"url("+t.senderImageUrl+")"))}}let GA=(()=>{class t{update(t){this.chatType=t.chatType,this.chatStyle=t.styleId,this.senderId=t.userId,this.senderName=t.userName,this.senderCategory=t.userCategory,this.message=t.text,this.messageLinks=t.links,this.senderX=t.userX,this.senderImageUrl=t.userImage&&t.userImage.src||null,this.senderColor=t.userColor,this.senderColorString=this.senderColor&&"#"+this.senderColor.toString(16).padStart(6,"0")||null,this.roomId=t.roomId,this.userType=t.userType,this.petType=t.petType}ready(){this.makeVisible()}makeVisible(){this.chatContainerElement&&(this.chatContainerElement.style.visibility="visible")}getX(){return this.x}setX(t){this.chatContainerElement&&(this.x=t,this.chatContainerElement.style.left=t+"px")}getY(){return this.y}setY(t){this.chatContainerElement&&(this.y=t,this.chatContainerElement.style.top=t+"px")}selectUser(){um.instance.roomEngine.selectRoomObject(this.roomId,this.senderId,this.senderCategory)}get width(){return this.chatContainerElement&&this.chatContainerElement.clientWidth||0}get height(){return this.chatContainerElement&&this.chatContainerElement.clientHeight||0}get chatContainerElement(){return this.chatContainer&&this.chatContainer.nativeElement||null}get decoratedUsername(){return this.senderName+":"}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275cmp=i.Ob({type:t,selectors:[["ng-component"]],viewQuery:function(t,e){if(1&t&&i.Wc(wA,!0),2&t){let t;i.Ac(t=i.kc())&&(e.chatContainer=t.first)}},inputs:{id:"id"},decls:11,vars:8,consts:[[1,"bubble-container"],["chatContainer",""],["class","user-container-bg",3,"ngStyle",4,"ngIf"],[3,"click"],[1,"user-container"],["class","user-image",3,"ngStyle",4,"ngIf"],[1,"chat-content"],[3,"innerHTML"],[1,"message"],[1,"pointer"],[1,"user-container-bg",3,"ngStyle"],[1,"user-image",3,"ngStyle"]],template:function(t,e){1&t&&(i.Zb(0,"div",0,1),i.Pc(2,LA,1,3,"div",2),i.Zb(3,"div",3),i.jc("click",(function(){return e.selectUser()})),i.Zb(4,"div",4),i.Pc(5,FA,1,5,"div",5),i.Yb(),i.Zb(6,"div",6),i.Vb(7,"b",7),i.Zb(8,"span",8),i.Rc(9),i.Yb(),i.Yb(),i.Vb(10,"div",9),i.Yb(),i.Yb()),2&t&&(i.Gb(2),i.sc("ngIf",0===e.chatStyle),i.Gb(1),i.Kb("chat-bubble bubble-",e.chatStyle," type-",e.chatType,""),i.Gb(2),i.sc("ngIf",e.senderImageUrl),i.Gb(2),i.sc("innerHTML",e.decoratedUsername,i.Fc),i.Gb(2),i.Tc(" ",e.message,""))},directives:[o.m,o.n],encapsulation:2}),t})();const VA=["chatView"],YA=["chatContainer"];function kA(t,e){}let jA=(()=>{class t extends kT{constructor(t,e){super(),this.ngZone=t,this.componentFactoryResolver=e,this.timeoutTime=0,this.originalScale=0,this.scaleFactor=1,this.cameraOffset=new A.j,this.chats=[],this.tempChats=[],this.pendingChats=[],this.processingChats=!1,this.onChatMessage=this.onChatMessage.bind(this),this.onRoomViewUpdate=this.onRoomViewUpdate.bind(this)}ngOnInit(){this.ngZone.runOutsideAngular(()=>um.instance.ticker.add(this.update,this))}ngOnDestroy(){this.ngZone.runOutsideAngular(()=>um.instance.ticker.remove(this.update,this))}registerUpdateEvents(t){t&&(t.addEventListener(iT.RWCUE_EVENT_CHAT,this.onChatMessage),t.addEventListener(Yv.SIZE_CHANGED,this.onRoomViewUpdate),t.addEventListener(Yv.POSITION_CHANGED,this.onRoomViewUpdate),t.addEventListener(Yv.SCALE_CHANGED,this.onRoomViewUpdate),super.registerUpdateEvents(t))}unregisterUpdateEvents(t){t&&(t.removeEventListener(iT.RWCUE_EVENT_CHAT,this.onChatMessage),t.removeEventListener(Yv.SIZE_CHANGED,this.onRoomViewUpdate),t.removeEventListener(Yv.POSITION_CHANGED,this.onRoomViewUpdate),t.removeEventListener(Yv.SCALE_CHANGED,this.onRoomViewUpdate))}update(t){um.instance.time>this.timeoutTime&&(this.timeoutTime>0&&this.moveAllChatsUp(),this.resetTimeout())}resetTimeout(){this.timeoutTime=um.instance.time+t.UPDATE_INTERVAL}onChatMessage(t){!t||hh.isRunning()&&t.chatType!==iT.CHAT_TYPE_WHISPER||(this.pendingChats.push(t),this.timeoutTime=0,this.processPendingChats())}onRoomViewUpdate(t){t.scale>0&&(this.originalScale?this.scaleFactor=t.scale/this.originalScale:this.originalScale=t.scale),t.positionDelta&&(this.cameraOffset.x=this.cameraOffset.x+t.positionDelta.x/this.scaleFactor,this.cameraOffset.y=this.cameraOffset.y+t.positionDelta.y/this.scaleFactor),this.resetAllChatLocations()}processPendingChats(t=!1){if(!t&&this.processingChats)return;this.processingChats=!0;const e=this.pendingChats.shift();if(!e)return this.resetTimeout(),void(this.processingChats=!1);let s=null,i=null;this.ngZone.run(()=>{const t=this.componentFactoryResolver.resolveComponentFactory(GA);s=this.chatContainer.createComponent(t),i=s.instance,i&&(i.id=this.getFreeItemId(),i.update(e))}),setTimeout(()=>this.addChat(s),0)}getFreeItemId(){return"chat_item_"+t.CHAT_COUNTER}addChat(e){if(!e)return;const s=e.instance;s.senderX=s.senderX/this.scaleFactor-this.cameraOffset.x,s.setY(this.chatViewElement.offsetHeight-s.height),this.resetChatItemLocation(e),this.makeRoomForChat(e),this.chats.push(e),s.ready(),t.CHAT_COUNTER++,setTimeout(()=>this.processPendingChats(!0),0)}hideChat(t){if(!t)return;const e=this.chats.indexOf(t);e>=0&&this.chats.splice(e,1);const s=this.chatContainer.indexOf(t.hostView);s>=0&&this.chatContainer.remove(s)}moveChatUp(t,e=0){if(!t)return;const s=t.instance;let i=s.height;e&&(i=e),s.setY(s.getY()-i),s.getY()<-2*s.height&&this.hideChat(t)}moveAllChatsUp(){let t=this.chats.length-1;for(;t>=0;)this.moveChatUp(this.chats[t],15),t--}makeRoomForChat(t){if(!t)return;const e=t.instance,s=this.chats[this.chats.length-1],i=s&&s.instance;if(!i)return;const r=i.getY()+i.height-1,n=(e.getY(),e.height+1),a=this.chatViewElement.offsetHeight-r;if(a<n)for(const o of this.chats)this.moveChatUp(o,n-a)}resetAllChatLocations(){let t=this.chats.length-1;for(;t>=0;){const e=this.chats[t];e&&this.resetChatItemLocation(e),t--}}resetChatItemLocation(t){const e=t.instance;let s=(e.senderX+this.cameraOffset.x)*this.scaleFactor;s-=e.width/2,s+=this.chatViewElement.offsetWidth/2,e.setX(s)}get chatViewElement(){return this.chatViewReference&&this.chatViewReference.nativeElement||null}get handler(){return this.widgetHandler}}return t.CHAT_COUNTER=0,t.MAX_CHAT_HISTORY=250,t.UPDATE_INTERVAL=4e3,t.\u0275fac=function(e){return new(e||t)(i.Ub(i.E),i.Ub(i.l))},t.\u0275cmp=i.Ob({type:t,selectors:[["nitro-room-chat-component"]],viewQuery:function(t,e){if(1&t&&(i.Wc(VA,!0),i.Wc(YA,!0,i.W)),2&t){let t;i.Ac(t=i.kc())&&(e.chatViewReference=t.first),i.Ac(t=i.kc())&&(e.chatContainer=t.first)}},features:[i.Db],decls:4,vars:0,consts:[[1,"nitro-room-chat-component"],["chatView",""],["chatContainer",""]],template:function(t,e){1&t&&(i.Zb(0,"div",0,1),i.Pc(2,kA,0,0,"ng-template",null,2,i.Qc),i.Yb())},encapsulation:2}),t})(),BA=(()=>{class t{constructor(t){this._notificationService=t,this.title="",this.message=""}close(){this._notificationService.closeAlert(this)}}return t.\u0275fac=function(e){return new(e||t)(i.Ub(Nm))},t.\u0275cmp=i.Ob({type:t,selectors:[["ng-component"]],decls:10,vars:5,consts:[["noMemory","true",1,"nitro-alert","d-flex","flex-column","bg-primary","border","shadow","rounded",3,"bringToTop","draggable"],[1,"drag-handler","d-flex","justify-content-center","align-items-center","px-3","pt-3"],[1,"m-0"],[1,"d-flex","flex-column","p-3"],[1,"d-flex","flex-column",3,"innerHTML"],[1,"d-flex","flex-column","align-items-center","justify-content-center","mt-3"],["type","button",1,"btn","btn-secondary",3,"click"]],template:function(t,e){1&t&&(i.Zb(0,"div",0),i.Zb(1,"div",1),i.Zb(2,"h6",2),i.Rc(3),i.Yb(),i.Yb(),i.Zb(4,"div",3),i.Vb(5,"div",4),i.Zb(6,"div",5),i.Zb(7,"button",6),i.jc("click",(function(){return e.close()})),i.Rc(8),i.mc(9,"translate"),i.Yb(),i.Yb(),i.Yb(),i.Yb()),2&t&&(i.Gb(3),i.Sc(e.title),i.Gb(2),i.sc("innerHTML",e.message,i.Fc),i.Gb(3),i.Sc(i.nc(9,3,"generic.close")))},directives:[op,dp],pipes:[Ep],encapsulation:2}),t})(),HA=(()=>{class t extends BA{constructor(){super(...arguments),this.callback=null}confirm(){if(this.callback)try{this.callback()}catch(t){D.log(t)}this.close()}}return t.\u0275fac=function(e){return WA(e||t)},t.\u0275cmp=i.Ob({type:t,selectors:[["ng-component"]],features:[i.Db],decls:13,vars:8,consts:[["noMemory","true",1,"nitro-alert","d-flex","flex-column","bg-primary","border","shadow","rounded",3,"bringToTop","draggable"],[1,"drag-handler","d-flex","justify-content-center","align-items-center","px-3","pt-3"],[1,"m-0"],[1,"d-flex","flex-column","p-3"],[1,"d-flex","flex-column",3,"innerHTML"],[1,"d-flex","align-items-center","justify-content-center","mt-3"],["type","button",1,"btn","btn-link","mr-1",3,"click"],["type","button",1,"btn","btn-success",3,"click"]],template:function(t,e){1&t&&(i.Zb(0,"div",0),i.Zb(1,"div",1),i.Zb(2,"h6",2),i.Rc(3),i.Yb(),i.Yb(),i.Zb(4,"div",3),i.Vb(5,"div",4),i.Zb(6,"div",5),i.Zb(7,"button",6),i.jc("click",(function(){return e.close()})),i.Rc(8),i.mc(9,"translate"),i.Yb(),i.Zb(10,"button",7),i.jc("click",(function(){return e.confirm()})),i.Rc(11),i.mc(12,"translate"),i.Yb(),i.Yb(),i.Yb(),i.Yb()),2&t&&(i.Gb(3),i.Sc(e.title),i.Gb(2),i.sc("innerHTML",e.message,i.Fc),i.Gb(3),i.Sc(i.nc(9,4,"generic.cancel")),i.Gb(3),i.Sc(i.nc(12,6,"generic.ok")))},directives:[op,dp],pipes:[Ep],encapsulation:2}),t})();const WA=i.bc(HA);function ZA(t,e){if(1&t){const t=i.ac();i.Zb(0,"button",8),i.jc("click",(function(){return i.Ec(t),i.lc().openLink()})),i.Rc(1),i.mc(2,"translate"),i.Yb()}2&t&&(i.Gb(1),i.Sc(i.nc(2,1,"mod.alert.link")))}let zA=(()=>{class t extends BA{constructor(){super(...arguments),this.link=""}openLink(){window.open(this.link,"_blank")}get hasLink(){return this.link.length>0}}return t.\u0275fac=function(e){return XA(e||t)},t.\u0275cmp=i.Ob({type:t,selectors:[["ng-component"]],features:[i.Db],decls:11,vars:6,consts:[["noMemory","true",1,"nitro-alert","d-flex","flex-column","bg-primary","border","shadow","rounded",3,"bringToTop","draggable"],[1,"drag-handler","d-flex","justify-content-center","align-items-center","px-3","pt-3"],[1,"m-0"],[1,"d-flex","flex-column","p-3"],[1,"d-flex","flex-column",3,"innerHTML"],[1,"d-flex","align-items-center","justify-content-center","mt-3"],["type","button","class","btn btn-link mr-1",3,"click",4,"ngIf"],["type","button",1,"btn","btn-secondary",3,"click"],["type","button",1,"btn","btn-link","mr-1",3,"click"]],template:function(t,e){1&t&&(i.Zb(0,"div",0),i.Zb(1,"div",1),i.Zb(2,"h6",2),i.Rc(3),i.Yb(),i.Yb(),i.Zb(4,"div",3),i.Vb(5,"div",4),i.Zb(6,"div",5),i.Pc(7,ZA,3,3,"button",6),i.Zb(8,"button",7),i.jc("click",(function(){return e.close()})),i.Rc(9),i.mc(10,"translate"),i.Yb(),i.Yb(),i.Yb(),i.Yb()),2&t&&(i.Gb(3),i.Sc(e.title),i.Gb(2),i.sc("innerHTML",e.message,i.Fc),i.Gb(2),i.sc("ngIf",e.hasLink),i.Gb(2),i.Sc(i.nc(10,4,"generic.close")))},directives:[op,dp,o.m],pipes:[Ep],encapsulation:2}),t})();const XA=i.bc(zA);function KA(t,e){if(1&t&&(i.Xb(0),i.Vb(1,"div",8),i.Wb()),2&t){const t=e.$implicit;i.Gb(1),i.sc("innerHTML",t,i.Fc)}}let qA=(()=>{class t extends BA{constructor(){super(...arguments),this.messages=[]}}return t.\u0275fac=function(e){return JA(e||t)},t.\u0275cmp=i.Ob({type:t,selectors:[["ng-component"]],features:[i.Db],decls:11,vars:5,consts:[["noMemory","true",1,"nitro-alert","multiple-messages","d-flex","flex-column","bg-primary","border","shadow","rounded",3,"bringToTop","draggable"],[1,"drag-handler","d-flex","justify-content-center","align-items-center","px-3","pt-3"],[1,"m-0"],[1,"d-flex","flex-column","p-3"],[1,"position-relative","w-100",2,"min-height","275px","max-height","275px","height","275px"],[4,"ngFor","ngForOf"],[1,"d-flex","flex-column","align-items-center","justify-content-center","mt-3"],["type","button",1,"btn","btn-secondary",3,"click"],[1,"d-flex","flex-column",3,"innerHTML"]],template:function(t,e){1&t&&(i.Zb(0,"div",0),i.Zb(1,"div",1),i.Zb(2,"h6",2),i.Rc(3),i.Yb(),i.Yb(),i.Zb(4,"div",3),i.Zb(5,"perfect-scrollbar",4),i.Pc(6,KA,2,1,"ng-container",5),i.Yb(),i.Zb(7,"div",6),i.Zb(8,"button",7),i.jc("click",(function(){return e.close()})),i.Rc(9),i.mc(10,"translate"),i.Yb(),i.Yb(),i.Yb(),i.Yb()),2&t&&(i.Gb(3),i.Sc(e.title),i.Gb(3),i.sc("ngForOf",e.messages),i.Gb(3),i.Sc(i.nc(10,3,"generic.close")))},directives:[op,dp,u.b,o.l],pipes:[Ep],encapsulation:2}),t})();const JA=i.bc(qA),QA=["alertsContainer"];function $A(t,e){}let ty=(()=>{class t{constructor(t,e,s){this._notificationService=t,this._componentFactoryResolver=e,this._ngZone=s,this._alerts=new Map}ngOnInit(){this._notificationService.component=this}ngOnDestroy(){this._notificationService.component=null}alert(t,e=null){return this.buildAlert(BA,t,e)}alertWithLink(t,e=null,s=null){const i=this.buildAlert(zA,t,s);return i?(i.link=e,i):null}alertWithConfirm(t,e=null,s=null){const i=this.buildAlert(HA,t,e);return i?(i.callback=s,i):null}alertWithScrollableMessages(t,e=null){const s=this.buildAlert(qA,null,e);if(!s)return;const i=[];for(const r of t)r&&i.push(r.replace(/\r\n|\r|\n/g,"<br />"));return s.messages=i,s}buildAlert(t,e,s=null){let i=null;return this._ngZone.run(()=>{i=this.createComponent(t),s?s.startsWith("${")&&(s=um.instance.getLocalization(s)):s=um.instance.getLocalization("${mod.alert.title}"),e&&(e.startsWith("${")&&(e=um.instance.getLocalization(e)),e=e.replace(/\r\n|\r|\n/g,"<br />")),i.title=s,i.message=e}),i||null}createComponent(t){if(!t)return null;let e=null;const s=this._componentFactoryResolver.resolveComponentFactory(t);let i=null;return s&&(i=this.alertsContainer.createComponent(s),this._alerts.set(i.instance,i)),e=i.instance,e}close(t){if(!t)return;const e=this._alerts.get(t);e&&(this._alerts.delete(t),this.removeView(e.hostView))}closeAll(){for(const t of this._alerts.keys())this.close(t)}removeView(t){if(!t)return;const e=this.alertsContainer.indexOf(t);-1!==e&&this.alertsContainer.remove(e)}}return t.\u0275fac=function(e){return new(e||t)(i.Ub(Nm),i.Ub(i.l),i.Ub(i.E))},t.\u0275cmp=i.Ob({type:t,selectors:[["nitro-notification-main-component"]],viewQuery:function(t,e){if(1&t&&i.Wc(QA,!0,i.W),2&t){let t;i.Ac(t=i.kc())&&(e.alertsContainer=t.first)}},decls:2,vars:0,consts:[["alertsContainer",""]],template:function(t,e){1&t&&i.Pc(0,$A,0,0,"ng-template",null,0,i.Qc)},encapsulation:2}),t})();const ey=["progressBar"],sy=["nitro-achievements-category-list-component",""];function iy(t,e){if(1&t&&(i.Zb(0,"div",13),i.Rc(1),i.Yb()),2&t){const t=i.lc().$implicit,e=i.lc();i.Gb(1),i.Sc(e.getUnseenCount(t))}}const ry=function(t){return[t]},ny=function(t){return{"background-image":t}};function ay(t,e){if(1&t){const t=i.ac();i.Zb(0,"div",9),i.jc("click",(function(){i.Ec(t);const s=e.$implicit;return i.lc().selectCategory(s)})),i.Zb(1,"div",10),i.Pc(2,iy,2,1,"div",11),i.Zb(3,"div",12),i.Rc(4),i.Yb(),i.Yb(),i.Yb()}if(2&t){const t=e.$implicit,s=i.lc();i.Gb(1),i.sc("ngClass",i.vc(4,ry,s.selectedCategory===t?"bg-primary":"bg-secondary"))("ngStyle",i.vc(6,ny,"url("+s.getCategoryImage(t.name,t.achievements)+")")),i.Gb(1),i.sc("ngIf",s.getUnseenCount(t)),i.Gb(2),i.Sc(s.getCategoryProgress(t.achievements))}}const oy=function(t){return{width:t}};let cy=(()=>{class t{constructor(t,e,s){this._settingsService=t,this._achivementsService=e,this._ngZone=s,this.visible=!1}selectCategory(t){this._achivementsService.selectedCategory=t}getProgressNumbers(){let t=0,e=0;for(const s of this.categories)if(s)for(const i of s.achievements)i&&(t+=i._Str_7518?i.level:i.level-1,e+=i.totalLevels);return[t,e]}getProgressPercentageString(){const[t,e]=this.getProgressNumbers();return Math.trunc(t/e*100)+"%"}getProgressString(){const[t,e]=this.getProgressNumbers();return t+"/"+e}getCategoryImage(t,e,s=!1){if(s)return um.instance.getConfiguration("achievements.images.url",um.instance.core.configuration.getValue("c.images.url")+`/quests/achcategory_${t}.png`).toString().replace("%image%",t);let i=0;for(const n of e)i+=n._Str_7518?n.level:n.level-1;const r=i>0?"active":"inactive";return um.instance.getConfiguration("achievements.images.url",um.instance.core.configuration.getValue("c.images.url")+`/quests/achcategory_${t}_${r}.png`).toString().replace("%image%",`achcategory_${t}_${r}`)}getCategoryProgress(t){let e=0,s=0;for(const i of t)i&&(i._Str_7518&&(e=e+1+i.level),s+=i.totalLevels);return e+"/"+s}getUnseenCount(t){let e=0;if(t)for(const s of t.achievements)s&&(e+=s.unseen);return e}get categories(){return this._achivementsService.categories}get selectedCategory(){return this._achivementsService.selectedCategory}get achievementScore(){return this._achivementsService.achievementScore}}return t.\u0275fac=function(e){return new(e||t)(i.Ub(gm),i.Ub(mm),i.Ub(i.E))},t.\u0275cmp=i.Ob({type:t,selectors:[["","nitro-achievements-category-list-component",""]],viewQuery:function(t,e){if(1&t&&i.Wc(ey,!0),2&t){let t;i.Ac(t=i.kc())&&(e.progressBar=t.first)}},inputs:{visible:"visible"},attrs:sy,decls:12,vars:10,consts:[[1,"grid-container","achievement-category-container","w-100","mb-2"],[1,"grid-items","grid-3"],["class","d-flex flex-column item-detail justify-content-center align-items-center",3,"click",4,"ngFor","ngForOf"],[1,"d-flex","flex-column","w-100"],[1,"achievement-progress-bar","bg-secondary","rounded","p-1","position-relative"],[1,"achievement-progress-bar-inner","bg-success","rounded","py-3",3,"ngStyle"],[1,"achievement-progress-bar-content","text-center","d-flex","justify-content-center"],[1,"align-self-center"],[1,"text-center","bg-secondary","rounded","px-2","mt-2"],[1,"d-flex","flex-column","item-detail","justify-content-center","align-items-center",3,"click"],[1,"detail-info","has-image","rounded",3,"ngClass","ngStyle"],["class","position-absolute btn btn-sm btn-primary px-1 py-0 rounded count",4,"ngIf"],[1,"achievement-progress"],[1,"position-absolute","btn","btn-sm","btn-primary","px-1","py-0","rounded","count"]],template:function(t,e){1&t&&(i.Zb(0,"div",0),i.Zb(1,"div",1),i.Pc(2,ay,5,8,"div",2),i.Yb(),i.Yb(),i.Zb(3,"div",3),i.Zb(4,"div",4),i.Vb(5,"div",5),i.Zb(6,"div",6),i.Zb(7,"span",7),i.Rc(8),i.Yb(),i.Yb(),i.Yb(),i.Zb(9,"div",8),i.Rc(10),i.mc(11,"translate"),i.Yb(),i.Yb()),2&t&&(i.Gb(2),i.sc("ngForOf",e.categories),i.Gb(3),i.sc("ngStyle",i.vc(8,oy,e.getProgressPercentageString())),i.Gb(3),i.Sc(e.getProgressString()),i.Gb(2),i.Sc(i.pc(11,4,"achievements.categories.score","score",e.achievementScore)))},directives:[o.l,o.n,o.k,o.m],pipes:[Ep],encapsulation:2}),t})();class _y{constructor(t){this.badgeId=t,this._base="",this._level=1,this.parseText()}parseText(){let t=this.badgeId.length-1;for(;t>0&&this.isNumber(this.badgeId.charAt(t));)t--;this._base=this.badgeId.substr(0,t+1);const e=this.badgeId.substr(t+1,this.badgeId.length);e&&""!=e&&(this._level=Number.parseInt(e))}isNumber(t){const e=t.charCodeAt(0);return e>=49&&e<=57}set level(t){this._level=Math.max(1,t)}get level(){return this._level}get getBadgeId(){return this._base+this._level}get base(){return this._base}}const hy=["nitro-achievements-category-component",""];function ly(t,e){if(1&t&&(i.Zb(0,"div",8),i.Rc(1),i.Yb()),2&t){const t=i.lc().$implicit;i.Gb(1),i.Sc(t.count)}}const uy=function(t,e){return[t,e]},dy=function(t){return{"background-image":t}};function gy(t,e){if(1&t){const t=i.ac();i.Zb(0,"div",5),i.jc("click",(function(){i.Ec(t);const s=e.$implicit;return i.lc().selectAchievement(s)})),i.Zb(1,"div",6),i.Pc(2,ly,2,1,"div",7),i.Yb(),i.Yb()}if(2&t){const t=e.$implicit,s=i.lc();i.Gb(1),i.sc("ngClass",i.wc(3,uy,s.selectedAchievement===t?"bg-primary":"bg-secondary",t&&t._Str_10438?"":"greyscale"))("ngStyle",i.vc(6,dy,"url("+s.getBadgeImageUrl(t)+")")),i.Gb(1),i.sc("ngIf",t.count)}}function my(t,e){if(1&t&&(i.Zb(0,"span",19),i.Rc(1),i.mc(2,"translate"),i.Zb(3,"b"),i.Rc(4),i.Yb(),i.Vb(5,"img",20),i.Yb()),2&t){const t=i.lc(2);i.Gb(1),i.Tc("",i.nc(2,3,"achievements.details.reward")," "),i.Gb(3),i.Sc(t.selectedAchievement.rewardAmount),i.Gb(1),i.sc("src",t.getCurrencyUrl(t.selectedAchievement.rewardType),i.Gc)}}const py=function(t){return{width:t}};function Ey(t,e){if(1&t&&(i.Zb(0,"div",21),i.Vb(1,"div",22),i.Zb(2,"div",23),i.Zb(3,"span",24),i.Rc(4),i.Yb(),i.Yb(),i.Yb()),2&t){const t=i.lc(2);i.Gb(1),i.sc("ngStyle",i.vc(2,py,t.getProgress(t.selectedAchievement))),i.Gb(3),i.Sc(t.getProgress(t.selectedAchievement,!0))}}const fy=function(t){return[t]};function Sy(t,e){if(1&t&&(i.Zb(0,"div",9),i.Zb(1,"div",10),i.Zb(2,"div",11),i.Vb(3,"img",12),i.Yb(),i.Zb(4,"span",13),i.Rc(5),i.Yb(),i.Yb(),i.Zb(6,"div",14),i.Zb(7,"span",15),i.Rc(8),i.Yb(),i.Zb(9,"span",16),i.Rc(10),i.Yb(),i.Pc(11,my,6,5,"span",17),i.Pc(12,Ey,5,4,"div",18),i.Yb(),i.Yb()),2&t){const t=i.lc();i.Gb(3),i.sc("ngClass",i.vc(7,fy,t.selectedAchievement._Str_10438?"":"greyscale"))("src",t.getBadgeImageUrl(t.selectedAchievement),i.Gc),i.Gb(2),i.Sc(t.getBadgeLevelString(t.selectedAchievement)),i.Gb(3),i.Sc(t.getBadgeText(t.selectedAchievement)),i.Gb(2),i.Sc(t.getBadgeText(t.selectedAchievement,!0)),i.Gb(1),i.sc("ngIf",!t.selectedAchievement._Str_7518),i.Gb(1),i.sc("ngIf",!t.selectedAchievement._Str_7518)}}let by=(()=>{class t{constructor(t){this._achivementsService=t,this.category=null,this._selectedAchievement=null}ngOnChanges(t){const e=t.category.currentValue;e&&e!==t.category.previousValue&&(this._selectedAchievement=null)}selectAchievement(t){t.unseen=0,this._selectedAchievement=t}getAchievedBadgeId(t){return t._Str_7518?t.badgeId:um.instance.localization.getBadgeBaseAndLevel(t.badgeId)}getBadgeText(t,e=!1){const s=this.getAchievedBadgeId(t),i=new _y(s);let r;return r=this.getText(e?["badge_desc_"+s,"badge_desc_"+i.base]:["badge_name_"+s,"badge_name_"+i.base]),r.replace("%roman%",this.getRomanNumeral(i.level)).replace("%limit%",t._Str_24142.toString())}getText(t){let e="",s=0;for(;s<t.length;){const i=t[s];if(e=um.instance.getLocalization(i),e!==i)return e;s++}return""}getProgress(t,e=!1){if(t)return e?t.progress+"/"+t.toNextProgress:Math.trunc(t.progress/t.toNextProgress*100)+"%"}getBadgeLevelString(t){if(!t)return;let e=um.instance.getLocalization("achievements.details.level");return e=e.replace("%level%",Math.max(1,t.level-1).toString()),e=e.replace("%limit%",t.totalLevels.toString()),e}getRomanNumeral(t){return um.instance.localization.getRomanNumeral(t)}getBadgeImageUrl(t){let e=t.badgeId;return t.totalLevels>1&&(e=e.replace(/[0-9]/g,""),e+=t.level-1>0?t.level-1:t.level),um.instance.sessionDataManager.getBadgeUrl(e)}getCurrencyUrl(t){return um.instance.getConfiguration("currency.asset.icon.url").replace("%type%",t.toString())}get selectedAchievement(){return this._selectedAchievement}}return t.\u0275fac=function(e){return new(e||t)(i.Ub(mm))},t.\u0275cmp=i.Ob({type:t,selectors:[["","nitro-achievements-category-component",""]],inputs:{category:"category"},features:[i.Eb],attrs:hy,decls:7,vars:5,consts:[[1,"text-center","bg-secondary","rounded","px-2","mb-2"],[1,"grid-container","w-100","mb-2",2,"min-height","156px","max-height","156px","height","156px"],[1,"grid-items","grid-5"],["class","d-flex flex-column item-detail justify-content-center align-items-center",3,"click",4,"ngFor","ngForOf"],["class","bg-secondary mb-auto w-100 p-1 rounded d-flex flex-row",4,"ngIf"],[1,"d-flex","flex-column","item-detail","justify-content-center","align-items-center",3,"click"],[1,"detail-info","has-image","rounded",3,"ngClass","ngStyle"],["class","position-absolute btn btn-sm btn-danger px-1 py-0 rounded count",4,"ngIf"],[1,"position-absolute","btn","btn-sm","btn-danger","px-1","py-0","rounded","count"],[1,"bg-secondary","mb-auto","w-100","p-1","rounded","d-flex","flex-row"],[1,"text-center"],[1,"badge_preview","flex-shrink-0","justify-content-center","d-flex"],[1,"badge_preview_image","align-self-center",3,"ngClass","src"],[1,"font-weight-bolder","text-center","small"],[1,"badge_info","w-100","small"],[1,"mb-1","font-weight-bolder"],[1,"mb-1","d-block",2,"min-height","42px"],["class","mb-1 d-block",4,"ngIf"],["class","achievement-progress-bar bg-primary rounded p-1 position-relative",4,"ngIf"],[1,"mb-1","d-block"],[1,"pl-1",3,"src"],[1,"achievement-progress-bar","bg-primary","rounded","p-1","position-relative"],[1,"achievement-progress-bar-inner","bg-success","rounded","py-3",3,"ngStyle"],[1,"achievement-progress-bar-content","text-center","d-flex","justify-content-center"],[1,"align-self-center"]],template:function(t,e){1&t&&(i.Zb(0,"div",0),i.Rc(1),i.mc(2,"translate"),i.Yb(),i.Zb(3,"perfect-scrollbar",1),i.Zb(4,"div",2),i.Pc(5,gy,3,8,"div",3),i.Yb(),i.Yb(),i.Pc(6,Sy,13,9,"div",4)),2&t&&(i.Gb(1),i.Sc(i.nc(2,3,"quests."+e.category.name+".name")),i.Gb(4),i.sc("ngForOf",e.category.achievements),i.Gb(1),i.sc("ngIf",e.selectedAchievement))},directives:[u.b,o.l,o.m,o.k,o.n],pipes:[Ep],encapsulation:2}),t})();function Ry(t,e){if(1&t&&i.Vb(0,"div",9),2&t){const t=i.lc(2);i.sc("category",t.selectedCategory)}}function Iy(t,e){if(1&t){const t=i.ac();i.Zb(0,"div",1),i.Zb(1,"div",2),i.Zb(2,"h6",3),i.Rc(3),i.mc(4,"translate"),i.Yb(),i.Zb(5,"button",4),i.jc("click",(function(){return i.Ec(t),i.lc().hide()})),i.Vb(6,"i",5),i.Yb(),i.Yb(),i.Zb(7,"div",6),i.Vb(8,"div",7),i.Pc(9,Ry,1,1,"div",8),i.Yb(),i.Yb()}if(2&t){const t=i.lc();i.Gb(3),i.Sc(i.nc(4,2,"inventory.achievements")),i.Gb(6),i.sc("ngIf",t.selectedCategory)}}let vy=(()=>{class t{constructor(t,e,s){this._settingsService=t,this._achivementsService=e,this._ngZone=s,this.visible=!1}ngOnChanges(t){const e=t.visible.currentValue;e&&e!==(t.visible.previousValue||!1)&&this.prepareAchievements()}prepareAchievements(){this._achivementsService.isInitalized||this._achivementsService.loadAchievements()}hide(){this._settingsService.hideAchievements()}get selectedCategory(){return this._achivementsService.selectedCategory}}return t.\u0275fac=function(e){return new(e||t)(i.Ub(gm),i.Ub(mm),i.Ub(i.E))},t.\u0275cmp=i.Ob({type:t,selectors:[["nitro-achievements-main-component"]],inputs:{visible:"visible"},features:[i.Eb],decls:1,vars:1,consts:[["class","nitro-achievements card",3,"bringToTop","draggable",4,"ngIf"],[1,"nitro-achievements","card",3,"bringToTop","draggable"],[1,"drag-handler","d-flex","justify-content-between","align-items-center","px-3","pt-3"],[1,"m-0"],["type","button",1,"close",3,"click"],[1,"fas","fa-times"],[1,"row","p-3"],["nitro-achievements-category-list-component","",1,"col-6","d-flex","flex-column"],["class","col-6 d-flex flex-column","nitro-achievements-category-component","",3,"category",4,"ngIf"],["nitro-achievements-category-component","",1,"col-6","d-flex","flex-column",3,"category"]],template:function(t,e){1&t&&i.Pc(0,Iy,10,4,"div",0),2&t&&i.sc("ngIf",e.visible)},directives:[o.m,op,dp,cy,by],pipes:[Ep],encapsulation:2}),t})(),Ty=(()=>{class t{constructor(t,e){this._callForHelpService=t,this._ngZone=e}ngOnInit(){this._callForHelpService.component=this}ngOnDestroy(){this._callForHelpService.component=null}}return t.\u0275fac=function(e){return new(e||t)(i.Ub(Sp),i.Ub(i.E))},t.\u0275cmp=i.Ob({type:t,selectors:[["nitro-call-for-help-main-component"]],decls:0,vars:0,template:function(t,e){},encapsulation:2}),t})(),Oy=(()=>{class t{constructor(t){this._habbopediaService=t,this.url=""}close(){this._habbopediaService.closePage(this)}}return t.\u0275fac=function(e){return new(e||t)(i.Ub(Jf))},t.\u0275cmp=i.Ob({type:t,selectors:[["ng-component"]],decls:0,vars:0,template:function(t,e){},encapsulation:2}),t})();const Ay=["pagesContainer"];function yy(t,e){}let Cy=(()=>{class t{constructor(t,e,s){this._habbopediaService=t,this._componentFactoryResolver=e,this._ngZone=s,this._pages=new Map}ngOnInit(){this._habbopediaService.component=this,um.instance.addLinkEventTracker(this)}ngOnDestroy(){um.instance.removeLinkEventTracker(this),this._habbopediaService.component=null}openPage(t){this.buildPage(Oy,t)}buildPage(t,e){const s=this.createComponent(t);return s?(s.url=e,s):null}createComponent(t){if(!t)return null;const e=this._componentFactoryResolver.resolveComponentFactory(t);let s=null;return e&&(s=this.pagesContainer.createComponent(e),this._pages.set(s.instance,s)),s.instance}close(t){if(!t)return;const e=this._pages.get(t);e&&(this._pages.delete(t),this.removeView(e.hostView))}closeAll(){for(const t of this._pages.keys())this.close(t)}removeView(t){if(!t)return;const e=this.pagesContainer.indexOf(t);-1!==e&&this.pagesContainer.remove(e)}linkReceived(t){const e=t.split("/");e.length<2||(e.shift(),this.openPage(e.join("/")))}get eventUrlPrefix(){return"habbopages/"}}return t.\u0275fac=function(e){return new(e||t)(i.Ub(Jf),i.Ub(i.l),i.Ub(i.E))},t.\u0275cmp=i.Ob({type:t,selectors:[["nitro-pedia-main-component"]],viewQuery:function(t,e){if(1&t&&i.Wc(Ay,!0,i.W),2&t){let t;i.Ac(t=i.kc())&&(e.pagesContainer=t.first)}},decls:2,vars:0,consts:[["pagesContainer",""]],template:function(t,e){1&t&&i.Pc(0,yy,0,0,"ng-template",null,0,i.Qc)},encapsulation:2}),t})(),My=(()=>{class t{transform(t,e){if(isNaN(t))return 0;if(null===t)return 0;if(0===t)return 0;let s=Math.abs(t);const i=Math.pow(10,1),r=t<0;let n="";const a=[{key:"Q",value:Math.pow(10,15)},{key:"T",value:Math.pow(10,12)},{key:"B",value:Math.pow(10,9)},{key:"M",value:Math.pow(10,6)},{key:"K",value:1e3}];for(let o=0;o<a.length;o++){let t=s/a[o].value;if(t=Math.round(t*i)/i,t>=1){s=t,n=a[o].key;break}}return(r?"-":"")+s+n}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275pipe=i.Tb({name:"shortNumber",type:t,pure:!0}),t})();const Dy=function(t,e,s){return{"bg-pink":t,"bg-warning":e,"bg-skyBlue":s}},Ny=function(t){return{"background-image":t}};function wy(t,e){if(1&t&&(i.Zb(0,"div",4),i.Zb(1,"div",5),i.Rc(2),i.mc(3,"shortNumber"),i.Yb(),i.Zb(4,"div",9),i.Vb(5,"div",7),i.Yb(),i.Yb()),2&t){const t=i.lc().$implicit,e=i.lc();i.Gb(2),i.Tc(" ",i.nc(3,3,t.value),""),i.Gb(2),i.sc("ngClass",i.xc(5,Dy,0==t.key,-1==t.key,5==t.key)),i.Gb(1),i.sc("ngStyle",i.vc(9,Ny,"url("+e.getCurrencyUrl(t.key.toString())+")"))}}function Uy(t,e){if(1&t&&(i.Xb(0),i.Pc(1,wy,6,11,"div",8),i.Wb()),2&t){const t=e.$implicit,s=i.lc();i.Gb(1),i.sc("ngIf",s.isVisible(t.key))}}let Ly=(()=>{class t{constructor(t){this._purseService=t}ngOnInit(){this._purseService.requestUpdate()}isVisible(t){return-1!==this._purseService.visibleCurrencies.indexOf(t)}getCurrencyUrl(t){return um.instance.getConfiguration("currency.asset.icon.url").replace("%type%",t)}get currencies(){return this._purseService.currencies}get hcDay(){if(!this._purseService.hcSub)return;const t=dI.shortFormat(60*this._purseService.hcSub.totalSeconds);return this._purseService.hcSub.totalSeconds?t:um.instance.localization.getValue("purse.clubdays.zero.amount.text")}get isReady(){return this._purseService.isReady}}return t.\u0275fac=function(e){return new(e||t)(i.Ub(ME))},t.\u0275cmp=i.Ob({type:t,selectors:[["nitro-purse-main-component"]],decls:10,vars:7,consts:[[1,"nitro-purse-component","float-right"],[1,"position-relative","mb-1"],[1,"row","px-0","mx-0"],[4,"ngFor","ngForOf"],[1,"col","item-detail","btn","btn-primary","rounded","d-flex","nohover"],[1,"d-flex","flex-grow-1","align-items-center","justify-content-end","detail-value"],[1,"detail-icon","bg-orange"],[1,"currency-icon",3,"ngStyle"],["class","col item-detail btn btn-primary rounded d-flex nohover",4,"ngIf"],[1,"detail-icon","bg-secondary",3,"ngClass"]],template:function(t,e){1&t&&(i.Zb(0,"div",0),i.Zb(1,"div",1),i.Zb(2,"div",2),i.Pc(3,Uy,2,1,"ng-container",3),i.mc(4,"keyvalue"),i.Zb(5,"div",4),i.Zb(6,"div",5),i.Rc(7),i.Yb(),i.Zb(8,"div",6),i.Vb(9,"div",7),i.Yb(),i.Yb(),i.Yb(),i.Yb(),i.Yb()),2&t&&(i.Gb(3),i.sc("ngForOf",i.nc(4,3,e.currencies)),i.Gb(4),i.Tc(" ",e.hcDay," "),i.Gb(2),i.sc("ngStyle",i.vc(5,Ny,"url("+e.getCurrencyUrl("hc")+")")))},directives:[o.l,o.n,o.m,o.k],pipes:[o.g,My],encapsulation:2}),t})(),Py=(()=>{class t{constructor(t){this._notificationService=t,this.image="",this.message="",this.removing=!1,setTimeout(()=>{this.removing=!0},1e3),setTimeout(()=>{this.close()},5e3)}close(){this._notificationService.notificationCentre.close(this)}}return t.\u0275fac=function(e){return new(e||t)(i.Ub(Nm))},t.\u0275cmp=i.Ob({type:t,selectors:[["ng-component"]],decls:6,vars:4,consts:[[1,"nitro-notification-dialog","btn","btn-primary","rounded"],[1,"d-flex","flex-row"],[1,"nitro-notification-dialog-message"],[1,"bg-secondary","rounded","nitro-notification-dialog-image"],[3,"src"]],template:function(t,e){1&t&&(i.Zb(0,"div",0),i.Zb(1,"div",1),i.Zb(2,"div",2),i.Rc(3),i.Yb(),i.Zb(4,"div",3),i.Vb(5,"img",4),i.Yb(),i.Yb(),i.Yb()),2&t&&(i.Mb("removing",e.removing),i.Gb(3),i.Tc(" ",e.message," "),i.Gb(2),i.sc("src",e.image,i.Gc))},encapsulation:2}),t})();const xy=["alertsContainer"];function Fy(t,e){}let Gy=(()=>{class t{constructor(t,e,s){this._notificationService=t,this._componentFactoryResolver=e,this._ngZone=s,this._alerts=new Map}ngOnInit(){this._notificationService.notificationCentre=this}ngOnDestroy(){this._notificationService.notificationCentre=null}publish(t,e){const s=t[0].split("}"),i=um.instance.core.configuration.getValue("c.images.url")+"/"+s[1];return this.buildPublish(t[2],i)}buildPublish(t,e){let s=null;return this._ngZone.run(()=>{s=this.createComponent(Py),t&&(t.startsWith("${")&&(t=um.instance.getLocalization(t)),t=t.replace(/\r\n|\r|\n/g,"<br />")),s.message=t,s.image=e}),s||null}createComponent(t){if(!t)return null;let e=null;const s=this._componentFactoryResolver.resolveComponentFactory(t);let i=null;return s&&(i=this.alertsContainer.createComponent(s),this._alerts.set(i.instance,i)),e=i.instance,e}close(t){if(!t)return;const e=this._alerts.get(t);e&&(this._alerts.delete(t),this.removeView(e.hostView))}removeView(t){if(!t)return;const e=this.alertsContainer.indexOf(t);-1!==e&&this.alertsContainer.remove(e)}get alerts(){return this._alerts}}return t.\u0275fac=function(e){return new(e||t)(i.Ub(Nm),i.Ub(i.l),i.Ub(i.E))},t.\u0275cmp=i.Ob({type:t,selectors:[["nitro-notification-centre-component"]],viewQuery:function(t,e){if(1&t&&i.Wc(xy,!0,i.W),2&t){let t;i.Ac(t=i.kc())&&(e.alertsContainer=t.first)}},decls:3,vars:0,consts:[[1,"d-flex","flex-column-reverse"],["alertsContainer",""]],template:function(t,e){1&t&&(i.Zb(0,"div",0),i.Pc(1,Fy,0,0,"ng-template",null,1,i.Qc),i.Yb())},encapsulation:2}),t})(),Vy=(()=>{class t{constructor(t){this._ngZone=t,this._userId=-1,this._userName=null,this._figure=null,this._gender=null,this.registerMessages()}ngOnDestroy(){this.unregisterMessages()}registerMessages(){this._ngZone.runOutsideAngular(()=>{this._messages=[new ko(this.onUserInfoEvent.bind(this)),new Go(this.onUserFigureEvent.bind(this))];for(const t of this._messages)um.instance.communication.registerMessageEvent(t)})}unregisterMessages(){this._ngZone.runOutsideAngular(()=>{for(const t of this._messages)um.instance.communication.removeMessageEvent(t);this._messages=[]})}onUserInfoEvent(t){if(!t)return;const e=t.getParser();if(!e)return;const s=e.userInfo;this._ngZone.run(()=>{this._userId=s.userId,this._userName=s.username,this._figure=s.figure,this._gender=s.gender})}onUserFigureEvent(t){if(!t)return;const e=t.getParser();e&&this._ngZone.run(()=>{this._figure=e.figure,this._gender=e.gender})}get userId(){return this._userId}get userName(){return this._userName}get figure(){return this._figure}get gender(){return this._gender}}return t.\u0275fac=function(e){return new(e||t)(i.gc(i.E))},t.\u0275prov=i.Qb({token:t,factory:t.\u0275fac}),t})();const Yy=function(t){return{background:t}},ky=function(t){return{backgroundImage:t}};let jy=(()=>{class t{constructor(t){this.sessionService=t;const e=um.instance.getConfiguration("asset.url");this._background=um.instance.getConfiguration("hotelview.images").background.replace("%asset.url%",e),this._backgroundColour=um.instance.getConfiguration("hotelview.images")["background.colour"],this._sun=um.instance.getConfiguration("hotelview.images").sun.replace("%asset.url%",e),this._drape=um.instance.getConfiguration("hotelview.images").drape.replace("%asset.url%",e),this._left=um.instance.getConfiguration("hotelview.images").left.replace("%asset.url%",e),this._right=um.instance.getConfiguration("hotelview.images").right.replace("%asset.url%",e),this._rightRepeat=um.instance.getConfiguration("hotelview.images")["right.repeat"].replace("%asset.url%",e)}get figure(){return this.sessionService.figure}get background(){return this._background||null}get backgroundColour(){return this._backgroundColour||null}get sun(){return this._sun||null}get drape(){return this._drape||null}get left(){return this._left||null}get right(){return this._right||null}get rightRepeat(){return this._rightRepeat||null}}return t.\u0275fac=function(e){return new(e||t)(i.Ub(Vy))},t.\u0275cmp=i.Ob({type:t,selectors:[["nitro-hotelview-component"]],decls:7,vars:11,consts:[[1,"nitro-hotelview-component",3,"ngStyle"],[1,"background","position-absolute",3,"ngStyle"],[1,"sun","position-absolute",3,"src"],[1,"drape","position-absolute",3,"src"],[1,"left","position-absolute",3,"src"],[1,"rightRepeat","position-absolute",3,"src"],[1,"right","position-absolute",3,"src"]],template:function(t,e){1&t&&(i.Zb(0,"div",0),i.Vb(1,"div",1),i.Vb(2,"img",2),i.Vb(3,"img",3),i.Vb(4,"img",4),i.Vb(5,"img",5),i.Vb(6,"img",6),i.Yb()),2&t&&(i.sc("ngStyle",i.vc(7,Yy,e.backgroundColour)),i.Gb(1),i.sc("ngStyle",i.vc(9,ky,"url("+e.background+")")),i.Gb(1),i.sc("src",e.sun,i.Gc),i.Gb(1),i.sc("src",e.drape,i.Gc),i.Gb(1),i.sc("src",e.left,i.Gc),i.Gb(1),i.sc("src",e.rightRepeat,i.Gc),i.Gb(1),i.sc("src",e.right,i.Gc))},directives:[o.n],encapsulation:2}),t})();class By{constructor(t){this._complete=!0,this._target=t}get running(){return this._running&&!!this._target}get complete(){return this._complete}set target(t){this._target=t}get target(){return this._target}set tag(t){this._tag=t}get tag(){return this._tag}start(){this._running=!0}update(t){}stop(){this._target=null,this._running=!1}tick(t){}}class Hy extends By{constructor(t){super(t)}tick(t){super.tick(t),this.target&&(this.target.remove(),this.target=null)}}class Wy extends By{constructor(t,e){super(t),this._complete=!1,this._duration=e}get duration(){return this._duration}start(){super.start(),this._complete=!1,this._startTimeMs=um.instance.time}tick(t){super.tick(t);const e=(t-this._startTimeMs)/this._duration;e<1?this.update(e):(this.update(1),this._complete=!0)}}class Zy extends Wy{constructor(t,e,s){super(t,e),this._height=s}start(){super.start(),this._offset=0,this.target.style.top=this._offset-this._height+"px"}update(t){super.update(t),this.target.style.top=this._offset-this._height+this.getBounceOffset(t)*this._height+"px"}getBounceOffset(t){return t<.364?7.5625*t*t:t<.727?7.5625*(t-=.545)*t+.75:t<.909?7.5625*(t-=.9091)*t+.9375:7.5625*(t-=.955)*t+.984375}stop(){this.target.style.top=this._offset+"px",super.stop()}}class zy extends Wy{constructor(t){super(t.target,t.duration),this._interval=t}start(){super.start(),this._interval.start()}update(t){super.update(t),this._interval.update(t)}stop(){super.stop(),this._interval.stop()}}class Xy extends zy{constructor(t,e){super(t),this._Str_21638=e}}class Ky extends Xy{constructor(t,e){super(t,e)}update(t){this._interval.update(Math.pow(t,1/this._Str_21638))}}class qy extends Wy{constructor(t,e,s,i,r,n){super(t,e),this._deltaX=s,this._deltaY=i,this._height=-r,this._numJumps=n}start(){super.start(),this._startX=this.target.offsetLeft,this._startY=this.target.offsetTop}update(t){super.update(t),this.target.style.left=this._startX+this._deltaX*t+"px",this.target.style.top=this._startY+this._height*Math.abs(Math.sin(t*Math.PI*this._numJumps))+this._deltaY*t+"px"}}let Jy=(()=>{class t{static get TIMER_TIME(){return 1e3/um.instance.ticker.FPS}static _Str_4598(e){return-1===t._Str_3932.indexOf(e)&&-1===t._Str_5358.indexOf(e)&&(t._Str_7507?t._Str_5358.push(e):(t._Str_3932.push(e),e.start()),t._Str_12757()),e}static _Str_15790(e){let s=t._Str_3932.indexOf(e);s>-1?t._Str_7507?(s=t._Str_10731.indexOf(e),-1==s&&t._Str_10731.push(e)):(t._Str_3932.splice(s,1),e.running&&e.stop(),t._Str_3932.length||t._Str_7465()):(s=t._Str_5358.indexOf(e),s>-1&&t._Str_5358.splice(s,1))}static _Str_19320(e){for(const s of t._Str_3932)if(s.tag==e)return s;for(const s of t._Str_5358)if(s.tag==e)return s;return null}static _Str_9810(e){for(const s of t._Str_3932)if(s.target==e)return s;for(const s of t._Str_5358)if(s.target==e)return s;return null}static _Str_26365(e,s){for(const i of t._Str_3932)if(i.tag==e&&i.target==s)return i;for(const i of t._Str_5358)if(i.tag==e&&i.target==s)return i;return null}static get _Str_1349(){return!!t._Str_5307}static get _Str_26314(){return t._Str_7507}static _Str_21055(){t._Str_7507=!0;const e=um.instance.time;let s=null;for(;s=t._Str_5358.pop();)t._Str_3932.push(s);for(;s=t._Str_10731.pop();)t._Str_3932.splice(t._Str_3932.indexOf(s),1),s.running&&s.stop();for(s of t._Str_3932)s.running?(s.tick(e),s.complete&&t._Str_15790(s)):t._Str_15790(s);t._Str_3932.length||t._Str_7465(),t._Str_7507=!1}static _Str_12757(){t._Str_5307||(t._Str_5307=setInterval(t._Str_21055,t.TIMER_TIME))}static _Str_7465(){t._Str_5307&&(clearInterval(t._Str_5307),t._Str_5307=null)}_Str_25883(e){let s=0;for(const i of t._Str_3932)i.target===e&&s++;return s}}return t._Str_5358=[],t._Str_3932=[],t._Str_10731=[],t._Str_5307=null,t._Str_7507=!1,t})();class Qy extends By{constructor(...t){super(t?t[0].target:null),this._queue=[];for(const e of t)this._queue.push(e);this._motion=t[0],this._complete=!this._motion}get running(){return!(!this._running||!this._motion)&&this._motion.running}start(){super.start(),this._motion.start()}update(t){super.update(t),this._motion.running&&this._motion.update(t)}stop(){super.stop(),this._motion.stop()}tick(t){if(super.tick(t),this._motion.tick(t),this._motion.complete){this._motion.stop();const t=this._queue.indexOf(this._motion);t<this._queue.length-1?(this._motion=this._queue[t+1],this._target=this._motion.target,this._motion.start()):this._complete=!0}}}class $y extends By{constructor(t){super(null),this._waitTimeMs=t}get running(){return this._running}start(){super.start(),this._complete=!1,this._startTimeMs=um.instance.time}tick(t){super.tick(t),this._complete=t-this._startTimeMs>=this._waitTimeMs,this._complete&&this.stop()}}function tC(t,e){if(1&t&&(i.Zb(0,"div",9),i.Rc(1),i.Yb()),2&t){const t=i.lc(2);i.Gb(1),i.Sc(t.unseenAchievementsCount)}}function eC(t,e){if(1&t){const t=i.ac();i.Zb(0,"div",1),i.Zb(1,"div",2),i.Zb(2,"ul",3),i.Zb(3,"li",4),i.jc("click",(function(){return i.Ec(t),i.lc().toggleAvatarEditor()})),i.Vb(4,"i",5),i.Zb(5,"span"),i.Rc(6),i.mc(7,"translate"),i.Yb(),i.Yb(),i.Zb(8,"li",4),i.jc("click",(function(){return i.Ec(t),i.lc().toggleAchievements()})),i.Vb(9,"i",6),i.Pc(10,tC,2,1,"div",7),i.Zb(11,"span"),i.Rc(12),i.mc(13,"translate"),i.Yb(),i.Yb(),i.Zb(14,"li",4),i.jc("click",(function(){return i.Ec(t),i.lc().toggleNavigator()})),i.Vb(15,"i",8),i.Zb(16,"span"),i.Rc(17),i.mc(18,"translate"),i.Yb(),i.Yb(),i.Yb(),i.Yb(),i.Yb()}if(2&t){const t=i.lc();i.sc("@inOutAnimation",void 0),i.Gb(6),i.Sc(i.nc(7,5,"widget.memenu.editavatar")),i.Gb(4),i.sc("ngIf",t.unseenAchievementsCount),i.Gb(2),i.Sc(i.nc(13,7,"widget.memenu.achievements")),i.Gb(5),i.Sc(i.nc(18,9,"widget.memenu.myrooms"))}}let sC=(()=>{class t{constructor(t,e,s,i,r){this._avatarEditorService=t,this.settingsService=e,this.navigatorService=s,this._achievementService=i,this._ngZone=r}ngOnInit(){}ngOnDestroy(){}get isVisible(){return this.settingsService.meMenuVisible||!1}toggleAvatarEditor(){this._avatarEditorService.loadOwnAvatarInEditor(),this.settingsService.toggleAvatarEditor()}toggleAchievements(){this.settingsService.toggleAchievements()}toggleNavigator(){this.settingsService.toggleNavigator(),this.navigatorService.setCurrentContextByCode("myworld_view")}get unseenAchievementsCount(){return this._achievementService.unseenCount}}return t.\u0275fac=function(e){return new(e||t)(i.Ub(wm),i.Ub(gm),i.Ub(QS),i.Ub(mm),i.Ub(i.E))},t.\u0275cmp=i.Ob({type:t,selectors:[["nitro-toolbar-me-menu-component"]],decls:1,vars:1,consts:[["class","card bg-secondary nitro-toolbar-me-menu",4,"ngIf"],[1,"card","bg-secondary","nitro-toolbar-me-menu"],[1,"d-flex","justify-content-between","w-100"],[1,"list-group","py-2"],[1,"list-group-item","py-1","flex-column",3,"click"],[1,"icon","icon-me-clothing","d-block"],[1,"icon","icon-me-achievements","d-block"],["class","position-absolute bg-danger px-1 py-0 rounded shadow count",4,"ngIf"],[1,"icon","icon-me-rooms","d-block"],[1,"position-absolute","bg-danger","px-1","py-0","rounded","shadow","count"]],template:function(t,e){1&t&&i.Pc(0,eC,19,11,"div",0),2&t&&i.sc("ngIf",e.isVisible)},directives:[o.m],pipes:[Ep],encapsulation:2,data:{animation:[Object(Lv.j)("inOutAnimation",[Object(Lv.i)(":enter",[Object(Lv.h)({left:0,opacity:0}),Object(Lv.e)(".3s ease-out",Object(Lv.h)({left:72,opacity:1}))]),Object(Lv.i)(":leave",[Object(Lv.h)({left:72,opacity:1}),Object(Lv.e)(".3s ease-in",Object(Lv.h)({left:0,opacity:0}))])])]}}),t})();const iC=["navigationList"];function rC(t,e){if(1&t){const t=i.ac();i.Zb(0,"li",6),i.jc("click",(function(){return i.Ec(t),i.lc().clickIcon("hotel_view")})),i.Vb(1,"i",15),i.Yb()}}function nC(t,e){if(1&t){const t=i.ac();i.Zb(0,"li",6),i.jc("click",(function(){return i.Ec(t),i.lc().clickIcon("home_room")})),i.Vb(1,"i",16),i.Yb()}}function aC(t,e){if(1&t&&(i.Zb(0,"div",17),i.Rc(1),i.Yb()),2&t){const t=i.lc();i.Gb(1),i.Sc(t.unseenInventoryCount)}}function oC(t,e){if(1&t&&(i.Zb(0,"div",17),i.Rc(1),i.Yb()),2&t){const t=i.lc();i.Gb(1),i.Sc(t.unseenFriendListCount)}}function cC(t,e){if(1&t&&(i.Zb(0,"div",17),i.Rc(1),i.Yb()),2&t){const t=i.lc();i.Gb(1),i.Sc(t.unseenAchievementsCount)}}let _C=(()=>{class t{constructor(t,e,s,i,r,n,a){this._inventoryService=t,this._navigatorService=e,this._friendListService=s,this._achievementService=i,this.sessionService=r,this.settingsService=n,this.ngZone=a,this.isInRoom=!1,this.onNitroToolbarEvent=this.onNitroToolbarEvent.bind(this)}ngOnInit(){this.ngZone.runOutsideAngular(()=>{um.instance.roomEngine.events.addEventListener(Ah.TOOLBAR_CLICK,this.onNitroToolbarEvent),um.instance.roomEngine.events.addEventListener(yh.ANIMATE_ICON,this.onNitroToolbarEvent)})}ngOnDestroy(){this.ngZone.runOutsideAngular(()=>{um.instance.roomEngine.events.removeEventListener(Ah.TOOLBAR_CLICK,this.onNitroToolbarEvent),um.instance.roomEngine.events.removeEventListener(yh.ANIMATE_ICON,this.onNitroToolbarEvent)})}onNitroToolbarEvent(t){if(t)switch(t.type){case Ah.TOOLBAR_CLICK:return void this.clickIcon(t.iconName);case yh.ANIMATE_ICON:return void this.animateToIcon(t.iconName,t.image,t.x,t.y)}}clickIcon(t){if(t&&""!==t)switch(t){case Oh.HOTEL_VIEW:return void this.visitDesktop();case Oh.HOME_ROOM:return void this.visitHomeRoom();case Oh.NAVIGATOR:return void this.toggleNavigator();case Oh.CATALOG:return void this.toggleCatalog();case Oh.INVENTORY:return void this.toggleInventory();case Oh.FRIEND_LIST:return void this.toggleFriendList();case Oh.ME_MENU:return this.toggleMeMenu(),void um.instance.roomEngine.events.dispatchEvent(new Ah(Ah.SELECT_OWN_AVATAR))}}animateToIcon(t,e,s,i){if(!t||!e||!this.navigationListElement)return;if(""===(t=this.getIconName(t)))return;const r=this.navigationListElement.getElementsByClassName(t)[0];if(r){e.className="toolbar-icon-animation",e.style.visibility="visible",e.style.left=s+"px",e.style.top=i+"px",document.body.append(e);const n=r.getBoundingClientRect(),a=e.getBoundingClientRect(),o=a.x-n.x,c=a.y-n.y,_=Math.sqrt(o*o+c*c),h=500-Math.abs(1/_*100*500*.5),l=20,u=`ToolbarBouncing[${t}]`;Jy._Str_19320(u)||(Jy._Str_4598(new Qy(new $y(h+8),new Zy(r,400,12))).tag=u);const d=new Qy(new Ky(new qy(e,h,n.x-a.x+l,n.y-a.y,100,1),1),new Hy(e));Jy._Str_4598(d)}}getIconName(t){switch(t){case Oh.HOTEL_VIEW:return"icon-hotelview";case Oh.NAVIGATOR:return"icon-navigator";case Oh.CATALOG:return"icon-catalog";case Oh.INVENTORY:return"icon-inventory";default:return""}}toggleCatalog(){this.settingsService.toggleCatalog()}toggleInventory(){this.settingsService.toggleInventory()}toggleFriendList(){this.settingsService.toggleFriendList()}toggleNavigator(){this.settingsService.toggleNavigator()}toggleMeMenu(){this.settingsService.toggleMeMenu()}visitDesktop(){um.instance.roomSessionManager.getSession(-1)&&(um.instance.communication.connection.send(new nc),um.instance.roomSessionManager.removeSession(-1))}visitHomeRoom(){this._navigatorService.goToHomeRoom()}get figure(){return this.sessionService.figure}get navigationListElement(){return this.navigationList&&this.navigationList.nativeElement||null}get unseenInventoryCount(){return this._inventoryService.unseenCount}get unseenFriendListCount(){return this._friendListService.notificationCount}get unseenAchievementsCount(){return this._achievementService.unseenCount}}return t.\u0275fac=function(e){return new(e||t)(i.Ub(Dm),i.Ub(QS),i.Ub(Ef),i.Ub(mm),i.Ub(Vy),i.Ub(gm),i.Ub(i.E))},t.\u0275cmp=i.Ob({type:t,selectors:[["nitro-toolbar-component"]],viewQuery:function(t,e){if(1&t&&i.Wc(iC,!0),2&t){let t;i.Ac(t=i.kc())&&(e.navigationList=t.first)}},inputs:{isInRoom:"isInRoom"},decls:22,vars:9,consts:[[1,"nitro-toolbar-component","d-flex","flex-row"],[1,"card","nitro-toolbar-component-body"],[1,"d-flex","justify-content-between","p-0","w-100"],["navigationList",""],[1,"list-group","list-group-vertical"],["class","list-group-item",3,"click",4,"ngIf"],[1,"list-group-item",3,"click"],[1,"icon","icon-rooms"],[1,"icon","icon-catalog"],[1,"icon","icon-inventory"],["class","position-absolute bg-danger px-1 py-0 rounded shadow count",4,"ngIf"],[1,"icon","icon-friendall"],[1,"list-group-item","splitter"],[1,"list-group-item","avatar-image",3,"click"],["nitro-avatar-image","",3,"figure","headOnly","direction"],[1,"icon","icon-hotelview","icon-nitro-light"],[1,"icon","icon-house"],[1,"position-absolute","bg-danger","px-1","py-0","rounded","shadow","count"]],template:function(t,e){1&t&&(i.Zb(0,"div",0),i.Zb(1,"div",1),i.Zb(2,"div",2,3),i.Zb(4,"ul",4),i.Pc(5,rC,2,0,"li",5),i.Pc(6,nC,2,0,"li",5),i.Zb(7,"li",6),i.jc("click",(function(){return e.clickIcon("navigator")})),i.Vb(8,"i",7),i.Yb(),i.Zb(9,"li",6),i.jc("click",(function(){return e.clickIcon("catalog")})),i.Vb(10,"i",8),i.Yb(),i.Zb(11,"li",6),i.jc("click",(function(){return e.clickIcon("inventory")})),i.Vb(12,"i",9),i.Pc(13,aC,2,1,"div",10),i.Yb(),i.Zb(14,"li",6),i.jc("click",(function(){return e.clickIcon("friendlist")})),i.Vb(15,"i",11),i.Pc(16,oC,2,1,"div",10),i.Yb(),i.Vb(17,"li",12),i.Zb(18,"li",13),i.jc("click",(function(){return e.clickIcon("me_menu")})),i.Vb(19,"div",14),i.Pc(20,cC,2,1,"div",10),i.Yb(),i.Yb(),i.Yb(),i.Yb(),i.Vb(21,"nitro-toolbar-me-menu-component"),i.Yb()),2&t&&(i.sc("@inOutAnimation",void 0),i.Gb(5),i.sc("ngIf",e.isInRoom),i.Gb(1),i.sc("ngIf",!e.isInRoom),i.Gb(7),i.sc("ngIf",e.unseenInventoryCount),i.Gb(3),i.sc("ngIf",e.unseenFriendListCount),i.Gb(3),i.sc("figure",e.figure)("headOnly",!0)("direction",2),i.Gb(1),i.sc("ngIf",e.unseenAchievementsCount))},directives:[o.m,pp,sC],encapsulation:2,data:{animation:[Object(Lv.j)("inOutAnimation",[Object(Lv.i)(":enter",[Object(Lv.h)({left:"-100%"}),Object(Lv.e)("1s ease-out",Object(Lv.h)({left:10}))])])]}}),t})();function hC(t,e){1&t&&(i.Zb(0,"div",5),i.Zb(1,"div",6),i.Vb(2,"nitro-purse-main-component"),i.Vb(3,"nitro-notification-centre-component"),i.Yb(),i.Yb()),2&t&&i.sc("@inOutAnimation",void 0)}function lC(t,e){1&t&&i.Vb(0,"nitro-hotelview-component")}function uC(t,e){if(1&t&&i.Vb(0,"nitro-toolbar-component",7),2&t){const t=i.lc();i.sc("isInRoom",!t.landingViewVisible)}}let dC=(()=>{class t{constructor(t,e,s){this._notificationService=t,this._settingsService=e,this._ngZone=s,this.roomComponent=null,this._landingViewVisible=!0,this.onRoomEngineEvent=this.onRoomEngineEvent.bind(this),this.onInterstitialEvent=this.onInterstitialEvent.bind(this),this.onRoomEngineObjectEvent=this.onRoomEngineObjectEvent.bind(this),this.onRoomSessionEvent=this.onRoomSessionEvent.bind(this)}ngOnInit(){this._ngZone.runOutsideAngular(()=>{um.instance.roomEngine.events&&(um.instance.roomEngine.events.addEventListener(ih.INITIALIZED,this.onRoomEngineEvent),um.instance.roomEngine.events.addEventListener(ih.DISPOSED,this.onRoomEngineEvent),um.instance.roomEngine.events.addEventListener(ih.ENGINE_INITIALIZED,this.onInterstitialEvent),um.instance.roomEngine.events.addEventListener(ih.OBJECTS_INITIALIZED,this.onInterstitialEvent),um.instance.roomEngine.events.addEventListener(ih.NORMAL_MODE,this.onInterstitialEvent),um.instance.roomEngine.events.addEventListener(ih.GAME_MODE,this.onInterstitialEvent),um.instance.roomEngine.events.addEventListener(Pv.ROOM_ZOOM,this.onRoomEngineEvent),um.instance.roomEngine.events.addEventListener(Sd.ROOM_BACKGROUND_COLOR,this.onRoomEngineEvent),um.instance.roomEngine.events.addEventListener(Dh.ROOM_COLOR,this.onRoomEngineEvent),um.instance.roomEngine.events.addEventListener(ud.ROOM_COLOR,this.onRoomEngineEvent),um.instance.roomEngine.events.addEventListener(Nh.SELECTED,this.onRoomEngineObjectEvent),um.instance.roomEngine.events.addEventListener(Nh.DESELECTED,this.onRoomEngineObjectEvent),um.instance.roomEngine.events.addEventListener(Nh.ADDED,this.onRoomEngineObjectEvent),um.instance.roomEngine.events.addEventListener(Nh.REMOVED,this.onRoomEngineObjectEvent),um.instance.roomEngine.events.addEventListener(Nh.PLACED,this.onRoomEngineObjectEvent),um.instance.roomEngine.events.addEventListener(Nh.REQUEST_MOVE,this.onRoomEngineObjectEvent),um.instance.roomEngine.events.addEventListener(Nh.REQUEST_ROTATE,this.onRoomEngineObjectEvent),um.instance.roomEngine.events.addEventListener(Nh.MOUSE_ENTER,this.onRoomEngineObjectEvent),um.instance.roomEngine.events.addEventListener(Nh.MOUSE_LEAVE,this.onRoomEngineObjectEvent),um.instance.roomEngine.events.addEventListener(md.OPEN_WIDGET,this.onRoomEngineObjectEvent),um.instance.roomEngine.events.addEventListener(md.CLOSE_WIDGET,this.onRoomEngineObjectEvent),um.instance.roomEngine.events.addEventListener(md.REQUEST_INTERNAL_LINK,this.onRoomEngineObjectEvent),um.instance.roomEngine.events.addEventListener(md.REQUEST_ROOM_LINK,this.onRoomEngineObjectEvent),um.instance.roomEngine.events.addEventListener(md.REQUEST_TROPHY,this.onRoomEngineObjectEvent),um.instance.roomEngine.events.addEventListener(Od.OPEN_FURNI_CONTEXT_MENU,this.onRoomEngineObjectEvent)),um.instance.roomSessionManager.events&&(um.instance.roomSessionManager.events.addEventListener(Fe.CREATED,this.onRoomSessionEvent),um.instance.roomSessionManager.events.addEventListener(Fe.STARTED,this.onRoomSessionEvent),um.instance.roomSessionManager.events.addEventListener(Fe.ROOM_DATA,this.onRoomSessionEvent),um.instance.roomSessionManager.events.addEventListener(Fe.ENDED,this.onRoomSessionEvent),um.instance.roomSessionManager.events.addEventListener(Fg.CHAT_EVENT,this.onRoomSessionEvent),um.instance.roomSessionManager.events.addEventListener(Kg.RSDE_DANCE,this.onRoomSessionEvent),um.instance.roomSessionManager.events.addEventListener(qg.RSUBE_BADGES,this.onRoomSessionEvent),um.instance.roomSessionManager.events.addEventListener(zg.DOORBELL,this.onRoomSessionEvent),um.instance.roomSessionManager.events.addEventListener(zg.RSDE_REJECTED,this.onRoomSessionEvent),um.instance.roomSessionManager.events.addEventListener(zg.RSDE_ACCEPTED,this.onRoomSessionEvent))})}ngOnDestroy(){this._ngZone.runOutsideAngular(()=>{um.instance.roomEngine.events&&(um.instance.roomEngine.events.removeEventListener(ih.INITIALIZED,this.onRoomEngineEvent),um.instance.roomEngine.events.removeEventListener(ih.DISPOSED,this.onRoomEngineEvent),um.instance.roomEngine.events.removeEventListener(Pv.ROOM_ZOOM,this.onRoomEngineEvent),um.instance.roomEngine.events.removeEventListener(Sd.ROOM_BACKGROUND_COLOR,this.onRoomEngineEvent),um.instance.roomEngine.events.removeEventListener(Dh.ROOM_COLOR,this.onRoomEngineEvent),um.instance.roomEngine.events.removeEventListener(ud.ROOM_COLOR,this.onRoomEngineEvent),um.instance.roomEngine.events.removeEventListener(Nh.SELECTED,this.onRoomEngineObjectEvent),um.instance.roomEngine.events.removeEventListener(Nh.DESELECTED,this.onRoomEngineObjectEvent),um.instance.roomEngine.events.removeEventListener(Nh.ADDED,this.onRoomEngineObjectEvent),um.instance.roomEngine.events.removeEventListener(Nh.REMOVED,this.onRoomEngineObjectEvent),um.instance.roomEngine.events.removeEventListener(Nh.PLACED,this.onRoomEngineObjectEvent),um.instance.roomEngine.events.removeEventListener(Nh.REQUEST_MOVE,this.onRoomEngineObjectEvent),um.instance.roomEngine.events.removeEventListener(Nh.REQUEST_ROTATE,this.onRoomEngineObjectEvent),um.instance.roomEngine.events.removeEventListener(Nh.MOUSE_ENTER,this.onRoomEngineObjectEvent),um.instance.roomEngine.events.removeEventListener(Nh.MOUSE_LEAVE,this.onRoomEngineObjectEvent),um.instance.roomEngine.events.removeEventListener(md.OPEN_WIDGET,this.onRoomEngineObjectEvent),um.instance.roomEngine.events.removeEventListener(md.CLOSE_WIDGET,this.onRoomEngineObjectEvent),um.instance.roomEngine.events.removeEventListener(md.REQUEST_INTERNAL_LINK,this.onRoomEngineObjectEvent),um.instance.roomEngine.events.removeEventListener(md.REQUEST_ROOM_LINK,this.onRoomEngineObjectEvent),um.instance.roomEngine.events.removeEventListener(md.REQUEST_TROPHY,this.onRoomEngineObjectEvent),um.instance.roomEngine.events.removeEventListener(Od.OPEN_FURNI_CONTEXT_MENU,this.onRoomEngineObjectEvent)),um.instance.roomSessionManager.events&&(um.instance.roomSessionManager.events.removeEventListener(Fe.CREATED,this.onRoomSessionEvent),um.instance.roomSessionManager.events.removeEventListener(Fe.STARTED,this.onRoomSessionEvent),um.instance.roomSessionManager.events.removeEventListener(Fe.ROOM_DATA,this.onRoomSessionEvent),um.instance.roomSessionManager.events.removeEventListener(Fe.ENDED,this.onRoomSessionEvent),um.instance.roomSessionManager.events.removeEventListener(Fg.CHAT_EVENT,this.onRoomSessionEvent),um.instance.roomSessionManager.events.removeEventListener(Kg.RSDE_DANCE,this.onRoomSessionEvent),um.instance.roomSessionManager.events.removeEventListener(qg.RSUBE_BADGES,this.onRoomSessionEvent),um.instance.roomSessionManager.events.removeEventListener(zg.DOORBELL,this.onRoomSessionEvent),um.instance.roomSessionManager.events.removeEventListener(zg.RSDE_REJECTED,this.onRoomSessionEvent),um.instance.roomSessionManager.events.removeEventListener(zg.RSDE_ACCEPTED,this.onRoomSessionEvent))})}onRoomEngineEvent(t){if(!t)return;if(zp.isRoomPreviewerId(t.roomId))return;const e=um.instance.roomSessionManager.getSession(t.roomId);if(e)switch(t.type){case ih.INITIALIZED:return void(this.roomComponent&&(this.roomComponent.prepareRoom(e),um.instance.roomEngine.setActiveRoomId(t.roomId),this.roomComponent.createWidget(kd.CHAT_WIDGET,jA),this.roomComponent.createWidget(kd.INFOSTAND,CA),this.roomComponent.createWidget(kd.LOCATION_WIDGET,null),this.roomComponent.createWidget(kd.ROOM_DIMMER,null),this.roomComponent.createWidget(kd.INTERNAL_LINK,null),this.roomComponent.createWidget(kd.ROOM_LINK,null),this.roomComponent.createWidget(kd.CUSTOM_STACK_HEIGHT,PO),this.roomComponent.createWidget(kd.ROOM_DIMMER,GO),this.roomComponent.createWidget(kd.DOORBELL,NA),this.roomComponent.createWidget(kd.FURNI_TROPHY_WIDGET,YO),this.roomComponent.roomSession.isSpectator||(this.roomComponent.createWidget(kd.CHAT_INPUT_WIDGET,bO),this.roomComponent.createWidget(kd.AVATAR_INFO,dO),this.roomComponent.createWidget(kd.FURNI_CHOOSER,CO),this.roomComponent.createWidget(kd.USER_CHOOSER,wO))));case ih.DISPOSED:return;case Pv.ROOM_ZOOM:{const e=t;let s=e.level<1?.5:1<<Math.floor(e.level)-1;return(e.forceFlip||e.asDelta)&&(s=e.level),void(this.roomComponent&&um.instance.roomEngine.setRoomInstanceRenderingCanvasScale(this.roomComponent.roomSession.roomId,this.roomComponent.getFirstCanvasId(),s,null,null,!1,e.asDelta))}case Dh.ROOM_COLOR:if(this.roomComponent){const e=t;e._Str_11464?this.roomComponent.setRoomColorizerColor(16711680,255):this.roomComponent.setRoomColorizerColor(e.color,e._Str_5123)}return;case ud.ROOM_COLOR:return void(this.roomComponent&&this.roomComponent._Str_2485(t));case Sd.ROOM_BACKGROUND_COLOR:if(this.roomComponent){const e=t;e.enable?this.roomComponent.setRoomBackgroundColor(e.hue,e.saturation,e.lightness):this.roomComponent.setRoomBackgroundColor(0,0,0)}return}}onInterstitialEvent(t){t&&(t.type!==ih.GAME_MODE&&t.type!==ih.NORMAL_MODE||this.roomComponent&&this.roomComponent.onRoomEngineEvent(t))}onRoomEngineObjectEvent(t){this.roomComponent&&this.roomComponent.onRoomEngineObjectEvent(t)}onRoomSessionEvent(t){if(t)switch(t.type){case Fe.CREATED:return this._ngZone.run(()=>{this._landingViewVisible=!1}),void um.instance.roomSessionManager.startSession(t.session);case Fe.STARTED:case Fe.ROOM_DATA:return;case Fe.ENDED:return this.roomComponent&&this.roomComponent.endRoom(),void this._ngZone.run(()=>{this._landingViewVisible=t.openLandingView});default:return void(this.roomComponent&&this.roomComponent.processEvent(t))}}get landingViewVisible(){return this._landingViewVisible}get avatarEditorVisible(){return this._settingsService.avatarEditorVisible}get catalogVisible(){return this._settingsService.catalogVisible}get navigatorVisible(){return this._settingsService.navigatorVisible}get inventoryVisible(){return this._settingsService.inventoryVisible}get friendListVisible(){return this._settingsService.friendListVisible}get achievementsVisible(){return this._settingsService.achievementsVisible}get isReady(){return this._settingsService.isReady}}return t.\u0275fac=function(e){return new(e||t)(i.Ub(Nm),i.Ub(gm),i.Ub(i.E))},t.\u0275cmp=i.Ob({type:t,selectors:[["nitro-main-component"]],viewQuery:function(t,e){if(1&t&&i.Wc(YT,!0),2&t){let t;i.Ac(t=i.kc())&&(e.roomComponent=t.first)}},decls:15,vars:9,consts:[[1,"nitro-main-component"],["class","nitro-right-side",4,"ngIf"],[3,"visible"],[4,"ngIf"],[3,"isInRoom",4,"ngIf"],[1,"nitro-right-side"],[1,"d-flex","flex-column"],[3,"isInRoom"]],template:function(t,e){1&t&&(i.Zb(0,"div",0),i.Vb(1,"nitro-notification-main-component"),i.Pc(2,hC,4,1,"div",1),i.Vb(3,"nitro-achievements-main-component",2),i.Vb(4,"nitro-call-for-help-main-component"),i.Vb(5,"nitro-pedia-main-component"),i.Vb(6,"nitro-avatar-editor-main-component",2),i.Pc(7,lC,1,0,"nitro-hotelview-component",3),i.Pc(8,uC,1,1,"nitro-toolbar-component",4),i.Vb(9,"nitro-friendlist-main-component",2),i.Vb(10,"nitro-catalog-main-component",2),i.Vb(11,"nitro-navigator-main-component",2),i.Vb(12,"nitro-inventory-main-component",2),i.Vb(13,"nitro-wired-main-component"),i.Vb(14,"nitro-room-component"),i.Yb()),2&t&&(i.Gb(2),i.sc("ngIf",e.isReady),i.Gb(1),i.sc("visible",e.achievementsVisible),i.Gb(3),i.sc("visible",e.avatarEditorVisible),i.Gb(1),i.sc("ngIf",e.landingViewVisible),i.Gb(1),i.sc("ngIf",e.isReady),i.Gb(1),i.sc("visible",e.friendListVisible),i.Gb(1),i.sc("visible",e.catalogVisible),i.Gb(1),i.sc("visible",e.navigatorVisible),i.Gb(1),i.sc("visible",e.inventoryVisible))},directives:[ty,o.m,vy,Ty,Cy,Gm,xf,YE,vb,XS,Iv,YT,Ly,Gy,jy,_C],encapsulation:2,data:{animation:[Object(Lv.j)("inOutAnimation",[Object(Lv.i)(":enter",[Object(Lv.h)({top:"-100%"}),Object(Lv.e)("1s ease-out",Object(Lv.h)({top:0}))])])]}}),t})();function gC(t,e){if(1&t&&i.Vb(0,"nitro-loading",3),2&t){const t=i.lc();i.sc("message",t.message)("percentage",t.percentage)("hideProgress",t.hideProgress)}}function mC(t,e){1&t&&i.Vb(0,"nitro-main-component")}let pC=(()=>{class t{constructor(t,e){this._settingsService=t,this._ngZone=e,this.message="Starting",this.percentage=0,this.hideProgress=!1,this.isLocalizationReady=!1,this.isRoomEngineReady=!1,this.isAvatarRenderReady=!1,this.isError=!1,this.onNitroEvent=this.onNitroEvent.bind(this)}ngOnInit(){this._ngZone.runOutsideAngular(()=>{if(!NitroConfig)throw new Error("NitroConfig is not defined!");(class{static isWebGLAvailable(){try{if(!window.WebGLRenderingContext)return!1;const t={stencil:!0,failIfMajorPerformanceCaveat:A.s.FAIL_IF_MAJOR_PERFORMANCE_CAVEAT},e=document.createElement("canvas");let s=e.getContext("webgl",t)||e.getContext("experimental-webgl",t);const i=!(!s||!s.getContextAttributes().stencil);if(s){const t=s.getExtension("WEBGL_lose_context");t&&t.loseContext()}return s=null,i}catch(t){return!1}}}).isWebGLAvailable()?(um.instance||um.bootstrap(),um.instance.events.addEventListener(Le.CONNECTION_ESTABLISHED,this.onNitroEvent),um.instance.events.addEventListener(Le.CONNECTION_HANDSHAKING,this.onNitroEvent),um.instance.events.addEventListener(Le.CONNECTION_HANDSHAKE_FAILED,this.onNitroEvent),um.instance.events.addEventListener(Le.CONNECTION_AUTHENTICATED,this.onNitroEvent),um.instance.events.addEventListener(Le.CONNECTION_ERROR,this.onNitroEvent),um.instance.events.addEventListener(Le.CONNECTION_CLOSED,this.onNitroEvent),um.instance.localization.events.addEventListener(eh.LOADED,this.onNitroEvent),um.instance.roomEngine.events.addEventListener(ih.ENGINE_INITIALIZED,this.onNitroEvent),um.instance.avatar.events.addEventListener(Et.AVATAR_RENDER_READY,this.onNitroEvent),um.instance.core.configuration.events.addEventListener(C.LOADED,this.onNitroEvent),um.instance.core.configuration.events.addEventListener(C.FAILED,this.onNitroEvent),um.instance.core.configuration.init(),this._connectionTimeout=setTimeout(this.onConnectionTimeout,15e3)):this.onNitroEvent(new y(um.WEBGL_UNAVAILABLE))})}ngOnDestroy(){this._ngZone.runOutsideAngular(()=>{um.instance.events.removeEventListener(Le.CONNECTION_ESTABLISHED,this.onNitroEvent),um.instance.events.removeEventListener(Le.CONNECTION_HANDSHAKING,this.onNitroEvent),um.instance.events.removeEventListener(Le.CONNECTION_HANDSHAKE_FAILED,this.onNitroEvent),um.instance.events.removeEventListener(Le.CONNECTION_AUTHENTICATED,this.onNitroEvent),um.instance.events.removeEventListener(Le.CONNECTION_ERROR,this.onNitroEvent),um.instance.events.removeEventListener(Le.CONNECTION_CLOSED,this.onNitroEvent),um.instance.localization.events.removeEventListener(eh.LOADED,this.onNitroEvent),um.instance.roomEngine.events.removeEventListener(ih.ENGINE_INITIALIZED,this.onNitroEvent),um.instance.avatar.events.removeEventListener(Et.AVATAR_RENDER_READY,this.onNitroEvent),um.instance.core.configuration.events.removeEventListener(C.LOADED,this.onNitroEvent),um.instance.core.configuration.events.removeEventListener(C.FAILED,this.onNitroEvent),clearTimeout(this._connectionTimeout)})}getPreloadAssetUrls(){const t=[],e=um.instance.getConfiguration("preload.assets.urls");if(e&&e.length)for(const s of e)t.push(um.instance.core.configuration.interpolate(s));return t}onNitroEvent(t){if(t)switch(t.type){case C.LOADED:return void um.instance.localization.init();case C.FAILED:return void this._ngZone.run(()=>{this.isError=!0,this.message="Configuration Failed",this.percentage=0,this.hideProgress=!0});case um.WEBGL_UNAVAILABLE:return void this._ngZone.run(()=>{this.isError=!0,this.message="WebGL Required",this.percentage=0,this.hideProgress=!0});case um.WEBGL_CONTEXT_LOST:return this._ngZone.run(()=>{this.isError=!0,this.message="WebGL Context Lost - Reloading",this.percentage=0,this.hideProgress=!0}),void setTimeout(()=>location.reload(),1500);case Le.CONNECTION_HANDSHAKING:this._ngZone.run(()=>{this.message="Handshaking",this.percentage=this.percentage+20,this.hideProgress=!1}),clearTimeout(this._connectionTimeout);break;case Le.CONNECTION_HANDSHAKE_FAILED:this._ngZone.run(()=>{this.isError=!0,this.message="Handshake Failed",this.percentage=0,this.hideProgress=!0});break;case Le.CONNECTION_AUTHENTICATED:this._ngZone.run(()=>{this.message="Preparing Nitro",this.percentage=this.percentage+20,this.hideProgress=!1}),um.instance.init(),clearTimeout(this._connectionTimeout);break;case Le.CONNECTION_ERROR:this._ngZone.run(()=>{this.isError=!0,this.message="Connection Error",this.percentage=0,this.hideProgress=!0});break;case Le.CONNECTION_CLOSED:um.instance.roomEngine&&um.instance.roomEngine.dispose(),this._ngZone.run(()=>{this.isError=!0,this.message="Connection Closed",this.percentage=0,this.hideProgress=!0}),Q_.call("disconnect",-1,"client.init.handshake.fail");break;case eh.LOADED:this._ngZone.run(()=>{this.isLocalizationReady=!0,this.percentage=this.percentage+20,this.hideProgress=!1}),um.instance.core.asset.downloadAssets(this.getPreloadAssetUrls(),t=>{um.instance.communication.init()});break;case ih.ENGINE_INITIALIZED:this._ngZone.run(()=>{this.isRoomEngineReady=!0,this.percentage=this.percentage+20,this.hideProgress=!1}),um.instance.communication.connection.onReady();break;case Et.AVATAR_RENDER_READY:this._ngZone.run(()=>{this.isAvatarRenderReady=!0,this.percentage=this.percentage+20,this.hideProgress=!1})}}get isReady(){return this._settingsService.isReady=this.isLocalizationReady&&this.isRoomEngineReady&&this.isAvatarRenderReady,this.isLocalizationReady&&this.isRoomEngineReady&&this.isAvatarRenderReady||!1}onConnectionTimeout(){Q_.call("logDebug","TcpAuth control socket security error")}}return t.\u0275fac=function(e){return new(e||t)(i.Ub(gm),i.Ub(i.E))},t.\u0275cmp=i.Ob({type:t,selectors:[["app-root"]],decls:3,vars:2,consts:[["id","nitro"],[3,"message","percentage","hideProgress",4,"ngIf"],[4,"ngIf"],[3,"message","percentage","hideProgress"]],template:function(t,e){1&t&&(i.Zb(0,"div",0),i.Pc(1,gC,1,3,"nitro-loading",1),i.Pc(2,mC,1,0,"nitro-main-component",2),i.Yb()),2&t&&(i.Gb(1),i.sc("ngIf",!e.isReady||e.isError),i.Gb(1),i.sc("ngIf",e.isReady&&!e.isError))},directives:[o.m,Uv,dC],encapsulation:2}),t})(),EC=(()=>{class t{}return t.\u0275mod=i.Sb({type:t}),t.\u0275inj=i.Rb({factory:function(e){return new(e||t)},providers:[gm]}),t})(),fC=(()=>{class t{}return t.\u0275mod=i.Sb({type:t}),t.\u0275inj=i.Rb({factory:function(e){return new(e||t)},providers:[Vy]}),t})(),SC=(()=>{class t{}return t.\u0275mod=i.Sb({type:t,bootstrap:[pC]}),t.\u0275inj=i.Rb({factory:function(e){return new(e||t)},imports:[[p,EC,fC,Mv,r.a,n.a]]}),t})();Object(i.Z)(),r.c().bootstrapModule(SC).catch(t=>console.log(t))},zn8P:function(t,e){function s(t){return Promise.resolve().then((function(){var e=new Error("Cannot find module '"+t+"'");throw e.code="MODULE_NOT_FOUND",e}))}s.keys=function(){return[]},s.resolve=s,t.exports=s,s.id="zn8P"}},[[0,0,4]]]);